<!DOCTYPE html>

<html lang="en">

<head>
	  <meta charset="UTF-8">
  <title>Algorithms & Optimization</title>
  <link rel="icon" href="../_static/img/Symbol.png" />

  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />

  <!-- Google font -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700,900" rel="stylesheet">

  <!-- FreeFEM theme specific -->
  <link rel="stylesheet" type="text/css" href="../_static/css/freefemtheme.css" />

  <!-- css -->
  <link rel="stylesheet" href="../_static/css/pygments_custom.css" type="text/css" />

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
</head>

<body>
	<header>
   <a class="header-logo" href="../introduction/index.html">
      <img alt="logo" title="FreeFEM documentation" src="../_static/img/FreeFem_Documentation_Logo_bleu.svg" />
   </a>

   <a class="header-github" href="https://github.com/FreeFem/FreeFem-doc" target="_blank">
      <i class="fab fa-github"></i>
      <p class="header-github-title" >
         FreeFEM Documentation on GitHub
      </p>

      <p class="header-github-stars" id="headerGithubStarsForks">
         <span id="headerGithubStars"></span> stars - <span id="headerGithubForks"></span> forks
      </p>
   </a>
</header>
	
	<nav id="nav">
	<div style="display: none;">
		<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html"><strong>Introduction</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/new-features.html">New features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-13-30-june-2023">Version 4.13 (30 June 2023)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-12">Version 4.12</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-11">Version 4.11</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-10">Version 4.10</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-9">Version 4.9</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-8">Version 4.8</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-7-1">Version 4.7-1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-7">Version 4.7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-6">Version 4.6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-5">Version 4.5</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/new-features.html#release-binaries-packages">Release, binaries packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/new-features.html#new-meshes-and-fem-border">New meshes and FEM border</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/new-features.html#boundary-element-method">Boundary Element Method</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/installation.html">Installation guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#using-binary-package">Using binary package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#windows-installation">Windows installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#macos-x-installation">macOS X installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#ubuntu-installation">Ubuntu installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#arch-aur-package">Arch AUR package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#fedora-installation">Fedora installation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#compiling-source-code">Compiling source code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-osx-10-13">Compilation on OSX (&gt;=10.13)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-ubuntu">Compilation on Ubuntu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-arch-linux">Compilation on Arch Linux</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-fedora">Compilation on Fedora</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-linux-with-intel-software-tools">Compilation on Linux with Intel software tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-windows">Compilation on Windows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#freefem-continuous-integration"><strong>FreeFEM</strong> continuous integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#environment-variables-and-init-file">Environment variables and init file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#coloring-syntax-freefem">Coloring Syntax FreeFem++</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#atom">Atom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#gedit">Gedit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#textmate-2-an-editor-under-macos">Textmate 2, an editor under macOS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#notepad-an-editor-under-windows">Notepad++,an editor under windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#emacs-editor">Emacs editor</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/download.html">Download</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/download.html#latest-binary-packages">Latest binary packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/download.html#syntax-highlighters">Syntax highlighters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/history.html">History</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/citation.html">Citation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/citation.html#if-you-use-freefem-please-cite-the-following-reference-in-your-work">If you use <strong>FreeFEM</strong>, please cite the following reference in your work:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#bibtex">BibTeX</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#apa">APA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#iso690">ISO690</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#mla">MLA</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/authors.html">Authors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/contributing.html">Contributing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/contributing.html#bug-report">Bug report</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/contributing.html#concerning-the-freefem-documentation">Concerning the <strong>FreeFEM</strong> documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/contributing.html#concerning-the-freefem-compilation-or-usage">Concerning the <strong>FreeFEM</strong> compilation or usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/contributing.html#improve-content">Improve content</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/git-github.html">Git &amp; Github usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/git-github.html#contribution-timeline">Contribution timeline</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Learning by Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/poisson.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/equationsClassification.html">Classification of partial differential equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/membrane.html">Membrane</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/heatExchanger.html">Heat Exchanger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/acoustics.html">Acoustics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/thermalConduction.html">Thermal Conduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/thermalConduction.html#axisymmetry-3d-rod-with-circular-section">Axisymmetry: 3D Rod with circular section</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/thermalConduction.html#a-nonlinear-problem-radiation">A Nonlinear Problem : Radiation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/fanBlade.html">Irrotational Fan Blade Flow and Thermal effects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/fanBlade.html#heat-convection-around-the-airfoil">Heat Convection around the airfoil</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/rotatingHill.html">Pure Convection : The Rotating Hill</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/rotatingHill.html#solution-by-a-characteristics-galerkin-method">Solution by a Characteristics-Galerkin Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/rotatingHill.html#solution-by-discontinuous-galerkin-fem">Solution by Discontinuous-Galerkin FEM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/elasticity.html">The System of elasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/stokes.html">The System of Stokes for Fluids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/navierStokesProjection.html">A projection algorithm for the Navier-Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/navierStokesNewton.html">Newton Method for the Steady Navier-Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/aLargeFluidProblem.html">A Large Fluid Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/complexNumbers.html">An Example with Complex Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/optimalControl.html">Optimal Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/flowWithShocks.html">A Flow with Shocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/heatEquationOptimization.html">Time dependent schema optimization for heat equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/timeDependentStokes.html">Tutorial to write a transient Stokes solver in matrix form</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/wifiPropagation.html">Wifi Propagation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/wifiPropagation.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/wifiPropagation.html#physics">Physics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/wifiPropagation.html#coding">Coding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/wifiPropagation.html#the-domain">The domain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/wifiPropagation.html#lets-create-a-mesh">Let’s create a mesh</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/matlabOctavePlot.html">Plotting in Matlab and Octave</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#d-problem">2D Problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#exporting-data">Exporting Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#importing-data">Importing Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#d-plot-examples">2D Plot Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#id1">3D Plot Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="notations.html">Notations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="notations.html#generalities">Generalities</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#sets-mappings-matrices-vectors">Sets, Mappings, Matrices, Vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#numbers">Numbers</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#differential-calculus">Differential Calculus</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#meshes">Meshes</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#functional-spaces">Functional Spaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#finite-element-spaces">Finite Element Spaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mesh-generation.html">Mesh Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#the-type-mesh-in-2-dimension"><strong>The type mesh in 2 dimension</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#commands-for-2d-mesh-generation">Commands for 2d mesh Generation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-square">The command <em>square</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-buildmesh">The command <em>buildmesh</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#mesh-connectivity-and-data">Mesh Connectivity and data</a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#the-keyword-triangulate">The keyword “triangulate”</a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#d-finite-element-space-on-a-boundary">2d Finite Element space on a boundary</a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#remeshing">Remeshing</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-movemesh">The command <em>movemesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-htriangle">The command <em>hTriangle</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-adaptmesh">The command <em>adaptmesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-trunc">The command <em>trunc</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-change">The command <em>change</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-splitmesh">The command <em>splitmesh</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#meshing-examples">Meshing Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#the-type-mesh3-in-3-dimension"><strong>The type mesh3 in 3 dimension</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#d-mesh-generation">3d mesh generation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-cube">The command <em>cube</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-buildlayers">The command <em>buildlayers</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#id3">Remeshing</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id4">The command <em>change</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#meshgenerationtrunc">The command <em>trunc</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id6">The command <em>movemesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-extract">The command <em>extract</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-buildsurface">The command <em>buildSurface</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-movemesh23">The command <em>movemesh23</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#d-meshing-examples">3d Meshing examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#the-type-meshs-in-3-dimension"><strong>The type meshS in 3 dimension</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#commands-for-3d-surface-mesh-generation">Commands for 3d surface mesh generation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-square3">The command <em>square3</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#surface-mesh-builders">surface mesh builders</a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#d-mesh-generators-combined-with-movemesh23">2D mesh generators combined with  <em>movemesh23</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#id7">Remeshing</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id8">The command <em>trunc</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id9">The command <em>movemesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id10">The command <em>change</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#link-with-a-mesh3">Link with a mesh3</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-gamma">The command <em>Gamma</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-buildbdmesh">The command <em>buildBdMesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-savesurfacemesh">The command <em>savesurfacemesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#glue-of-meshs-meshes">Glue of meshS meshes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#the-type-meshl-in-3-dimension"><strong>The type meshL in 3 dimension</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#commands-for-3d-curve-mesh-generation">Commands for 3d curve mesh generation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-segment">The command <em>segment</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id11">The command <em>buildmesh</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#id12">Remeshing</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id13">The command <em>trunc</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id14">The command <em>movemesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id15">The command <em>change</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-commands-buildbdmesh-and-gamma">The commands <em>buildBdMesh</em> and <em>Gamma</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#glue-of-meshl-meshes">Glue of meshL meshes</a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id16">The command extract</a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-commands-rebuildborder">The commands <em>rebuildBorder</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#the-commands-checkmesh">The commands <em>checkmesh</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#tetgen-a-tetrahedral-mesh-generator">TetGen: A tetrahedral mesh generator</a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#reconstruct-refine-a-3d-mesh-with-tetgen">Reconstruct/Refine a 3d mesh with TetGen</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#read-write-statements-for-meshes">Read/Write Statements for meshes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#d-case">2d case</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#format-of-mesh-data">format of  mesh data</a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#input-output-for-a-mesh">Input/output for a mesh</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#id27">3d case</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id28">format of  mesh data</a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#input-output-for-a-mesh3">Input/output for a mesh3</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#surface-3d-case">Surface 3d case</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id29">format of  mesh data</a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#input-output-for-a-meshs">Input/output for a meshS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#medit">Medit</a></li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#mshmet">Mshmet</a></li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#freeyams">FreeYams</a></li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#mmg3d">mmg3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#a-first-3d-isotrope-mesh-adaptation-process">A first 3d isotrope mesh adaptation process</a></li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#build-a-2d-mesh-from-an-isoline">Build a 2d mesh from an isoline</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="finite-element.html">Finite element</a><ul>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#list-of-the-types-of-finite-elements">List of the types of finite elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#use-of-fespace-in-2d">Use of fespace in 2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#use-of-fespace-in-3d">Use of fespace in 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#use-of-fespace-in-surface-3d">Use of fespace in surface 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#finite-element-functions">Finite Element functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#lagrangian-finite-elements">Lagrangian Finite Elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="finite-element.html#p0-element">P0-element</a></li>
<li class="toctree-l4"><a class="reference internal" href="finite-element.html#p1-element">P1-element</a></li>
<li class="toctree-l4"><a class="reference internal" href="finite-element.html#p2-element">P2-element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#surface-lagrangian-finite-elements">Surface Lagrangian Finite Elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="finite-element.html#definition-of-the-surface-p1-lagragian-element">Definition of the surface P1 Lagragian element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#p1-nonconforming-element">P1 Nonconforming Element</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#other-fe-space">Other FE-space</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#vector-valued-fe-function">Vector Valued FE-function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="finite-element.html#raviart-thomas-element">Raviart-Thomas Element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#a-fast-finite-element-interpolator">A Fast Finite Element Interpolator</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#keywords-problem-and-solve">Keywords: Problem and Solve</a><ul>
<li class="toctree-l4"><a class="reference internal" href="finite-element.html#weak-form-and-boundary-condition">Weak Form and Boundary Condition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#parameters-affecting-solve-and-problem">Parameters affecting solve and problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#problem-definition">Problem definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#numerical-integration">Numerical Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#variational-form-sparse-matrix-pde-data-vector">Variational Form, Sparse Matrix, PDE Data Vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#interpolation-matrix">Interpolation matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#finite-elements-connectivity">Finite elements connectivity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#plot">Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-gnuplot">Link with gnuplot</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-medit">Link with medit</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-paraview">Link with Paraview</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-matlab-and-octave">Link with Matlab© and Octave</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Algorithms &amp; Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#conjugate-gradient-gmres">Conjugate Gradient/GMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#algorithms-for-unconstrained-optimization">Algorithms for Unconstrained Optimization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-of-usage-for-bfgs-or-cmaes">Example of usage for BFGS or CMAES</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ipopt">IPOPT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#short-description-of-the-algorithm">Short description of the algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ipopt-in-freefem">IPOPT in <strong>FreeFEM</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#some-short-examples-using-ipopt">Some short examples using IPOPT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#d-constrained-minimum-surface-with-ipopt">3D constrained minimum surface with IPOPT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#area-and-volume-expressions">Area and volume expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#derivatives">Derivatives</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-problem-and-its-script">The problem and its script</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-nlopt-optimizers">The nlOpt optimizers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optimization-with-mpi">Optimization with MPI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parallelization.html">Parallelization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parallelization.html#mpi">MPI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-keywords">MPI Keywords</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-constants">MPI Constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-constructor">MPI Constructor</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-functions">MPI Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-communicator-operator">MPI Communicator operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#schwarz-example-in-parallel">Schwarz example in parallel</a><ul>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#true-parallel-schwarz-example">True parallel Schwarz example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="parallelization.html#parallel-sparse-solvers">Parallel sparse solvers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#using-parallel-sparse-solvers-in-freefem">Using parallel sparse solvers in <strong>FreeFEM</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#sparse-direct-solver">Sparse direct solver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#mumps-solver">MUMPS solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#superlu-distributed-solver">SuperLU distributed solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#pastix-solver">PaStiX solver</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#parallel-sparse-iterative-solver">Parallel sparse iterative solver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#parms-solver">pARMS solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#interfacing-with-hips">Interfacing with HIPS</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#interfacing-with-hypre">Interfacing with HYPRE</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#domain-decomposition">Domain decomposition</a><ul>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#communicators-and-groups">Communicators and groups</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#process">Process</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#points-to-points-communicators">Points to Points communicators</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#global-operations">Global operations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="petsc/index.html">PETSc and SLEPc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="petsc/examples.html">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="petsc/examples.html#linear-problems">Linear problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="petsc/examples.html#nonlinear-problems">Nonlinear problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="petsc/examples.html#time-steppers-and-optimizers">Time steppers and optimizers</a></li>
<li class="toctree-l4"><a class="reference internal" href="petsc/examples.html#eigenvalue-problems">Eigenvalue problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="petsc/examples.html#miscellaneous">Miscellaneous</a></li>
<li class="toctree-l4"><a class="reference internal" href="petsc/examples.html#reproducible-science">Reproducible science</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="BEM.html">The Boundary Element Method</a><ul>
<li class="toctree-l3"><a class="reference internal" href="BEM.html#introduction-to-the-boundary-element-method-bem">Introduction to the Boundary Element Method (BEM)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#model-problem">Model problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#boundary-integral-operators">Boundary Integral Operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#the-bemtool-library">the BEMTool library</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#hierarchical-matrices">Hierarchical matrices</a><ul>
<li class="toctree-l5"><a class="reference internal" href="BEM.html#low-rank-approximation">Low-rank approximation</a></li>
<li class="toctree-l5"><a class="reference internal" href="BEM.html#hierarchical-block-structure">Hierarchical block structure</a></li>
<li class="toctree-l5"><a class="reference internal" href="BEM.html#the-htool-library">The Htool library</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="BEM.html#solve-a-bem-problem-with-freefem">Solve a BEM problem with FreeFEM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#build-the-geometry">Build the geometry</a><ul>
<li class="toctree-l5"><a class="reference internal" href="BEM.html#d">2D</a></li>
<li class="toctree-l5"><a class="reference internal" href="BEM.html#id3">3D</a></li>
<li class="toctree-l5"><a class="reference internal" href="BEM.html#orientation-of-normal-vector">Orientation of normal vector</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#define-the-type-of-operator">Define the type of operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#define-the-variational-problem">Define the variational problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#assemble-the-h-matrix">Assemble the H-Matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#solve-the-linear-system">Solve the linear system</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#compute-the-solution">Compute the solution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="BEM.html#d-example-script">2D example script</a></li>
<li class="toctree-l3"><a class="reference internal" href="BEM.html#bem-for-maxwell-s-equations">BEM for Maxwell’s equations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#efie-for-the-scattering-problem">EFIE for the scattering problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#maxwell-bem-problem-in-freefem">Maxwell BEM problem in FreeFEM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="composite.html">Composite finite element spaces <span class="red">NEW!</span></a><ul>
<li class="toctree-l3"><a class="reference internal" href="composite.html#limitations-of-the-current-syntax">Limitations of the current syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="composite.html#definition-of-composite-spaces">Definition of composite spaces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="composite.html#first-examples">First examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="composite.html#stokes-with-p2-iso-p1-elements">Stokes with P2-iso-P1 elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="composite.html#using-solve-or-problem">using <em>solve</em> or <em>problem</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="composite.html#using-varf-and-matrix">using <em>varf</em> and <em>matrix</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="composite.html#parallel-assembly-and-solution">Parallel assembly and solution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="composite.html#with-mumps">with <em>MUMPS</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="composite.html#with-petsc">with <em>PETSc</em></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html">Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#gsl">gsl</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#ffrandom">ffrandom</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#mmap-semaphore">mmap / semaphore</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="developers.html">Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="developers.html#file-formats">File formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="developers.html#mesh-file-data-structure">Mesh file data structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#bb-file-type-to-store-solutions">bb file type to Store Solutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#id1">BB file type to store solutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#metric-file">Metric file</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#list-of-am-fmt-amdba-meshes">List of AM_FMT, AMDBA Meshes</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#sol-and-solb-files">sol and solb files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="developers.html#adding-a-new-finite-element">Adding a new finite element</a><ul>
<li class="toctree-l4"><a class="reference internal" href="developers.html#some-notations">Some notations</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#which-class-to-add">Which class to add?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="developers.html#dynamical-link">Dynamical link</a><ul>
<li class="toctree-l4"><a class="reference internal" href="developers.html#a-first-example-myfunction-cpp">A first example myfunction.cpp</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#example-discrete-fast-fourier-transform">Example: Discrete Fast Fourier Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#load-module-for-dervieux-p0-p1-finite-volume-method">Load Module for Dervieux P0-P1 Finite Volume Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#more-on-adding-a-new-finite-element">More on Adding a new finite element</a><ul>
<li class="toctree-l5"><a class="reference internal" href="developers.html#the-bernardi-raugel-element">The Bernardi-Raugel Element</a></li>
<li class="toctree-l5"><a class="reference internal" href="developers.html#the-morley-element">The Morley Element</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ffddm/index.html">ffddm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html">Domain Decomposition (DD)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#mesh-decomposition">Mesh Decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#distributed-linear-algebra">Distributed Linear Algebra</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#partition-of-unity-matrices-poum">Partition of Unity Matrices (POUM)</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#distributed-scalar-product">Distributed scalar product</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#update">Update</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#distributed-matrix-and-vector-resulting-from-a-variational-formulation">Distributed Matrix and Vector resulting from a variational formulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#distributed-linear-solvers">Distributed Linear Solvers</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#distributed-direct-solvers">Distributed Direct Solvers</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#schwarz-methods">Schwarz methods</a><ul>
<li class="toctree-l6"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#restricted-additive-schwarz-ras">Restricted Additive Schwarz (RAS)</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#optimized-restricted-additive-schwarz-oras">Optimized Restricted Additive Schwarz (ORAS)</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#two-level-methods">Two level methods</a><ul>
<li class="toctree-l7"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#coarse-mesh">Coarse Mesh</a></li>
<li class="toctree-l7"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#geneo">GenEO</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/documentation.html">ffddm documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#minimal-example">Minimal example</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#overlapping-mesh-decomposition">Overlapping mesh decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#local-finite-element-spaces">Local finite element spaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#define-the-problem-to-solve">Define the problem to solve</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#one-level-preconditioners">One level preconditioners</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#two-level-preconditioners">Two level preconditioners</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#building-the-geneo-coarse-space">Building the GenEO coarse space</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#building-the-coarse-space-from-a-coarse-mesh">Building the coarse space from a coarse mesh</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#solving-the-linear-system">Solving the linear system</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#using-hpddm-within-ffddm">Using <em>HPDDM</em> within <em>ffddm</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#advanced-use">Advanced use</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#interpolation-between-two-distributed-finite-element-spaces">Interpolation between two distributed finite element spaces</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#local-finite-element-spaces-for-non-lagrange-finite-elements">Local finite element spaces for non Lagrange finite elements</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#inexact-coarse-solves-for-two-level-methods">Inexact coarse solves for two level methods</a><ul>
<li class="toctree-l6"><a class="reference internal" href="ffddm/documentation.html#coarse-mesh-and-inexact-coarse-solve">Coarse mesh and inexact coarse solve</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/parameters.html">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/parameters.html#command-line-arguments">Command-line arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/parameters.html#global-parameters">Global parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/tutorial.html">Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#what-is-ffddm">What is <strong>ffddm</strong> ?</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#why-domain-decomposition-methods">Why Domain Decomposition Methods ?</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-1-decompose-the-mesh">Step 1: Decompose the mesh</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-2-define-your-finite-element">Step 2: Define your finite element</a><ul>
<li class="toctree-l6"><a class="reference internal" href="ffddm/tutorial.html#distributed-vectors-and-restriction-operators">Distributed vectors and restriction operators</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/tutorial.html#partition-of-unity">Partition of unity</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/tutorial.html#data-exchange-between-neighbors">Data exchange between neighbors</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-3-define-your-problem">Step 3: Define your problem</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#summary-so-far-translating-your-sequential-freefem-script">Summary so far: translating your sequential <em>FreeFEM</em> script</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#id1">Step 1: Decompose the mesh</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#solve-the-linear-system">Solve the linear system</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#solve-the-linear-system-with-the-parallel-direct-solver-mumps">Solve the linear system with the parallel direct solver <em>MUMPS</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-4-define-the-one-level-dd-preconditioner">Step 4: Define the one level DD preconditioner</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-5-solve-the-linear-system-with-preconditioned-gmres">Step 5: Solve the linear system with preconditioned GMRES</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#define-a-two-level-dd-preconditioner">Define a two level DD preconditioner</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#build-the-geneo-coarse-space">Build the GenEO coarse space</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#build-the-coarse-space-from-a-coarse-mesh">Build the coarse space from a coarse mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#use-hpddm-within-ffddm">Use <strong>HPDDM</strong> within <strong>ffddm</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#some-results-heterogeneous-3d-elasticity-with-geneo">Some results: Heterogeneous 3D elasticity with GenEO</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#some-results-2-level-dd-for-maxwell-equations-scattering-from-the-cobra-cavity">Some results: 2-level DD for Maxwell equations, scattering from the COBRA cavity</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#id2">Some results: 2-level DD for Maxwell equations, scattering from the COBRA cavity</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/examples.html">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references/index.html">Language references</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../references/types.html">Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#standard-types">Standard types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#int">int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#bool">bool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#real">real</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#complex">complex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#string">string</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#mesh-design">Mesh design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#border">border</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#mesh">mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#mesh3">mesh3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#finite-element-space-design">Finite element space design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#fespace">fespace</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#macro-design">Macro design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#macro">macro</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#newmacro-endmacro">NewMacro / EndMacro</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#ifmacro">IFMACRO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#endifmacro">ENDIFMACRO</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#functions-design">Functions design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#func">func</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#elementary-functions">Elementary functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#random-functions">Random functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#fe-functions">FE-functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#problem-design">Problem design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#problem">problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#solve">solve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#varf">varf</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#array">Array</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#array-index">Array index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#array-size">Array size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#array-sort">Array sort</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#double-array">Double array</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#array-of-fe-functions">Array of FE functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#map-arrays">Map arrays</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#matrix">matrix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#matrix-size">Matrix size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#matrix-resize">Matrix resize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#matrix-diagonal">Matrix diagonal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#matrix-renumbering">Matrix renumbering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#complex-matrix">Complex matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#dot-product-outer-product">Dot product / Outer product</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#matrix-inversion">Matrix inversion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/global-variables.html">Global variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#area">area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#argv">ARGV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#boundaryedge">BoundaryEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#cg">CG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#cholesky">Cholesky</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#crout">Crout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#edgeorientation">edgeOrientation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#false">false</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#gmres">GMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#htriangle">hTriangle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#include">include</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#internaledge">InternalEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#label">label</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#lenedge">lenEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#load">load</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#lu">LU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#n">N</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#ntonedge">nTonEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#nuedge">nuEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#nutriangle">nuTriangle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#p">P</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#pi">pi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#region">region</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#sparsesolver">sparsesolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#true">true</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#verbosity">verbosity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#version">version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#volume">volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#x">x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#y">y</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#z">z</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/quadrature-formulae.html">Quadrature formulae</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/quadrature-formulae.html#int1d">int1d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#notations">Notations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf1pe">qf1pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf2pe">qf2pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf3pe-default">qf3pE   <em>(default)</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf4pe">qf4pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf5pe">qf5pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf1pelump">qf1pElump</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/quadrature-formulae.html#int2d">int2d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf1pt">qf1pT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf2pt">qf2pT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf5pt-default">qf5pT   <em>(default)</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf1ptlump">qf1pTlump</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf2pt4p1">qf2pT4P1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf7pt">qf7pT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf9pt">qf9pT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/quadrature-formulae.html#int3d">int3d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qfv1">qfV1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qfv2">qfV2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qfv5-default">qfV5   <em>(default)</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qfv1lump">qfV1lump</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/operators.html">Operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#addition-operator">Addition operator +</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#increment-operator">Increment operator ++</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#substraction-operator">Substraction operator -</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#decrement-operator">Decrement operator –</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#multiplication-operator">Multiplication operator *</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#equal-operator">Equal operator =</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#comparison-operator">Comparison operator ==</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#id1">Comparison operator !=</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#id2">Comparison operator &lt;, &lt;=</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#id3">Comparison operator &gt;, &gt;=</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#compound-operator">Compound operator <cite>+=</cite>, <cite>-=</cite>, <cite>*=</cite>, <cite>/=</cite></a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#term-by-term-multiplication">Term by term multiplication .*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#division-operator">Division operator /</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#term-by-term-division">Term by term division ./</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#remainder-from-the-division">Remainder from the division %</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#power-operator">Power operator ^</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#inverse-of-a-matrix-1">Inverse of a matrix ^-1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#transpose-operator">Transpose operator ‘</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#tensor-scalar-product">Tensor scalar product :</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#c-arithmetical-if-expression">C++ arithmetical if expression ? :</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/loops.html">Loops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#for">for</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#if">if</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#else">else</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#while">while</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#continue">continue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#break">break</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#try">try</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#catch">catch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#implicit-loop">Implicit loop</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/IO.html">I/O</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#cout">cout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#cin">cin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#endl">endl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#ifstream">ifstream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#ofstream">ofstream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#append">append</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#binary">binary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#seekg">seekg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#tellg">tellg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#flush">flush</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#getline">getline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#output-format">Output format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#precision">precision</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#scientific">scientific</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#fixed">fixed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#showbase">showbase</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#noshowbase">noshowbase</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#showpos">showpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#noshowpos">noshowpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#default">default</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#setw">setw</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/functions.html">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#abs">abs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#acos">acos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#acosh">acosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#adaptmesh">adaptmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#adj">adj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#affinecg">AffineCG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#affinegmres">AffineGMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#arg">arg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#asin">asin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#asinh">asinh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#assert">assert</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#atan">atan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#atan2">atan2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#atanh">atanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#atoi">atoi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#atof">atof</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#bfgs">BFGS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#buildmesh">buildmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#ceil">ceil</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#change">change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#checkmovemesh">checkmovemesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#chi">chi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#clock">clock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#complexeigenvalue">complexEigenValue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#conj">conj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#convect">convect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#copysign">copysign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#cos">cos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#cosh">cosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#diffnp">diffnp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#diffpos">diffpos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dist">dist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dumptable">dumptable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dx">dx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dxx">dxx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dxy">dxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dxz">dxz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dy">dy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dyx">dyx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dyy">dyy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dyz">dyz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dz">dz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dzx">dzx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dzy">dzy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dzz">dzz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#eigenvalue">EigenValue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#emptymesh">emptymesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#erf">erf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#erfc">erfc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#exec">exec</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#exit">exit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#exp">exp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#fdim">fdim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#floor">floor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#fmax">fmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#fmin">fmin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#fmod">fmod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#imag">imag</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#int1d">int1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#int2d">int2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#int3d">int3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#intalledges">intalledges</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#intallfaces">intallfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#interpolate">interpolate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#invdiff">invdiff</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#invdiffnp">invdiffnp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#invdiffpos">invdiffpos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#isinf">isInf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#isnan">isNaN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#isnormal">isNormal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#j0">j0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#j1">j1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#jn">jn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#jump">jump</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#linearcg">LinearCG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#lineargmres">LinearGMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#lgamma">lgamma</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#log">log</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#log10">log10</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#lrint">lrint</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#lround">lround</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#ltime">ltime</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#max">max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#min">min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#movemesh">movemesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#nan">NaN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#nlcg">NLCG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#on">on</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#plot">plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#polar">polar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#pow">pow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#projection">projection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randinit">randinit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randint31">randint31</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randint32">randint32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randreal1">randreal1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randreal2">randreal2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randreal3">randreal3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randres53">randres53</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#readmesh">readmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#readmesh3">readmesh3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#real">real</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#rint">rint</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#round">round</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#savemesh">savemesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#set">set</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#sign">sign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#signbit">signbit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#sin">sin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#sinh">sinh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#sort">sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#splitmesh">splitmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#sqrt">sqrt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#square">square</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#storagetotal">storagetotal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#storageused">storageused</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#strtod">strtod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#strtol">strtol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#swap">swap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#system">system</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#tan">tan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#tanh">tanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#tgamma">tgamma</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#time">time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#trace">trace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#trunc">trunc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#y0">y0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#y1">y1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#yn">yn</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/external-libraries.html">External libraries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#aniso">aniso</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#boundaniso">boundaniso</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#bec">BEC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#bectrap">BECtrap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gpvortex">GPvortex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dxgpvortex">dxGPVortex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dygpvortex">dyGPVortex</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#binary-i-o">Binary I/O</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#loadvec">LoadVec</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#loadflag">LoadFlag</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#savevec">SaveVec</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#flag">flag</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#buildlayer">buildlayer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#buildlayers">buildlayers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#closepoints">ClosePoints</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#radiussearch">radiusSearch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#voisinage">Voisinage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#neighborhood">neighborhood</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#closepoints2">ClosePoints2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#closepoint">ClosePoint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#closepoints1">ClosePoints1</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#curvature">Curvature</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#extractborder">extractborder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id17">curvature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#raxicurvature">raxicurvature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#curves">curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#setecurveabcisse">setecurveabcisse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#equiparameter">equiparameter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#tresca">Tresca</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#vonmises">VonMises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#dfft">dfft</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#plandfft">plandfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#execute">execute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#delete">delete</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id28">dfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#map">map</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#distance">distance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id31">distance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#checkdist">checkdist</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#dxwriter">DxWriter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dxaddmesh">Dxaddmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dxaddtimeseries">Dxaddtimeseries</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dxaddsol2ts">Dxaddsol2ts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#element-p1bl">Element_P1bl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#expert">expert</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#exactpartition">exactpartition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id38">exactpartition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ff-airybiry">ff-AiryBiry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#airy">airy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#biry">biry</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ff-cmaes">ff-cmaes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#cmaes">cmaes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ff-gsl-awk">ff_gsl_awk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfugaussianp">gslcdfugaussianP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfugaussianq">gslcdfugaussianQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfugaussianpinv">gslcdfugaussianPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfugaussianqinv">gslcdfugaussianQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgaussianp">gslcdfgaussianP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgaussianq">gslcdfgaussianQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgaussianpinv">gslcdfgaussianPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgaussianqinv">gslcdfgaussianQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgammap">gslcdfgammaP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgammaq">gslcdfgammaQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgammapinv">gslcdfgammaPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgammaqinv">gslcdfgammaQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfcauchyp">gslcdfcauchyP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfcauchyq">gslcdfcauchyQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfcauchypinv">gslcdfcauchyPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfcauchyqinv">gslcdfcauchyQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflaplacep">gslcdflaplaceP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflaplaceq">gslcdflaplaceQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflaplacepinv">gslcdflaplacePinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflaplaceqinv">gslcdflaplaceQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfrayleighp">gslcdfrayleighP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfrayleighq">gslcdfrayleighQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfrayleighpinv">gslcdfrayleighPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfrayleighqinv">gslcdfrayleighQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfchisqp">gslcdfchisqP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfchisqq">gslcdfchisqQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfchisqpinv">gslcdfchisqPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfchisqqinv">gslcdfchisqQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfexponentialp">gslcdfexponentialP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfexponentialq">gslcdfexponentialQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfexponentialpinv">gslcdfexponentialPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfexponentialqinv">gslcdfexponentialQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfexppowp">gslcdfexppowP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfexppowq">gslcdfexppowQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdftdistp">gslcdftdistP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdftdistq">gslcdftdistQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdftdistpinv">gslcdftdistPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdftdistqinv">gslcdftdistQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdffdistp">gslcdffdistP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdffdistq">gslcdffdistQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdffdistpinv">gslcdffdistPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdffdistqinv">gslcdffdistQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfbetap">gslcdfbetaP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfbetaq">gslcdfbetaQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfbetapinv">gslcdfbetaPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfbetaqinv">gslcdfbetaQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfflatp">gslcdfflatP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfflatq">gslcdfflatQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfflatpinv">gslcdfflatPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfflatqinv">gslcdfflatQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflognormalp">gslcdflognormalP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflognormalq">gslcdflognormalQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflognormalpinv">gslcdflognormalPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflognormalqinv">gslcdflognormalQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel1p">gslcdfgumbel1P</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel1q">gslcdfgumbel1Q</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel1pinv">gslcdfgumbel1Pinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel1qinv">gslcdfgumbel1Qinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel2p">gslcdfgumbel2P</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel2q">gslcdfgumbel2Q</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel2pinv">gslcdfgumbel2Pinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel2qinv">gslcdfgumbel2Qinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfweibullp">gslcdfweibullP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfweibullq">gslcdfweibullQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfweibullpinv">gslcdfweibullPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfweibullqinv">gslcdfweibullQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfparetop">gslcdfparetoP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfparetoq">gslcdfparetoQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfparetopinv">gslcdfparetoPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfparetoqinv">gslcdfparetoQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflogisticp">gslcdflogisticP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflogisticq">gslcdflogisticQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflogisticpinv">gslcdflogisticPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflogisticqinv">gslcdflogisticQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfbinomialp">gslcdfbinomialP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfbinomialq">gslcdfbinomialQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfpoissonp">gslcdfpoissonP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfpoissonq">gslcdfpoissonQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgeometricp">gslcdfgeometricP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgeometricq">gslcdfgeometricQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfnegativebinomialp">gslcdfnegativebinomialP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfnegativebinomialq">gslcdfnegativebinomialQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfpascalp">gslcdfpascalP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfpascalq">gslcdfpascalQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranbernoullipdf">gslranbernoullipdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranbeta">gslranbeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranbetapdf">gslranbetapdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranbinomialpdf">gslranbinomialpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranexponential">gslranexponential</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranexponentialpdf">gslranexponentialpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranexppow">gslranexppow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranexppowpdf">gslranexppowpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrancauchy">gslrancauchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrancauchypdf">gslrancauchypdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranchisq">gslranchisq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranchisqpdf">gslranchisqpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranerlang">gslranerlang</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranerlangpdf">gslranerlangpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranfdist">gslranfdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranfdistpdf">gslranfdistpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranflat">gslranflat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranflatpdf">gslranflatpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangamma">gslrangamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangammaint">gslrangammaint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangammapdf">gslrangammapdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangammamt">gslrangammamt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangammaknuth">gslrangammaknuth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangaussian">gslrangaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangaussianratiomethod">gslrangaussianratiomethod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangaussianziggurat">gslrangaussianziggurat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangaussianpdf">gslrangaussianpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranugaussian">gslranugaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranugaussianratiomethod">gslranugaussianratiomethod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranugaussianpdf">gslranugaussianpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangaussiantail">gslrangaussiantail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangaussiantailpdf">gslrangaussiantailpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranugaussiantail">gslranugaussiantail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranugaussiantailpdf">gslranugaussiantailpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlandau">gslranlandau</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlandaupdf">gslranlandaupdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangeometricpdf">gslrangeometricpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangumbel1">gslrangumbel1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangumbel1pdf">gslrangumbel1pdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangumbel2">gslrangumbel2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangumbel2pdf">gslrangumbel2pdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlogistic">gslranlogistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlogisticpdf">gslranlogisticpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlognormal">gslranlognormal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlognormalpdf">gslranlognormalpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlogarithmicpdf">gslranlogarithmicpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrannegativebinomialpdf">gslrannegativebinomialpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranpascalpdf">gslranpascalpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranpareto">gslranpareto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranparetopdf">gslranparetopdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranpoissonpdf">gslranpoissonpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranrayleigh">gslranrayleigh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranrayleighpdf">gslranrayleighpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranrayleightail">gslranrayleightail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranrayleightailpdf">gslranrayleightailpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrantdist">gslrantdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrantdistpdf">gslrantdistpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlaplace">gslranlaplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlaplacepdf">gslranlaplacepdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlevy">gslranlevy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranweibull">gslranweibull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranweibullpdf">gslranweibullpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyai">gslsfairyAi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairybi">gslsfairyBi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyaiscaled">gslsfairyAiscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairybiscaled">gslsfairyBiscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyaideriv">gslsfairyAideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairybideriv">gslsfairyBideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyaiderivscaled">gslsfairyAiderivscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairybiderivscaled">gslsfairyBiderivscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyzeroai">gslsfairyzeroAi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyzerobi">gslsfairyzeroBi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyzeroaideriv">gslsfairyzeroAideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyzerobideriv">gslsfairyzeroBideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselj0">gslsfbesselJ0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselj1">gslsfbesselJ1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseljn">gslsfbesselJn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbessely0">gslsfbesselY0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbessely1">gslsfbesselY1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselyn">gslsfbesselYn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseli0">gslsfbesselI0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseli1">gslsfbesselI1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselin">gslsfbesselIn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseli0scaled">gslsfbesselI0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseli1scaled">gslsfbesselI1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselinscaled">gslsfbesselInscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselk0">gslsfbesselK0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselk1">gslsfbesselK1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselkn">gslsfbesselKn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselk0scaled">gslsfbesselK0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselk1scaled">gslsfbesselK1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselknscaled">gslsfbesselKnscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id43">gslsfbesselj0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id44">gslsfbesselj1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselj2">gslsfbesselj2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseljl">gslsfbesseljl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id45">gslsfbessely0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id46">gslsfbessely1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbessely2">gslsfbessely2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselyl">gslsfbesselyl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id47">gslsfbesseli0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id48">gslsfbesseli1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseli2scaled">gslsfbesseli2scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselilscaled">gslsfbesselilscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id49">gslsfbesselk0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id50">gslsfbesselk1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselk2scaled">gslsfbesselk2scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselklscaled">gslsfbesselklscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseljnu">gslsfbesselJnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselynu">gslsfbesselYnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselinuscaled">gslsfbesselInuscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselinu">gslsfbesselInu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselknuscaled">gslsfbesselKnuscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselknu">gslsfbesselKnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbessellnknu">gslsfbessellnKnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselzeroj0">gslsfbesselzeroJ0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselzeroj1">gslsfbesselzeroJ1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselzerojnu">gslsfbesselzeroJnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfclausen">gslsfclausen</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhydrogenicr1">gslsfhydrogenicR1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdawson">gslsfdawson</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdebye1">gslsfdebye1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdebye2">gslsfdebye2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdebye3">gslsfdebye3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdebye4">gslsfdebye4</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdebye5">gslsfdebye5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdebye6">gslsfdebye6</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdilog">gslsfdilog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfmultiply">gslsfmultiply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellintkcomp">gslsfellintKcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellintecomp">gslsfellintEcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellintpcomp">gslsfellintPcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellintdcomp">gslsfellintDcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellintf">gslsfellintF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellinte">gslsfellintE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellintrc">gslsfellintRC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsferfc">gslsferfc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflogerfc">gslsflogerfc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsferf">gslsferf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsferfz">gslsferfZ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsferfq">gslsferfQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhazard">gslsfhazard</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexp">gslsfexp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpmult">gslsfexpmult</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpm1">gslsfexpm1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexprel">gslsfexprel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexprel2">gslsfexprel2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpreln">gslsfexpreln</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpinte1">gslsfexpintE1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpinte2">gslsfexpintE2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpinten">gslsfexpintEn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpinte1scaled">gslsfexpintE1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpinte2scaled">gslsfexpintE2scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpintenscaled">gslsfexpintEnscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpintei">gslsfexpintEi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpinteiscaled">gslsfexpintEiscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfshi">gslsfShi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfchi">gslsfChi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpint3">gslsfexpint3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfsi">gslsfSi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfci">gslsfCi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfatanint">gslsfatanint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidiracm1">gslsffermidiracm1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidirac0">gslsffermidirac0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidirac1">gslsffermidirac1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidirac2">gslsffermidirac2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidiracint">gslsffermidiracint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidiracmhalf">gslsffermidiracmhalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidirachalf">gslsffermidirachalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidirac3half">gslsffermidirac3half</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidiracinc0">gslsffermidiracinc0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflngamma">gslsflngamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgamma">gslsfgamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgammastar">gslsfgammastar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgammainv">gslsfgammainv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsftaylorcoeff">gslsftaylorcoeff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffact">gslsffact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdoublefact">gslsfdoublefact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflnfact">gslsflnfact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflndoublefact">gslsflndoublefact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflnchoose">gslsflnchoose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfchoose">gslsfchoose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflnpoch">gslsflnpoch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpoch">gslsfpoch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpochrel">gslsfpochrel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgammaincq">gslsfgammaincQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgammaincp">gslsfgammaincP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgammainc">gslsfgammainc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflnbeta">gslsflnbeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbeta">gslsfbeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbetainc">gslsfbetainc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgegenpoly1">gslsfgegenpoly1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgegenpoly2">gslsfgegenpoly2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgegenpoly3">gslsfgegenpoly3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgegenpolyn">gslsfgegenpolyn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhyperg0f1">gslsfhyperg0F1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhyperg1f1int">gslsfhyperg1F1int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhyperg1f1">gslsfhyperg1F1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhyperguint">gslsfhypergUint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhypergu">gslsfhypergU</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhyperg2f0">gslsfhyperg2F0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflaguerre1">gslsflaguerre1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflaguerre2">gslsflaguerre2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflaguerre3">gslsflaguerre3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflaguerren">gslsflaguerren</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflambertw0">gslsflambertW0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflambertwm1">gslsflambertWm1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendrepl">gslsflegendrePl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendrep1">gslsflegendreP1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendrep2">gslsflegendreP2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendrep3">gslsflegendreP3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreq0">gslsflegendreQ0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreq1">gslsflegendreQ1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreql">gslsflegendreQl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreplm">gslsflegendrePlm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendresphplm">gslsflegendresphPlm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendrearraysize">gslsflegendrearraysize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfconicalphalf">gslsfconicalPhalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfconicalpmhalf">gslsfconicalPmhalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfconicalp0">gslsfconicalP0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfconicalp1">gslsfconicalP1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfconicalpsphreg">gslsfconicalPsphreg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfconicalpcylreg">gslsfconicalPcylreg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreh3d0">gslsflegendreH3d0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreh3d1">gslsflegendreH3d1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreh3d">gslsflegendreH3d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflog">gslsflog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflogabs">gslsflogabs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflog1plusx">gslsflog1plusx</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflog1plusxmx">gslsflog1plusxmx</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpowint">gslsfpowint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpsiint">gslsfpsiint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpsi">gslsfpsi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpsi1piy">gslsfpsi1piy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpsi1int">gslsfpsi1int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpsi1">gslsfpsi1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpsin">gslsfpsin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfsynchrotron1">gslsfsynchrotron1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfsynchrotron2">gslsfsynchrotron2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsftransport2">gslsftransport2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsftransport3">gslsftransport3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsftransport4">gslsftransport4</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsftransport5">gslsftransport5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfsin">gslsfsin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfcos">gslsfcos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhypot">gslsfhypot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfsinc">gslsfsinc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflnsinh">gslsflnsinh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflncosh">gslsflncosh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfanglerestrictsymm">gslsfanglerestrictsymm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfanglerestrictpos">gslsfanglerestrictpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfzetaint">gslsfzetaint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfzeta">gslsfzeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfzetam1">gslsfzetam1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfzetam1int">gslsfzetam1int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhzeta">gslsfhzeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfetaint">gslsfetaint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfeta">gslsfeta</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ff-ipopt">ff-Ipopt</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#ipopt">IPOPT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#fflapack">fflapack</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#inv">inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dgeev">dgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#zgeev">zgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#geev">geev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id56">geev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dggev">dggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#zggev">zggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dsygvd">dsygvd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dgesdd">dgesdd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#zhegv">zhegv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dsyev">dsyev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#zheev">zheev</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ff-mmap-semaphore">ff-mmap-semaphore</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#wait">Wait</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#trywait">trywait</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#post">Post</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#msync">msync</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#read">Read</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#write">Write</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ffnewuoa">ffnewuoa</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#newuoa">newuoa</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ff-nlopt">ff-NLopt</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirect">nloptDIRECT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirectl">nloptDIRECTL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirectlrand">nloptDIRECTLRand</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirectscal">nloptDIRECTScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirectnoscal">nloptDIRECTNoScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirectlnoscal">nloptDIRECTLNoScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirectlrandnoscal">nloptDIRECTLRandNoScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptorigdirect">nloptOrigDIRECT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptorigdirectl">nloptOrigDIRECTL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptstogo">nloptStoGO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptstogorand">nloptStoGORand</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptlbfgs">nloptLBFGS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptpraxis">nloptPRAXIS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptvar1">nloptVar1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptvar2">nloptVar2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nlopttnewton">nloptTNewton</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nlopttnewtonrestart">nloptTNewtonRestart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nlopttnewtonprecond">nloptTNewtonPrecond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nlopttnewtonprecondrestart">nloptTNewtonPrecondRestart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptcrs2">nloptCRS2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptmma">nloptMMA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptcobyla">nloptCOBYLA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptnewuoa">nloptNEWUOA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptnewuoabound">nloptNEWUOABound</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptneldermead">nloptNelderMead</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptsbplx">nloptSbplx</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptbobyqa">nloptBOBYQA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptisres">nloptISRES</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptslsqp">nloptSLSQP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptmlsl">nloptMLSL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptmlsllds">nloptMLSLLDS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptauglag">nloptAUGLAG</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptauglageq">nloptAUGLAGEQ</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ffrandom">ffrandom</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#srandomdev">srandomdev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#srandom">srandom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#random">random</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#freefemqa">FreeFemQA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#meshgenqa">MeshGenQA</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#freeyams">freeyams</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id109">freeyams</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#gmsh">gmsh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gmshload">gmshload</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gmshload3">gmshload3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#savegmsh">savegmsh</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#gsl">gsl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslpolysolvequadratic">gslpolysolvequadratic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslpolysolvecubic">gslpolysolvecubic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslpolycomplexsolve">gslpolycomplexsolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrnguniform">gslrnguniform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrnguniformpos">gslrnguniformpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslname">gslname</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrngget">gslrngget</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrngmin">gslrngmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrngmax">gslrngmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrngset">gslrngset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrngtype">gslrngtype</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ilut">ilut</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#applyilutprecond">applyIlutPrecond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#makeilutprecond">makeIlutPrecond</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#iohdf5">iohdf5</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#savehdf5sol">savehdf5sol</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#iovtk">iovtk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#savevtk">savevtk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#vtkload">vtkload</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#vtkload3">vtkload3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#isoline">isoline</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id128">isoline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#curve">Curve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#area">Area</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#findallocalmin">findallocalmin</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#lapack">lapack</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id133">inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id135">dgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id137">zgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id139">geev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id141">dggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id143">zggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id145">dsygvd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id147">dgesdd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id149">zhegv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id151">dsyev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id153">zheev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dgelsy">dgelsy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#lgbmo">lgbmo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#bmo">bmo</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mat-dervieux">mat_dervieux</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#matupwind1">MatUpWind1</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mat-psi">mat_psi</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#matupwind0">MatUpWind0</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#medit">medit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id159">medit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#savesol">savesol</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#readsol">readsol</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#metis">metis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#metisnodal">metisnodal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#metisdual">metisdual</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#metrickuate">MetricKuate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id165">MetricKuate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#metricpk">MetricPk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id167">MetricPk</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mmg3d">mmg3d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id169">mmg3d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mmg3d-v4-0">mmg3d-v4.0</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id171">mmg3d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#msh3">msh3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#change">change</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#movemesh23">movemesh23</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#movemesh2d3dsurf">movemesh2D3Dsurf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#movemesh3">movemesh3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#movemesh">movemesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#movemesh3d">movemesh3D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#deplacement">deplacement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#checkbemesh">checkbemesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id181">buildlayers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#bcube">bcube</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#cube">cube</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#trunc">trunc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gluemesh">gluemesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#extract">extract</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#showborder">showborder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#getborder">getborder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#addlayers">AddLayers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mshmet">mshmet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id190">mshmet</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mumps">MUMPS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#defaulttomumpsseq">defaulttoMUMPSseq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mumps-seq">MUMPS_seq</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id193">defaulttoMUMPSseq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#netgen">netgen</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#netg">netg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#netgstl">netgstl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#netgload">netgload</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#newsolver">NewSolver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#defaulttoumfpack">defaulttoUMFPACK</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#pardiso">PARDISO</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#defaulttopardiso">defaulttoPARDISO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#ompsetnumthreads">ompsetnumthreads</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#ompgetnumthreads">ompgetnumthreads</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#ompgetmaxthreads">ompgetmaxthreads</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#pcm2rnm">pcm2rnm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#readpcm">readpcm</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#pipe">pipe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#flush">flush</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#sleep">sleep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#usleep">usleep</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#qf11to25">qf11to25</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#qf1d">QF1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#qf2d">QF2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#qf3d">QF3d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#tripleqf">tripleQF</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#scotch">scotch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id210">scotch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#shell">shell</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#readdir">readdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#unlink">unlink</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#rmdir">rmdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#cddir">cddir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#chdir">chdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#basename">basename</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dirname">dirname</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#mkdir">mkdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#chmod">chmod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#cpfile">cpfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#stat">stat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#isdir">isdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#getenv">getenv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#setenv">setenv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#unsetenv">unsetenv</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#splitedges">splitedges</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#splitedgemesh">SplitedgeMesh</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#splitmesh12">splitmesh12</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id228">splitmesh12</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#splitmesh3">splitmesh3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id230">splitmesh3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#splitmesh4">splitmesh4</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#splimesh4">splimesh4</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#splitmesh6">splitmesh6</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id233">splitmesh6</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#superlu">SuperLu</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#defaulttosuperlu">defaulttoSuperLu</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#symmetrizecsr">symmetrizeCSR</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id236">symmetrizeCSR</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#tetgen">tetgen</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#tetgconvexhull">tetgconvexhull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#tetgtransfo">tetgtransfo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#tetg">tetg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#tetgreconstruction">tetgreconstruction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#umfpack64">UMFPACK64</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#defaulttoumfpack64">defaulttoUMFPACK64</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#vtk-writer-3d">VTK_writer_3d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#vtkaddmesh">Vtkaddmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#vtkaddscalar">Vtkaddscalar</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#vtk-writer">VTK_writer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id245">Vtkaddmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id247">Vtkaddscalar</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../models/index.html">Mathematical Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/static-problems.html">Static problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#soap-film">Soap Film</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#electrostatics">Electrostatics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#aerodynamics">Aerodynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#error-estimation">Error estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#periodic-boundary-conditions">Periodic Boundary Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#poisson-problems-with-mixed-boundary-condition">Poisson Problems with mixed boundary condition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#poisson-with-mixed-finite-element">Poisson with mixed finite element</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#metric-adaptation-and-residual-error-indicator">Metric Adaptation and residual error indicator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#adaptation-using-residual-error-indicator">Adaptation using residual error indicator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/elasticity.html">Elasticity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/elasticity.html#fracture-mechanics">Fracture Mechanics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/non-linear-static-problems.html">Non-linear static problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/non-linear-static-problems.html#newton-raphson-algorithm">Newton-Raphson algorithm</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/eigen-value-problems.html">Eigen value problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/evolution-problems.html">Evolution problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/evolution-problems.html#mathematical-theory-on-time-difference-approximations">Mathematical Theory on Time Difference Approximations.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/evolution-problems.html#convection">Convection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/evolution-problems.html#d-black-scholes-equation-for-an-european-put-option">2D Black-Scholes equation for an European Put option</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/navier-stokes-equations.html">Navier-Stokes equations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/navier-stokes-equations.html#uzawa-algorithm-and-conjugate-gradients">Uzawa Algorithm and Conjugate Gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/navier-stokes-equations.html#nsuzawacahouetchabart-edp">NSUzawaCahouetChabart.edp</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/variational-inequality.html">Variational Inequality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/domain-decomposition.html">Domain decomposition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/domain-decomposition.html#schwarz-overlapping">Schwarz overlapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/domain-decomposition.html#schwarz-non-overlapping-scheme">Schwarz non overlapping Scheme</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/domain-decomposition.html#schwarz-conjuguate-gradient">Schwarz conjuguate gradient</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/fluid-structure-coupled-problem.html">Fluid-structure coupled problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/transmission-problem.html">Transmission problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/free-boundary-problems.html">Free boundary problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/non-linear-elasticity.html">Non-linear elasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/compressible-neo-hookean-materials.html">Compressible Neo-Hookean materials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/compressible-neo-hookean-materials.html#notation">Notation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/compressible-neo-hookean-materials.html#recommended-references">Recommended References</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/compressible-neo-hookean-materials.html#a-neo-hookean-compressible-material">A Neo-Hookean Compressible Material</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/compressible-neo-hookean-materials.html#an-approach-to-implementation-in-freefem">An Approach to Implementation in FreeFEM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/whispering-gallery-modes.html">Whispering gallery modes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/whispering-gallery-modes.html#wave-equation-for-the-wgms">Wave equation for the WGMs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/whispering-gallery-modes.html#weak-formulation">Weak formulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/whispering-gallery-modes.html#a-dielectric-sphere-example-with-freefem">A dielectric sphere example with FreeFEM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/misc.html">Misc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/misc.html#poisson-s-equation">Poisson’s Equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/misc.html#poisson-s-equation-3d">Poisson’s equation 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/misc.html#stokes-equation-on-a-cube">Stokes Equation on a cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/misc.html#cavity">Cavity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/mesh-generation.html">Mesh Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#square-mesh">Square mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#mesh-adaptation">Mesh adaptation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#mesh-adaptation-for-the-poisson-s-problem">Mesh adaptation for the Poisson’s problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#uniform-mesh-adaptation">Uniform mesh adaptation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#borders">Borders</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#change">Change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#cube">Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#empty-mesh">Empty mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#points">3 points</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#bezier">Bezier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#build-layer-mesh">Build layer mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#sphere">Sphere</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/finite-element.html">Finite Element</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/finite-element.html#periodic-3d">Periodic 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/finite-element.html#lagrange-multipliers">Lagrange multipliers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/visualization.html">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/visualization.html#plot">Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/visualization.html#hsv">HSV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/visualization.html#medit">Medit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/visualization.html#paraview">Paraview</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/algorithms-and-optimizations.html">Algorithms &amp; Optimizations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/algorithms-and-optimizations.html#algorithms">Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/algorithms-and-optimizations.html#cmaes-variational-inequality">CMAES variational inequality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/algorithms-and-optimizations.html#ipopt-minimal-surface-volume">IPOPT minimal surface &amp; volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/algorithms-and-optimizations.html#cmaes-mpi-variational-inequality">CMAES MPI variational inequality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/parallelization.html">Parallelization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/parallelization.html#mpi-gmres-2d">MPI-GMRES 2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/parallelization.html#mpi-gmres-3d">MPI-GMRES 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/parallelization.html#direct-solvers">Direct solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/parallelization.html#solver-mumps">Solver MUMPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/parallelization.html#solver-superlu-dist">Solver superLU_DIST</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/parallelization.html#solver-pastix">Solver PaStiX</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/developers.html">Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#fft">FFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#complex">Complex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#string">String</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#elementary-function">Elementary function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#array">Array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#block-matrix">Block matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#matrix-operations">Matrix operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#matrix-inversion">Matrix inversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#fe-array">FE array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#loop">Loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#implicit-loop">Implicit loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#i-o">I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#file-stream">File stream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#command-line-arguments">Command line arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#macro">Macro</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#basic-error-handling">Basic error handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#error-handling">Error handling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

	</div>

	<div class="nav-links" id="staticNav">
	</div>

	<button class="nav-btn" onclick="openNav()"><i class="fa fa-bars"></i></button>

	<div id="sideNav" class="sidenav">
		<div class="sideNavHeader">
			<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   id="Calque_1"
   data-name="Calque 1"
   viewBox="0 0 380.98 113.39"
   version="1.1"
   sodipodi:docname="Logo.svg"
   inkscape:version="0.92.4 5da689c313, 2019-01-14">
  <metadata
     id="metadata30">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <sodipodi:namedview
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1"
     objecttolerance="10"
     gridtolerance="10"
     guidetolerance="10"
     inkscape:pageopacity="0"
     inkscape:pageshadow="2"
     inkscape:window-width="1920"
     inkscape:window-height="1016"
     id="namedview28"
     showgrid="false"
     inkscape:zoom="1.1312929"
     inkscape:cx="194.02578"
     inkscape:cy="53.159222"
     inkscape:window-x="0"
     inkscape:window-y="27"
     inkscape:window-maximized="1"
     inkscape:current-layer="Calque_1" />
  <defs
     id="defs4">
    <style
       id="style2">.cls-1{fill:blue;}.cls-2{fill:#00007f;}</style>
  </defs>
  <title
     id="title6">Logo</title>
  <path
     class="cls-2"
     d="M397.36,291H381.81v14.22h-11V267.42h27.75v8.44H381.74v6.67H397.3V291Z"
     transform="translate(-230.46 -229.51)"
     id="path13" />
  <path
     class="cls-2"
     d="M417.29,292.68H413v12.51H402V267.42h16.7c4.89,0,8.76,1,11.49,3a9.55,9.55,0,0,1,4.13,8.32,12.59,12.59,0,0,1-1.59,6.73,11.85,11.85,0,0,1-5.33,4.38l8.19,15v.44H423.77ZM413,284.24h5.71c3.18,0,4.76-1.4,4.76-4.25s-1.71-4.13-5.08-4.13H413Z"
     transform="translate(-230.46 -229.51)"
     id="path15" />
  <path
     class="cls-2"
     d="M465.8,289.89H450.94v6.86h17.59v8.44H440V267.42h28.76v8.44H450.94v5.59H465.8Z"
     transform="translate(-230.46 -229.51)"
     id="path17" />
  <path
     class="cls-2"
     d="M497.6,289.89H482.75v6.86h17.58v8.44H471.77V267.42h28.75v8.44H482.75v5.59H497.6Z"
     transform="translate(-230.46 -229.51)"
     id="path19" />
  <path
     class="cls-2"
     d="M530.11,291H514.55v14.22h-11V267.42h27.75v8.44H514.49v6.67h15.56V291Z"
     transform="translate(-230.46 -229.51)"
     id="path21" />
  <path
     class="cls-2"
     d="M560.58,289.89H545.73v6.86h17.58v8.44H534.74V267.42H563.5v8.44H545.73v5.59h14.85Z"
     transform="translate(-230.46 -229.51)"
     id="path23" />
  <path
     class="cls-2"
     d="M581.09,267.42,589,291.54l7.87-24.12h14.6v37.77h-11v-5.84l1.08-20.19-9,26h-7l-9-26,1.14,20.19v5.84h-11V267.42Z"
     transform="translate(-230.46 -229.51)"
     id="path25" />
  <g
     id="g833"
     transform="matrix(0.69996616,0,0,0.69996616,24.36493,-106.39712)">
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="181.58182"
       x="49.328617"
       height="86.368324"
       width="21.264048"
       id="rect1411"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="181.58182"
       x="64.966545"
       height="21.592081"
       width="53.160122"
       id="rect1413"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="218.71571"
       x="72.469795"
       height="16.194061"
       width="21.264048"
       id="rect1415"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="205.23866"
       x="95.834"
       height="86.368324"
       width="21.264048"
       id="rect1411-6"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="205.23866"
       x="111.47193"
       height="21.592081"
       width="53.160122"
       id="rect1413-7"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="242.37254"
       x="118.97518"
       height="16.194061"
       width="21.264048"
       id="rect1415-5"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
  </g>
</svg>
			<a class="closebtn" href="#" onclick="closeNav()"><i class="fas fa-times"></i></a>
		</div>
		<div id="dynamicSideNav">
		</div>
	</div>
	<div class="search-container">
	<label id="search-icon" for="searchInput"><i class="fas fa-search"></i></label>
	<input type="search" placeholder="Type to start searching" id="searchInput">
	<label id="search-overlay" onclick="removeOverlay()"></label>
	<div class="search-toggle">
		<input type="checkbox" id="checkbox-search-toggle"/>
		<label for="checkbox-search"> search in examples &emsp;&emsp; NEW !! toggle between documentation or examples (or press CTRL key)</label>
	</div>
	<div id="searchResults"></div>
</div>
	
</nav>
	

	<div id="subnav">
	<div class="subnav-toc", style="display: none">
		<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html"><strong>Introduction</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Learning by Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="notations.html">Notations</a></li>
<li class="toctree-l2"><a class="reference internal" href="mesh-generation.html">Mesh Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="finite-element.html">Finite element</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Algorithms &amp; Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#conjugate-gradient-gmres">Conjugate Gradient/GMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#algorithms-for-unconstrained-optimization">Algorithms for Unconstrained Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ipopt">IPOPT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#some-short-examples-using-ipopt">Some short examples using IPOPT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#d-constrained-minimum-surface-with-ipopt">3D constrained minimum surface with IPOPT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-nlopt-optimizers">The nlOpt optimizers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optimization-with-mpi">Optimization with MPI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parallelization.html">Parallelization</a></li>
<li class="toctree-l2"><a class="reference internal" href="petsc/index.html">PETSc and SLEPc</a></li>
<li class="toctree-l2"><a class="reference internal" href="BEM.html">The Boundary Element Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="composite.html">Composite finite element spaces <span class="red">NEW!</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="developers.html">Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="ffddm/index.html">ffddm</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references/index.html">Language references</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models/index.html">Mathematical Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

	</div>
	<div class="tag-tree" style="display: none">
		<strong> Filter by categories <br> &#9888; Work in progress ! <br> <br> </strong>
		<div class="tag-tree-container">
		</div>
	</div>
</div>
	
	<div id="content">
		<div id="content-examples" style="display: none">
			<div id="exampleWelcome">
				<ul>
					<li><h4>Here you can use the search bar to search in all FreeFEM examples instead</h4></li>
					<li><h4>The list of all matching examples on the right is updated for each new query</h4></li>
					<li><h4>Clicking on a search hit or on an example on the right brings up the corresponding script from GitHub</h4></li>
					<li><h4>You can also filter the list on the right by selecting one or more intersecting categories on the left tree </h4></li>
				</ul>
			</div>
			<div id="exampleCode" spellcheck="false" style="display: none">
				<h2><div id='ExampleLinkToGitHub'></div> <!-- <span id="exampleSave">Save as EDP</span> --></h2>
				<textarea id="code"></textarea>
			</div>
		</div>
		<div id="content-doc">
			
   <section id="algorithms-optimization">
<h1>Algorithms &amp; Optimization<a class="headerlink" href="#algorithms-optimization" title="Link to this heading"></a></h1>
<section id="conjugate-gradient-gmres">
<h2>Conjugate Gradient/GMRES<a class="headerlink" href="#conjugate-gradient-gmres" title="Link to this heading"></a></h2>
<p>Suppose we want to solve the Euler problem (here <span class="math notranslate nohighlight">\(x\)</span> has nothing to do with the reserved variable for the first coordinate in <strong>FreeFEM</strong>):</p>
<p>find <span class="math notranslate nohighlight">\(x\in \mathbb{R}^n\)</span> such that</p>
<div class="math notranslate nohighlight" id="equation-eqndj">
<span class="eqno">(24)<a class="headerlink" href="#equation-eqndj" title="Link to this equation"></a></span>\[\nabla J(x) = \left(\frac{\partial J}{\partial x_i} (\mathbf{x})\right) = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(J\)</span> is a function (to minimize for example) from <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> to <span class="math notranslate nohighlight">\(\mathbb{R}\)</span>.</p>
<p>If the function is convex we can use the conjugate gradient algorithm to solve the problem, and we just need the function (named <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">dJ</span></code> for example) which computes <span class="math notranslate nohighlight">\(\nabla J\)</span>, so the parameters are the name of that function with prototype <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">dJ</span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">xx</span><span class="p">);</span></code> which computes <span class="math notranslate nohighlight">\(\nabla J\)</span>, and a vector <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">x</span></code> of type (of course the number 20 can be changed) <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="kr">x</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span></code> to initialize the process and get the result.</p>
<p>Given an initial value <span class="math notranslate nohighlight">\(\mathbf{x}^{(0)}\)</span>, a maximum number <span class="math notranslate nohighlight">\(i_{\max}\)</span> of iterations, and an error tolerance <span class="math notranslate nohighlight">\(0&lt;\epsilon&lt;1\)</span>:</p>
<p>Put <span class="math notranslate nohighlight">\(\mathbf{x}=\mathbf{x}^{(0)}\)</span> and write</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nf">NLCG</span><span class="p">(</span><span class="n">dJ</span><span class="p">,</span><span class="w"> </span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="kp">precon</span><span class="o">=</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="kp">nbiter</span><span class="o">=</span><span class="kr">imax</span><span class="p">,</span><span class="w"> </span><span class="kp">eps</span><span class="o">=</span><span class="n">epsilon</span><span class="p">,</span><span class="w"> </span><span class="kp">stop</span><span class="o">=</span><span class="n">stopfunc</span><span class="p">);</span>
</pre></div>
</div>
<p>will give the solution of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> of <span class="math notranslate nohighlight">\(\nabla J(\mathbf{x})=0\)</span>.
We can omit parameters <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">precon</span><span class="p">,</span><span class="w"> </span><span class="kp">nbiter</span><span class="p">,</span><span class="w"> </span><span class="kp">eps</span><span class="p">,</span><span class="w"> </span><span class="kp">stop</span></code>.
Here <span class="math notranslate nohighlight">\(M\)</span> is the preconditioner whose default is the identity matrix.</p>
<p>The stopping test is</p>
<div class="math notranslate nohighlight">
\[\|\nabla J(\mathbf{x})\|_P\le \epsilon\| \nabla J(\mathbf{x}^{(0)})\|_P\]</div>
<p>Writing the minus value in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">eps</span><span class="o">=</span></code>, i.e.,</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nf">NLCG</span><span class="p">(</span><span class="n">dJ</span><span class="p">,</span><span class="w"> </span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="kp">precon</span><span class="o">=</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="kp">nbiter</span><span class="o">=</span><span class="kr">imax</span><span class="p">,</span><span class="w"> </span><span class="kp">eps</span><span class="o">=-</span><span class="n">epsilon</span><span class="p">);</span>
</pre></div>
</div>
<p>We can use the stopping test:</p>
<div class="math notranslate nohighlight">
\[\| \nabla J(\mathbf{x})\|_P^2\le \epsilon\]</div>
<p>The parameters of these three functions are:</p>
<ul>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbiter</span><span class="o">=</span></code> set the number of iteration (by default 100)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">precon</span><span class="o">=</span></code> set the preconditioner function (<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">P</span></code> for example) by default it is the identity, note the prototype is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="kr">P</span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="kr">x</span><span class="p">)</span></code>.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">eps</span><span class="o">=</span></code> set the value of the stop test <span class="math notranslate nohighlight">\(\varepsilon\)</span> (<span class="math notranslate nohighlight">\(=10^{-6}\)</span> by default) if positive then relative test <span class="math notranslate nohighlight">\(||\nabla J(x)||_P\leq \varepsilon||\nabla J(x_0)||_P\)</span>, otherwise the absolute test is <span class="math notranslate nohighlight">\(||\nabla J(x)||_P^2\leq |\varepsilon|\)</span>.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">veps</span><span class="o">=</span></code> set and return the value of the stop test, if positive, then relative test is <span class="math notranslate nohighlight">\(||\nabla J(x)||_P\leq \varepsilon||\nabla J(x_0)||_P\)</span>, otherwise the absolute test is <span class="math notranslate nohighlight">\(||\nabla J(x)||_P^2\leq |\varepsilon|\)</span>.
The return value is minus the real stop test (remark: it is useful in loop).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">stop</span><span class="o">=</span></code> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">stopfunc</span></code> add your test function to stop before the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">eps</span></code> criterion. The prototype for the function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">stopfunc</span></code> is</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">func</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">stopfunc</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="p">,</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">u</span></code> is the current solution, and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">g</span></code>, the current gradient, is not preconditioned.</p>
</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><a class="reference internal" href="../examples/algorithms-and-optimizations.html#examplealgorithms"><span class="std std-ref">Algorithms.edp</span></a></p>
<p>For a given function <span class="math notranslate nohighlight">\(b\)</span>, let us find the minimizer <span class="math notranslate nohighlight">\(u\)</span> of the function</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{rcl}
   J(u) &amp;=&amp; \frac{1}{2}\int_{\Omega} f(|\nabla u|^2) - \int_{\Omega} u b \\
   f(x) &amp;=&amp; ax + x-\ln(1+x), \quad f'(x) = a+\frac{x}{1+x}, \quad f''(x) = \frac{1}{(1+x)^2}
\end{array}\end{split}\]</div>
<p>under the boundary condition <span class="math notranslate nohighlight">\(u=0\)</span> on <span class="math notranslate nohighlight">\(\partial\Omega\)</span>.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Ph</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P0</span><span class="p">);</span>
<span class="linenos"> 2</span><span class="n">Ph</span><span class="w"> </span><span class="n">alpha</span><span class="p">;</span><span class="w"> </span><span class="c1">//store df(|nabla u|^2)</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1">// The function J</span>
<span class="linenos"> 5</span><span class="c1">//J(u) = 1/2 int_Omega f(|nabla u|^2) - int_Omega u b</span>
<span class="linenos"> 6</span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">J</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">u</span><span class="p">){</span>
<span class="linenos"> 7</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="n">w</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="w">   </span><span class="n">w</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="linenos"> 9</span><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">w</span><span class="p">))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="o">*</span><span class="n">w</span><span class="p">);</span>
<span class="linenos">10</span><span class="w">   </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;J(u) = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="kr">min</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="kr">max</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">11</span><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">r</span><span class="p">;</span>
<span class="linenos">12</span><span class="p">}</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="c1">// The gradient of J</span>
<span class="linenos">15</span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">dJ</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">u</span><span class="p">){</span>
<span class="linenos">16</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="n">w</span><span class="p">;</span>
<span class="linenos">17</span><span class="w">   </span><span class="n">w</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="linenos">18</span><span class="w">   </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">w</span><span class="p">));</span>
<span class="linenos">19</span><span class="w">   </span><span class="kt">varf</span><span class="w"> </span><span class="nf">au</span><span class="w"> </span><span class="p">(</span><span class="n">uh</span><span class="p">,</span><span class="w"> </span><span class="n">vh</span><span class="p">)</span>
<span class="linenos">20</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos">21</span><span class="w">           </span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">vh</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">vh</span><span class="p">))</span>
<span class="linenos">22</span><span class="w">         </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="o">*</span><span class="n">vh</span>
<span class="linenos">23</span><span class="w">      </span><span class="p">)</span>
<span class="linenos">24</span><span class="w">      </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">uh</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">25</span><span class="w">      </span><span class="p">;</span>
<span class="linenos">26</span>
<span class="linenos">27</span><span class="w">   </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">au</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span>
<span class="linenos">28</span><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">u</span><span class="p">;</span><span class="w"> </span><span class="c1">//warning: no return of local array</span>
<span class="linenos">29</span><span class="p">}</span>
</pre></div>
</div>
<p>We also want to construct a preconditioner <span class="math notranslate nohighlight">\(C\)</span> with solving the problem:</p>
<p>find <span class="math notranslate nohighlight">\(u_h \in V_{0h}\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[\forall v_h \in V_{0h}, \quad \int_\Omega \alpha \nabla u_h . \nabla v_h = \int_\Omega b v_h\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha=f'(|\nabla u|^2)\)</span>.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">));</span>
<span class="linenos"> 2</span><span class="kt">varf</span><span class="w"> </span><span class="nf">alap</span><span class="w"> </span><span class="p">(</span><span class="n">uh</span><span class="p">,</span><span class="w"> </span><span class="n">vh</span><span class="p">)</span>
<span class="linenos"> 3</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos"> 4</span><span class="w">        </span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">uh</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">vh</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">uh</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">vh</span><span class="p">))</span>
<span class="linenos"> 5</span><span class="w">   </span><span class="p">)</span>
<span class="linenos"> 6</span><span class="w">   </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">uh</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="w">   </span><span class="p">;</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="kt">varf</span><span class="w"> </span><span class="nf">amass</span><span class="p">(</span><span class="n">uh</span><span class="p">,</span><span class="w"> </span><span class="n">vh</span><span class="p">)</span>
<span class="linenos">10</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos">11</span><span class="w">        </span><span class="n">uh</span><span class="o">*</span><span class="n">vh</span>
<span class="linenos">12</span><span class="w">   </span><span class="p">)</span>
<span class="linenos">13</span><span class="w">   </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">uh</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">14</span><span class="w">   </span><span class="p">;</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="kt">matrix</span><span class="w"> </span><span class="n">Amass</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">amass</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">);</span>
<span class="linenos">17</span><span class="kt">matrix</span><span class="w"> </span><span class="n">Alap</span><span class="o">=</span><span class="w"> </span><span class="n">alap</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="kp">solver</span><span class="o">=</span><span class="kr">Cholesky</span><span class="p">,</span><span class="w"> </span><span class="kp">factorize</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="c1">// Preconditionner</span>
<span class="linenos">20</span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">C</span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">u</span><span class="p">){</span>
<span class="linenos">21</span><span class="w">   </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="linenos">22</span><span class="w">   </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alap</span><span class="o">^</span><span class="mi">-1</span><span class="o">*</span><span class="n">w</span><span class="p">;</span>
<span class="linenos">23</span><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">u</span><span class="p">;</span><span class="w"> </span><span class="c1">//warning: no return of local array variable</span>
<span class="linenos">24</span><span class="p">}</span>
</pre></div>
</div>
<p>To solve the problem, we make 10 iterations of the conjugate gradient, recompute the preconditioner and restart the conjugate gradient:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">int</span><span class="w"> </span><span class="n">conv</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 2</span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="linenos"> 3</span><span class="w">   </span><span class="n">conv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">NLCG</span><span class="p">(</span><span class="n">dJ</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">[],</span><span class="w"> </span><span class="kp">nbiter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="kp">precon</span><span class="o">=</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="kp">veps</span><span class="o">=</span><span class="kp">eps</span><span class="p">,</span><span class="w"> </span><span class="kr">verbosity</span><span class="o">=</span><span class="mi">5</span><span class="p">);</span>
<span class="linenos"> 4</span><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">conv</span><span class="p">)</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="w">   </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">));</span>
<span class="linenos"> 7</span><span class="w">   </span><span class="n">Alap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alap</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="kp">solver</span><span class="o">=</span><span class="kr">Cholesky</span><span class="p">,</span><span class="w"> </span><span class="kp">factorize</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos"> 8</span><span class="w">   </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Restart with new preconditionner &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">conv</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, eps =&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kp">eps</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 9</span><span class="p">}</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="c1">// Plot</span>
<span class="linenos">12</span><span class="nf">plot</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;solution with NLCG&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>For a given symmetric positive matrix <span class="math notranslate nohighlight">\(A\)</span>, consider the quadratic form</p>
<div class="math notranslate nohighlight">
\[J(\mathbf{x})=\frac{1}{2}\mathbf{x}^TA\mathbf{x}-\mathbf{b}^T\mathbf{x}\]</div>
<p>then <span class="math notranslate nohighlight">\(J(\mathbf{x})\)</span> is minimized by the solution <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> of <span class="math notranslate nohighlight">\(A\mathbf{x}=\mathbf{b}\)</span>.
In this case, we can use the function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">AffineCG</span></code></p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nf">AffineCG</span><span class="p">(</span><span class="kp">A</span><span class="p">,</span><span class="w"> </span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="kp">precon</span><span class="o">=</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="kp">nbiter</span><span class="o">=</span><span class="kr">imax</span><span class="p">,</span><span class="w"> </span><span class="kp">eps</span><span class="o">=</span><span class="n">epsilon</span><span class="p">,</span><span class="w"> </span><span class="kp">stop</span><span class="o">=</span><span class="n">stp</span><span class="p">);</span>
</pre></div>
</div>
<p>If <span class="math notranslate nohighlight">\(A\)</span> is not symmetric, we can use GMRES(Generalized Minimum Residual) algorithm by</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nf">AffineGMRES</span><span class="p">(</span><span class="kp">A</span><span class="p">,</span><span class="w"> </span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="kp">precon</span><span class="o">=</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="kp">nbiter</span><span class="o">=</span><span class="kr">imax</span><span class="p">,</span><span class="w"> </span><span class="kp">eps</span><span class="o">=</span><span class="n">epsilon</span><span class="p">);</span>
</pre></div>
</div>
<p>Also, we can use the non-linear version of GMRES algorithm (the function <span class="math notranslate nohighlight">\(J\)</span> is just convex)</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nf">AffineGMRES</span><span class="p">(</span><span class="n">dJ</span><span class="p">,</span><span class="w"> </span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="kp">precon</span><span class="o">=</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="kp">nbiter</span><span class="o">=</span><span class="kr">imax</span><span class="p">,</span><span class="w"> </span><span class="kp">eps</span><span class="o">=</span><span class="n">epsilon</span><span class="p">);</span>
</pre></div>
</div>
<p>For the details of these algorithms, refer to <a class="reference internal" href="../bibliography.html#pironneau1998" id="id1"><span>[PIRONNEAU1998]</span></a>, Chapter IV, 1.3.</p>
</section>
<section id="algorithms-for-unconstrained-optimization">
<h2>Algorithms for Unconstrained Optimization<a class="headerlink" href="#algorithms-for-unconstrained-optimization" title="Link to this heading"></a></h2>
<p>Two algorithms of COOOL package are interfaced with the Newton Raphson method (called <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Newton</span></code>) and the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">BFGS</span></code> method.
These two are directly available in <strong>FreeFEM</strong> (no dynamical link to load).
Be careful with these algorithms, because their implementation uses full matrices.
We also provide several optimization algorithms from the <a class="reference external" href="https://nlopt.readthedocs.io/en/latest/">NLopt library</a> as well as an interface for Hansen’s implementation of CMAES (a MPI version of this one is also available).</p>
<section id="example-of-usage-for-bfgs-or-cmaes">
<h3>Example of usage for BFGS or CMAES<a class="headerlink" href="#example-of-usage-for-bfgs-or-cmaes" title="Link to this heading"></a></h3>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>BFGS</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="c1">//J</span>
<span class="linenos"> 4</span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">J</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">u</span><span class="p">){</span>
<span class="linenos"> 5</span><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 6</span><span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="kr">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="w">      </span><span class="n">s</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mf">0.5</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos"> 8</span><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debugJ</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="w">      </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;J = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, u = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">10</span><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">s</span><span class="p">;</span>
<span class="linenos">11</span><span class="p">}</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="c1">//the gradient of J (this is a affine version (the RHS is in)</span>
<span class="linenos">14</span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">DJ</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">u</span><span class="p">){</span>
<span class="linenos">15</span><span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="kr">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">16</span><span class="w">      </span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos">17</span><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debugdJ</span><span class="p">)</span>
<span class="linenos">18</span><span class="w">      </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;dJ: u = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">19</span><span class="w">   </span><span class="n">u</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="linenos">20</span><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debugdJ</span><span class="p">)</span>
<span class="linenos">21</span><span class="w">      </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;dJ-b: u = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">22</span><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">u</span><span class="p">;</span><span class="w"> </span><span class="c1">//return of global variable ok</span>
<span class="linenos">23</span><span class="p">}</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="linenos">26</span><span class="n">u</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
<span class="linenos">27</span><span class="nf">BFGS</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">DJ</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kp">eps</span><span class="o">=</span><span class="mf">1.</span><span class="n">e</span><span class="mi">-6</span><span class="p">,</span><span class="w"> </span><span class="kp">nbiter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="n">nbiterline</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
<span class="linenos">28</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;BFGS: J(u) = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">J</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, err = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">error</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
</pre></div>
</div>
</div>
<p>It is almost the same a using the CMA evolution strategy except, that since it is a derivative free optimizer, the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">dJ</span></code> argument is omitted and there are some other named parameters to control the behavior of the algorithm.
With the same objective function as above, an example of utilization would be (see <a class="reference internal" href="../examples/algorithms-and-optimizations.html#examplecmaesvariationalinequality"><span class="std std-ref">CMAES Variational inequality</span></a> for a complete example):</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;ff-cmaes&quot;</span>
<span class="linenos">2</span><span class="c1">//define J, u, ...</span>
<span class="linenos">3</span><span class="kt">real</span><span class="w"> </span><span class="kr">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cmaes</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">stopTolFun</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span><span class="w"> </span><span class="n">stopMaxIter</span><span class="o">=</span><span class="mi">3000</span><span class="p">);</span>
<span class="linenos">4</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;minimum value is &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">min</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; for u = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>This algorithm works with a normal multivariate distribution in the parameters space and tries to adapt its covariance matrix using the information provided by the successive function evaluations (see <a class="reference external" href="https://nlopt.readthedocs.io/en/latest/">NLopt documentation</a> for more details).
Therefore, some specific parameters can be passed to control the starting distribution, size of the sample generations, etc…
Named parameters for this are the following:</p>
<ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">seed</span><span class="o">=</span></code> Seed for random number generator (<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">val</span></code> is an integer).
No specified value will lead to a clock based seed initialization.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">initialStdDev</span><span class="o">=</span></code> Value for the standard deviations of the initial covariance matrix ( <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">val</span></code> is a real).
If the value <span class="math notranslate nohighlight">\(\sigma\)</span> is passed, the initial covariance matrix will be set to <span class="math notranslate nohighlight">\(\sigma I\)</span>.
The expected initial distance between initial <span class="math notranslate nohighlight">\(X\)</span> and the <span class="math notranslate nohighlight">\(argmin\)</span> should be roughly initialStdDev. Default is 0.3.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">initialStdDevs</span><span class="o">=</span></code> Same as above except that the argument is an array allowing to set a value of the initial standard deviation for each parameter.
Entries differing by several orders of magnitude should be avoided (if it can’t be, try rescaling the problem).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">stopTolFun</span><span class="o">=</span></code> Stops the algorithm if function value differences are smaller than the passed one, default is <span class="math notranslate nohighlight">\(10^{-12}\)</span>.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">stopTolFunHist</span><span class="o">=</span></code> Stops the algorithm if function value differences from the best values are smaller than the passed one, default is 0 (unused).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">stopTolX</span><span class="o">=</span></code> Stopping criteria is triggered if step sizes in the parameters space are smaller than this real value, default is 0.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">stopTolXFactor</span><span class="o">=</span></code> Stopping criteria is triggered when the standard deviation increases more than this value. The default value is <span class="math notranslate nohighlight">\(10^{3}\)</span>.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">stopMaxFunEval</span><span class="o">=</span></code> Stops the algorithm when <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">stopMaxFunEval</span></code> function evaluations have been done.
Set to <span class="math notranslate nohighlight">\(900(n+3)^{2}\)</span> by default, where <span class="math notranslate nohighlight">\(n\)</span> is the parameters space dimension.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">stopMaxIter</span><span class="o">=</span></code> Integer stopping the search when <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">stopMaxIter</span></code> generations have been sampled.
Unused by default.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">popsize</span><span class="o">=</span></code> Integer value used to change the sample size.
The default value is <span class="math notranslate nohighlight">\(4+ \lfloor 3\ln (n) \rfloor\)</span>.
Increasing the population size usually improves the global search capabilities at the cost of, at most, a linear reduction of the convergence speed with respect to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">popsize</span></code>.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">paramFile</span><span class="o">=</span></code> This <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">string</span></code> type parameter allows the user to pass all the parameters using an extern file, as in Hansen’s original code.
More parameters related to the CMA-ES algorithm can be changed with this file.
Note that the parameters passed to the CMAES function in the <strong>FreeFEM</strong> script will be ignored if an input parameters file is given.</p></li>
</ul>
</section>
</section>
<section id="ipopt">
<h2>IPOPT<a class="headerlink" href="#ipopt" title="Link to this heading"></a></h2>
<p>The <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ff</span><span class="o">-</span><span class="n">Ipopt</span></code> package is an interface for the <a class="reference external" href="https://projects.coin-or.org/Ipopt">IPOPT</a> <a class="reference internal" href="../bibliography.html#wachter2006" id="id2"><span>[WÄCHTER2006]</span></a> optimizer.
IPOPT is a software library for large scale, non-linear, constrained optimization.
It implements a primal-dual interior point method along with filter method based line searches.</p>
<p>IPOPT needs a direct sparse symmetric linear solver.
If your version of <strong>FreeFEM</strong> has been compiled with the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">downlad</span></code> tag, it will automatically be linked with a sequential version of MUMPS.
An alternative to MUMPS would be to download the HSL subroutines (see <a class="reference external" href="https://projects.coin-or.org/Ipopt/wiki/JavaInterface">Compiling and Installing the Java Interface JIPOPT</a>) and place them in the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="o">/</span><span class="n">ipopt</span><span class="o">/</span><span class="n">Ipopt</span><span class="mf">-3.10.2</span><span class="o">/</span><span class="n">ThirdParty</span><span class="o">/</span><span class="n">HSL</span></code> directory of the <strong>FreeFEM</strong> downloads folder before compiling.</p>
<section id="short-description-of-the-algorithm">
<h3>Short description of the algorithm<a class="headerlink" href="#short-description-of-the-algorithm" title="Link to this heading"></a></h3>
<p>In this section, we give a very brief glimpse at the underlying mathematics of IPOPT.
For a deeper introduction on interior methods for nonlinear smooth optimization, one may consult <a class="reference internal" href="../bibliography.html#forsgren2002" id="id3"><span>[FORSGREN2002]</span></a>, or <a class="reference internal" href="../bibliography.html#wachter2006" id="id4"><span>[WÄCHTER2006]</span></a> for more IPOPT specific elements.
IPOPT is designed to perform optimization for both equality and inequality constrained problems.
However, nonlinear inequalities are rearranged before the beginning of the optimization process in order to restrict the panel of nonlinear constraints to those of the equality kind.
Each nonlinear inequality is transformed into a pair of simple bound inequalities and nonlinear equality constraints by the introduction of as many slack variables as is needed : <span class="math notranslate nohighlight">\(c_{i}(x)\leq 0\)</span> becomes <span class="math notranslate nohighlight">\(c_{i}(x) + s_{i} = 0\)</span> and <span class="math notranslate nohighlight">\(s_{i}\leq 0\)</span>, where <span class="math notranslate nohighlight">\(s_{i}\)</span> is added to the initial variables of the problems <span class="math notranslate nohighlight">\(x_{i}\)</span>.
Thus, for convenience, we will assume that the minimization problem does not contain any nonlinear inequality constraint.
It means that, given a function <span class="math notranslate nohighlight">\(f:\mathbb{R}^{n}\mapsto\mathbb{R}\)</span>, we want to find:</p>
<div class="math notranslate nohighlight" id="equation-minimproblem">
<span class="eqno">(25)<a class="headerlink" href="#equation-minimproblem" title="Link to this equation"></a></span>\[\begin{split}x_{0} = \underset{x\in V}{\operatorname{argmin}} f(x) \\
\mathrm{with}\ V = \left\lbrace x\in\mathbb{R}^{n}\ \vert\ c(x)= 0 \ \text{and}\ x_{l}\leq x\leq x_{u}\right\rbrace\end{split}\]</div>
<p>Where <span class="math notranslate nohighlight">\(c:\mathbb{R}^{n}\rightarrow\mathbb{R}^{m}\)</span> and <span class="math notranslate nohighlight">\(x_{l},x_{u}\in\mathbb{R}^{n}\)</span> and inequalities hold componentwise.
The <span class="math notranslate nohighlight">\(f\)</span> function as well as the constraints <span class="math notranslate nohighlight">\(c\)</span> should be twice-continuously differentiable.</p>
<p>As a barrier method, interior points algorithms try to find a Karush-Kuhn-Tucker point for <a class="reference internal" href="#equation-minimproblem">(25)</a> by solving a sequence of problems, unconstrained with respect to the inequality constraints, of the form:</p>
<div class="math notranslate nohighlight" id="equation-barrier">
<span class="eqno">(26)<a class="headerlink" href="#equation-barrier" title="Link to this equation"></a></span>\[\mathrm{for\ a\ given\ }\mu &gt; 0,\ \mathrm{find}\ x_{\mu} = \underset{x\in\mathbb{R}^{n}\ \vert\ c(x)=0}{\operatorname{argmin}}\ B(x,\mu)\]</div>
<p>Where <span class="math notranslate nohighlight">\(\mu\)</span> is a positive real number and</p>
<div class="math notranslate nohighlight">
\[B(x,\mu) = f(x) - \displaystyle{\mu\sum_{i=1}^{n} \ln (x_{u,i}-x_{i})} - \displaystyle{\mu\sum_{i=1}^{m} \ln(x_{i}-x_{l,i})}\]</div>
<p>The remaining equality constraints are handled with the usual Lagrange multipliers method.
If the sequence of barrier parameters <span class="math notranslate nohighlight">\(\mu\)</span> converge to 0, intuition suggests that the sequence of minimizers of <a class="reference internal" href="#equation-barrier">(26)</a> converge to a local constrained minimizer of <a class="reference internal" href="#equation-minimproblem">(25)</a>.
For a given <span class="math notranslate nohighlight">\(\mu\)</span>, <a class="reference internal" href="#equation-barrier">(26)</a> is solved by finding <span class="math notranslate nohighlight">\((x_{\mu},\lambda_{\mu})\in\mathbb{R}^{n}\times\mathbb{R}^{m}\)</span> such that:</p>
<div class="math notranslate nohighlight" id="equation-muproblem">
<span class="eqno">(27)<a class="headerlink" href="#equation-muproblem" title="Link to this equation"></a></span>\[\begin{split}\nabla B(x_{\mu},\mu) + \displaystyle{\sum_{i=1}^{m}\lambda_{\mu,i}\nabla c_{i}(x_{\mu})}= \nabla B(x_{\mu},\mu) + J_{c}(x_{\mu})^{T}\lambda_{\mu}&amp;= 0\\
c(x_{\mu}) &amp;= 0\end{split}\]</div>
<p>The derivations for <span class="math notranslate nohighlight">\(\nabla B\)</span> only holds for the <span class="math notranslate nohighlight">\(x\)</span> variables, so that:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla B(x,\mu) = \nabla f(x) + \left(\begin{matrix}\mu/(x_{u,1}-x_{1}) \\ \vdots \\ \mu/(x_{u,n}-x_{n})\end{matrix}\right) - \left(\begin{matrix}\mu/(x_{1}-x_{l,1}) \\ \vdots \\ \mu/(x_{n}-x_{l,n})\end{matrix}\right)\end{split}\]</div>
<p>If we respectively call <span class="math notranslate nohighlight">\(z_{u}(x,\mu) = \left(\mu/(x_{u,1}-x_{1}),\dots, \mu/(x_{u,n}-x_{n})\right)\)</span> and <span class="math notranslate nohighlight">\(z_{l}(x,\mu)\)</span> the other vector appearing in the above equation, then the optimum <span class="math notranslate nohighlight">\((x_{\mu},\lambda_{\mu})\)</span> satisfies:</p>
<div class="math notranslate nohighlight" id="equation-muproblemlambda">
<span class="eqno">(28)<a class="headerlink" href="#equation-muproblemlambda" title="Link to this equation"></a></span>\[\nabla f(x_{\mu}) + J_{c}(x_{\mu})^{T}\lambda_{\mu}+ z_{u}(x_{\mu},\mu) - z_{l}(x_{\mu},\mu) = 0 \quad \text{and} \quad c(x_{\mu}) = 0\]</div>
<p>In this equation, the <span class="math notranslate nohighlight">\(z_l\)</span> and <span class="math notranslate nohighlight">\(z_u\)</span> vectors seem to play the role of Lagrange multipliers for the simple bound inequalities, and indeed, when <span class="math notranslate nohighlight">\(\mu\rightarrow 0\)</span>, they converge toward some suitable Lagrange multipliers for the KKT conditions, provided some technical assumptions are fulfilled (see <a class="reference internal" href="../bibliography.html#forsgren2002" id="id5"><span>[FORSGREN2002]</span></a>).</p>
<p>Equation <a class="reference internal" href="#equation-muproblemlambda">(28)</a> is solved by performing a Newton method in order to find a solution of <a class="reference internal" href="#equation-muproblem">(27)</a> for each of the decreasing values of <span class="math notranslate nohighlight">\(\mu\)</span>.
Some order 2 conditions are also taken into account to avoid convergence to local maximizers, see <a class="reference internal" href="../bibliography.html#forsgren2002" id="id6"><span>[FORSGREN2002]</span></a> for details about them.
In the most classic IP algorithms, the Newton method is directly applied to <a class="reference internal" href="#equation-muproblem">(27)</a>.
This is in most case inefficient due to frequent computation of infeasible points.
These difficulties are avoided in Primal-Dual interior point methods where <a class="reference internal" href="#equation-muproblem">(27)</a> is transformed into an extended system where <span class="math notranslate nohighlight">\(z_u\)</span> and <span class="math notranslate nohighlight">\(z_l\)</span> are treated as unknowns and the barrier problems are finding <span class="math notranslate nohighlight">\((x,\lambda,z_u,z_l)\in\mathbb{R}^n\times\mathbb{R}^m\times\mathbb{R}^n\times\mathbb{R}^n\)</span> such that:</p>
<div class="math notranslate nohighlight" id="equation-primaldualipbarrierproblem">
<span class="eqno">(29)<a class="headerlink" href="#equation-primaldualipbarrierproblem" title="Link to this equation"></a></span>\[\begin{split}\left\lbrace
\begin{array}{rcl}
   \nabla f(x) + J_{c}(x)^{T}\lambda+ z_{u} - z_{l} &amp; = &amp; 0 \\
   c(x) &amp; = &amp; 0 \\
   (X_u - X) z_u - \mu e &amp; = &amp; 0 \\
   (X - X_l) z_l - \mu e &amp; = &amp; 0
\end{array}
\right.\end{split}\]</div>
<p>Where if <span class="math notranslate nohighlight">\(a\)</span> is a vector of <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>, <span class="math notranslate nohighlight">\(A\)</span> denotes the diagonal matrix <span class="math notranslate nohighlight">\(A=(a_i \delta_{ij})_{1\leq i,j\leq n}\)</span> and <span class="math notranslate nohighlight">\(e\in\mathbb{R}^{n} = (1,1,\dots,1)\)</span>.
Solving this nonlinear system by the Newton method is known as being the <em>primal-dual</em> interior point method.
Here again, more details are available in <a class="reference internal" href="../bibliography.html#forsgren2002" id="id7"><span>[FORSGREN2002]</span></a>.
Most actual implementations introduce features in order to globalize the convergence capability of the method, essentially by adding some line-search steps to the Newton algorithm, or by using trust regions.
For the purpose of IPOPT, this is achieved by a <em>filter line search</em> methods, the details of which can be found in <a class="reference internal" href="../bibliography.html#wachter2006" id="id8"><span>[WÄCHTER2006]</span></a>.</p>
<p>More IPOPT specific features or implementation details can be found in <a class="reference internal" href="../bibliography.html#wachter2006" id="id9"><span>[WÄCHTER2006]</span></a>.
We will just retain that IPOPT is a smart Newton method for solving constrained optimization problems, with global convergence capabilities due to a robust line search method (in the sense that the algorithm will converge no matter the initializer).
Due to the underlying Newton method, the optimization process requires expressions of all derivatives up to the order 2 of the fitness function as well as those of the constraints.
For problems whose Hessian matrices are difficult to compute or lead to high dimensional dense matrices, it is possible to use a BFGS approximation of these objects at the cost of a much slower convergence rate.</p>
</section>
<section id="ipopt-in-freefem">
<h3>IPOPT in <strong>FreeFEM</strong><a class="headerlink" href="#ipopt-in-freefem" title="Link to this heading"></a></h3>
<p>Calling the IPOPT optimizer in a <strong>FreeFEM</strong> script is done with the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">IPOPT</span></code> function included in the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ff</span><span class="o">-</span><span class="n">Ipopt</span></code> dynamic library.
IPOPT is designed to solve constrained minimization problems in the form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathrm{find} &amp; x_{0} = \underset{x\in\mathbb{R}^{n}}{\operatorname{argmin}} f(x) \\
\mathrm{s.t.} &amp; \left\lbrace
\begin{array}{l r}
   \forall i\leq n,\ x_{i}^{\mathrm{lb}}\leq x_{i}\leq x_{i}^{\mathrm{ub}} &amp; \mathrm{\ (simple\ bounds)} \\
   \forall i\leq m,\ c_{i}^{\mathrm{lb}}\leq c_{i}(x)\leq c_{i}^{\mathrm{ub}} &amp; \mathrm{(constraints\ functions)}
\end{array}
\right.\end{split}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\mathrm{ub}\)</span> and <span class="math notranslate nohighlight">\(\mathrm{lb}\)</span> stand for “upper bound” and “lower bound”.
If for some <span class="math notranslate nohighlight">\(i, 1\leq i\leq m\)</span> we have <span class="math notranslate nohighlight">\(c_{i}^{\mathrm{lb}} = c_{i}^{\mathrm{ub}}\)</span>, it means that <span class="math notranslate nohighlight">\(c_{i}\)</span> is an equality constraint, and an inequality one if <span class="math notranslate nohighlight">\(c_{i}^{\mathrm{lb}} &lt; c_{i}^{\mathrm{ub}}\)</span>.</p>
<p>There are different ways to pass the fitness function and constraints.
The more general one is to define the functions using the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">func</span></code>.
Any returned matrix must be a sparse one (type <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">matrix</span></code>, not a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span></code>):</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">J</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="p">{...}</span><span class="w"> </span><span class="c1">//Fitness Function, returns a scalar</span>
<span class="linenos">2</span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">gradJ</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="p">{...}</span><span class="w"> </span><span class="c1">//Gradient is a vector</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="p">{...}</span><span class="w"> </span><span class="c1">//Constraints</span>
<span class="linenos">5</span><span class="kt">func</span><span class="w"> </span><span class="kt">matrix</span><span class="w"> </span><span class="n">jacC</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="p">{...}</span><span class="w"> </span><span class="c1">//Constraints Jacobian</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In the current version of <strong>FreeFEM</strong>, returning a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">matrix</span></code> object that is local to a function block leads to undefined results.
For each sparse matrix returning function you define, an extern matrix object has to be declared, whose associated function will overwrite and return on each call.
Here is an example for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">jacC</span></code>:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">matrix</span><span class="w"> </span><span class="n">jacCBuffer</span><span class="p">;</span><span class="w"> </span><span class="c1">//just declare, no need to define yet</span>
<span class="linenos">2</span><span class="kt">func</span><span class="w"> </span><span class="kt">matrix</span><span class="w"> </span><span class="n">jacC</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">){</span>
<span class="linenos">3</span><span class="w">   </span><span class="p">...</span><span class="c1">//fill jacCBuffer</span>
<span class="linenos">4</span><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">jacCBuffer</span><span class="p">;</span>
<span class="linenos">5</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>IPOPT requires the structure of each matrix at the initialization of the algorithm.
Some errors may occur if the matrices are not constant and are built with the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">matrix</span><span class="w"> </span><span class="kp">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">I</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">C</span><span class="p">]</span></code> syntax, or with an intermediary full matrix (<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span></code>), because any null coefficient is discarded during the construction of the sparse matrix.
It is also the case when making matrices linear combinations, for which any zero coefficient will result in the suppression of the matrix from the combination.
Some controls are available to avoid such problems.
Check the named parameter descriptions (<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">checkindex</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">structhess</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">structjac</span></code> can help).
We strongly advice to use <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">varf</span></code> as much as possible for the matrix forging.</p>
</div>
<p>The Hessian returning function is somewhat different because it has to
be the Hessian of the Lagrangian function:</p>
<div class="math notranslate nohighlight">
\[(x,\sigma_{f},\lambda)\mapsto\sigma_{f}\nabla^{2}f(x)+\displaystyle{\sum_{i=1}^{m}\lambda_{i}\nabla^{2}c_{i}(x)}\ \mathrm{ where }\ \lambda\in\mathbb{R}^{m}\ \mathrm{ and }\ \sigma\in\mathbb{R}\]</div>
<p>Your Hessian function should then have the following prototype:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">matrix</span><span class="w"> </span><span class="n">hessianLBuffer</span><span class="p">;</span><span class="w"> </span><span class="c1">//Just to keep it in mind</span>
<span class="linenos">2</span><span class="kt">func</span><span class="w"> </span><span class="kt">matrix</span><span class="w"> </span><span class="n">hessianL</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="kp">sigma</span><span class="p">,</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">lambda</span><span class="p">){...}</span>
</pre></div>
</div>
<p>If the constraints functions are all affine, or if there are only simple bound constraints, or no constraint at all, the Lagrangian Hessian is equal to the fitness function Hessian, one can then omit the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">sigma</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">lambda</span></code> parameters:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">matrix</span><span class="w"> </span><span class="n">hessianJBuffer</span><span class="p">;</span>
<span class="linenos">2</span><span class="kt">func</span><span class="w"> </span><span class="kt">matrix</span><span class="w"> </span><span class="n">hessianJ</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">){...}</span><span class="w"> </span><span class="c1">//Hessian prototype when constraints are affine</span>
</pre></div>
</div>
<p>When these functions are defined, IPOPT is called this way:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">Xi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">//starting point</span>
<span class="linenos">2</span><span class="n">IPOPT</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">gradJ</span><span class="p">,</span><span class="w"> </span><span class="n">hessianL</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">jacC</span><span class="p">,</span><span class="w"> </span><span class="n">Xi</span><span class="p">,</span><span class="w"> </span><span class="cm">/*some named parameters*/</span><span class="p">);</span>
</pre></div>
</div>
<p>If the Hessian is omitted, the interface will tell IPOPT to use the (L)BFGS approximation (it can also be enabled with a named parameter, see further).
Simple bound or unconstrained problems do not require the constraints part, so the following expressions are valid:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">IPOPT</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">gradJ</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">jacC</span><span class="p">,</span><span class="w"> </span><span class="n">Xi</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">);</span><span class="w"> </span><span class="c1">//IPOPT with BFGS</span>
<span class="linenos">2</span><span class="n">IPOPT</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">gradJ</span><span class="p">,</span><span class="w"> </span><span class="n">hessianJ</span><span class="p">,</span><span class="w"> </span><span class="n">Xi</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">);</span><span class="w"> </span><span class="c1">//Newton IPOPT without constraints</span>
<span class="linenos">3</span><span class="n">IPOPT</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">gradJ</span><span class="p">,</span><span class="w"> </span><span class="n">Xi</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">);</span><span class="w"> </span><span class="c1">//BFGS, no constraints</span>
</pre></div>
</div>
<p>Simple bounds are passed using the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">lb</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ub</span></code> named parameters, while constraint bounds are passed with the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">clb</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">cub</span></code> ones.
Unboundedness in some directions can be achieved by using the <span class="math notranslate nohighlight">\(1e^{19}\)</span> and <span class="math notranslate nohighlight">\(-1e^{19}\)</span> values that IPOPT recognizes as <span class="math notranslate nohighlight">\(+\infty\)</span> and <span class="math notranslate nohighlight">\(-\infty\)</span>:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">xlb</span><span class="p">(</span><span class="kr">n</span><span class="p">),</span><span class="w"> </span><span class="n">xub</span><span class="p">(</span><span class="kr">n</span><span class="p">),</span><span class="w"> </span><span class="n">clb</span><span class="p">(</span><span class="kr">m</span><span class="p">),</span><span class="w"> </span><span class="n">cub</span><span class="p">(</span><span class="kr">m</span><span class="p">);</span>
<span class="linenos">2</span><span class="c1">//fill the arrays...</span>
<span class="linenos">3</span><span class="n">IPOPT</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">gradJ</span><span class="p">,</span><span class="w"> </span><span class="n">hessianL</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">jacC</span><span class="p">,</span><span class="w"> </span><span class="n">Xi</span><span class="p">,</span><span class="w"> </span><span class="n">lb</span><span class="o">=</span><span class="n">xlb</span><span class="p">,</span><span class="w"> </span><span class="n">ub</span><span class="o">=</span><span class="n">xub</span><span class="p">,</span><span class="w"> </span><span class="n">clb</span><span class="o">=</span><span class="n">clb</span><span class="p">,</span><span class="w"> </span><span class="n">cub</span><span class="o">=</span><span class="n">cub</span><span class="p">,</span><span class="w"> </span><span class="cm">/*some other named parameters*/</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>P2 fitness function and affine constraints function :</strong> In the case where the fitness function or constraints function can be expressed respectively in the following forms:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c c}
    \forall x\in\mathbb{R}^{n},\ f(x) = \frac{1}{2}\left\langle Ax,x \right\rangle + \left\langle b,x\right\rangle &amp; (A,b)\in\mathcal{M}_{n,n}(\mathbb{R})\times\mathbb{R}^{n} \\
    \mathrm{or} ,\ C(x) = Ax + b &amp; (A,b)\in\mathcal{M}_{m,n}(\mathbb{R})\times\mathbb{R}^{m}
\end{array}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are constant, it is possible to directly pass the <span class="math notranslate nohighlight">\((A,b)\)</span> pair instead of defining 3 (or 2) functions.
It also indicates to IPOPT that some objects are constant and that they have to be evaluated only once, thus avoiding multiple copies of the same matrix.
The syntax is:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">// Affine constraints with &quot;standard&quot; fitness function</span>
<span class="linenos">2</span><span class="kt">matrix</span><span class="w"> </span><span class="kp">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">//linear part of the constraints</span>
<span class="linenos">3</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">//constant part of constraints</span>
<span class="linenos">4</span><span class="n">IPOPT</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">gradJ</span><span class="p">,</span><span class="w"> </span><span class="n">hessianJ</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kp">A</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">],</span><span class="w"> </span><span class="n">Xi</span><span class="p">,</span><span class="w"> </span><span class="cm">/*bounds and named parameters*/</span><span class="p">);</span>
<span class="linenos">5</span><span class="c1">//[b, A] would work as well.</span>
</pre></div>
</div>
<p>Note that if you define the constraints in this way, they don’t contribute to the Hessian, so the Hessian should only take one <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> as an argument.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">// Affine constraints and P2 fitness func</span>
<span class="linenos">2</span><span class="kt">matrix</span><span class="w"> </span><span class="kp">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">//bilinear form matrix</span>
<span class="linenos">3</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">//linear contribution to f</span>
<span class="linenos">4</span><span class="kt">matrix</span><span class="w"> </span><span class="n">Ac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">//linear part of the constraints</span>
<span class="linenos">5</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">bc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">//constant part of constraints</span>
<span class="linenos">6</span><span class="n">IPOPT</span><span class="p">([</span><span class="kp">A</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">Ac</span><span class="p">,</span><span class="w"> </span><span class="n">bc</span><span class="p">],</span><span class="w"> </span><span class="n">Xi</span><span class="p">,</span><span class="w"> </span><span class="cm">/*bounds and named parameters*/</span><span class="p">);</span>
</pre></div>
</div>
<p>If both objective and constraint functions are given this way, it automatically activates the IPOPT <code class="docutils literal highlight highlight-python"><span></span><span class="n">mehrotra_algorithm</span></code> option (better for linear and quadratic programming according to the documentation).
Otherwise, this option can only be set through the option file (see the named parameters section).</p>
<p>A false case is the one of defining <span class="math notranslate nohighlight">\(f\)</span> in this manner while using standard functions for the constraints:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">matrix</span><span class="w"> </span><span class="kp">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">//bilinear form matrix</span>
<span class="linenos">2</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">//linear contribution to f</span>
<span class="linenos">3</span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">C</span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">){...}</span><span class="w"> </span><span class="c1">//constraints</span>
<span class="linenos">4</span><span class="kt">func</span><span class="w"> </span><span class="kt">matrix</span><span class="w"> </span><span class="n">jacC</span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">){...}</span><span class="w"> </span><span class="c1">//constraints Jacobian</span>
<span class="linenos">5</span><span class="n">IPOPT</span><span class="p">([</span><span class="kp">A</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">],</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">jacC</span><span class="p">,</span><span class="w"> </span><span class="n">Xi</span><span class="p">,</span><span class="w"> </span><span class="cm">/*bounds and named parameters*/</span><span class="p">);</span>
</pre></div>
</div>
<p>Indeed, when passing <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="kp">A</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">]</span></code> in order to define <span class="math notranslate nohighlight">\(f\)</span>, the Lagrangian Hessian is automatically built and has the constant <span class="math notranslate nohighlight">\(x \mapsto A\)</span> function, with no way to add possible constraint contributions, leading to incorrect second order derivatives.
So, a problem should be defined like that in only two cases:</p>
<ol class="arabic simple">
<li><p>constraints are nonlinear but you want to use the BFGS mode (then add <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">bfgs</span><span class="o">=</span><span class="mi">1</span></code> to the named parameter),</p></li>
<li><p>constraints are affine, but in this case, compatible to pass in the same way</p></li>
</ol>
<p>Here are some other valid definitions of the problem (cases when <span class="math notranslate nohighlight">\(f\)</span> is a pure quadratic or linear form, or <span class="math notranslate nohighlight">\(C\)</span> a pure linear function, etc…):</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">// Pure quadratic f - A is a matrix</span>
<span class="linenos">2</span><span class="n">IPOPT</span><span class="p">(</span><span class="kp">A</span><span class="p">,</span><span class="w"> </span><span class="cm">/*constraints arguments*/</span><span class="p">,</span><span class="w"> </span><span class="n">Xi</span><span class="p">,</span><span class="w"> </span><span class="cm">/*bound and named parameters*/</span><span class="p">);</span>
<span class="linenos">3</span><span class="c1">// Pure linear f - b is a real[int]</span>
<span class="linenos">4</span><span class="n">IPOPT</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="cm">/*constraints arguments*/</span><span class="p">,</span><span class="w"> </span><span class="n">Xi</span><span class="p">,</span><span class="w"> </span><span class="cm">/*bound and named parameters*/</span><span class="p">);</span>
<span class="linenos">5</span><span class="c1">// Linear constraints - Ac is a matrix</span>
<span class="linenos">6</span><span class="n">IPOPT</span><span class="p">(</span><span class="cm">/*fitness function arguments*/</span><span class="p">,</span><span class="w"> </span><span class="n">Ac</span><span class="p">,</span><span class="w"> </span><span class="n">Xi</span><span class="p">,</span><span class="w"> </span><span class="cm">/*bound and named parameters*/</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>Returned Value :</strong> The <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">IPOPT</span></code> function returns an error code of type <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span></code>.
A zero value is obtained when the algorithm succeeds and positive values reflect the fact that IPOPT encounters minor troubles.
Negative values reveal more problematic cases.
The associated IPOPT return tags are listed in the table below.
The <a class="reference external" href="https://projects.coin-or.org/Ipopt/browser/stable/3.10/Ipopt/doc/documentation.pdf?format=raw">IPOPT pdf documentation</a> provides a more accurate description of these return statuses:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Success</p></th>
<th class="head"><p>Failures</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 <code class="docutils literal highlight highlight-python"><span></span><span class="n">Solve_Succeeded</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>1 <code class="docutils literal highlight highlight-python"><span></span><span class="n">Solved_To_Acceptable_Level</span></code></p></td>
<td><p>-1 <code class="docutils literal highlight highlight-python"><span></span><span class="n">Maximum_Iterations_Exceeded</span></code></p></td>
</tr>
<tr class="row-even"><td><p>2 <code class="docutils literal highlight highlight-python"><span></span><span class="n">Infeasible_Problem_Detected</span></code></p></td>
<td><p>-2 <code class="docutils literal highlight highlight-python"><span></span><span class="n">Restoration_Failed</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>3 <code class="docutils literal highlight highlight-python"><span></span><span class="n">Search_Direction_Becomes_Too_Small</span></code></p></td>
<td><p>-3 <code class="docutils literal highlight highlight-python"><span></span><span class="n">Error_In_Step_Computation</span></code></p></td>
</tr>
<tr class="row-even"><td><p>4 <code class="docutils literal highlight highlight-python"><span></span><span class="n">Diverging_Iterates</span></code></p></td>
<td><p>-4 <code class="docutils literal highlight highlight-python"><span></span><span class="n">Maximum_CpuTime_Exceeded</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>5 <code class="docutils literal highlight highlight-python"><span></span><span class="n">User_Requested_Stop</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>6 <code class="docutils literal highlight highlight-python"><span></span><span class="n">Feasible_Point_Found</span></code></p></td>
<td></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Problem definition issues</p></th>
<th class="head"><p>Critical errors</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>-10 <code class="docutils literal highlight highlight-python"><span></span><span class="n">Not_Enough_Degrees_Of_Freedom</span></code></p></td>
<td><p>-100 <code class="docutils literal highlight highlight-python"><span></span><span class="n">Unrecoverable_Exception</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>-11 <code class="docutils literal highlight highlight-python"><span></span><span class="n">Invalid_Problem_Definition</span></code></p></td>
<td><p>-101 <code class="docutils literal highlight highlight-python"><span></span><span class="n">NonIpopt_Exception_Thrown</span></code></p></td>
</tr>
<tr class="row-even"><td><p>-12 <code class="docutils literal highlight highlight-python"><span></span><span class="n">Invalid_Option</span></code></p></td>
<td><p>-102 <code class="docutils literal highlight highlight-python"><span></span><span class="n">Insufficient_Memory</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>-13 <code class="docutils literal highlight highlight-python"><span></span><span class="n">Invalid_Number_Detected</span></code></p></td>
<td><p>-199 <code class="docutils literal highlight highlight-python"><span></span><span class="n">Internal_Error</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Named Parameters :</strong> The available named parameters in this interface are those we thought to be the most subject to variations from one optimization to another, plus a few that are interface specific.
Though, as one could see at <a class="reference external" href="https://coin-or.github.io/Ipopt/OPTIONS.html#OPT_MA97_Linear_Solver">IPOPT Linear solver</a>, there are many parameters that can be changed within IPOPT, affecting the algorithm behavior.
These parameters can still be controlled by placing an option file in the execution directory.
Note that <a class="reference external" href="https://projects.coin-or.org/Ipopt/browser/stable/3.10/Ipopt/doc/documentation.pdf?format=raw">IPOPT’s pdf documentation</a> may provides more information than the previously mentioned online version for certain parameters.
The in-script available parameters are:</p>
<ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">lb</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ub</span></code> : <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> for lower and upper simple bounds upon the search variables must be of size <span class="math notranslate nohighlight">\(n\)</span> (search space dimension).
If two components of the same index in these arrays are equal then the corresponding search variable is fixed.
By default IPOPT will remove any fixed variable from the optimization process and always use the fixed value when calling functions.
It can be changed using the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">fixedvar</span></code> parameter.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">clb</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">cub</span></code> : <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> of size <span class="math notranslate nohighlight">\(m\)</span> (number of constraints) for lower and upper constraints bounds.
Equality between two components of the same index <span class="math notranslate nohighlight">\(i\)</span> in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">clb</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">cub</span></code> reflect an equality constraint.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">structjacc</span></code> : To pass the greatest possible structure (indexes of non null coefficients) of the constraint Jacobians under the form <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="n">I</span><span class="p">,</span><span class="n">J</span><span class="p">]</span></code> where <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">I</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">J</span></code> are two integer arrays.
If not defined, the structure of the constraint Jacobians, evaluated in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Xi</span></code>, is used (no issue if the Jacobian is constant or always defined with the same <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">varf</span></code>, hazardous if it is with a triplet array or if a full matrix is involved).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">structhess</span></code> : Same as above but for the Hessian function (unused if <span class="math notranslate nohighlight">\(f\)</span> is P2 or less and constraints are affine).
Here again, keep in mind that it is the Hessian of the Lagrangian function (which is equal to the Hessian of <span class="math notranslate nohighlight">\(f\)</span> only if constraints are affine).
If no structure is given with this parameter, the Lagrangian Hessian is evaluated on the starting point, with <span class="math notranslate nohighlight">\(\sigma=1\)</span> and <span class="math notranslate nohighlight">\(\lambda = (1,1,\dots,1)\)</span> (it is safe if all the constraints and fitness function Hessians are constant or build with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">varf</span></code>, and here again it is less reliable if built with a triplet array or a full matrix).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">checkindex</span></code> : A <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">bool</span></code> that triggers a dichotomic index search when matrices are copied from <strong>FreeFEM</strong> functions to IPOPT arrays.
It is used to avoid wrong index matching when some null coefficients are removed from the matrices by <strong>FreeFEM</strong>.
It will not solve the problems arising when a too small structure has been given at the initialization of the algorithm.
Enabled by default (except in cases where all matrices are obviously constant).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">warmstart</span></code> : If set to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">true</span></code>, the constraints dual variables <span class="math notranslate nohighlight">\(\lambda\)</span>, and simple bound dual variables are initialized with the values of the arrays passed to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">lm</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">lz</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">uz</span></code> named parameters (see below).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">lm</span></code> : <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> of size <span class="math notranslate nohighlight">\(m\)</span>, which is used to get the final values of the constraints dual variables <span class="math notranslate nohighlight">\(\lambda\)</span> and/or initialize them in case of a warm start (the passed array is also updated to the last dual variables values at the end of the algorithm).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">lz</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">uz</span></code> : <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> of size <span class="math notranslate nohighlight">\(n\)</span> to get the final values and/or initialize (in case of a warm start) the dual variables associated to simple bounds.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">tol</span></code> : <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code>, convergence tolerance for the algorithm, the default value is <span class="math notranslate nohighlight">\(10^{-8}\)</span>.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">maxiter</span></code> : <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span></code>, maximum number of iterations with 3000 as default value.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">maxcputime</span></code> : <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code> value, maximum runtime duration. Default is <span class="math notranslate nohighlight">\(10^{6}\)</span> (almost 11 and a halfdays).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">bfgs</span></code> : <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">bool</span></code> enabling or not the (low-storage) BFGS approximation of the Lagrangian Hessian.
It is set to false by default, unless there is no way to compute the Hessian with the functions that have been passed to IPOPT.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">derivativetest</span></code> : Used to perform a comparison of the derivatives given to IPOPT with finite differences computation.
The possible <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">string</span></code> values are : <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="s">&quot;none&quot;</span></code> (default), <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="s">&quot;first-order&quot;</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="s">&quot;second-order&quot;</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="s">&quot;only-second-order&quot;</span></code>.
The associated derivative error tolerance can be changed via the option file.
One should not care about any error given by it before having tried, and failed, to perform a first optimization.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">dth</span></code> : Perturbation parameter for the derivative test computations with finite differences.
Set by default to <span class="math notranslate nohighlight">\(10^{-8}\)</span>.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">dttol</span></code> : Tolerance value for the derivative test error detection (default value unknown yet, maybe <span class="math notranslate nohighlight">\(10^{-5}\)</span>).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">optfile</span></code> : <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">string</span></code> parameter to specify the IPOPT option file name.
IPOPT will look for a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ipopt</span><span class="p">.</span><span class="n">opt</span></code> file by default.
Options set in the file will overwrite those defined in the <strong>FreeFEM</strong> script.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">printlevel</span></code> : An <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span></code> to control IPOPT output print level, set to 5 by default, the possible values are from 0 to 12.
A description of the output information is available in the <a class="reference external" href="https://projects.coin-or.org/Ipopt/browser/stable/3.10/Ipopt/doc/documentation.pdf?format=raw">PDF documentation</a> of IPOPT.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">fixedvar</span></code> : <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">string</span></code> for the definition of simple bound equality constraints treatment : use <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="s">&quot;make_parameter&quot;</span></code> (default value) to simply remove them from the optimization process (the functions will always be evaluated with the fixed value for those variables), <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="s">&quot;make_constraint&quot;</span></code> to treat them as any other constraint or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="s">&quot;relax_bounds&quot;</span></code> to relax fixing bound constraints.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">mustrategy</span></code> : a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">string</span></code> to choose the update strategy for the barrier parameter <span class="math notranslate nohighlight">\(\mu\)</span>.
The two possible tags are <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="s">&quot;monotone&quot;</span></code>, to use the monotone (Fiacco-McCormick) strategy, or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="s">&quot;adaptive&quot;</span></code> (default setting).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">muinit</span></code> : <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code> positive value for the barrier parameter initialization.
It is only relevant when <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">mustrategy</span></code> has been set to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">monotone</span></code>.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">pivtol</span></code> : <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code> value to set the pivot tolerance for the linear solver. A smaller number pivots for sparsity, a larger number pivots for stability.
The value has to be in the <span class="math notranslate nohighlight">\([0,1]\)</span> interval and is set to <span class="math notranslate nohighlight">\(10^{-6}\)</span> by default.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">brf</span></code> : Bound relax factor: before starting the optimization, the bounds given by the user are relaxed.
This option sets the factor for this relaxation.
If it is set to zero, then the bound relaxation is disabled.
This <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code> has to be positive and its default value is <span class="math notranslate nohighlight">\(10^{-8}\)</span>.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">objvalue</span></code> : An identifier to a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code> type variable to get the last value of the objective function (best value in case of success).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">mumin</span></code> : minimum value for the barrier parameter <span class="math notranslate nohighlight">\(\mu\)</span>, a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code> with <span class="math notranslate nohighlight">\(10^{-11}\)</span> as default value.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">linesearch</span></code> : A boolean which disables the line search when set to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">false</span></code>.
The line search is activated by default.
When disabled, the method becomes a standard Newton algorithm instead of a primal-dual system.
The global convergence is then no longer assured, meaning that many initializers could lead to diverging iterates.
But on the other hand, it can be useful when trying to catch a precise local minimum without having some out of control process making the iterate caught by some other near optimum.</p></li>
</ul>
</section>
</section>
<section id="some-short-examples-using-ipopt">
<h2>Some short examples using IPOPT<a class="headerlink" href="#some-short-examples-using-ipopt" title="Link to this heading"></a></h2>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Ipopt variational inequality
A very simple example consisting of, given two functions <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span> (defined on <span class="math notranslate nohighlight">\(\Omega\subset\mathbb{R}^{2}\)</span>), minimizing <span class="math notranslate nohighlight">\(J(u) = \displaystyle{\frac{1}{2}\int_{\Omega} \vert\nabla u\vert^{2} - \int_{\Omega}fu}\ \)</span>, with <span class="math notranslate nohighlight">\(u\leq g\)</span> almost everywhere:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Solve</span>
<span class="linenos"> 2</span><span class="c1">//- Delta u = f</span>
<span class="linenos"> 3</span><span class="c1">//u &lt; g</span>
<span class="linenos"> 4</span><span class="c1">//u = 0 on Gamma</span>
<span class="linenos"> 5</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;ff-Ipopt&quot;</span><span class="p">;</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1">// Parameters</span>
<span class="linenos"> 8</span><span class="kt">int</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
<span class="linenos"> 9</span><span class="kt">func</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="c1">//rhs function</span>
<span class="linenos">10</span><span class="kt">real</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.03</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span>
<span class="linenos">11</span><span class="kt">func</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">r</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="nf">exp</span><span class="p">(</span><span class="mf">-0.5</span><span class="o">*</span><span class="p">(</span><span class="nf">square</span><span class="p">(</span><span class="kr">x</span><span class="mf">-0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="kr">y</span><span class="mf">-0.5</span><span class="p">))</span><span class="o">/</span><span class="nf">square</span><span class="p">(</span><span class="n">s</span><span class="p">));</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="c1">// Mesh</span>
<span class="linenos">14</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="n">nn</span><span class="p">);</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="c1">// Fespace</span>
<span class="linenos">17</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P2</span><span class="p">);</span>
<span class="linenos">18</span><span class="n">Vh</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">19</span><span class="n">Vh</span><span class="w"> </span><span class="n">lb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.</span><span class="n">e19</span><span class="p">;</span>
<span class="linenos">20</span><span class="n">Vh</span><span class="w"> </span><span class="n">ub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g</span><span class="p">;</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="c1">// Macro</span>
<span class="linenos">23</span><span class="kt">macro</span><span class="w"> </span><span class="n">Grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">),</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span><span class="w"> </span><span class="c1">//</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="c1">// Problem</span>
<span class="linenos">26</span><span class="kt">varf</span><span class="w"> </span><span class="n">vP</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="linenos">27</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos">28</span><span class="w">        </span><span class="n">Grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">&#39;*</span><span class="n">Grad</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos">29</span><span class="w">   </span><span class="p">)</span>
<span class="linenos">30</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos">31</span><span class="w">        </span><span class="n">f</span><span class="o">*</span><span class="n">v</span>
<span class="linenos">32</span><span class="w">   </span><span class="p">)</span>
<span class="linenos">33</span><span class="w">   </span><span class="p">;</span>
</pre></div>
</div>
<p>Here we build the matrix and second member associated to the function to fully and finally minimize it.
The <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="kp">A</span><span class="p">,</span><span class="n">b</span><span class="p">]</span></code> syntax for the fitness function is then used to pass it to IPOPT.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">matrix</span><span class="w"> </span><span class="kp">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vP</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">);</span>
<span class="linenos">2</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vP</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span>
</pre></div>
</div>
<p>We use simple bounds to impose the boundary condition <span class="math notranslate nohighlight">\(u=0\)</span> on <span class="math notranslate nohighlight">\(\partial\Omega\)</span>, as well as the <span class="math notranslate nohighlight">\(u\leq g\)</span> condition.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">varf</span><span class="w"> </span><span class="nf">vGamma</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos"> 2</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">onGamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vGamma</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1">//warning: the boundary conditions are given with lb and ub on border</span>
<span class="linenos"> 5</span><span class="n">ub</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onGamma</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">ub</span><span class="p">[];</span>
<span class="linenos"> 6</span><span class="n">lb</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onGamma</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">lb</span><span class="p">[];</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="c1">// Solve</span>
<span class="linenos"> 9</span><span class="n">IPOPT</span><span class="p">([</span><span class="kp">A</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">],</span><span class="w"> </span><span class="n">u</span><span class="p">[],</span><span class="w"> </span><span class="n">lb</span><span class="o">=</span><span class="n">lb</span><span class="p">[],</span><span class="w"> </span><span class="n">ub</span><span class="o">=</span><span class="n">ub</span><span class="p">[]);</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="c1">// Plot</span>
<span class="linenos">12</span><span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Ipopt variational inequality 2</p>
<p>Let <span class="math notranslate nohighlight">\(\Omega\)</span> be a domain of <span class="math notranslate nohighlight">\(\mathbb{R}^{2}\)</span>.
<span class="math notranslate nohighlight">\(f_{1}, f_{2}\in L^{2}(\Omega)\)</span> and <span class="math notranslate nohighlight">\(g_{1}, g_{2} \in L^{2}(\partial\Omega)\)</span> four given functions with <span class="math notranslate nohighlight">\(g_{1}\leq g_{2}\)</span> almost everywhere.
We define the space:</p>
<div class="math notranslate nohighlight">
\[V = \left\lbrace (v_{1},v_{2})\in H^{1}(\Omega)^{2} ; v_{1}\vert_{\partial\Omega}=g_{1}, v_{2}\vert_{\partial\Omega}=g_{2}, v_{1}\leq v_{2}\ \mathrm{a.e.}\ \right\rbrace\]</div>
<p>as well as the function <span class="math notranslate nohighlight">\(J:H^{1}(\Omega)^{2}\longrightarrow \mathbb{R}\)</span>:</p>
<div class="math notranslate nohighlight">
\[J(v_{1},v_{2}) = \displaystyle{\frac{1}{2}\int_{\Omega}\vert\nabla v_{1}\vert^{2} - \int_{\Omega} f_{1}v_{1} + \frac{1}{2}\int_{\Omega}\vert\nabla v_{2}\vert^{2} - \int_{\Omega} f_{2}v_{2}}\]</div>
<p>The problem entails finding (numerically) two functions <span class="math notranslate nohighlight">\((u_{1},u_{2}) = \underset{(v_{1},v_{2})\in V}{\operatorname{argmin}} J(v_{1},v_{2})\)</span>.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;ff-Ipopt&quot;</span><span class="p">;</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="c1">// Parameters</span>
<span class="linenos"> 4</span><span class="kt">int</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="kt">func</span><span class="w"> </span><span class="n">f1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="c1">//right hand side</span>
<span class="linenos"> 6</span><span class="kt">func</span><span class="w"> </span><span class="n">f2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-15</span><span class="p">;</span>
<span class="linenos"> 7</span><span class="kt">func</span><span class="w"> </span><span class="n">g1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.1</span><span class="p">;</span><span class="c1">//Boundary condition functions</span>
<span class="linenos"> 8</span><span class="kt">func</span><span class="w"> </span><span class="n">g2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1">// Mesh</span>
<span class="linenos">11</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="n">nn</span><span class="p">);</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="c1">// Fespace</span>
<span class="linenos">14</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nc">P1</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">]);</span>
<span class="linenos">15</span><span class="n">Vh</span><span class="w"> </span><span class="p">[</span><span class="n">uz</span><span class="p">,</span><span class="w"> </span><span class="n">uz2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="linenos">16</span><span class="n">Vh</span><span class="w"> </span><span class="p">[</span><span class="n">lz</span><span class="p">,</span><span class="w"> </span><span class="n">lz2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="linenos">17</span><span class="n">Vh</span><span class="w"> </span><span class="p">[</span><span class="n">u1</span><span class="p">,</span><span class="w"> </span><span class="n">u2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span><span class="w"> </span><span class="c1">//starting point</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Wh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nc">P1</span><span class="p">]);</span>
<span class="linenos">20</span><span class="n">Wh</span><span class="w"> </span><span class="n">lm</span><span class="o">=</span><span class="mf">1.</span><span class="p">;</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="c1">// Macro</span>
<span class="linenos">23</span><span class="kt">macro</span><span class="w"> </span><span class="n">Grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">),</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span><span class="w"> </span><span class="c1">//</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="c1">// Loop</span>
<span class="linenos">26</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">27</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">++</span><span class="n">iter</span><span class="p">){</span>
<span class="linenos">28</span><span class="w">   </span><span class="c1">// Problem</span>
<span class="linenos">29</span><span class="w">   </span><span class="kt">varf</span><span class="w"> </span><span class="n">vP</span><span class="w"> </span><span class="p">([</span><span class="n">u1</span><span class="p">,</span><span class="w"> </span><span class="n">u2</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">v1</span><span class="p">,</span><span class="w"> </span><span class="n">v2</span><span class="p">])</span>
<span class="linenos">30</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos">31</span><span class="w">           </span><span class="n">Grad</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span><span class="o">&#39;*</span><span class="n">Grad</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
<span class="linenos">32</span><span class="w">         </span><span class="o">+</span><span class="w"> </span><span class="n">Grad</span><span class="p">(</span><span class="n">u2</span><span class="p">)</span><span class="o">&#39;*</span><span class="n">Grad</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
<span class="linenos">33</span><span class="w">      </span><span class="p">)</span>
<span class="linenos">34</span><span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos">35</span><span class="w">           </span><span class="n">f1</span><span class="o">*</span><span class="n">v1</span>
<span class="linenos">36</span><span class="w">         </span><span class="o">+</span><span class="w"> </span><span class="n">f2</span><span class="o">*</span><span class="n">v2</span>
<span class="linenos">37</span><span class="w">      </span><span class="p">)</span>
<span class="linenos">38</span><span class="w">      </span><span class="p">;</span>
<span class="linenos">39</span>
<span class="linenos">40</span><span class="w">   </span><span class="kt">matrix</span><span class="w"> </span><span class="kp">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vP</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span><span class="w"> </span><span class="c1">//fitness function matrix</span>
<span class="linenos">41</span><span class="w">   </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vP</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span><span class="w"> </span><span class="c1">//and linear form</span>
<span class="linenos">42</span>
<span class="linenos">43</span><span class="w">   </span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">II1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">II2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="c1">//Constraints matrix</span>
<span class="linenos">44</span><span class="w">   </span><span class="kt">matrix</span><span class="w"> </span><span class="n">C1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">interpolate</span><span class="w"> </span><span class="p">(</span><span class="n">Wh</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="kp">U2Vc</span><span class="o">=</span><span class="n">II1</span><span class="p">);</span>
<span class="linenos">45</span><span class="w">   </span><span class="kt">matrix</span><span class="w"> </span><span class="n">C2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">interpolate</span><span class="w"> </span><span class="p">(</span><span class="n">Wh</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="kp">U2Vc</span><span class="o">=</span><span class="n">II2</span><span class="p">);</span>
<span class="linenos">46</span><span class="w">   </span><span class="kt">matrix</span><span class="w"> </span><span class="n">CC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="o">*</span><span class="n">C1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C2</span><span class="p">;</span><span class="w"> </span><span class="c1">// u2 - u1 &gt; 0</span>
<span class="linenos">47</span><span class="w">   </span><span class="n">Wh</span><span class="w"> </span><span class="n">cl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">//constraints lower bounds (no upper bounds)</span>
<span class="linenos">48</span>
<span class="linenos">49</span><span class="w">   </span><span class="c1">//Boundary conditions</span>
<span class="linenos">50</span><span class="w">   </span><span class="kt">varf</span><span class="w"> </span><span class="nf">vGamma</span><span class="w"> </span><span class="p">([</span><span class="n">u1</span><span class="p">,</span><span class="w"> </span><span class="n">u2</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">v1</span><span class="p">,</span><span class="w"> </span><span class="n">v2</span><span class="p">])</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">u1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">u2</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">51</span><span class="w">   </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">onGamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vGamma</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span>
<span class="linenos">52</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="p">[</span><span class="n">ub1</span><span class="p">,</span><span class="w"> </span><span class="n">ub2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">g1</span><span class="p">,</span><span class="w"> </span><span class="n">g2</span><span class="p">];</span>
<span class="linenos">53</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="p">[</span><span class="n">lb1</span><span class="p">,</span><span class="w"> </span><span class="n">lb2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">g1</span><span class="p">,</span><span class="w"> </span><span class="n">g2</span><span class="p">];</span>
<span class="linenos">54</span><span class="w">   </span><span class="n">ub1</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onGamma</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">ub1</span><span class="p">[]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1e19</span><span class="p">;</span><span class="w"> </span><span class="c1">//Unbounded in interior</span>
<span class="linenos">55</span><span class="w">   </span><span class="n">lb1</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onGamma</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">lb1</span><span class="p">[]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">-1e19</span><span class="p">;</span>
<span class="linenos">56</span>
<span class="linenos">57</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="p">[</span><span class="n">uzi</span><span class="p">,</span><span class="w"> </span><span class="n">uzi2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">uz</span><span class="p">,</span><span class="w"> </span><span class="n">uz2</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">lzi</span><span class="p">,</span><span class="w"> </span><span class="n">lzi2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">lz</span><span class="p">,</span><span class="w"> </span><span class="n">lz2</span><span class="p">];</span>
<span class="linenos">58</span><span class="w">   </span><span class="n">Wh</span><span class="w"> </span><span class="n">lmi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm</span><span class="p">;</span>
<span class="linenos">59</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="p">[</span><span class="n">ui1</span><span class="p">,</span><span class="w"> </span><span class="n">ui2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">u1</span><span class="p">,</span><span class="w"> </span><span class="n">u2</span><span class="p">];</span>
<span class="linenos">60</span>
<span class="linenos">61</span><span class="w">   </span><span class="c1">// Solve</span>
<span class="linenos">62</span><span class="w">   </span><span class="n">IPOPT</span><span class="p">([</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="kp">A</span><span class="p">],</span><span class="w"> </span><span class="n">CC</span><span class="p">,</span><span class="w"> </span><span class="n">ui1</span><span class="p">[],</span><span class="w"> </span><span class="n">lb</span><span class="o">=</span><span class="n">lb1</span><span class="p">[],</span><span class="w"> </span><span class="n">clb</span><span class="o">=</span><span class="n">cl</span><span class="p">[],</span><span class="w"> </span><span class="n">ub</span><span class="o">=</span><span class="n">ub1</span><span class="p">[],</span><span class="w"> </span><span class="n">warmstart</span><span class="o">=</span><span class="n">iter</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">uz</span><span class="o">=</span><span class="n">uzi</span><span class="p">[],</span><span class="w"> </span><span class="n">lz</span><span class="o">=</span><span class="n">lzi</span><span class="p">[],</span><span class="w"> </span><span class="n">lm</span><span class="o">=</span><span class="n">lmi</span><span class="p">[]);</span>
<span class="linenos">63</span>
<span class="linenos">64</span><span class="w">   </span><span class="c1">// Plot</span>
<span class="linenos">65</span><span class="w">   </span><span class="nf">plot</span><span class="p">(</span><span class="n">ui1</span><span class="p">,</span><span class="w"> </span><span class="n">ui2</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="kp">nbiso</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="kp">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">);</span>
<span class="linenos">66</span>
<span class="linenos">67</span><span class="w">   </span><span class="k">if</span><span class="p">(</span><span class="n">iter</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="linenos">68</span>
<span class="linenos">69</span><span class="w">   </span><span class="c1">// Mesh adpatation</span>
<span class="linenos">70</span><span class="w">   </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">ui1</span><span class="p">,</span><span class="w"> </span><span class="n">ui2</span><span class="p">],</span><span class="w"> </span><span class="kp">err</span><span class="o">=</span><span class="mf">0.004</span><span class="p">,</span><span class="w"> </span><span class="kp">nbvx</span><span class="o">=</span><span class="mi">100000</span><span class="p">);</span>
<span class="linenos">71</span><span class="w">   </span><span class="p">[</span><span class="n">uz</span><span class="p">,</span><span class="w"> </span><span class="n">uz2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">uzi</span><span class="p">,</span><span class="w"> </span><span class="n">uzi2</span><span class="p">];</span>
<span class="linenos">72</span><span class="w">   </span><span class="p">[</span><span class="n">lz</span><span class="p">,</span><span class="w"> </span><span class="n">lz2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">lzi</span><span class="p">,</span><span class="w"> </span><span class="n">lzi2</span><span class="p">];</span>
<span class="linenos">73</span><span class="w">   </span><span class="p">[</span><span class="n">u1</span><span class="p">,</span><span class="w"> </span><span class="n">u2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">ui1</span><span class="p">,</span><span class="w"> </span><span class="n">ui2</span><span class="p">];</span>
<span class="linenos">74</span><span class="w">   </span><span class="n">lm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lmi</span><span class="p">;</span>
<span class="linenos">75</span><span class="p">}</span>
</pre></div>
</div>
<div class="figure compound align-center" id="VariationalInequality">
<figure class="align-default" id="id10">
<span id="figalgovarineqfill"></span><a class="reference internal image-reference" href="../_images/VarIneqFill.jpg"><img alt="VarIneqFill" src="../_images/VarIneqFill.jpg" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 121 </span><span class="caption-text">Numerical Approximation of the Variational Inequality</span><a class="headerlink" href="#id10" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id11">
<span id="figalgovarineqiso"></span><a class="reference internal image-reference" href="../_images/VarIneqIso.jpg"><img alt="../_images/VarIneqIso.jpg" src="../_images/VarIneqIso.jpg" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 122 </span><span class="caption-text">Numerical Approximation of the Variational Inequality</span><a class="headerlink" href="#id11" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><span class="caption-text">Variational inequality</span></p>
</div></div>
</section>
<section id="d-constrained-minimum-surface-with-ipopt">
<span id="VariationalInequality"></span><h2>3D constrained minimum surface with IPOPT<a class="headerlink" href="#d-constrained-minimum-surface-with-ipopt" title="Link to this heading"></a></h2>
<section id="area-and-volume-expressions">
<h3>Area and volume expressions<a class="headerlink" href="#area-and-volume-expressions" title="Link to this heading"></a></h3>
<p>This example is aimed at numerically solving some constrained minimum surface problems with the IPOPT algorithm.
We restrain to <span class="math notranslate nohighlight">\(C^{k}\)</span> (<span class="math notranslate nohighlight">\(k\geq 1\)</span>), closed, spherically parametrizable surfaces, i.e. surfaces <span class="math notranslate nohighlight">\(S\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\exists \rho \in C^{k}([0,2\pi ]\times[0,\pi] ) \vert
S = \left\lbrace
X = \left(
\begin{array} {c}
 \rho(\theta,\phi) \\
 0 \\
 0
\end{array}
\right)
, (\theta,\phi) \in [0,2\pi ]\times[0,\pi]
 \right\rbrace\end{split}\]</div>
<p>Where the components are expressed in the spherical coordinate system.
Let’s call <span class="math notranslate nohighlight">\(\Omega\)</span> the <span class="math notranslate nohighlight">\([0,2\pi ]\times[0,\pi]\)</span> angular parameters set.
In order to exclude self crossing and opened shapes, the following assumptions upon <span class="math notranslate nohighlight">\(\rho\)</span> are made:</p>
<div class="math notranslate nohighlight">
\[\rho \geq 0\ \ \mathrm{and}\ \ \forall \phi, \rho(0,\phi) = \rho(2\pi,\phi)\]</div>
<p>For a given function <span class="math notranslate nohighlight">\(\rho\)</span> the first fundamental form (the metric) of the defined surface has the following matrix representation:</p>
<div class="math notranslate nohighlight" id="equation-msfff">
<span class="eqno">(30)<a class="headerlink" href="#equation-msfff" title="Link to this equation"></a></span>\[\begin{split}G =
\left(
\begin{array}{c c}
    \rho^{2}\sin^{2}(\phi) + (\partial_{\theta}\rho)^{2} &amp;\partial_{\theta}\rho\partial_{\phi}\rho \\
    \partial_{\theta}\rho\partial_{\phi}\rho &amp; \rho^{2} + (\partial_{\phi}\rho)^{2} \\
\end{array}
\right)\end{split}\]</div>
<p>This metric is used to express the area of the surface.
Let <span class="math notranslate nohighlight">\(g=\det(G)\)</span>, then we have:</p>
<div class="math notranslate nohighlight" id="equation-msarea">
<span class="eqno">(31)<a class="headerlink" href="#equation-msarea" title="Link to this equation"></a></span>\[\begin{split}\begin{array}{ll}
    \mathcal{A}(\rho) &amp;= \int{\Omega}{\left\| \partial_{\theta} X \wedge \partial_{\phi} X \right\|} =\int{\Omega}{\sqrt{g}}\\
        &amp;=\int{\Omega}{\sqrt{ \rho^{2}(\partial_{\theta}\rho)^{2} + \rho^{4}\sin^{2}(\phi) + \rho^{2}(\partial_{\phi}\rho)^{2}\sin^{2}(\phi)}d\theta d\phi}
\end{array}\end{split}\]</div>
<p>The volume of the space enclosed within the shape is easier to express:</p>
<div class="math notranslate nohighlight" id="equation-msvolume">
<span class="eqno">(32)<a class="headerlink" href="#equation-msvolume" title="Link to this equation"></a></span>\[\mathcal{V}(\rho)
= \int{\Omega}{\int_{0}^{\rho(\theta,\phi)} r^{2}\sin(\phi) dr d\theta d\phi}
= \frac{1}{3}\int{\Omega}{\rho^{3} \sin(\phi) d\theta d\phi}\]</div>
</section>
<section id="derivatives">
<h3>Derivatives<a class="headerlink" href="#derivatives" title="Link to this heading"></a></h3>
<p>In order to use a Newton based interior point optimization algorithm, one must be able to evaluate the derivatives of <span class="math notranslate nohighlight">\(\mathcal{A}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{V}\)</span> with respect to <span class="math notranslate nohighlight">\(rho\)</span>.
Concerning the area, we have the following result:</p>
<div class="math notranslate nohighlight">
\[\forall v\in C^{1}(\Omega) \ , \ \langle d\mathcal{A}(\rho),v\rangle
= \int{\Omega}{\frac{1}{2} \frac{ d\bar{g}(\rho)(v)}{\sqrt{g}}d\theta d\phi }\]</div>
<p>Where <span class="math notranslate nohighlight">\(\bar{g}\)</span> is the application mapping the <span class="math notranslate nohighlight">\((\theta,\phi) \mapsto g(\theta,\phi)\)</span> scalar field to <span class="math notranslate nohighlight">\(\rho\)</span>.
This leads to the following expression, easy to transpose in a freefem script using:</p>
<div class="math notranslate nohighlight" id="equation-msdarea">
<span class="eqno">(33)<a class="headerlink" href="#equation-msdarea" title="Link to this equation"></a></span>\[\begin{split}\begin{array}{r c l}
    \forall v\in C^{1}(\Omega)&amp; &amp;\\
    \langle d\mathcal{A}(\rho),v\rangle &amp;=&amp; \int{\Omega}{ \left(2\rho^{3}\sin^{2}(\phi) + \rho(\partial_{\theta}\rho)^{2} + \rho(\partial_{\phi}\rho)^{2}\sin^{2}(\phi) \right) v} \\
    &amp; &amp; +\int{\Omega}{\ \rho^{2}\partial_{\theta}\rho\partial_{\theta} v\ + \ \rho^{2}\partial_{\phi}\rho\sin^{2}(\phi)\partial_{\phi} v }
\end{array}\end{split}\]</div>
<p>With a similar approach, one can derive an expression for second order derivatives.
However, comporting no specific difficulties, the detailed calculus are tedious, the result is that these derivatives can be written using a <span class="math notranslate nohighlight">\(3\times 3\)</span> matrix <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> whose coefficients are expressed in term of <span class="math notranslate nohighlight">\(\rho\)</span> and its derivatives with respect to <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span>, such that:</p>
<div class="math notranslate nohighlight" id="equation-msd2area">
<span class="eqno">(34)<a class="headerlink" href="#equation-msd2area" title="Link to this equation"></a></span>\[\begin{split}\forall (w,v)\in C^{1}(\Omega)\ ,\ d^{2}\mathcal{A}(\rho)(w,v) = \int{\Omega}
{
   \left(\begin{array}{c c c} w &amp; \partial_{\theta} w &amp; \partial_{\phi} w \end{array}\right)
   \mathbf{B}
} \left( \begin{array}{c} v \\ \partial_{\theta} v \\ \partial_{\phi} v \end{array} \right) d\theta d\phi\end{split}\]</div>
<p>Deriving the volume function derivatives is again an easier task.
We immediately get the following expressions:</p>
<div class="math notranslate nohighlight" id="equation-msdvolume">
<span class="eqno">(35)<a class="headerlink" href="#equation-msdvolume" title="Link to this equation"></a></span>\[\begin{split}\begin{array}{r c l}
   \forall v\ ,\ \langle d\mathcal{V}(\rho),v\rangle &amp; = &amp; \int{\Omega}{\rho^{2}\sin(\phi)v\ d\theta d\phi} \\
   \forall w,v\ , d^{2}\mathcal{V}(\rho)(w,v) &amp; = &amp; \int{\Omega}{2\rho\sin(\phi)wv\ d\theta d\phi}
\end{array}\end{split}\]</div>
</section>
<section id="the-problem-and-its-script">
<h3>The problem and its script<a class="headerlink" href="#the-problem-and-its-script" title="Link to this heading"></a></h3>
<p>The whole code is available in <a class="reference internal" href="../examples/algorithms-and-optimizations.html#exampleipoptminimalsurfacevolume"><span class="std std-ref">IPOPT minimal surface &amp; volume example</span></a>.
We propose to solve the following problem:</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Given a positive function <span class="math notranslate nohighlight">\(\rho_{\mathrm{object}}\)</span> piecewise continuous, and a scalar <span class="math notranslate nohighlight">\(\mathcal{V}_{\mathrm{max}} &gt; \mathcal{V}(\rho_{\mathrm{object}})\)</span>, find <span class="math notranslate nohighlight">\(\rho_{0}\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[\rho_{0} = \underset{\rho\in C^{1}(\Omega)}{\operatorname{argmin}}\ \mathcal{A}(\rho)\ ,\ \mathrm{s.t.}\ \rho_{0}\geq\rho_{\mathrm{object}} \ \mathrm{and\ } \mathcal{V}(\rho_{0})\leq \mathcal{V}_{\mathrm{max}}\]</div>
<p>If <span class="math notranslate nohighlight">\(\rho_{\mathrm{object}}\)</span> is the spherical parametrization of the surface of a 3-dimensional object (domain) <span class="math notranslate nohighlight">\(\mathcal{O}\)</span>, it can be interpreted as finding the surface with minimum area enclosing the object with a given maximum volume. If <span class="math notranslate nohighlight">\(\mathcal{V}_{\mathrm{max}}\)</span> is close to <span class="math notranslate nohighlight">\(\mathcal{V}(\rho_{\mathrm{object}})\)</span>, so should be <span class="math notranslate nohighlight">\(\rho_{0}\)</span> and <span class="math notranslate nohighlight">\(\rho_{\mathrm{object}}\)</span>. With higher values of <span class="math notranslate nohighlight">\(\mathcal{V}_{\mathrm{max}}\)</span>, <span class="math notranslate nohighlight">\(\rho\)</span> should be closer to the unconstrained minimum surface surrounding <span class="math notranslate nohighlight">\(\mathcal{O}\)</span> which is obtained as soon as <span class="math notranslate nohighlight">\(\mathcal{V}_{\mathrm{max}} \geq \frac{4}{3}\pi \|\rho_{\mathrm{object}}\|_{\infty}^{3}\)</span> (sufficient but not necessary).</p>
<p>It also could be interesting to solve the same problem with the constraint <span class="math notranslate nohighlight">\(\mathcal{V}(\rho_{0})\geq \mathcal{V}_{\mathrm{min}}\)</span> which leads to a sphere when <span class="math notranslate nohighlight">\(\mathcal{V}_{\mathrm{min}} \geq \frac{1}{6}\pi \mathrm{diam}(\mathcal{O})^{3}\)</span> and moves toward the solution of the unconstrained problem as <span class="math notranslate nohighlight">\(\mathcal{V}_{\mathrm{min}}\)</span> decreases.</p>
<p>We start by meshing the domain <span class="math notranslate nohighlight">\([0,2\pi]\times\ [0,\pi]\)</span>, then a periodic P1 finite elements space is defined.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span><span class="p">;</span>
<span class="linenos"> 2</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span><span class="p">;</span>
<span class="linenos"> 3</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;ff-Ipopt&quot;</span><span class="p">;</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="c1">// Parameters</span>
<span class="linenos"> 6</span><span class="kt">int</span><span class="w"> </span><span class="n">nadapt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="linenos"> 7</span><span class="kt">real</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.9</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="kt">int</span><span class="w"> </span><span class="n">np</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span>
<span class="linenos"> 9</span><span class="kt">real</span><span class="w"> </span><span class="n">regtest</span><span class="p">;</span>
<span class="linenos">10</span><span class="kt">int</span><span class="w"> </span><span class="n">shapeswitch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos">11</span><span class="kt">real</span><span class="w"> </span><span class="kp">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">/</span><span class="mf">40.</span><span class="p">;</span>
<span class="linenos">12</span><span class="kt">real</span><span class="w"> </span><span class="n">treshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span>
<span class="linenos">13</span><span class="kt">real</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span>
<span class="linenos">14</span><span class="kt">real</span><span class="w"> </span><span class="n">r0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25</span><span class="p">;</span>
<span class="linenos">15</span><span class="kt">real</span><span class="w"> </span><span class="n">rr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">-</span><span class="n">r0</span><span class="p">;</span>
<span class="linenos">16</span><span class="kt">real</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="n">e</span><span class="p">);</span>
<span class="linenos">17</span><span class="kt">real</span><span class="w"> </span><span class="n">RR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">rr</span><span class="o">*</span><span class="n">rr</span><span class="p">);</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="c1">// Mesh</span>
<span class="linenos">20</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="p">,</span><span class="w"> </span><span class="n">np</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="kr">pi</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="c1">// Fespace</span>
<span class="linenos">23</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">,</span><span class="w"> </span><span class="kp">periodic</span><span class="o">=</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="p">]]);</span>
<span class="linenos">24</span><span class="c1">//Initial shape definition</span>
<span class="linenos">25</span><span class="c1">//outside of the mesh adaptation loop to initialize with the previous optimial shape found on further iterations</span>
<span class="linenos">26</span><span class="n">Vh</span><span class="w"> </span><span class="n">startshape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
</pre></div>
</div>
<p>We create some finite element functions whose underlying arrays will be used to store the values of dual variables associated to all the constraints in order to reinitialize the algorithm with it in the case where we use mesh adaptation. Doing so, the algorithm will almost restart at the accuracy level it reached before mesh adaptation, thus saving many iterations.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">Vh</span><span class="w"> </span><span class="n">uz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="p">,</span><span class="w"> </span><span class="n">lz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span>
<span class="linenos">2</span><span class="n">rreal</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">lm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</pre></div>
</div>
<p>Then, follows the mesh adaptation loop, and a rendering function, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Plot3D</span></code>, using 3D mesh to display the shape it is passed with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">medit</span></code> (the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">movemesh23</span></code> procedure often crashes when called with ragged shapes).</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">kkk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">kkk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nadapt</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">kkk</span><span class="p">){</span>
<span class="linenos"> 2</span><span class="w">   </span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 3</span><span class="w">   </span><span class="kt">func</span><span class="w"> </span><span class="n">sin2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">));</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="w">   </span><span class="c1">// A function which transform Th in 3d mesh (r=rho)</span>
<span class="linenos"> 6</span><span class="w">   </span><span class="c1">//a point (theta,phi) of Th becomes ( r(theta,phi)*cos(theta)*sin(phi) , r(theta,phi)*sin(theta)*sin(phi) , r(theta,phi)*cos(phi) )</span>
<span class="linenos"> 7</span><span class="w">   </span><span class="c1">//then displays the resulting mesh with medit</span>
<span class="linenos"> 8</span><span class="w">   </span><span class="kt">func</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Plot3D</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="kp">cmm</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">ffplot</span><span class="p">){</span>
<span class="linenos"> 9</span><span class="w">      </span><span class="n">Vh</span><span class="w"> </span><span class="n">rhoo</span><span class="p">;</span>
<span class="linenos">10</span><span class="w">      </span><span class="n">rhoo</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rho</span><span class="p">;</span>
<span class="linenos">11</span><span class="w">      </span><span class="c1">//mesh sTh = square(np, np/2, [2*pi*x, pi*y]);</span>
<span class="linenos">12</span><span class="w">      </span><span class="c1">//fespace sVh(sTh, P1);</span>
<span class="linenos">13</span><span class="w">      </span><span class="c1">//Vh rhoplot = rhoo;</span>
<span class="linenos">14</span><span class="w">      </span><span class="k">try</span><span class="p">{</span>
<span class="linenos">15</span><span class="w">         </span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Sphere</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">rhoo</span><span class="p">(</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">),</span><span class="w"> </span><span class="n">rhoo</span><span class="p">(</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">),</span><span class="w"> </span><span class="n">rhoo</span><span class="p">(</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">)]);</span>
<span class="linenos">16</span><span class="w">         </span><span class="k">if</span><span class="p">(</span><span class="n">ffplot</span><span class="p">)</span>
<span class="linenos">17</span><span class="w">            </span><span class="nf">plot</span><span class="p">(</span><span class="n">Sphere</span><span class="p">);</span>
<span class="linenos">18</span><span class="w">         </span><span class="k">else</span>
<span class="linenos">19</span><span class="w">            </span><span class="nf">medit</span><span class="p">(</span><span class="kp">cmm</span><span class="p">,</span><span class="w"> </span><span class="n">Sphere</span><span class="p">);</span>
<span class="linenos">20</span><span class="w">      </span><span class="p">}</span>
<span class="linenos">21</span><span class="w">      </span><span class="k">catch</span><span class="p">(...){</span>
<span class="linenos">22</span><span class="w">         </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;PLOT ERROR&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">23</span><span class="w">      </span><span class="p">}</span>
<span class="linenos">24</span><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos">25</span><span class="w">   </span><span class="p">}</span>
<span class="linenos">26</span><span class="p">}</span>
</pre></div>
</div>
<p>Here are the functions related to the area computation and its shape derivative, according to equations <a class="reference internal" href="#equation-msarea">(31)</a> and <a class="reference internal" href="#equation-msdarea">(33)</a>:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Surface computation</span>
<span class="linenos"> 2</span><span class="c1">//Maybe is it possible to use movemesh23 to have the surface function less complicated</span>
<span class="linenos"> 3</span><span class="c1">//However, it would not simplify the gradient and the hessian</span>
<span class="linenos"> 4</span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">Area</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">){</span>
<span class="linenos"> 5</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="n">rho</span><span class="p">;</span>
<span class="linenos"> 6</span><span class="w">   </span><span class="n">rho</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span><span class="p">;</span>
<span class="linenos"> 7</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="n">rho2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">rho</span><span class="p">);</span>
<span class="linenos"> 8</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="n">rho4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">rho2</span><span class="p">);</span>
<span class="linenos"> 9</span><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">rho4</span><span class="o">*</span><span class="n">sin2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rho2</span><span class="o">*</span><span class="nf">square</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">rho</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rho2</span><span class="o">*</span><span class="n">sin2</span><span class="o">*</span><span class="nf">square</span><span class="p">(</span><span class="nf">dy</span><span class="p">(</span><span class="n">rho</span><span class="p">))));</span>
<span class="linenos">10</span><span class="w">   </span><span class="o">++</span><span class="n">iter</span><span class="p">;</span>
<span class="linenos">11</span><span class="w">   </span><span class="k">if</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">12</span><span class="w">      </span><span class="nf">plot</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="kp">value</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="kp">fill</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;rho(theta,phi) on [0,2pi]x[0,pi] - S=&quot;</span><span class="o">+</span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="kp">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">);</span>
<span class="linenos">13</span><span class="w">   </span><span class="k">else</span>
<span class="linenos">14</span><span class="w">      </span><span class="n">Plot3D</span><span class="p">(</span><span class="n">rho</span><span class="p">[],</span><span class="w"> </span><span class="s">&quot;shape_evolution&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">15</span><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="p">;</span>
<span class="linenos">16</span><span class="p">}</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">GradArea</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">){</span>
<span class="linenos">19</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">rho2</span><span class="p">;</span>
<span class="linenos">20</span><span class="w">   </span><span class="n">rho</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span><span class="p">;</span>
<span class="linenos">21</span><span class="w">   </span><span class="n">rho2</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">X</span><span class="p">);</span>
<span class="linenos">22</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="n">sqrtPsi</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">;</span>
<span class="linenos">23</span><span class="w">   </span><span class="p">{</span>
<span class="linenos">24</span><span class="w">      </span><span class="n">Vh</span><span class="w"> </span><span class="n">dxrho2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">dx</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">rho</span><span class="p">),</span><span class="w"> </span><span class="n">dyrho2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">rho</span><span class="p">);</span>
<span class="linenos">25</span><span class="w">      </span><span class="n">sqrtPsi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">rho2</span><span class="o">*</span><span class="n">rho2</span><span class="o">*</span><span class="n">sin2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rho2</span><span class="o">*</span><span class="n">dxrho2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rho2</span><span class="o">*</span><span class="n">dyrho2</span><span class="o">*</span><span class="n">sin2</span><span class="p">);</span>
<span class="linenos">26</span><span class="w">      </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.</span><span class="o">*</span><span class="n">rho2</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="n">sin2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rho</span><span class="o">*</span><span class="n">dxrho2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rho</span><span class="o">*</span><span class="n">dyrho2</span><span class="o">*</span><span class="n">sin2</span><span class="p">;</span>
<span class="linenos">27</span><span class="w">   </span><span class="p">}</span>
<span class="linenos">28</span><span class="w">   </span><span class="kt">varf</span><span class="w"> </span><span class="n">dArea</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="linenos">29</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos">30</span><span class="w">           </span><span class="mf">1.</span><span class="o">/</span><span class="n">sqrtPsi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">v</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rho2</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rho2</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">*</span><span class="n">sin2</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="linenos">31</span><span class="w">      </span><span class="p">)</span>
<span class="linenos">32</span><span class="w">      </span><span class="p">;</span>
<span class="linenos">33</span>
<span class="linenos">34</span><span class="w">   </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">grad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dArea</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span>
<span class="linenos">35</span><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">grad</span><span class="p">;</span>
<span class="linenos">36</span><span class="p">}</span>
</pre></div>
</div>
<p>The function returning the hessian of the area for a given shape is a bit blurry, thus we won’t show here all of equation <a class="reference internal" href="#equation-msd2area">(34)</a> coefficients definition, they can be found in the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">edp</span></code> file.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">matrix</span><span class="w"> </span><span class="n">hessianA</span><span class="p">;</span>
<span class="linenos"> 2</span><span class="kt">func</span><span class="w"> </span><span class="kt">matrix</span><span class="w"> </span><span class="n">HessianArea</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">){</span>
<span class="linenos"> 3</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">rho2</span><span class="p">;</span>
<span class="linenos"> 4</span><span class="w">   </span><span class="n">rho</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="w">   </span><span class="n">rho2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">rho</span><span class="p">);</span>
<span class="linenos"> 6</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="n">sqrtPsi</span><span class="p">,</span><span class="w"> </span><span class="n">sqrtPsi3</span><span class="p">,</span><span class="w"> </span><span class="n">C00</span><span class="p">,</span><span class="w"> </span><span class="n">C01</span><span class="p">,</span><span class="w"> </span><span class="n">C02</span><span class="p">,</span><span class="w"> </span><span class="n">C11</span><span class="p">,</span><span class="w"> </span><span class="n">C12</span><span class="p">,</span><span class="w"> </span><span class="n">C22</span><span class="p">,</span><span class="w"> </span><span class="kp">A</span><span class="p">;</span>
<span class="linenos"> 7</span><span class="w">   </span><span class="p">{</span>
<span class="linenos"> 8</span><span class="w">      </span><span class="n">Vh</span><span class="w"> </span><span class="n">C0</span><span class="p">,</span><span class="w"> </span><span class="n">C1</span><span class="p">,</span><span class="w"> </span><span class="n">C2</span><span class="p">;</span>
<span class="linenos"> 9</span><span class="w">      </span><span class="n">Vh</span><span class="w"> </span><span class="n">dxrho2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">dx</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">rho</span><span class="p">),</span><span class="w"> </span><span class="n">dyrho2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">rho</span><span class="p">);</span>
<span class="linenos">10</span><span class="w">      </span><span class="n">sqrtPsi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">rho2</span><span class="o">*</span><span class="n">rho2</span><span class="o">*</span><span class="n">sin2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rho2</span><span class="o">*</span><span class="n">dxrho2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rho2</span><span class="o">*</span><span class="n">dyrho2</span><span class="o">*</span><span class="n">sin2</span><span class="p">);</span>
<span class="linenos">11</span><span class="w">      </span><span class="n">sqrtPsi3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">rho2</span><span class="o">*</span><span class="n">rho2</span><span class="o">*</span><span class="n">sin2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rho2</span><span class="o">*</span><span class="n">dxrho2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rho2</span><span class="o">*</span><span class="n">dyrho2</span><span class="o">*</span><span class="n">sin2</span><span class="p">)</span><span class="o">*</span><span class="n">sqrtPsi</span><span class="p">;</span>
<span class="linenos">12</span><span class="w">      </span><span class="n">C0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">rho2</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="n">sin2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rho</span><span class="o">*</span><span class="n">dxrho2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rho</span><span class="o">*</span><span class="n">dyrho2</span><span class="o">*</span><span class="n">sin2</span><span class="p">;</span>
<span class="linenos">13</span><span class="w">      </span><span class="n">C1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rho2</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">rho</span><span class="p">);</span>
<span class="linenos">14</span><span class="w">      </span><span class="n">C2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rho2</span><span class="o">*</span><span class="n">sin2</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">rho</span><span class="p">);</span>
<span class="linenos">15</span><span class="w">      </span><span class="n">C00</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">C0</span><span class="p">);</span>
<span class="linenos">16</span><span class="w">      </span><span class="n">C01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C0</span><span class="o">*</span><span class="n">C1</span><span class="p">;</span>
<span class="linenos">17</span><span class="w">      </span><span class="n">C02</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C0</span><span class="o">*</span><span class="n">C2</span><span class="p">;</span>
<span class="linenos">18</span><span class="w">      </span><span class="n">C11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">C1</span><span class="p">);</span>
<span class="linenos">19</span><span class="w">      </span><span class="n">C12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C1</span><span class="o">*</span><span class="n">C2</span><span class="p">;</span>
<span class="linenos">20</span><span class="w">      </span><span class="n">C22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">C2</span><span class="p">);</span>
<span class="linenos">21</span><span class="w">      </span><span class="kp">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6.</span><span class="o">*</span><span class="n">rho2</span><span class="o">*</span><span class="n">sin2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dxrho2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dyrho2</span><span class="o">*</span><span class="n">sin2</span><span class="p">;</span>
<span class="linenos">22</span><span class="w">   </span><span class="p">}</span>
<span class="linenos">23</span><span class="w">   </span><span class="kt">varf</span><span class="w"> </span><span class="n">d2Area</span><span class="w"> </span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="linenos">24</span><span class="w">      </span><span class="o">=</span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos">25</span><span class="w">           </span><span class="mf">1.</span><span class="o">/</span><span class="n">sqrtPsi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span>
<span class="linenos">26</span><span class="w">              </span><span class="kp">A</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">v</span>
<span class="linenos">27</span><span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="n">v</span>
<span class="linenos">28</span><span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos">29</span><span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">*</span><span class="n">sin2</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="n">v</span>
<span class="linenos">30</span><span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">*</span><span class="n">sin2</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos">31</span><span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="n">rho2</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos">32</span><span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="n">rho2</span><span class="o">*</span><span class="n">sin2</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos">33</span><span class="w">         </span><span class="p">)</span>
<span class="linenos">34</span><span class="w">         </span><span class="o">+</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="n">sqrtPsi3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span>
<span class="linenos">35</span><span class="w">              </span><span class="n">C00</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">v</span>
<span class="linenos">36</span><span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="n">C01</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="n">v</span>
<span class="linenos">37</span><span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="n">C01</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos">38</span><span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="n">C02</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="n">v</span>
<span class="linenos">39</span><span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="n">C02</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos">40</span><span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="n">C11</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos">41</span><span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="n">C12</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos">42</span><span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="n">C12</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos">43</span><span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="n">C22</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos">44</span><span class="w">         </span><span class="p">)</span>
<span class="linenos">45</span><span class="w">      </span><span class="p">)</span>
<span class="linenos">46</span><span class="w">      </span><span class="p">;</span>
<span class="linenos">47</span><span class="w">   </span><span class="n">hessianA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d2Area</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span>
<span class="linenos">48</span><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">hessianA</span><span class="p">;</span>
<span class="linenos">49</span><span class="p">}</span>
</pre></div>
</div>
<p>And the volume related functions:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Volume computation</span>
<span class="linenos"> 2</span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">Volume</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">){</span>
<span class="linenos"> 3</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="n">rho</span><span class="p">;</span>
<span class="linenos"> 4</span><span class="w">   </span><span class="n">rho</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="n">rho3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rho</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="n">rho</span><span class="p">;</span>
<span class="linenos"> 6</span><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="mf">3.</span><span class="o">*</span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">rho3</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">));</span>
<span class="linenos"> 7</span><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="p">}</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">GradVolume</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">){</span>
<span class="linenos">11</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="n">rho</span><span class="p">;</span>
<span class="linenos">12</span><span class="w">   </span><span class="n">rho</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span><span class="p">;</span>
<span class="linenos">13</span><span class="w">   </span><span class="kt">varf</span><span class="w"> </span><span class="nf">dVolume</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">rho</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">)</span><span class="o">*</span><span class="n">v</span><span class="p">);</span>
<span class="linenos">14</span><span class="w">   </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">grad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dVolume</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span>
<span class="linenos">15</span><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">grad</span><span class="p">;</span>
<span class="linenos">16</span><span class="p">}</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="kt">matrix</span><span class="w"> </span><span class="n">hessianV</span><span class="p">;</span>
<span class="linenos">19</span><span class="kt">func</span><span class="w"> </span><span class="kt">matrix</span><span class="w"> </span><span class="n">HessianVolume</span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">){</span>
<span class="linenos">20</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="n">rho</span><span class="p">;</span>
<span class="linenos">21</span><span class="w">   </span><span class="n">rho</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span><span class="p">;</span>
<span class="linenos">22</span><span class="w">   </span><span class="kt">varf</span><span class="w"> </span><span class="nf">d2Volume</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="mi">2</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">)</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">);</span>
<span class="linenos">23</span><span class="w">   </span><span class="n">hessianV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d2Volume</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span>
<span class="linenos">24</span><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">hessianV</span><span class="p">;</span>
<span class="linenos">25</span><span class="p">}</span>
</pre></div>
</div>
<p>If we want to use the volume as a constraint function we must wrap it and its derivatives in some <strong>FreeFEM</strong> functions returning the appropriate types.
It is not done in the above functions in cases where one wants to use it as a fitness function.
The lagrangian hessian also has to be wrapped since the Volume is not linear with respect to <span class="math notranslate nohighlight">\(\rho\)</span>, it has some non-null second order derivatives.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">ipVolume</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">){</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">vol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">Volume</span><span class="p">(</span><span class="n">X</span><span class="p">)];</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">vol</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos">2</span><span class="kt">matrix</span><span class="w"> </span><span class="n">mdV</span><span class="p">;</span>
<span class="linenos">3</span><span class="kt">func</span><span class="w"> </span><span class="kt">matrix</span><span class="w"> </span><span class="n">ipGradVolume</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">dvol</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="p">);</span><span class="w"> </span><span class="n">dvol</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">:</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GradVolume</span><span class="p">(</span><span class="n">X</span><span class="p">);</span><span class="w"> </span><span class="n">mdV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dvol</span><span class="p">;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">mdV</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos">4</span><span class="kt">matrix</span><span class="w"> </span><span class="n">HLagrangian</span><span class="p">;</span>
<span class="linenos">5</span><span class="kt">func</span><span class="w"> </span><span class="kt">matrix</span><span class="w"> </span><span class="n">ipHessianLag</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">objfact</span><span class="p">,</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">lambda</span><span class="p">){</span>
<span class="linenos">6</span><span class="w">   </span><span class="n">HLagrangian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">objfact</span><span class="o">*</span><span class="n">HessianArea</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lambda</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">HessianVolume</span><span class="p">(</span><span class="n">X</span><span class="p">);</span>
<span class="linenos">7</span><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">HLagrangian</span><span class="p">;</span>
<span class="linenos">8</span><span class="p">}</span>
</pre></div>
</div>
<p>The <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ipGradVolume</span></code> function could pose some troubles during the optimization process because the gradient vector is transformed in a sparse matrix, so any null coefficient will be discarded.
Here we create the IPOPT structure manually and use the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">checkindex</span></code> named-parameter to avoid bad indexing during copies.
This gradient is actually dense, there is no reason for some components to be constantly zero:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">gvi</span><span class="p">(</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="p">),</span><span class="w"> </span><span class="n">gvj</span><span class="o">=</span><span class="mi">0</span><span class="o">:</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="mi">-1</span><span class="p">;</span>
<span class="linenos">2</span><span class="n">gvi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
<p>These two arrays will be passed to IPOPT with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">structjacc</span><span class="o">=</span><span class="p">[</span><span class="n">gvi</span><span class="p">,</span><span class="n">gvj</span><span class="p">]</span></code>.
The last remaining things are the bound definitions.
The simple lower bound must be equal to the components of the P1 projection of <span class="math notranslate nohighlight">\(\rho_{object}\)</span>.
And we choose <span class="math notranslate nohighlight">\(\alpha\in [0,1]\)</span> to set <span class="math notranslate nohighlight">\(\mathcal{V}_{\mathrm{max}}\)</span> to <span class="math notranslate nohighlight">\((1-\alpha) \mathcal{V}(\rho_{object}) + \alpha\frac{4}{3}\pi \|\rho_{\mathrm{object}}\|_{\infty}^{3}\)</span>:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">func</span><span class="w"> </span><span class="n">disc1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">RR</span><span class="o">+</span><span class="p">(</span><span class="n">E</span><span class="o">-</span><span class="n">RR</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">)))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.1</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="kr">x</span><span class="p">));</span>
<span class="linenos"> 2</span><span class="kt">func</span><span class="w"> </span><span class="n">disc2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">RR</span><span class="o">+</span><span class="p">(</span><span class="n">E</span><span class="o">-</span><span class="n">RR</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin2</span><span class="p">));</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="k">if</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
<span class="linenos"> 5</span><span class="w">   </span><span class="n">lb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r0</span><span class="p">;</span>
<span class="linenos"> 6</span><span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">q</span><span class="p">){</span>
<span class="linenos"> 7</span><span class="w">      </span><span class="kt">func</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rr</span><span class="o">*</span><span class="n">Gaussian</span><span class="p">(</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="kr">pi</span><span class="o">/</span><span class="mf">5.</span><span class="p">,</span><span class="w"> </span><span class="kr">pi</span><span class="o">/</span><span class="mf">3.</span><span class="p">);</span>
<span class="linenos"> 8</span><span class="w">      </span><span class="kt">func</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rr</span><span class="o">*</span><span class="n">Gaussian</span><span class="p">(</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="kr">pi</span><span class="o">/</span><span class="mf">5.</span><span class="o">+</span><span class="kr">pi</span><span class="o">/</span><span class="mf">5.</span><span class="p">,</span><span class="w"> </span><span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="o">/</span><span class="mf">3.</span><span class="p">);</span>
<span class="linenos"> 9</span><span class="w">      </span><span class="n">lb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">max</span><span class="p">(</span><span class="kr">max</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">),</span><span class="w"> </span><span class="n">g</span><span class="p">);</span>
<span class="linenos">10</span><span class="w">   </span><span class="p">}</span>
<span class="linenos">11</span><span class="w">   </span><span class="n">lb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">max</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span><span class="w"> </span><span class="n">rr</span><span class="o">*</span><span class="n">Gaussian</span><span class="p">(</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">,</span><span class="w"> </span><span class="kr">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">));</span>
<span class="linenos">12</span><span class="p">}</span>
<span class="linenos">13</span><span class="n">lb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">max</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span><span class="w"> </span><span class="kr">max</span><span class="p">(</span><span class="n">disc1</span><span class="p">,</span><span class="w"> </span><span class="n">disc2</span><span class="p">));</span>
<span class="linenos">14</span><span class="kt">real</span><span class="w"> </span><span class="n">Vobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Volume</span><span class="p">(</span><span class="n">lb</span><span class="p">[]);</span>
<span class="linenos">15</span><span class="kt">real</span><span class="w"> </span><span class="n">Vnvc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.</span><span class="o">/</span><span class="mf">3.</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="nf">pow</span><span class="p">(</span><span class="n">lb</span><span class="p">[].</span><span class="kr">linfty</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="k">if</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">18</span><span class="w">   </span><span class="n">Plot3D</span><span class="p">(</span><span class="n">lb</span><span class="p">[],</span><span class="w"> </span><span class="s">&quot;object_inside&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">19</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">clb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="n">cub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">Vobj</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">alpha</span><span class="o">*</span><span class="n">Vnvc</span><span class="p">];</span>
</pre></div>
</div>
<p>Calling IPOPT:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">int</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IPOPT</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span><span class="w"> </span><span class="n">GradArea</span><span class="p">,</span><span class="w"> </span><span class="n">ipHessianLag</span><span class="p">,</span><span class="w"> </span><span class="n">ipVolume</span><span class="p">,</span><span class="w"> </span><span class="n">ipGradVolume</span><span class="p">,</span>
<span class="linenos">2</span><span class="w">   </span><span class="n">rc</span><span class="p">[],</span><span class="w"> </span><span class="n">ub</span><span class="o">=</span><span class="n">ub</span><span class="p">[],</span><span class="w"> </span><span class="n">lb</span><span class="o">=</span><span class="n">lb</span><span class="p">[],</span><span class="w"> </span><span class="n">clb</span><span class="o">=</span><span class="n">clb</span><span class="p">,</span><span class="w"> </span><span class="n">cub</span><span class="o">=</span><span class="n">cub</span><span class="p">,</span><span class="w"> </span><span class="n">checkindex</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">maxiter</span><span class="o">=</span><span class="n">kkk</span><span class="o">&lt;</span><span class="n">nadapt</span><span class="mi">-1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">40</span><span class="o">:</span><span class="mi">150</span><span class="p">,</span>
<span class="linenos">3</span><span class="w">   </span><span class="n">warmstart</span><span class="o">=</span><span class="n">kkk</span><span class="p">,</span><span class="w"> </span><span class="n">lm</span><span class="o">=</span><span class="n">lm</span><span class="p">,</span><span class="w"> </span><span class="n">uz</span><span class="o">=</span><span class="n">uz</span><span class="p">[],</span><span class="w"> </span><span class="n">lz</span><span class="o">=</span><span class="n">lz</span><span class="p">[],</span><span class="w"> </span><span class="kp">tol</span><span class="o">=</span><span class="mf">0.00001</span><span class="p">,</span><span class="w"> </span><span class="n">structjacc</span><span class="o">=</span><span class="p">[</span><span class="n">gvi</span><span class="p">,</span><span class="n">gvj</span><span class="p">]);</span>
<span class="linenos">4</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;IPOPT: res =&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="w"> </span><span class="p">;</span>
<span class="linenos">5</span>
<span class="linenos">6</span><span class="c1">// Plot</span>
<span class="linenos">7</span><span class="n">Plot3D</span><span class="p">(</span><span class="n">rc</span><span class="p">[],</span><span class="w"> </span><span class="s">&quot;Shape_at_&quot;</span><span class="o">+</span><span class="n">kkk</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">8</span><span class="n">Plot3D</span><span class="p">(</span><span class="n">GradArea</span><span class="p">(</span><span class="n">rc</span><span class="p">[]),</span><span class="w"> </span><span class="s">&quot;ShapeGradient&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<p>Finally, before closing the mesh adaptation loop, we have to perform the said adaptation.
The mesh is adaptated with respect to the <span class="math notranslate nohighlight">\(X=(\rho, 0, 0)\)</span> (in spherical coordinates) vector field, not directly with respect to <span class="math notranslate nohighlight">\(\rho\)</span>, otherwise the true curvature of the 3D-shape would not be well taken into account.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">kkk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nadapt</span><span class="mi">-1</span><span class="p">){</span>
<span class="linenos">2</span><span class="w">   </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">rc</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">),</span><span class="w"> </span><span class="n">rc</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">),</span><span class="w"> </span><span class="n">rc</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">),</span>
<span class="linenos">3</span><span class="w">      </span><span class="kp">nbvx</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span><span class="w"> </span><span class="kp">periodic</span><span class="o">=</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="p">]]);</span>
<span class="linenos">4</span><span class="w">   </span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos">5</span><span class="w">   </span><span class="n">startshape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rc</span><span class="p">;</span>
<span class="linenos">6</span><span class="w">   </span><span class="n">uz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uz</span><span class="p">;</span>
<span class="linenos">7</span><span class="w">   </span><span class="n">lz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lz</span><span class="p">;</span>
<span class="linenos">8</span><span class="p">}</span>
</pre></div>
</div>
<p>Here are some pictures of the resulting surfaces obtained for decreasing values of <span class="math notranslate nohighlight">\(\alpha\)</span> (and a slightly more complicated object than two orthogonal discs).
We return to the enclosed object when <span class="math notranslate nohighlight">\(\alpha=0\)</span>:</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/minsurf3D.jpg"><img alt="../_images/minsurf3D.jpg" src="../_images/minsurf3D.jpg" style="width: 100%;" /></a>
</figure>
</div>
</section>
</section>
<section id="the-nlopt-optimizers">
<h2>The nlOpt optimizers<a class="headerlink" href="#the-nlopt-optimizers" title="Link to this heading"></a></h2>
<p>The <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ff</span><span class="o">-</span><span class="n">NLopt</span></code> package provides a <strong>FreeFEM</strong> interface to the free/open-source library for nonlinear optimization, easing the use of several different free optimization (constrained or not) routines available online along with the PDE solver.
All the algorithms are well documented in <a class="reference external" href="https://nlopt.readthedocs.io/en/latest/">NLopt documentation</a>, therefore no exhaustive information concerning their mathematical specificities will be found here and we will focus on the way they are used in a <strong>FreeFEM</strong> script.
If needing detailed information about these algorithms, visit the website where a description of each of them is given, as well as many bibliographical links.</p>
<p>Most of the gradient based algorithms of NLopt uses a full matrix approximation of the Hessian, so if you’re planning to solve a large scale problem, use the IPOPT optimizer which definitely surpass them.</p>
<p>All the NLopt features are identified that way:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;ff-NLopt&quot;</span>
<span class="linenos"> 2</span><span class="c1">//define J, u, and maybe grad(J), some constraints etc...</span>
<span class="linenos"> 3</span><span class="kt">real</span><span class="w"> </span><span class="kr">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nloptXXXXXX</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="c1">//Unavoidable part</span>
<span class="linenos"> 4</span><span class="w">   </span><span class="n">grad</span><span class="o">=&lt;</span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">grad</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="c1">//if needed</span>
<span class="linenos"> 5</span><span class="w">   </span><span class="n">lb</span><span class="o">=</span><span class="w"> </span><span class="c1">//Lower bounds array</span>
<span class="linenos"> 6</span><span class="w">   </span><span class="n">ub</span><span class="o">=</span><span class="w"> </span><span class="c1">//Upper bounds array</span>
<span class="linenos"> 7</span><span class="w">   </span><span class="p">...</span><span class="w"> </span><span class="c1">//Some optional arguments:</span>
<span class="linenos"> 8</span><span class="w">   </span><span class="c1">//Constraints functions names,</span>
<span class="linenos"> 9</span><span class="w">   </span><span class="c1">//Stopping criteria,</span>
<span class="linenos">10</span><span class="w">   </span><span class="c1">//Algorithm specific parameters,</span>
<span class="linenos">11</span><span class="w">   </span><span class="c1">//Etc...</span>
<span class="linenos">12</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">XXXXXX</span></code> refers to the algorithm tag (not necessarily 6 characters long).
<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">u</span></code> is the starting position (a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> type array) which will be overwritten by the algorithm, the value at the end being the found <span class="math notranslate nohighlight">\(argmin\)</span>.
And as usual, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">J</span></code> is a function taking a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> type array as argument and returning a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code>.
<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">grad</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">lb</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ub</span></code> are “half-optional” arguments, in the sense that they are obligatory for some routines but not all.</p>
<p>The possible optionally named parameters are the following, note that they are not used by all algorithms (some do not support constraints, or a type of constraints, some are gradient-based and others are derivative free, etc…).
One can refer to the table after the parameters description to check which are the named parameters supported by a specific algorithm.
Using an unsupported parameter will not stop the compiler work, seldom breaks runtime, and will just be ignored.
When it is obvious you are missing a routine, you will get a warning message at runtime (for example if you pass a gradient to a derivative free algorithm, or set the population of a non-genetic one, etc…).
In the following description, <span class="math notranslate nohighlight">\(n\)</span> stands for the dimension of the search space.</p>
<p><strong>Half-optional parameters :</strong></p>
<ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">grad</span><span class="o">=</span></code> The name of the function which computes the gradient of the cost function (prototype should be <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> <span class="math notranslate nohighlight">\(\rightarrow\)</span> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, both argument and result should have the size <span class="math notranslate nohighlight">\(n\)</span>).
This is needed as soon as a gradient-based method is involved, which is ignored if defined in a derivative free context.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">lb</span></code>/<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ub</span></code> = Lower and upper bounds arrays ( <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> type) of size <span class="math notranslate nohighlight">\(n\)</span>.
Used to define the bounds within which the search variable is allowed to move.
Needed for some algorithms, optional, or unsupported for others.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">subOpt</span></code> : Only enabled for the Augmented Lagrangian and MLSL methods who need a sub-optimizer in order to work.
Just pass the tag of the desired local algorithm with a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">string</span></code>.</p></li>
</ul>
<p><strong>Constraints related parameters (optional - unused if not specified):</strong></p>
<ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">IConst</span></code>/<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">EConst</span></code> : Allows to pass the name of a function implementing some inequality (resp. equality) constraints on the search space.
The function type must be <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> <span class="math notranslate nohighlight">\(\rightarrow\)</span> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> where the size of the returned array is equal to the number of constraints (of the same type - it means that all of the constraints are computed in one vectorial function).
In order to mix inequality and equality constraints in a same minimization attempt, two vectorial functions have to be defined and passed.
See example <a class="reference internal" href="#equation-varineqex">(36)</a> for more details about how these constraints have to be implemented.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">gradIConst</span></code>/<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">gradEConst</span></code> : Use to provide the inequality (resp. equality) constraints gradient.
These are <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> <span class="math notranslate nohighlight">\(\rightarrow\)</span> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span></code> type functions.
Assuming we have defined a constraint function (either inequality or equality) with <span class="math notranslate nohighlight">\(p\)</span> constraints, the size of the matrix returned by its associated gradient must be <span class="math notranslate nohighlight">\(p\times n\)</span> (the <span class="math notranslate nohighlight">\(i\)</span>-th line of the matrix is the gradient of the <span class="math notranslate nohighlight">\(i\)</span>-th constraint).
It is needed in a gradient-based context as soon as an inequality or equality constraint function is passed to the optimizer and ignored in all other cases.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">tolIConst</span></code>/<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">tolEConst</span></code> : Tolerance values for each constraint.
This is an array of size equal to the number of inequality (resp. equality) constraints.
Default value is set to <span class="math notranslate nohighlight">\(10^{-12}\)</span> for each constraint of any type.</p></li>
</ul>
<p><strong>Stopping criteria :</strong></p>
<ul>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">stopFuncValue</span></code> : Makes the algorithm end when the objective function reaches this <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code> value.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">stopRelXTol</span></code> : Stops the algorithm when the relative moves in each direction of the search space is smaller than this <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code> value.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">stopAbsXTol</span></code> : Stops the algorithm when the moves in each direction of the search space is smaller than the corresponding value in this <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> array.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">stopRelFTol</span></code> : Stops the algorithm when the relative variation of the objective function is smaller than this <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code> value.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">stopAbsFTol</span></code> : Stops the algorithm when the variation of the objective function is smaller than this <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code> value.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">stopMaxFEval</span></code> : Stops the algorithm when the number of fitness evaluations reaches this <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">integer</span></code> value.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">stopTime</span></code> : Stops the algorithm when the optimization time in seconds exceeds this <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code> value.
This is not a strict maximum: the time may exceed it slightly, depending upon the algorithm and on how slow your function evaluation is.</p>
<p>Note that when an AUGLAG or MLSL method is used, the meta-algorithm and the sub-algorithm may have different termination criteria.
Thus, for algorithms of this kind, the following named parameters has been defined (just adding the SO prefix - for Sub-Optimizer) to set the ending condition of the sub-algorithm (the meta one uses the ones above): <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">SOStopFuncValue</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">SOStopRelXTol</span></code>, and so on… If these are not used, the sub-optimizer will use those of the master routine.</p>
</li>
</ul>
<p><strong>Other named parameters :</strong></p>
<ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">popSize</span></code> : <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">integer</span></code> used to change the size of the sample for stochastic search methods.
Default value is a peculiar heuristic to the chosen algorithm.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">SOPopSize</span></code> : Same as above, but when the stochastic search is passed to a meta-algorithm.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">nGradStored</span></code> : The number (<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">integer</span></code> type) of gradients to “remember” from previous optimization steps: increasing this increases the memory requirements but may speed convergence.
It is set to a heuristic value by default.
If used with AUGLAG or MLSL, it will only affect the given subsidiary algorithm.</p></li>
</ul>
<p>The following table sums up the main characteristics of each algorithm, providing the more important information about which features are supported by which algorithm and what are the unavoidable arguments they need.
More details can be found in <a class="reference external" href="https://nlopt.readthedocs.io/en/latest/">NLopt documentation</a>.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/nlopttab.png"><img alt="../_images/nlopttab.png" src="../_images/nlopttab.png" style="height: 22cm;" /></a>
</figure>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Variational inequality</p>
<p>Let <span class="math notranslate nohighlight">\(\Omega\)</span> be a domain of <span class="math notranslate nohighlight">\(\mathbb{R}^{2}\)</span>, <span class="math notranslate nohighlight">\(f_{1}, f_{2}\in L^{2}(\Omega)\)</span> and <span class="math notranslate nohighlight">\(g_{1}, g_{2} \in L^{2}(\partial\Omega)\)</span> four given functions with <span class="math notranslate nohighlight">\(g_{1}\leq g_{2}\)</span> almost everywhere.</p>
<p>We define the space:</p>
<div class="math notranslate nohighlight">
\[V = \left\lbrace (v_{1},v_{2})\in H^{1}(\Omega)^{2} ; v_{1}\vert_{\partial\Omega}=g_{1}, v_{2}\vert_{\partial\Omega}=g_{2}, v_{1}\leq v_{2}\ \mathrm{a.e.}\ \right\rbrace\]</div>
<p>as well as the function <span class="math notranslate nohighlight">\(J:H^{1}(\Omega)^{2}\longrightarrow \mathbb{R}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-varineqex">
<span class="eqno">(36)<a class="headerlink" href="#equation-varineqex" title="Link to this equation"></a></span>\[J(v_{1},v_{2}) = \displaystyle{\frac{1}{2}\int_{\Omega}\vert\nabla v_{1}\vert^{2} - \int_{\Omega} f_{1}v_{1} + \frac{1}{2}\int_{\Omega}\vert\nabla v_{2}\vert^{2} - \int_{\Omega} f_{2}v_{2}}\]</div>
<p>The problem consists in finding (numerically) two functions <span class="math notranslate nohighlight">\((u_{1},u_{2}) = \underset{(v_{1},v_{2})\in V}{\operatorname{argmin}} J(v_{1},v_{2})\)</span>.</p>
<p>This can be interpreted as finding <span class="math notranslate nohighlight">\(u_{1}, u_{2}\)</span> as close as possible (in a certain sense) to the solutions of the Laplace equation with respectively <span class="math notranslate nohighlight">\(f_{1}, f_{2}\)</span> second members and <span class="math notranslate nohighlight">\(g_{1}, g_{2}\)</span> Dirichlet boundary conditions with the <span class="math notranslate nohighlight">\(u_{1}\leq u_{2}\)</span> almost everywhere constraint.</p>
<p>Here is the corresponding script to treat this variational inequality problem with one of the NLOpt algorithms.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="c1">//A brief script to demonstrate how to use the freefemm interfaced nlopt routines</span>
<span class="linenos">  2</span><span class="c1">//The problem consist in solving a simple variational inequality using one of the</span>
<span class="linenos">  3</span><span class="c1">//optimization algorithm of nlopt. We restart the algorithlm a few times after</span>
<span class="linenos">  4</span><span class="c1">//performing some mesh adaptation to get a more precise output</span>
<span class="linenos">  5</span>
<span class="linenos">  6</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;ff-NLopt&quot;</span>
<span class="linenos">  7</span>
<span class="linenos">  8</span><span class="c1">// Parameters</span>
<span class="linenos">  9</span><span class="kt">int</span><span class="w"> </span><span class="n">kas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="c1">//choose of the algorithm</span>
<span class="linenos"> 10</span><span class="kt">int</span><span class="w"> </span><span class="n">NN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="linenos"> 11</span><span class="kt">func</span><span class="w"> </span><span class="n">f1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span>
<span class="linenos"> 12</span><span class="kt">func</span><span class="w"> </span><span class="n">f2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.</span><span class="p">;</span>
<span class="linenos"> 13</span><span class="kt">func</span><span class="w"> </span><span class="n">g1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span>
<span class="linenos"> 14</span><span class="kt">func</span><span class="w"> </span><span class="n">g2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span>
<span class="linenos"> 15</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 16</span><span class="kt">int</span><span class="w"> </span><span class="n">nadapt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="linenos"> 17</span><span class="kt">real</span><span class="w"> </span><span class="n">starttol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-6</span><span class="p">;</span>
<span class="linenos"> 18</span><span class="kt">real</span><span class="w"> </span><span class="n">bctol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6.</span><span class="n">e</span><span class="mi">-12</span><span class="p">;</span>
<span class="linenos"> 19</span>
<span class="linenos"> 20</span><span class="c1">// Mesh</span>
<span class="linenos"> 21</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">NN</span><span class="p">,</span><span class="w"> </span><span class="n">NN</span><span class="p">);</span>
<span class="linenos"> 22</span>
<span class="linenos"> 23</span><span class="c1">// Fespace</span>
<span class="linenos"> 24</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos"> 25</span><span class="n">Vh</span><span class="w"> </span><span class="n">oldu1</span><span class="p">,</span><span class="w"> </span><span class="n">oldu2</span><span class="p">;</span>
<span class="linenos"> 26</span>
<span class="linenos"> 27</span><span class="c1">// Adaptation loop</span>
<span class="linenos"> 28</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">al</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">al</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nadapt</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">al</span><span class="p">){</span>
<span class="linenos"> 29</span><span class="w">   </span><span class="kt">varf</span><span class="w"> </span><span class="nf">BVF</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="mf">0.5</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">w</span><span class="p">));</span>
<span class="linenos"> 30</span><span class="w">   </span><span class="kt">varf</span><span class="w"> </span><span class="nf">LVF1</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">f1</span><span class="o">*</span><span class="n">w</span><span class="p">);</span>
<span class="linenos"> 31</span><span class="w">   </span><span class="kt">varf</span><span class="w"> </span><span class="nf">LVF2</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">f2</span><span class="o">*</span><span class="n">w</span><span class="p">);</span>
<span class="linenos"> 32</span><span class="w">   </span><span class="kt">matrix</span><span class="w"> </span><span class="kp">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BVF</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span>
<span class="linenos"> 33</span><span class="w">   </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LVF1</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">),</span><span class="w"> </span><span class="n">b2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LVF2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span>
<span class="linenos"> 34</span>
<span class="linenos"> 35</span><span class="w">   </span><span class="kt">varf</span><span class="w"> </span><span class="nf">Vbord</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos"> 36</span>
<span class="linenos"> 37</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="n">In</span><span class="p">,</span><span class="w"> </span><span class="n">Bord</span><span class="p">;</span>
<span class="linenos"> 38</span><span class="w">   </span><span class="n">Bord</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vbord</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="kp">tgv</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos"> 39</span><span class="w">   </span><span class="n">In</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Bord</span><span class="p">[]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
<span class="linenos"> 40</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="n">gh1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Bord</span><span class="o">*</span><span class="n">g1</span><span class="p">,</span><span class="w"> </span><span class="n">gh2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Bord</span><span class="o">*</span><span class="n">g2</span><span class="p">;</span>
<span class="linenos"> 41</span>
<span class="linenos"> 42</span><span class="w">   </span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">J</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">){</span>
<span class="linenos"> 43</span><span class="w">      </span><span class="n">Vh</span><span class="w"> </span><span class="n">u1</span><span class="p">,</span><span class="w"> </span><span class="n">u2</span><span class="p">;</span>
<span class="linenos"> 44</span><span class="w">      </span><span class="n">u1</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="mi">-1</span><span class="p">);</span>
<span class="linenos"> 45</span><span class="w">      </span><span class="n">u2</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="o">:</span><span class="mi">2</span><span class="o">*</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="mi">-1</span><span class="p">);</span>
<span class="linenos"> 46</span><span class="w">      </span><span class="n">iter</span><span class="o">++</span><span class="p">;</span>
<span class="linenos"> 47</span><span class="w">      </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">Au1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">A</span><span class="o">*</span><span class="n">u1</span><span class="p">[],</span><span class="w"> </span><span class="n">Au2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">A</span><span class="o">*</span><span class="n">u2</span><span class="p">[];</span>
<span class="linenos"> 48</span><span class="w">      </span><span class="n">Au1</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">b1</span><span class="p">;</span>
<span class="linenos"> 49</span><span class="w">      </span><span class="n">Au2</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">b2</span><span class="p">;</span>
<span class="linenos"> 50</span><span class="w">      </span><span class="kt">real</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u1</span><span class="p">[]</span><span class="o">&#39;*</span><span class="n">Au1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u2</span><span class="p">[]</span><span class="o">&#39;*</span><span class="n">Au2</span><span class="p">;</span>
<span class="linenos"> 51</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iter</span><span class="o">%</span><span class="mi">10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span>
<span class="linenos"> 52</span><span class="w">         </span><span class="nf">plot</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="w"> </span><span class="n">u2</span><span class="p">,</span><span class="w"> </span><span class="kp">nbiso</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="kp">fill</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;adapt level &quot;</span><span class="o">+</span><span class="n">al</span><span class="o">+</span><span class="s">&quot; - iteration &quot;</span><span class="o">+</span><span class="n">iter</span><span class="o">+</span><span class="s">&quot; - J = &quot;</span><span class="o">+</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="kp">value</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos"> 53</span><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">val</span><span class="p">;</span>
<span class="linenos"> 54</span><span class="w">   </span><span class="p">}</span>
<span class="linenos"> 55</span>
<span class="linenos"> 56</span><span class="w">   </span><span class="kt">varf</span><span class="w"> </span><span class="n">dBFV</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">+</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">w</span><span class="p">));</span>
<span class="linenos"> 57</span><span class="w">   </span><span class="kt">matrix</span><span class="w"> </span><span class="n">dA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dBFV</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span>
<span class="linenos"> 58</span><span class="w">   </span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">dJ</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">){</span>
<span class="linenos"> 59</span><span class="w">      </span><span class="n">Vh</span><span class="w"> </span><span class="n">u1</span><span class="p">,</span><span class="w"> </span><span class="n">u2</span><span class="p">;</span>
<span class="linenos"> 60</span><span class="w">      </span><span class="n">u1</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="mi">-1</span><span class="p">);</span>
<span class="linenos"> 61</span><span class="w">      </span><span class="n">u2</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="o">:</span><span class="mi">2</span><span class="o">*</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="mi">-1</span><span class="p">);</span>
<span class="linenos"> 62</span>
<span class="linenos"> 63</span><span class="w">      </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">grad1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dA</span><span class="o">*</span><span class="n">u1</span><span class="p">[],</span><span class="w"> </span><span class="n">grad2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dA</span><span class="o">*</span><span class="n">u2</span><span class="p">[];</span>
<span class="linenos"> 64</span><span class="w">      </span><span class="n">grad1</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">b1</span><span class="p">;</span>
<span class="linenos"> 65</span><span class="w">      </span><span class="n">grad2</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">b2</span><span class="p">;</span>
<span class="linenos"> 66</span><span class="w">      </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">Grad</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="kr">n</span><span class="p">);</span>
<span class="linenos"> 67</span><span class="w">      </span><span class="n">Grad</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grad1</span><span class="p">;</span>
<span class="linenos"> 68</span><span class="w">      </span><span class="n">Grad</span><span class="p">(</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="o">:</span><span class="mi">2</span><span class="o">*</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grad2</span><span class="p">;</span>
<span class="linenos"> 69</span><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">Grad</span><span class="p">;</span>
<span class="linenos"> 70</span><span class="w">   </span><span class="p">}</span>
<span class="linenos"> 71</span>
<span class="linenos"> 72</span><span class="w">   </span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">IneqC</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">){</span>
<span class="linenos"> 73</span><span class="w">      </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">constraints</span><span class="p">(</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="p">);</span>
<span class="linenos"> 74</span><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">constraints</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="p">];</span>
<span class="linenos"> 75</span><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">constraints</span><span class="p">;</span>
<span class="linenos"> 76</span><span class="w">   </span><span class="p">}</span>
<span class="linenos"> 77</span>
<span class="linenos"> 78</span><span class="w">   </span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">dIneqC</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">){</span>
<span class="linenos"> 79</span><span class="w">      </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">dconst</span><span class="p">(</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="p">);</span>
<span class="linenos"> 80</span><span class="w">      </span><span class="n">dconst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 81</span><span class="w">      </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="linenos"> 82</span><span class="w">         </span><span class="n">dconst</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span>
<span class="linenos"> 83</span><span class="w">         </span><span class="n">dconst</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">+</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.</span><span class="p">;</span>
<span class="linenos"> 84</span><span class="w">      </span><span class="p">}</span>
<span class="linenos"> 85</span><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">dconst</span><span class="p">;</span>
<span class="linenos"> 86</span><span class="w">   </span><span class="p">}</span>
<span class="linenos"> 87</span>
<span class="linenos"> 88</span><span class="w">   </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">BordIndex</span><span class="p">(</span><span class="n">Th</span><span class="p">.</span><span class="kr">nbe</span><span class="p">);</span><span class="w"> </span><span class="c1">//Indexes of border d.f.</span>
<span class="linenos"> 89</span><span class="w">   </span><span class="p">{</span>
<span class="linenos"> 90</span><span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 91</span><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">Bord</span><span class="p">.</span><span class="kr">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Bord</span><span class="p">[][</span><span class="n">i</span><span class="p">]){</span><span class="w"> </span><span class="n">BordIndex</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">k</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos"> 92</span><span class="w">   </span><span class="p">}</span>
<span class="linenos"> 93</span>
<span class="linenos"> 94</span><span class="w">   </span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">BC</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">){</span>
<span class="linenos"> 95</span><span class="w">      </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">bc</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Th</span><span class="p">.</span><span class="kr">nbe</span><span class="p">);</span>
<span class="linenos"> 96</span><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">nbe</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="linenos"> 97</span><span class="w">         </span><span class="kt">int</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BordIndex</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos"> 98</span><span class="w">         </span><span class="n">bc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gh1</span><span class="p">[][</span><span class="n">I</span><span class="p">];</span>
<span class="linenos"> 99</span><span class="w">         </span><span class="n">bc</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">Th</span><span class="p">.</span><span class="kr">nbe</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span><span class="p">[</span><span class="n">I</span><span class="o">+</span><span class="n">Th</span><span class="p">.</span><span class="kr">nv</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gh2</span><span class="p">[][</span><span class="n">I</span><span class="p">];</span>
<span class="linenos">100</span><span class="w">      </span><span class="p">}</span>
<span class="linenos">101</span><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">bc</span><span class="p">;</span>
<span class="linenos">102</span><span class="w">   </span><span class="p">}</span>
<span class="linenos">103</span>
<span class="linenos">104</span><span class="w">   </span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">dBC</span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">X</span><span class="p">){</span>
<span class="linenos">105</span><span class="w">      </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">dbc</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Th</span><span class="p">.</span><span class="kr">nbe</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">Th</span><span class="p">.</span><span class="kr">nv</span><span class="p">);</span>
<span class="linenos">106</span><span class="w">      </span><span class="n">dbc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span>
<span class="linenos">107</span><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">nbe</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="linenos">108</span><span class="w">         </span><span class="kt">int</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BordIndex</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos">109</span><span class="w">         </span><span class="n">dbc</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span>
<span class="linenos">110</span><span class="w">         </span><span class="n">dbc</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">Th</span><span class="p">.</span><span class="kr">nbe</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="o">+</span><span class="n">Th</span><span class="p">.</span><span class="kr">nv</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span>
<span class="linenos">111</span><span class="w">      </span><span class="p">}</span>
<span class="linenos">112</span><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">dbc</span><span class="p">;</span>
<span class="linenos">113</span><span class="w">   </span><span class="p">}</span>
<span class="linenos">114</span>
<span class="linenos">115</span><span class="w">   </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">start</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="p">),</span><span class="w"> </span><span class="n">up</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="p">),</span><span class="w"> </span><span class="n">lo</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="p">);</span>
<span class="linenos">116</span>
<span class="linenos">117</span><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">al</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span>
<span class="linenos">118</span><span class="w">      </span><span class="n">start</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span>
<span class="linenos">119</span><span class="w">      </span><span class="n">start</span><span class="p">(</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="o">:</span><span class="mi">2</span><span class="o">*</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="p">;</span>
<span class="linenos">120</span><span class="w">   </span><span class="p">}</span>
<span class="linenos">121</span><span class="w">   </span><span class="k">else</span><span class="p">{</span>
<span class="linenos">122</span><span class="w">      </span><span class="n">start</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">oldu1</span><span class="p">[];</span>
<span class="linenos">123</span><span class="w">      </span><span class="n">start</span><span class="p">(</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="o">:</span><span class="mi">2</span><span class="o">*</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">oldu2</span><span class="p">[];</span>
<span class="linenos">124</span><span class="w">   </span><span class="p">}</span>
<span class="linenos">125</span>
<span class="linenos">126</span><span class="w">   </span><span class="n">up</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000000</span><span class="p">;</span>
<span class="linenos">127</span><span class="w">   </span><span class="n">lo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1000000</span><span class="p">;</span>
<span class="linenos">128</span><span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="linenos">129</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Bord</span><span class="p">[][</span><span class="n">i</span><span class="p">]){</span>
<span class="linenos">130</span><span class="w">         </span><span class="n">up</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gh1</span><span class="p">[][</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">bctol</span><span class="p">;</span>
<span class="linenos">131</span><span class="w">         </span><span class="n">lo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gh1</span><span class="p">[][</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">bctol</span><span class="p">;</span>
<span class="linenos">132</span><span class="w">         </span><span class="n">up</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gh2</span><span class="p">[][</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">bctol</span><span class="p">;</span>
<span class="linenos">133</span><span class="w">         </span><span class="n">lo</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gh2</span><span class="p">[][</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">bctol</span><span class="p">;</span>
<span class="linenos">134</span><span class="w">      </span><span class="p">}</span>
<span class="linenos">135</span><span class="w">   </span><span class="p">}</span>
<span class="linenos">136</span>
<span class="linenos">137</span><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="n">mini</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e100</span><span class="p">;</span>
<span class="linenos">138</span><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">kas</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">139</span><span class="w">      </span><span class="n">mini</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nloptAUGLAG</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="n">grad</span><span class="o">=</span><span class="n">dJ</span><span class="p">,</span><span class="w"> </span><span class="n">lb</span><span class="o">=</span><span class="n">lo</span><span class="p">,</span>
<span class="linenos">140</span><span class="w">         </span><span class="n">ub</span><span class="o">=</span><span class="n">up</span><span class="p">,</span><span class="w"> </span><span class="n">IConst</span><span class="o">=</span><span class="n">IneqC</span><span class="p">,</span><span class="w"> </span><span class="n">gradIConst</span><span class="o">=</span><span class="n">dIneqC</span><span class="p">,</span>
<span class="linenos">141</span><span class="w">         </span><span class="n">subOpt</span><span class="o">=</span><span class="s">&quot;LBFGS&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">stopMaxFEval</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span><span class="w"> </span><span class="n">stopAbsFTol</span><span class="o">=</span><span class="n">starttol</span><span class="p">);</span>
<span class="linenos">142</span><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">kas</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="linenos">143</span><span class="w">      </span><span class="n">mini</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nloptMMA</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="n">grad</span><span class="o">=</span><span class="n">dJ</span><span class="p">,</span><span class="w"> </span><span class="n">lb</span><span class="o">=</span><span class="n">lo</span><span class="p">,</span><span class="w"> </span><span class="n">ub</span><span class="o">=</span><span class="n">up</span><span class="p">,</span><span class="w"> </span><span class="n">stopMaxFEval</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span><span class="w"> </span><span class="n">stopAbsFTol</span><span class="o">=</span><span class="n">starttol</span><span class="p">);</span>
<span class="linenos">144</span><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">kas</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="linenos">145</span><span class="w">      </span><span class="n">mini</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nloptAUGLAG</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="n">grad</span><span class="o">=</span><span class="n">dJ</span><span class="p">,</span><span class="w"> </span><span class="n">IConst</span><span class="o">=</span><span class="n">IneqC</span><span class="p">,</span>
<span class="linenos">146</span><span class="w">         </span><span class="n">gradIConst</span><span class="o">=</span><span class="n">dIneqC</span><span class="p">,</span><span class="w"> </span><span class="n">EConst</span><span class="o">=</span><span class="n">BC</span><span class="p">,</span><span class="w"> </span><span class="n">gradEConst</span><span class="o">=</span><span class="n">dBC</span><span class="p">,</span>
<span class="linenos">147</span><span class="w">         </span><span class="n">subOpt</span><span class="o">=</span><span class="s">&quot;LBFGS&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">stopMaxFEval</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="n">stopRelXTol</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">);</span>
<span class="linenos">148</span><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">kas</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="linenos">149</span><span class="w">      </span><span class="n">mini</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nloptSLSQP</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="n">grad</span><span class="o">=</span><span class="n">dJ</span><span class="p">,</span><span class="w"> </span><span class="n">IConst</span><span class="o">=</span><span class="n">IneqC</span><span class="p">,</span>
<span class="linenos">150</span><span class="w">         </span><span class="n">gradIConst</span><span class="o">=</span><span class="n">dIneqC</span><span class="p">,</span><span class="w"> </span><span class="n">EConst</span><span class="o">=</span><span class="n">BC</span><span class="p">,</span><span class="w"> </span><span class="n">gradEConst</span><span class="o">=</span><span class="n">dBC</span><span class="p">,</span>
<span class="linenos">151</span><span class="w">         </span><span class="n">stopMaxFEval</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span><span class="w"> </span><span class="n">stopAbsFTol</span><span class="o">=</span><span class="n">starttol</span><span class="p">);</span>
<span class="linenos">152</span><span class="w">   </span><span class="n">Vh</span><span class="w"> </span><span class="n">best1</span><span class="p">,</span><span class="w"> </span><span class="n">best2</span><span class="p">;</span>
<span class="linenos">153</span><span class="w">   </span><span class="n">best1</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="mi">-1</span><span class="p">);</span>
<span class="linenos">154</span><span class="w">   </span><span class="n">best2</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start</span><span class="p">(</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="o">:</span><span class="mi">2</span><span class="o">*</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="mi">-1</span><span class="p">);</span>
<span class="linenos">155</span>
<span class="linenos">156</span><span class="w">   </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">best1</span><span class="p">,</span><span class="w"> </span><span class="n">best2</span><span class="p">);</span>
<span class="linenos">157</span><span class="w">   </span><span class="n">oldu1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">best1</span><span class="p">;</span>
<span class="linenos">158</span><span class="w">   </span><span class="n">oldu2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">best2</span><span class="p">;</span>
<span class="linenos">159</span><span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="optimization-with-mpi">
<h2>Optimization with MPI<a class="headerlink" href="#optimization-with-mpi" title="Link to this heading"></a></h2>
<p>The only quick way to use the previously presented algorithms on a parallel architecture lies in parallelizing the used cost function (which is in most real life cases, the expensive part of the algorithm).
Somehow, we provide a parallel version of the CMA-ES algorithm.
The parallelization principle is the trivial one of evolving/genetic algorithms: at each iteration the cost function has to be evaluated <span class="math notranslate nohighlight">\(N\)</span> times without any dependence at all, these <span class="math notranslate nohighlight">\(N\)</span> calculus are then equally distributed to each process.
Calling the MPI version of CMA-ES is nearly the same as calling its sequential version (a complete example of use can be found in the <a class="reference internal" href="../examples/algorithms-and-optimizations.html#examplecmaesmpivariationalinequality"><span class="std std-ref">CMAES MPI variational inequality example</span></a>):</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;mpi-cmaes&quot;</span>
<span class="linenos">2</span><span class="p">...</span><span class="w"> </span><span class="c1">// Define J, u and all here</span>
<span class="linenos">3</span><span class="kt">real</span><span class="w"> </span><span class="kr">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cmaesMPI</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">stopTolFun</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span><span class="w"> </span><span class="n">stopMaxIter</span><span class="o">=</span><span class="mi">3000</span><span class="p">);</span>
<span class="linenos">4</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;minimum value is &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">min</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; for u = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>If the population size is not changed using the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">popsize</span></code> parameter, it will use the heuristic value slightly changed to be equal to the closest greatest multiple of the size of the communicator used by the optimizer.
The <strong>FreeFEM</strong> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">mpicommworld</span></code> is used by default.
The user can specify his own MPI communicator with the named parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">comm</span><span class="o">=</span></code>, see the MPI section of this manual for more information about communicators in <strong>FreeFEM</strong>.</p>
</section>
</section>


			<div class="content-nav-buttons" role="navigation">
				<a href="visualization.html" class="btn-neutral" title="previous topic" rel="previous"><span class="fa fa-arrow-circle-left"></span> Previous topic: Visualization</a>
				<a href="parallelization.html" class="btn-neutral" title="next topic" rel="next">Next topic: Parallelization <span class="fa fa-arrow-circle-right"></span></a>
			</div>
		</div>
	</div>
	
	<div id="toc">
	<div id="toc-doc">
		<b>Table of content</b>
		<ul>
<li><a class="reference internal" href="#">Algorithms &amp; Optimization</a><ul>
<li><a class="reference internal" href="#conjugate-gradient-gmres">Conjugate Gradient/GMRES</a></li>
<li><a class="reference internal" href="#algorithms-for-unconstrained-optimization">Algorithms for Unconstrained Optimization</a><ul>
<li><a class="reference internal" href="#example-of-usage-for-bfgs-or-cmaes">Example of usage for BFGS or CMAES</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ipopt">IPOPT</a><ul>
<li><a class="reference internal" href="#short-description-of-the-algorithm">Short description of the algorithm</a></li>
<li><a class="reference internal" href="#ipopt-in-freefem">IPOPT in <strong>FreeFEM</strong></a></li>
</ul>
</li>
<li><a class="reference internal" href="#some-short-examples-using-ipopt">Some short examples using IPOPT</a></li>
<li><a class="reference internal" href="#d-constrained-minimum-surface-with-ipopt">3D constrained minimum surface with IPOPT</a><ul>
<li><a class="reference internal" href="#area-and-volume-expressions">Area and volume expressions</a></li>
<li><a class="reference internal" href="#derivatives">Derivatives</a></li>
<li><a class="reference internal" href="#the-problem-and-its-script">The problem and its script</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-nlopt-optimizers">The nlOpt optimizers</a></li>
<li><a class="reference internal" href="#optimization-with-mpi">Optimization with MPI</a></li>
</ul>
</li>
</ul>

	</div>
	<div id="exampleLinks" style="display: none">
		<div id="linksContainer">
		</div>
	</div>
</div>
	<footer>
	<p>
		Coded with <i class="fas fa-heart"></i> since 1987
	</p>
	<a href="https://freefem.org" target="_blank"><img src='../_static/img/Symbole.svg' alt="FreeFEM logo"/></a>
	<div>
		<a id="lgpl" href="https://www.gnu.org/licenses/lgpl-3.0.txt" target="_blank">LGPL 3.0</a>
		<a href="http://doc.freefem.org/introduction/citation.html" target="_blank">BibTeX</a>
	</div>
</footer>
	

	<!-- Common -->
	<script async src="../_static/js/common.js"></script>
	<!-- Nav -->
	<script async src="../_static/js/nav.js"></script>
	<!-- Subnav -->
	<script async src="../_static/js/subnav.js"></script>
	<!-- MathJax -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
	<!-- Treejs -->
	<script src="../_static/js/tree.min.js"></script>
	<!-- CodeMirror -->
	<script src="../_static/js/codemirror.js"></script>
	<script src="../_static/js/runmode.js"></script>
	<script src="../_static/js/searchcursor.js"></script>
	<script src="../_static/js/mode/freefem/freefem.js"></script>
	<!-- Github -->
	<script async src="../_static/js/github.js"></script>
	<!-- Search -->
	<script src="../_static/js/examples.js"></script>
	<script src="../_static/js/mathjax-config.js"></script>
	<script src="../_static/js/lunr.js"></script>
	<script src="../_static/lunr/lunr_index.js"></script>
	<script src="../_static/lunr/lunr_index_edps.js"></script>
	<script src="../_static/js/search.js"></script>
	<script>
		initSearch('../')
	</script>
</body>

</html>