<!DOCTYPE html>

<html lang="en">

<head>
	  <meta charset="UTF-8">
  <title>Mesh Generation</title>
  <link rel="icon" href="../_static/img/Symbol.png" />

  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />

  <!-- Google font -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700,900" rel="stylesheet">

  <!-- FreeFEM theme specific -->
  <link rel="stylesheet" type="text/css" href="../_static/css/freefemtheme.css" />

  <!-- css -->
  <link rel="stylesheet" href="../_static/css/pygments_custom.css" type="text/css" />

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
</head>

<body>
	<header>
   <a class="header-logo" href="../introduction/index.html">
      <img alt="logo" title="FreeFEM documentation" src="../_static/img/FreeFem_Documentation_Logo_bleu.svg" />
   </a>

   <a class="header-github" href="https://github.com/FreeFem/FreeFem-doc" target="_blank">
      <i class="fab fa-github"></i>
      <p class="header-github-title" >
         FreeFEM Documentation on GitHub
      </p>

      <p class="header-github-stars" id="headerGithubStarsForks">
         <span id="headerGithubStars"></span> stars - <span id="headerGithubForks"></span> forks
      </p>
   </a>
</header>
	
	<nav id="nav">
	<div style="display: none;">
		<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html"><strong>Introduction</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/new-features.html">New features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-13-30-june-2023">Version 4.13 (30 June 2023)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-12">Version 4.12</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-11">Version 4.11</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-10">Version 4.10</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-9">Version 4.9</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-8">Version 4.8</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-7-1">Version 4.7-1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-7">Version 4.7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-6">Version 4.6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#version-4-5">Version 4.5</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/new-features.html#release-binaries-packages">Release, binaries packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/new-features.html#new-meshes-and-fem-border">New meshes and FEM border</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/new-features.html#boundary-element-method">Boundary Element Method</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/installation.html">Installation guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#using-binary-package">Using binary package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#windows-installation">Windows installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#macos-x-installation">macOS X installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#ubuntu-installation">Ubuntu installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#arch-aur-package">Arch AUR package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#fedora-installation">Fedora installation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#compiling-source-code">Compiling source code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-osx-10-13">Compilation on OSX (&gt;=10.13)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-ubuntu">Compilation on Ubuntu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-arch-linux">Compilation on Arch Linux</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-fedora">Compilation on Fedora</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-linux-with-intel-software-tools">Compilation on Linux with Intel software tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-windows">Compilation on Windows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#freefem-continuous-integration"><strong>FreeFEM</strong> continuous integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#environment-variables-and-init-file">Environment variables and init file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#coloring-syntax-freefem">Coloring Syntax FreeFem++</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#atom">Atom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#gedit">Gedit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#textmate-2-an-editor-under-macos">Textmate 2, an editor under macOS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#notepad-an-editor-under-windows">Notepad++,an editor under windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#emacs-editor">Emacs editor</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/download.html">Download</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/download.html#latest-binary-packages">Latest binary packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/download.html#syntax-highlighters">Syntax highlighters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/history.html">History</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/citation.html">Citation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/citation.html#if-you-use-freefem-please-cite-the-following-reference-in-your-work">If you use <strong>FreeFEM</strong>, please cite the following reference in your work:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#bibtex">BibTeX</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#apa">APA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#iso690">ISO690</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#mla">MLA</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/authors.html">Authors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/contributing.html">Contributing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/contributing.html#bug-report">Bug report</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/contributing.html#concerning-the-freefem-documentation">Concerning the <strong>FreeFEM</strong> documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/contributing.html#concerning-the-freefem-compilation-or-usage">Concerning the <strong>FreeFEM</strong> compilation or usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/contributing.html#improve-content">Improve content</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/git-github.html">Git &amp; Github usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/git-github.html#contribution-timeline">Contribution timeline</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Learning by Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/poisson.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/equationsClassification.html">Classification of partial differential equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/membrane.html">Membrane</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/heatExchanger.html">Heat Exchanger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/acoustics.html">Acoustics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/thermalConduction.html">Thermal Conduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/thermalConduction.html#axisymmetry-3d-rod-with-circular-section">Axisymmetry: 3D Rod with circular section</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/thermalConduction.html#a-nonlinear-problem-radiation">A Nonlinear Problem : Radiation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/fanBlade.html">Irrotational Fan Blade Flow and Thermal effects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/fanBlade.html#heat-convection-around-the-airfoil">Heat Convection around the airfoil</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/rotatingHill.html">Pure Convection : The Rotating Hill</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/rotatingHill.html#solution-by-a-characteristics-galerkin-method">Solution by a Characteristics-Galerkin Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/rotatingHill.html#solution-by-discontinuous-galerkin-fem">Solution by Discontinuous-Galerkin FEM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/elasticity.html">The System of elasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/stokes.html">The System of Stokes for Fluids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/navierStokesProjection.html">A projection algorithm for the Navier-Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/navierStokesNewton.html">Newton Method for the Steady Navier-Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/aLargeFluidProblem.html">A Large Fluid Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/complexNumbers.html">An Example with Complex Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/optimalControl.html">Optimal Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/flowWithShocks.html">A Flow with Shocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/heatEquationOptimization.html">Time dependent schema optimization for heat equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/timeDependentStokes.html">Tutorial to write a transient Stokes solver in matrix form</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/wifiPropagation.html">Wifi Propagation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/wifiPropagation.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/wifiPropagation.html#physics">Physics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/wifiPropagation.html#coding">Coding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/wifiPropagation.html#the-domain">The domain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/wifiPropagation.html#lets-create-a-mesh">Let’s create a mesh</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/matlabOctavePlot.html">Plotting in Matlab and Octave</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#d-problem">2D Problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#exporting-data">Exporting Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#importing-data">Importing Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#d-plot-examples">2D Plot Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#id1">3D Plot Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="notations.html">Notations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="notations.html#generalities">Generalities</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#sets-mappings-matrices-vectors">Sets, Mappings, Matrices, Vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#numbers">Numbers</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#differential-calculus">Differential Calculus</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#meshes">Meshes</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#functional-spaces">Functional Spaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#finite-element-spaces">Finite Element Spaces</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Mesh Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-type-mesh-in-2-dimension"><strong>The type mesh in 2 dimension</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#commands-for-2d-mesh-generation">Commands for 2d mesh Generation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#the-command-square">The command <em>square</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#the-command-buildmesh">The command <em>buildmesh</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#mesh-connectivity-and-data">Mesh Connectivity and data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-keyword-triangulate">The keyword “triangulate”</a></li>
<li class="toctree-l4"><a class="reference internal" href="#d-finite-element-space-on-a-boundary">2d Finite Element space on a boundary</a></li>
<li class="toctree-l4"><a class="reference internal" href="#remeshing">Remeshing</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#the-command-movemesh">The command <em>movemesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#the-command-htriangle">The command <em>hTriangle</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#the-command-adaptmesh">The command <em>adaptmesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#the-command-trunc">The command <em>trunc</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#the-command-change">The command <em>change</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#the-command-splitmesh">The command <em>splitmesh</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#meshing-examples">Meshing Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-type-mesh3-in-3-dimension"><strong>The type mesh3 in 3 dimension</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#d-mesh-generation">3d mesh generation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#the-command-cube">The command <em>cube</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#the-command-buildlayers">The command <em>buildlayers</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Remeshing</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id4">The command <em>change</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#meshgenerationtrunc">The command <em>trunc</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#id6">The command <em>movemesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#the-command-extract">The command <em>extract</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#the-command-buildsurface">The command <em>buildSurface</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#the-command-movemesh23">The command <em>movemesh23</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#d-meshing-examples">3d Meshing examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-type-meshs-in-3-dimension"><strong>The type meshS in 3 dimension</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#commands-for-3d-surface-mesh-generation">Commands for 3d surface mesh generation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#the-command-square3">The command <em>square3</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#surface-mesh-builders">surface mesh builders</a></li>
<li class="toctree-l5"><a class="reference internal" href="#d-mesh-generators-combined-with-movemesh23">2D mesh generators combined with  <em>movemesh23</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#id7">Remeshing</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id8">The command <em>trunc</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#id9">The command <em>movemesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#id10">The command <em>change</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#link-with-a-mesh3">Link with a mesh3</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#the-command-gamma">The command <em>Gamma</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#the-command-buildbdmesh">The command <em>buildBdMesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#the-command-savesurfacemesh">The command <em>savesurfacemesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#glue-of-meshs-meshes">Glue of meshS meshes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-type-meshl-in-3-dimension"><strong>The type meshL in 3 dimension</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#commands-for-3d-curve-mesh-generation">Commands for 3d curve mesh generation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#the-command-segment">The command <em>segment</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#id11">The command <em>buildmesh</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#id12">Remeshing</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id13">The command <em>trunc</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#id14">The command <em>movemesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#id15">The command <em>change</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#the-commands-buildbdmesh-and-gamma">The commands <em>buildBdMesh</em> and <em>Gamma</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="#glue-of-meshl-meshes">Glue of meshL meshes</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id16">The command extract</a></li>
<li class="toctree-l5"><a class="reference internal" href="#the-commands-rebuildborder">The commands <em>rebuildBorder</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#the-commands-checkmesh">The commands <em>checkmesh</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tetgen-a-tetrahedral-mesh-generator">TetGen: A tetrahedral mesh generator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reconstruct-refine-a-3d-mesh-with-tetgen">Reconstruct/Refine a 3d mesh with TetGen</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#read-write-statements-for-meshes">Read/Write Statements for meshes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#d-case">2d case</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#format-of-mesh-data">format of  mesh data</a></li>
<li class="toctree-l5"><a class="reference internal" href="#input-output-for-a-mesh">Input/output for a mesh</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#id27">3d case</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id28">format of  mesh data</a></li>
<li class="toctree-l5"><a class="reference internal" href="#input-output-for-a-mesh3">Input/output for a mesh3</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#surface-3d-case">Surface 3d case</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id29">format of  mesh data</a></li>
<li class="toctree-l5"><a class="reference internal" href="#input-output-for-a-meshs">Input/output for a meshS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#medit">Medit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mshmet">Mshmet</a></li>
<li class="toctree-l3"><a class="reference internal" href="#freeyams">FreeYams</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mmg3d">mmg3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-first-3d-isotrope-mesh-adaptation-process">A first 3d isotrope mesh adaptation process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-a-2d-mesh-from-an-isoline">Build a 2d mesh from an isoline</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="finite-element.html">Finite element</a><ul>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#list-of-the-types-of-finite-elements">List of the types of finite elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#use-of-fespace-in-2d">Use of fespace in 2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#use-of-fespace-in-3d">Use of fespace in 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#use-of-fespace-in-surface-3d">Use of fespace in surface 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#finite-element-functions">Finite Element functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#lagrangian-finite-elements">Lagrangian Finite Elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="finite-element.html#p0-element">P0-element</a></li>
<li class="toctree-l4"><a class="reference internal" href="finite-element.html#p1-element">P1-element</a></li>
<li class="toctree-l4"><a class="reference internal" href="finite-element.html#p2-element">P2-element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#surface-lagrangian-finite-elements">Surface Lagrangian Finite Elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="finite-element.html#definition-of-the-surface-p1-lagragian-element">Definition of the surface P1 Lagragian element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#p1-nonconforming-element">P1 Nonconforming Element</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#other-fe-space">Other FE-space</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#vector-valued-fe-function">Vector Valued FE-function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="finite-element.html#raviart-thomas-element">Raviart-Thomas Element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#a-fast-finite-element-interpolator">A Fast Finite Element Interpolator</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#keywords-problem-and-solve">Keywords: Problem and Solve</a><ul>
<li class="toctree-l4"><a class="reference internal" href="finite-element.html#weak-form-and-boundary-condition">Weak Form and Boundary Condition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#parameters-affecting-solve-and-problem">Parameters affecting solve and problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#problem-definition">Problem definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#numerical-integration">Numerical Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#variational-form-sparse-matrix-pde-data-vector">Variational Form, Sparse Matrix, PDE Data Vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#interpolation-matrix">Interpolation matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="finite-element.html#finite-elements-connectivity">Finite elements connectivity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#plot">Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-gnuplot">Link with gnuplot</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-medit">Link with medit</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-paraview">Link with Paraview</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-matlab-and-octave">Link with Matlab© and Octave</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="algorithms-and-optimization.html">Algorithms &amp; Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="algorithms-and-optimization.html#conjugate-gradient-gmres">Conjugate Gradient/GMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithms-and-optimization.html#algorithms-for-unconstrained-optimization">Algorithms for Unconstrained Optimization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="algorithms-and-optimization.html#example-of-usage-for-bfgs-or-cmaes">Example of usage for BFGS or CMAES</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="algorithms-and-optimization.html#ipopt">IPOPT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="algorithms-and-optimization.html#short-description-of-the-algorithm">Short description of the algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="algorithms-and-optimization.html#ipopt-in-freefem">IPOPT in <strong>FreeFEM</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="algorithms-and-optimization.html#some-short-examples-using-ipopt">Some short examples using IPOPT</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithms-and-optimization.html#d-constrained-minimum-surface-with-ipopt">3D constrained minimum surface with IPOPT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="algorithms-and-optimization.html#area-and-volume-expressions">Area and volume expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="algorithms-and-optimization.html#derivatives">Derivatives</a></li>
<li class="toctree-l4"><a class="reference internal" href="algorithms-and-optimization.html#the-problem-and-its-script">The problem and its script</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="algorithms-and-optimization.html#the-nlopt-optimizers">The nlOpt optimizers</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithms-and-optimization.html#optimization-with-mpi">Optimization with MPI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parallelization.html">Parallelization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parallelization.html#mpi">MPI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-keywords">MPI Keywords</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-constants">MPI Constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-constructor">MPI Constructor</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-functions">MPI Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-communicator-operator">MPI Communicator operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#schwarz-example-in-parallel">Schwarz example in parallel</a><ul>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#true-parallel-schwarz-example">True parallel Schwarz example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="parallelization.html#parallel-sparse-solvers">Parallel sparse solvers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#using-parallel-sparse-solvers-in-freefem">Using parallel sparse solvers in <strong>FreeFEM</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#sparse-direct-solver">Sparse direct solver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#mumps-solver">MUMPS solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#superlu-distributed-solver">SuperLU distributed solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#pastix-solver">PaStiX solver</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#parallel-sparse-iterative-solver">Parallel sparse iterative solver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#parms-solver">pARMS solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#interfacing-with-hips">Interfacing with HIPS</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#interfacing-with-hypre">Interfacing with HYPRE</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#domain-decomposition">Domain decomposition</a><ul>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#communicators-and-groups">Communicators and groups</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#process">Process</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#points-to-points-communicators">Points to Points communicators</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#global-operations">Global operations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="petsc/index.html">PETSc and SLEPc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="petsc/examples.html">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="petsc/examples.html#linear-problems">Linear problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="petsc/examples.html#nonlinear-problems">Nonlinear problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="petsc/examples.html#time-steppers-and-optimizers">Time steppers and optimizers</a></li>
<li class="toctree-l4"><a class="reference internal" href="petsc/examples.html#eigenvalue-problems">Eigenvalue problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="petsc/examples.html#miscellaneous">Miscellaneous</a></li>
<li class="toctree-l4"><a class="reference internal" href="petsc/examples.html#reproducible-science">Reproducible science</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="BEM.html">The Boundary Element Method</a><ul>
<li class="toctree-l3"><a class="reference internal" href="BEM.html#introduction-to-the-boundary-element-method-bem">Introduction to the Boundary Element Method (BEM)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#model-problem">Model problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#boundary-integral-operators">Boundary Integral Operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#the-bemtool-library">the BEMTool library</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#hierarchical-matrices">Hierarchical matrices</a><ul>
<li class="toctree-l5"><a class="reference internal" href="BEM.html#low-rank-approximation">Low-rank approximation</a></li>
<li class="toctree-l5"><a class="reference internal" href="BEM.html#hierarchical-block-structure">Hierarchical block structure</a></li>
<li class="toctree-l5"><a class="reference internal" href="BEM.html#the-htool-library">The Htool library</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="BEM.html#solve-a-bem-problem-with-freefem">Solve a BEM problem with FreeFEM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#build-the-geometry">Build the geometry</a><ul>
<li class="toctree-l5"><a class="reference internal" href="BEM.html#d">2D</a></li>
<li class="toctree-l5"><a class="reference internal" href="BEM.html#id3">3D</a></li>
<li class="toctree-l5"><a class="reference internal" href="BEM.html#orientation-of-normal-vector">Orientation of normal vector</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#define-the-type-of-operator">Define the type of operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#define-the-variational-problem">Define the variational problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#assemble-the-h-matrix">Assemble the H-Matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#solve-the-linear-system">Solve the linear system</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#compute-the-solution">Compute the solution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="BEM.html#d-example-script">2D example script</a></li>
<li class="toctree-l3"><a class="reference internal" href="BEM.html#bem-for-maxwell-s-equations">BEM for Maxwell’s equations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#efie-for-the-scattering-problem">EFIE for the scattering problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#maxwell-bem-problem-in-freefem">Maxwell BEM problem in FreeFEM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="composite.html">Composite finite element spaces <span class="red">NEW!</span></a><ul>
<li class="toctree-l3"><a class="reference internal" href="composite.html#limitations-of-the-current-syntax">Limitations of the current syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="composite.html#definition-of-composite-spaces">Definition of composite spaces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="composite.html#first-examples">First examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="composite.html#stokes-with-p2-iso-p1-elements">Stokes with P2-iso-P1 elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="composite.html#using-solve-or-problem">using <em>solve</em> or <em>problem</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="composite.html#using-varf-and-matrix">using <em>varf</em> and <em>matrix</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="composite.html#parallel-assembly-and-solution">Parallel assembly and solution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="composite.html#with-mumps">with <em>MUMPS</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="composite.html#with-petsc">with <em>PETSc</em></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html">Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#gsl">gsl</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#ffrandom">ffrandom</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#mmap-semaphore">mmap / semaphore</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="developers.html">Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="developers.html#file-formats">File formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="developers.html#mesh-file-data-structure">Mesh file data structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#bb-file-type-to-store-solutions">bb file type to Store Solutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#id1">BB file type to store solutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#metric-file">Metric file</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#list-of-am-fmt-amdba-meshes">List of AM_FMT, AMDBA Meshes</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#sol-and-solb-files">sol and solb files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="developers.html#adding-a-new-finite-element">Adding a new finite element</a><ul>
<li class="toctree-l4"><a class="reference internal" href="developers.html#some-notations">Some notations</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#which-class-to-add">Which class to add?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="developers.html#dynamical-link">Dynamical link</a><ul>
<li class="toctree-l4"><a class="reference internal" href="developers.html#a-first-example-myfunction-cpp">A first example myfunction.cpp</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#example-discrete-fast-fourier-transform">Example: Discrete Fast Fourier Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#load-module-for-dervieux-p0-p1-finite-volume-method">Load Module for Dervieux P0-P1 Finite Volume Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#more-on-adding-a-new-finite-element">More on Adding a new finite element</a><ul>
<li class="toctree-l5"><a class="reference internal" href="developers.html#the-bernardi-raugel-element">The Bernardi-Raugel Element</a></li>
<li class="toctree-l5"><a class="reference internal" href="developers.html#the-morley-element">The Morley Element</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ffddm/index.html">ffddm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html">Domain Decomposition (DD)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#mesh-decomposition">Mesh Decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#distributed-linear-algebra">Distributed Linear Algebra</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#partition-of-unity-matrices-poum">Partition of Unity Matrices (POUM)</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#distributed-scalar-product">Distributed scalar product</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#update">Update</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#distributed-matrix-and-vector-resulting-from-a-variational-formulation">Distributed Matrix and Vector resulting from a variational formulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#distributed-linear-solvers">Distributed Linear Solvers</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#distributed-direct-solvers">Distributed Direct Solvers</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#schwarz-methods">Schwarz methods</a><ul>
<li class="toctree-l6"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#restricted-additive-schwarz-ras">Restricted Additive Schwarz (RAS)</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#optimized-restricted-additive-schwarz-oras">Optimized Restricted Additive Schwarz (ORAS)</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#two-level-methods">Two level methods</a><ul>
<li class="toctree-l7"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#coarse-mesh">Coarse Mesh</a></li>
<li class="toctree-l7"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#geneo">GenEO</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/documentation.html">ffddm documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#minimal-example">Minimal example</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#overlapping-mesh-decomposition">Overlapping mesh decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#local-finite-element-spaces">Local finite element spaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#define-the-problem-to-solve">Define the problem to solve</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#one-level-preconditioners">One level preconditioners</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#two-level-preconditioners">Two level preconditioners</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#building-the-geneo-coarse-space">Building the GenEO coarse space</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#building-the-coarse-space-from-a-coarse-mesh">Building the coarse space from a coarse mesh</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#solving-the-linear-system">Solving the linear system</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#using-hpddm-within-ffddm">Using <em>HPDDM</em> within <em>ffddm</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#advanced-use">Advanced use</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#interpolation-between-two-distributed-finite-element-spaces">Interpolation between two distributed finite element spaces</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#local-finite-element-spaces-for-non-lagrange-finite-elements">Local finite element spaces for non Lagrange finite elements</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#inexact-coarse-solves-for-two-level-methods">Inexact coarse solves for two level methods</a><ul>
<li class="toctree-l6"><a class="reference internal" href="ffddm/documentation.html#coarse-mesh-and-inexact-coarse-solve">Coarse mesh and inexact coarse solve</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/parameters.html">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/parameters.html#command-line-arguments">Command-line arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/parameters.html#global-parameters">Global parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/tutorial.html">Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#what-is-ffddm">What is <strong>ffddm</strong> ?</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#why-domain-decomposition-methods">Why Domain Decomposition Methods ?</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-1-decompose-the-mesh">Step 1: Decompose the mesh</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-2-define-your-finite-element">Step 2: Define your finite element</a><ul>
<li class="toctree-l6"><a class="reference internal" href="ffddm/tutorial.html#distributed-vectors-and-restriction-operators">Distributed vectors and restriction operators</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/tutorial.html#partition-of-unity">Partition of unity</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/tutorial.html#data-exchange-between-neighbors">Data exchange between neighbors</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-3-define-your-problem">Step 3: Define your problem</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#summary-so-far-translating-your-sequential-freefem-script">Summary so far: translating your sequential <em>FreeFEM</em> script</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#id1">Step 1: Decompose the mesh</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#solve-the-linear-system">Solve the linear system</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#solve-the-linear-system-with-the-parallel-direct-solver-mumps">Solve the linear system with the parallel direct solver <em>MUMPS</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-4-define-the-one-level-dd-preconditioner">Step 4: Define the one level DD preconditioner</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-5-solve-the-linear-system-with-preconditioned-gmres">Step 5: Solve the linear system with preconditioned GMRES</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#define-a-two-level-dd-preconditioner">Define a two level DD preconditioner</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#build-the-geneo-coarse-space">Build the GenEO coarse space</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#build-the-coarse-space-from-a-coarse-mesh">Build the coarse space from a coarse mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#use-hpddm-within-ffddm">Use <strong>HPDDM</strong> within <strong>ffddm</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#some-results-heterogeneous-3d-elasticity-with-geneo">Some results: Heterogeneous 3D elasticity with GenEO</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#some-results-2-level-dd-for-maxwell-equations-scattering-from-the-cobra-cavity">Some results: 2-level DD for Maxwell equations, scattering from the COBRA cavity</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#id2">Some results: 2-level DD for Maxwell equations, scattering from the COBRA cavity</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/examples.html">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references/index.html">Language references</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../references/types.html">Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#standard-types">Standard types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#int">int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#bool">bool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#real">real</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#complex">complex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#string">string</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#mesh-design">Mesh design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#border">border</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#mesh">mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#mesh3">mesh3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#finite-element-space-design">Finite element space design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#fespace">fespace</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#macro-design">Macro design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#macro">macro</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#newmacro-endmacro">NewMacro / EndMacro</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#ifmacro">IFMACRO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#endifmacro">ENDIFMACRO</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#functions-design">Functions design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#func">func</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#elementary-functions">Elementary functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#random-functions">Random functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#fe-functions">FE-functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#problem-design">Problem design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#problem">problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#solve">solve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#varf">varf</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#array">Array</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#array-index">Array index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#array-size">Array size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#array-sort">Array sort</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#double-array">Double array</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#array-of-fe-functions">Array of FE functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#map-arrays">Map arrays</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#matrix">matrix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#matrix-size">Matrix size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#matrix-resize">Matrix resize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#matrix-diagonal">Matrix diagonal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#matrix-renumbering">Matrix renumbering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#complex-matrix">Complex matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#dot-product-outer-product">Dot product / Outer product</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#matrix-inversion">Matrix inversion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/global-variables.html">Global variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#area">area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#argv">ARGV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#boundaryedge">BoundaryEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#cg">CG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#cholesky">Cholesky</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#crout">Crout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#edgeorientation">edgeOrientation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#false">false</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#gmres">GMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#htriangle">hTriangle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#include">include</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#internaledge">InternalEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#label">label</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#lenedge">lenEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#load">load</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#lu">LU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#n">N</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#ntonedge">nTonEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#nuedge">nuEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#nutriangle">nuTriangle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#p">P</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#pi">pi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#region">region</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#sparsesolver">sparsesolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#true">true</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#verbosity">verbosity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#version">version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#volume">volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#x">x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#y">y</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#z">z</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/quadrature-formulae.html">Quadrature formulae</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/quadrature-formulae.html#int1d">int1d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#notations">Notations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf1pe">qf1pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf2pe">qf2pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf3pe-default">qf3pE   <em>(default)</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf4pe">qf4pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf5pe">qf5pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf1pelump">qf1pElump</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/quadrature-formulae.html#int2d">int2d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf1pt">qf1pT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf2pt">qf2pT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf5pt-default">qf5pT   <em>(default)</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf1ptlump">qf1pTlump</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf2pt4p1">qf2pT4P1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf7pt">qf7pT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf9pt">qf9pT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/quadrature-formulae.html#int3d">int3d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qfv1">qfV1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qfv2">qfV2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qfv5-default">qfV5   <em>(default)</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qfv1lump">qfV1lump</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/operators.html">Operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#addition-operator">Addition operator +</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#increment-operator">Increment operator ++</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#substraction-operator">Substraction operator -</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#decrement-operator">Decrement operator –</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#multiplication-operator">Multiplication operator *</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#equal-operator">Equal operator =</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#comparison-operator">Comparison operator ==</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#id1">Comparison operator !=</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#id2">Comparison operator &lt;, &lt;=</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#id3">Comparison operator &gt;, &gt;=</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#compound-operator">Compound operator <cite>+=</cite>, <cite>-=</cite>, <cite>*=</cite>, <cite>/=</cite></a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#term-by-term-multiplication">Term by term multiplication .*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#division-operator">Division operator /</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#term-by-term-division">Term by term division ./</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#remainder-from-the-division">Remainder from the division %</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#power-operator">Power operator ^</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#inverse-of-a-matrix-1">Inverse of a matrix ^-1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#transpose-operator">Transpose operator ‘</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#tensor-scalar-product">Tensor scalar product :</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#c-arithmetical-if-expression">C++ arithmetical if expression ? :</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/loops.html">Loops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#for">for</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#if">if</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#else">else</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#while">while</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#continue">continue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#break">break</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#try">try</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#catch">catch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#implicit-loop">Implicit loop</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/IO.html">I/O</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#cout">cout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#cin">cin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#endl">endl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#ifstream">ifstream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#ofstream">ofstream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#append">append</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#binary">binary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#seekg">seekg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#tellg">tellg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#flush">flush</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#getline">getline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#output-format">Output format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#precision">precision</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#scientific">scientific</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#fixed">fixed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#showbase">showbase</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#noshowbase">noshowbase</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#showpos">showpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#noshowpos">noshowpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#default">default</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#setw">setw</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/functions.html">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#abs">abs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#acos">acos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#acosh">acosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#adaptmesh">adaptmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#adj">adj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#affinecg">AffineCG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#affinegmres">AffineGMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#arg">arg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#asin">asin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#asinh">asinh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#assert">assert</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#atan">atan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#atan2">atan2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#atanh">atanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#atoi">atoi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#atof">atof</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#bfgs">BFGS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#buildmesh">buildmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#ceil">ceil</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#change">change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#checkmovemesh">checkmovemesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#chi">chi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#clock">clock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#complexeigenvalue">complexEigenValue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#conj">conj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#convect">convect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#copysign">copysign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#cos">cos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#cosh">cosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#diffnp">diffnp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#diffpos">diffpos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dist">dist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dumptable">dumptable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dx">dx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dxx">dxx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dxy">dxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dxz">dxz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dy">dy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dyx">dyx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dyy">dyy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dyz">dyz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dz">dz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dzx">dzx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dzy">dzy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dzz">dzz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#eigenvalue">EigenValue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#emptymesh">emptymesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#erf">erf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#erfc">erfc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#exec">exec</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#exit">exit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#exp">exp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#fdim">fdim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#floor">floor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#fmax">fmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#fmin">fmin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#fmod">fmod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#imag">imag</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#int1d">int1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#int2d">int2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#int3d">int3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#intalledges">intalledges</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#intallfaces">intallfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#interpolate">interpolate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#invdiff">invdiff</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#invdiffnp">invdiffnp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#invdiffpos">invdiffpos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#isinf">isInf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#isnan">isNaN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#isnormal">isNormal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#j0">j0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#j1">j1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#jn">jn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#jump">jump</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#linearcg">LinearCG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#lineargmres">LinearGMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#lgamma">lgamma</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#log">log</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#log10">log10</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#lrint">lrint</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#lround">lround</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#ltime">ltime</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#max">max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#min">min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#movemesh">movemesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#nan">NaN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#nlcg">NLCG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#on">on</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#plot">plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#polar">polar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#pow">pow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#projection">projection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randinit">randinit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randint31">randint31</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randint32">randint32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randreal1">randreal1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randreal2">randreal2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randreal3">randreal3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randres53">randres53</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#readmesh">readmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#readmesh3">readmesh3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#real">real</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#rint">rint</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#round">round</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#savemesh">savemesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#set">set</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#sign">sign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#signbit">signbit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#sin">sin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#sinh">sinh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#sort">sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#splitmesh">splitmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#sqrt">sqrt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#square">square</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#storagetotal">storagetotal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#storageused">storageused</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#strtod">strtod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#strtol">strtol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#swap">swap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#system">system</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#tan">tan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#tanh">tanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#tgamma">tgamma</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#time">time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#trace">trace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#trunc">trunc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#y0">y0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#y1">y1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#yn">yn</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/external-libraries.html">External libraries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#aniso">aniso</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#boundaniso">boundaniso</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#bec">BEC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#bectrap">BECtrap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gpvortex">GPvortex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dxgpvortex">dxGPVortex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dygpvortex">dyGPVortex</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#binary-i-o">Binary I/O</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#loadvec">LoadVec</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#loadflag">LoadFlag</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#savevec">SaveVec</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#flag">flag</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#buildlayer">buildlayer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#buildlayers">buildlayers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#closepoints">ClosePoints</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#radiussearch">radiusSearch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#voisinage">Voisinage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#neighborhood">neighborhood</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#closepoints2">ClosePoints2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#closepoint">ClosePoint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#closepoints1">ClosePoints1</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#curvature">Curvature</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#extractborder">extractborder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id17">curvature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#raxicurvature">raxicurvature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#curves">curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#setecurveabcisse">setecurveabcisse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#equiparameter">equiparameter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#tresca">Tresca</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#vonmises">VonMises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#dfft">dfft</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#plandfft">plandfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#execute">execute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#delete">delete</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id28">dfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#map">map</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#distance">distance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id31">distance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#checkdist">checkdist</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#dxwriter">DxWriter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dxaddmesh">Dxaddmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dxaddtimeseries">Dxaddtimeseries</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dxaddsol2ts">Dxaddsol2ts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#element-p1bl">Element_P1bl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#expert">expert</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#exactpartition">exactpartition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id38">exactpartition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ff-airybiry">ff-AiryBiry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#airy">airy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#biry">biry</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ff-cmaes">ff-cmaes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#cmaes">cmaes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ff-gsl-awk">ff_gsl_awk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfugaussianp">gslcdfugaussianP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfugaussianq">gslcdfugaussianQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfugaussianpinv">gslcdfugaussianPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfugaussianqinv">gslcdfugaussianQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgaussianp">gslcdfgaussianP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgaussianq">gslcdfgaussianQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgaussianpinv">gslcdfgaussianPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgaussianqinv">gslcdfgaussianQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgammap">gslcdfgammaP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgammaq">gslcdfgammaQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgammapinv">gslcdfgammaPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgammaqinv">gslcdfgammaQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfcauchyp">gslcdfcauchyP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfcauchyq">gslcdfcauchyQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfcauchypinv">gslcdfcauchyPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfcauchyqinv">gslcdfcauchyQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflaplacep">gslcdflaplaceP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflaplaceq">gslcdflaplaceQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflaplacepinv">gslcdflaplacePinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflaplaceqinv">gslcdflaplaceQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfrayleighp">gslcdfrayleighP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfrayleighq">gslcdfrayleighQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfrayleighpinv">gslcdfrayleighPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfrayleighqinv">gslcdfrayleighQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfchisqp">gslcdfchisqP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfchisqq">gslcdfchisqQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfchisqpinv">gslcdfchisqPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfchisqqinv">gslcdfchisqQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfexponentialp">gslcdfexponentialP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfexponentialq">gslcdfexponentialQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfexponentialpinv">gslcdfexponentialPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfexponentialqinv">gslcdfexponentialQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfexppowp">gslcdfexppowP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfexppowq">gslcdfexppowQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdftdistp">gslcdftdistP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdftdistq">gslcdftdistQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdftdistpinv">gslcdftdistPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdftdistqinv">gslcdftdistQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdffdistp">gslcdffdistP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdffdistq">gslcdffdistQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdffdistpinv">gslcdffdistPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdffdistqinv">gslcdffdistQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfbetap">gslcdfbetaP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfbetaq">gslcdfbetaQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfbetapinv">gslcdfbetaPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfbetaqinv">gslcdfbetaQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfflatp">gslcdfflatP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfflatq">gslcdfflatQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfflatpinv">gslcdfflatPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfflatqinv">gslcdfflatQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflognormalp">gslcdflognormalP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflognormalq">gslcdflognormalQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflognormalpinv">gslcdflognormalPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflognormalqinv">gslcdflognormalQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel1p">gslcdfgumbel1P</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel1q">gslcdfgumbel1Q</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel1pinv">gslcdfgumbel1Pinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel1qinv">gslcdfgumbel1Qinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel2p">gslcdfgumbel2P</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel2q">gslcdfgumbel2Q</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel2pinv">gslcdfgumbel2Pinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel2qinv">gslcdfgumbel2Qinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfweibullp">gslcdfweibullP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfweibullq">gslcdfweibullQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfweibullpinv">gslcdfweibullPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfweibullqinv">gslcdfweibullQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfparetop">gslcdfparetoP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfparetoq">gslcdfparetoQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfparetopinv">gslcdfparetoPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfparetoqinv">gslcdfparetoQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflogisticp">gslcdflogisticP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflogisticq">gslcdflogisticQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflogisticpinv">gslcdflogisticPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflogisticqinv">gslcdflogisticQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfbinomialp">gslcdfbinomialP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfbinomialq">gslcdfbinomialQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfpoissonp">gslcdfpoissonP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfpoissonq">gslcdfpoissonQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgeometricp">gslcdfgeometricP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgeometricq">gslcdfgeometricQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfnegativebinomialp">gslcdfnegativebinomialP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfnegativebinomialq">gslcdfnegativebinomialQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfpascalp">gslcdfpascalP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfpascalq">gslcdfpascalQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranbernoullipdf">gslranbernoullipdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranbeta">gslranbeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranbetapdf">gslranbetapdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranbinomialpdf">gslranbinomialpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranexponential">gslranexponential</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranexponentialpdf">gslranexponentialpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranexppow">gslranexppow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranexppowpdf">gslranexppowpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrancauchy">gslrancauchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrancauchypdf">gslrancauchypdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranchisq">gslranchisq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranchisqpdf">gslranchisqpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranerlang">gslranerlang</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranerlangpdf">gslranerlangpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranfdist">gslranfdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranfdistpdf">gslranfdistpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranflat">gslranflat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranflatpdf">gslranflatpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangamma">gslrangamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangammaint">gslrangammaint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangammapdf">gslrangammapdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangammamt">gslrangammamt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangammaknuth">gslrangammaknuth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangaussian">gslrangaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangaussianratiomethod">gslrangaussianratiomethod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangaussianziggurat">gslrangaussianziggurat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangaussianpdf">gslrangaussianpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranugaussian">gslranugaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranugaussianratiomethod">gslranugaussianratiomethod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranugaussianpdf">gslranugaussianpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangaussiantail">gslrangaussiantail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangaussiantailpdf">gslrangaussiantailpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranugaussiantail">gslranugaussiantail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranugaussiantailpdf">gslranugaussiantailpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlandau">gslranlandau</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlandaupdf">gslranlandaupdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangeometricpdf">gslrangeometricpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangumbel1">gslrangumbel1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangumbel1pdf">gslrangumbel1pdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangumbel2">gslrangumbel2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangumbel2pdf">gslrangumbel2pdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlogistic">gslranlogistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlogisticpdf">gslranlogisticpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlognormal">gslranlognormal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlognormalpdf">gslranlognormalpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlogarithmicpdf">gslranlogarithmicpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrannegativebinomialpdf">gslrannegativebinomialpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranpascalpdf">gslranpascalpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranpareto">gslranpareto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranparetopdf">gslranparetopdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranpoissonpdf">gslranpoissonpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranrayleigh">gslranrayleigh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranrayleighpdf">gslranrayleighpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranrayleightail">gslranrayleightail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranrayleightailpdf">gslranrayleightailpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrantdist">gslrantdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrantdistpdf">gslrantdistpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlaplace">gslranlaplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlaplacepdf">gslranlaplacepdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlevy">gslranlevy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranweibull">gslranweibull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranweibullpdf">gslranweibullpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyai">gslsfairyAi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairybi">gslsfairyBi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyaiscaled">gslsfairyAiscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairybiscaled">gslsfairyBiscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyaideriv">gslsfairyAideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairybideriv">gslsfairyBideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyaiderivscaled">gslsfairyAiderivscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairybiderivscaled">gslsfairyBiderivscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyzeroai">gslsfairyzeroAi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyzerobi">gslsfairyzeroBi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyzeroaideriv">gslsfairyzeroAideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyzerobideriv">gslsfairyzeroBideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselj0">gslsfbesselJ0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselj1">gslsfbesselJ1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseljn">gslsfbesselJn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbessely0">gslsfbesselY0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbessely1">gslsfbesselY1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselyn">gslsfbesselYn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseli0">gslsfbesselI0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseli1">gslsfbesselI1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselin">gslsfbesselIn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseli0scaled">gslsfbesselI0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseli1scaled">gslsfbesselI1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselinscaled">gslsfbesselInscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselk0">gslsfbesselK0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselk1">gslsfbesselK1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselkn">gslsfbesselKn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselk0scaled">gslsfbesselK0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselk1scaled">gslsfbesselK1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselknscaled">gslsfbesselKnscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id43">gslsfbesselj0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id44">gslsfbesselj1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselj2">gslsfbesselj2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseljl">gslsfbesseljl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id45">gslsfbessely0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id46">gslsfbessely1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbessely2">gslsfbessely2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselyl">gslsfbesselyl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id47">gslsfbesseli0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id48">gslsfbesseli1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseli2scaled">gslsfbesseli2scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselilscaled">gslsfbesselilscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id49">gslsfbesselk0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id50">gslsfbesselk1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselk2scaled">gslsfbesselk2scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselklscaled">gslsfbesselklscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseljnu">gslsfbesselJnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselynu">gslsfbesselYnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselinuscaled">gslsfbesselInuscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselinu">gslsfbesselInu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselknuscaled">gslsfbesselKnuscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselknu">gslsfbesselKnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbessellnknu">gslsfbessellnKnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselzeroj0">gslsfbesselzeroJ0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselzeroj1">gslsfbesselzeroJ1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselzerojnu">gslsfbesselzeroJnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfclausen">gslsfclausen</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhydrogenicr1">gslsfhydrogenicR1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdawson">gslsfdawson</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdebye1">gslsfdebye1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdebye2">gslsfdebye2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdebye3">gslsfdebye3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdebye4">gslsfdebye4</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdebye5">gslsfdebye5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdebye6">gslsfdebye6</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdilog">gslsfdilog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfmultiply">gslsfmultiply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellintkcomp">gslsfellintKcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellintecomp">gslsfellintEcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellintpcomp">gslsfellintPcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellintdcomp">gslsfellintDcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellintf">gslsfellintF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellinte">gslsfellintE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellintrc">gslsfellintRC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsferfc">gslsferfc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflogerfc">gslsflogerfc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsferf">gslsferf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsferfz">gslsferfZ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsferfq">gslsferfQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhazard">gslsfhazard</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexp">gslsfexp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpmult">gslsfexpmult</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpm1">gslsfexpm1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexprel">gslsfexprel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexprel2">gslsfexprel2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpreln">gslsfexpreln</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpinte1">gslsfexpintE1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpinte2">gslsfexpintE2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpinten">gslsfexpintEn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpinte1scaled">gslsfexpintE1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpinte2scaled">gslsfexpintE2scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpintenscaled">gslsfexpintEnscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpintei">gslsfexpintEi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpinteiscaled">gslsfexpintEiscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfshi">gslsfShi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfchi">gslsfChi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpint3">gslsfexpint3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfsi">gslsfSi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfci">gslsfCi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfatanint">gslsfatanint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidiracm1">gslsffermidiracm1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidirac0">gslsffermidirac0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidirac1">gslsffermidirac1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidirac2">gslsffermidirac2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidiracint">gslsffermidiracint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidiracmhalf">gslsffermidiracmhalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidirachalf">gslsffermidirachalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidirac3half">gslsffermidirac3half</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidiracinc0">gslsffermidiracinc0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflngamma">gslsflngamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgamma">gslsfgamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgammastar">gslsfgammastar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgammainv">gslsfgammainv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsftaylorcoeff">gslsftaylorcoeff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffact">gslsffact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdoublefact">gslsfdoublefact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflnfact">gslsflnfact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflndoublefact">gslsflndoublefact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflnchoose">gslsflnchoose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfchoose">gslsfchoose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflnpoch">gslsflnpoch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpoch">gslsfpoch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpochrel">gslsfpochrel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgammaincq">gslsfgammaincQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgammaincp">gslsfgammaincP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgammainc">gslsfgammainc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflnbeta">gslsflnbeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbeta">gslsfbeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbetainc">gslsfbetainc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgegenpoly1">gslsfgegenpoly1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgegenpoly2">gslsfgegenpoly2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgegenpoly3">gslsfgegenpoly3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgegenpolyn">gslsfgegenpolyn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhyperg0f1">gslsfhyperg0F1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhyperg1f1int">gslsfhyperg1F1int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhyperg1f1">gslsfhyperg1F1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhyperguint">gslsfhypergUint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhypergu">gslsfhypergU</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhyperg2f0">gslsfhyperg2F0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflaguerre1">gslsflaguerre1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflaguerre2">gslsflaguerre2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflaguerre3">gslsflaguerre3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflaguerren">gslsflaguerren</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflambertw0">gslsflambertW0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflambertwm1">gslsflambertWm1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendrepl">gslsflegendrePl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendrep1">gslsflegendreP1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendrep2">gslsflegendreP2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendrep3">gslsflegendreP3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreq0">gslsflegendreQ0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreq1">gslsflegendreQ1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreql">gslsflegendreQl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreplm">gslsflegendrePlm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendresphplm">gslsflegendresphPlm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendrearraysize">gslsflegendrearraysize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfconicalphalf">gslsfconicalPhalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfconicalpmhalf">gslsfconicalPmhalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfconicalp0">gslsfconicalP0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfconicalp1">gslsfconicalP1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfconicalpsphreg">gslsfconicalPsphreg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfconicalpcylreg">gslsfconicalPcylreg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreh3d0">gslsflegendreH3d0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreh3d1">gslsflegendreH3d1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreh3d">gslsflegendreH3d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflog">gslsflog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflogabs">gslsflogabs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflog1plusx">gslsflog1plusx</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflog1plusxmx">gslsflog1plusxmx</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpowint">gslsfpowint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpsiint">gslsfpsiint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpsi">gslsfpsi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpsi1piy">gslsfpsi1piy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpsi1int">gslsfpsi1int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpsi1">gslsfpsi1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpsin">gslsfpsin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfsynchrotron1">gslsfsynchrotron1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfsynchrotron2">gslsfsynchrotron2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsftransport2">gslsftransport2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsftransport3">gslsftransport3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsftransport4">gslsftransport4</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsftransport5">gslsftransport5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfsin">gslsfsin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfcos">gslsfcos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhypot">gslsfhypot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfsinc">gslsfsinc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflnsinh">gslsflnsinh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflncosh">gslsflncosh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfanglerestrictsymm">gslsfanglerestrictsymm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfanglerestrictpos">gslsfanglerestrictpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfzetaint">gslsfzetaint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfzeta">gslsfzeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfzetam1">gslsfzetam1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfzetam1int">gslsfzetam1int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhzeta">gslsfhzeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfetaint">gslsfetaint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfeta">gslsfeta</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ff-ipopt">ff-Ipopt</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#ipopt">IPOPT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#fflapack">fflapack</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#inv">inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dgeev">dgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#zgeev">zgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#geev">geev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id56">geev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dggev">dggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#zggev">zggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dsygvd">dsygvd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dgesdd">dgesdd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#zhegv">zhegv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dsyev">dsyev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#zheev">zheev</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ff-mmap-semaphore">ff-mmap-semaphore</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#wait">Wait</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#trywait">trywait</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#post">Post</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#msync">msync</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#read">Read</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#write">Write</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ffnewuoa">ffnewuoa</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#newuoa">newuoa</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ff-nlopt">ff-NLopt</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirect">nloptDIRECT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirectl">nloptDIRECTL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirectlrand">nloptDIRECTLRand</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirectscal">nloptDIRECTScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirectnoscal">nloptDIRECTNoScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirectlnoscal">nloptDIRECTLNoScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirectlrandnoscal">nloptDIRECTLRandNoScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptorigdirect">nloptOrigDIRECT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptorigdirectl">nloptOrigDIRECTL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptstogo">nloptStoGO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptstogorand">nloptStoGORand</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptlbfgs">nloptLBFGS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptpraxis">nloptPRAXIS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptvar1">nloptVar1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptvar2">nloptVar2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nlopttnewton">nloptTNewton</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nlopttnewtonrestart">nloptTNewtonRestart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nlopttnewtonprecond">nloptTNewtonPrecond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nlopttnewtonprecondrestart">nloptTNewtonPrecondRestart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptcrs2">nloptCRS2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptmma">nloptMMA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptcobyla">nloptCOBYLA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptnewuoa">nloptNEWUOA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptnewuoabound">nloptNEWUOABound</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptneldermead">nloptNelderMead</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptsbplx">nloptSbplx</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptbobyqa">nloptBOBYQA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptisres">nloptISRES</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptslsqp">nloptSLSQP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptmlsl">nloptMLSL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptmlsllds">nloptMLSLLDS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptauglag">nloptAUGLAG</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptauglageq">nloptAUGLAGEQ</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ffrandom">ffrandom</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#srandomdev">srandomdev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#srandom">srandom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#random">random</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#freefemqa">FreeFemQA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#meshgenqa">MeshGenQA</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#freeyams">freeyams</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id109">freeyams</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#gmsh">gmsh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gmshload">gmshload</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gmshload3">gmshload3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#savegmsh">savegmsh</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#gsl">gsl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslpolysolvequadratic">gslpolysolvequadratic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslpolysolvecubic">gslpolysolvecubic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslpolycomplexsolve">gslpolycomplexsolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrnguniform">gslrnguniform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrnguniformpos">gslrnguniformpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslname">gslname</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrngget">gslrngget</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrngmin">gslrngmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrngmax">gslrngmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrngset">gslrngset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrngtype">gslrngtype</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ilut">ilut</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#applyilutprecond">applyIlutPrecond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#makeilutprecond">makeIlutPrecond</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#iohdf5">iohdf5</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#savehdf5sol">savehdf5sol</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#iovtk">iovtk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#savevtk">savevtk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#vtkload">vtkload</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#vtkload3">vtkload3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#isoline">isoline</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id128">isoline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#curve">Curve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#area">Area</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#findallocalmin">findallocalmin</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#lapack">lapack</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id133">inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id135">dgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id137">zgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id139">geev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id141">dggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id143">zggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id145">dsygvd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id147">dgesdd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id149">zhegv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id151">dsyev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id153">zheev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dgelsy">dgelsy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#lgbmo">lgbmo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#bmo">bmo</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mat-dervieux">mat_dervieux</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#matupwind1">MatUpWind1</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mat-psi">mat_psi</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#matupwind0">MatUpWind0</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#medit">medit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id159">medit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#savesol">savesol</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#readsol">readsol</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#metis">metis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#metisnodal">metisnodal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#metisdual">metisdual</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#metrickuate">MetricKuate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id165">MetricKuate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#metricpk">MetricPk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id167">MetricPk</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mmg3d">mmg3d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id169">mmg3d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mmg3d-v4-0">mmg3d-v4.0</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id171">mmg3d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#msh3">msh3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#change">change</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#movemesh23">movemesh23</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#movemesh2d3dsurf">movemesh2D3Dsurf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#movemesh3">movemesh3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#movemesh">movemesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#movemesh3d">movemesh3D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#deplacement">deplacement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#checkbemesh">checkbemesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id181">buildlayers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#bcube">bcube</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#cube">cube</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#trunc">trunc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gluemesh">gluemesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#extract">extract</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#showborder">showborder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#getborder">getborder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#addlayers">AddLayers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mshmet">mshmet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id190">mshmet</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mumps">MUMPS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#defaulttomumpsseq">defaulttoMUMPSseq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mumps-seq">MUMPS_seq</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id193">defaulttoMUMPSseq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#netgen">netgen</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#netg">netg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#netgstl">netgstl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#netgload">netgload</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#newsolver">NewSolver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#defaulttoumfpack">defaulttoUMFPACK</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#pardiso">PARDISO</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#defaulttopardiso">defaulttoPARDISO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#ompsetnumthreads">ompsetnumthreads</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#ompgetnumthreads">ompgetnumthreads</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#ompgetmaxthreads">ompgetmaxthreads</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#pcm2rnm">pcm2rnm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#readpcm">readpcm</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#pipe">pipe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#flush">flush</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#sleep">sleep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#usleep">usleep</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#qf11to25">qf11to25</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#qf1d">QF1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#qf2d">QF2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#qf3d">QF3d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#tripleqf">tripleQF</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#scotch">scotch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id210">scotch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#shell">shell</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#readdir">readdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#unlink">unlink</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#rmdir">rmdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#cddir">cddir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#chdir">chdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#basename">basename</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dirname">dirname</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#mkdir">mkdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#chmod">chmod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#cpfile">cpfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#stat">stat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#isdir">isdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#getenv">getenv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#setenv">setenv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#unsetenv">unsetenv</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#splitedges">splitedges</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#splitedgemesh">SplitedgeMesh</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#splitmesh12">splitmesh12</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id228">splitmesh12</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#splitmesh3">splitmesh3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id230">splitmesh3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#splitmesh4">splitmesh4</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#splimesh4">splimesh4</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#splitmesh6">splitmesh6</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id233">splitmesh6</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#superlu">SuperLu</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#defaulttosuperlu">defaulttoSuperLu</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#symmetrizecsr">symmetrizeCSR</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id236">symmetrizeCSR</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#tetgen">tetgen</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#tetgconvexhull">tetgconvexhull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#tetgtransfo">tetgtransfo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#tetg">tetg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#tetgreconstruction">tetgreconstruction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#umfpack64">UMFPACK64</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#defaulttoumfpack64">defaulttoUMFPACK64</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#vtk-writer-3d">VTK_writer_3d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#vtkaddmesh">Vtkaddmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#vtkaddscalar">Vtkaddscalar</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#vtk-writer">VTK_writer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id245">Vtkaddmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id247">Vtkaddscalar</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../models/index.html">Mathematical Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/static-problems.html">Static problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#soap-film">Soap Film</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#electrostatics">Electrostatics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#aerodynamics">Aerodynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#error-estimation">Error estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#periodic-boundary-conditions">Periodic Boundary Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#poisson-problems-with-mixed-boundary-condition">Poisson Problems with mixed boundary condition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#poisson-with-mixed-finite-element">Poisson with mixed finite element</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#metric-adaptation-and-residual-error-indicator">Metric Adaptation and residual error indicator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#adaptation-using-residual-error-indicator">Adaptation using residual error indicator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/elasticity.html">Elasticity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/elasticity.html#fracture-mechanics">Fracture Mechanics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/non-linear-static-problems.html">Non-linear static problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/non-linear-static-problems.html#newton-raphson-algorithm">Newton-Raphson algorithm</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/eigen-value-problems.html">Eigen value problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/evolution-problems.html">Evolution problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/evolution-problems.html#mathematical-theory-on-time-difference-approximations">Mathematical Theory on Time Difference Approximations.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/evolution-problems.html#convection">Convection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/evolution-problems.html#d-black-scholes-equation-for-an-european-put-option">2D Black-Scholes equation for an European Put option</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/navier-stokes-equations.html">Navier-Stokes equations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/navier-stokes-equations.html#uzawa-algorithm-and-conjugate-gradients">Uzawa Algorithm and Conjugate Gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/navier-stokes-equations.html#nsuzawacahouetchabart-edp">NSUzawaCahouetChabart.edp</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/variational-inequality.html">Variational Inequality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/domain-decomposition.html">Domain decomposition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/domain-decomposition.html#schwarz-overlapping">Schwarz overlapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/domain-decomposition.html#schwarz-non-overlapping-scheme">Schwarz non overlapping Scheme</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/domain-decomposition.html#schwarz-conjuguate-gradient">Schwarz conjuguate gradient</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/fluid-structure-coupled-problem.html">Fluid-structure coupled problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/transmission-problem.html">Transmission problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/free-boundary-problems.html">Free boundary problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/non-linear-elasticity.html">Non-linear elasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/compressible-neo-hookean-materials.html">Compressible Neo-Hookean materials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/compressible-neo-hookean-materials.html#notation">Notation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/compressible-neo-hookean-materials.html#recommended-references">Recommended References</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/compressible-neo-hookean-materials.html#a-neo-hookean-compressible-material">A Neo-Hookean Compressible Material</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/compressible-neo-hookean-materials.html#an-approach-to-implementation-in-freefem">An Approach to Implementation in FreeFEM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/whispering-gallery-modes.html">Whispering gallery modes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/whispering-gallery-modes.html#wave-equation-for-the-wgms">Wave equation for the WGMs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/whispering-gallery-modes.html#weak-formulation">Weak formulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/whispering-gallery-modes.html#a-dielectric-sphere-example-with-freefem">A dielectric sphere example with FreeFEM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/misc.html">Misc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/misc.html#poisson-s-equation">Poisson’s Equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/misc.html#poisson-s-equation-3d">Poisson’s equation 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/misc.html#stokes-equation-on-a-cube">Stokes Equation on a cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/misc.html#cavity">Cavity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/mesh-generation.html">Mesh Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#square-mesh">Square mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#mesh-adaptation">Mesh adaptation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#mesh-adaptation-for-the-poisson-s-problem">Mesh adaptation for the Poisson’s problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#uniform-mesh-adaptation">Uniform mesh adaptation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#borders">Borders</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#change">Change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#cube">Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#empty-mesh">Empty mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#points">3 points</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#bezier">Bezier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#build-layer-mesh">Build layer mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#sphere">Sphere</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/finite-element.html">Finite Element</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/finite-element.html#periodic-3d">Periodic 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/finite-element.html#lagrange-multipliers">Lagrange multipliers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/visualization.html">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/visualization.html#plot">Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/visualization.html#hsv">HSV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/visualization.html#medit">Medit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/visualization.html#paraview">Paraview</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/algorithms-and-optimizations.html">Algorithms &amp; Optimizations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/algorithms-and-optimizations.html#algorithms">Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/algorithms-and-optimizations.html#cmaes-variational-inequality">CMAES variational inequality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/algorithms-and-optimizations.html#ipopt-minimal-surface-volume">IPOPT minimal surface &amp; volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/algorithms-and-optimizations.html#cmaes-mpi-variational-inequality">CMAES MPI variational inequality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/parallelization.html">Parallelization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/parallelization.html#mpi-gmres-2d">MPI-GMRES 2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/parallelization.html#mpi-gmres-3d">MPI-GMRES 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/parallelization.html#direct-solvers">Direct solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/parallelization.html#solver-mumps">Solver MUMPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/parallelization.html#solver-superlu-dist">Solver superLU_DIST</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/parallelization.html#solver-pastix">Solver PaStiX</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/developers.html">Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#fft">FFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#complex">Complex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#string">String</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#elementary-function">Elementary function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#array">Array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#block-matrix">Block matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#matrix-operations">Matrix operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#matrix-inversion">Matrix inversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#fe-array">FE array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#loop">Loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#implicit-loop">Implicit loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#i-o">I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#file-stream">File stream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#command-line-arguments">Command line arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#macro">Macro</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#basic-error-handling">Basic error handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#error-handling">Error handling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

	</div>

	<div class="nav-links" id="staticNav">
	</div>

	<button class="nav-btn" onclick="openNav()"><i class="fa fa-bars"></i></button>

	<div id="sideNav" class="sidenav">
		<div class="sideNavHeader">
			<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   id="Calque_1"
   data-name="Calque 1"
   viewBox="0 0 380.98 113.39"
   version="1.1"
   sodipodi:docname="Logo.svg"
   inkscape:version="0.92.4 5da689c313, 2019-01-14">
  <metadata
     id="metadata30">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <sodipodi:namedview
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1"
     objecttolerance="10"
     gridtolerance="10"
     guidetolerance="10"
     inkscape:pageopacity="0"
     inkscape:pageshadow="2"
     inkscape:window-width="1920"
     inkscape:window-height="1016"
     id="namedview28"
     showgrid="false"
     inkscape:zoom="1.1312929"
     inkscape:cx="194.02578"
     inkscape:cy="53.159222"
     inkscape:window-x="0"
     inkscape:window-y="27"
     inkscape:window-maximized="1"
     inkscape:current-layer="Calque_1" />
  <defs
     id="defs4">
    <style
       id="style2">.cls-1{fill:blue;}.cls-2{fill:#00007f;}</style>
  </defs>
  <title
     id="title6">Logo</title>
  <path
     class="cls-2"
     d="M397.36,291H381.81v14.22h-11V267.42h27.75v8.44H381.74v6.67H397.3V291Z"
     transform="translate(-230.46 -229.51)"
     id="path13" />
  <path
     class="cls-2"
     d="M417.29,292.68H413v12.51H402V267.42h16.7c4.89,0,8.76,1,11.49,3a9.55,9.55,0,0,1,4.13,8.32,12.59,12.59,0,0,1-1.59,6.73,11.85,11.85,0,0,1-5.33,4.38l8.19,15v.44H423.77ZM413,284.24h5.71c3.18,0,4.76-1.4,4.76-4.25s-1.71-4.13-5.08-4.13H413Z"
     transform="translate(-230.46 -229.51)"
     id="path15" />
  <path
     class="cls-2"
     d="M465.8,289.89H450.94v6.86h17.59v8.44H440V267.42h28.76v8.44H450.94v5.59H465.8Z"
     transform="translate(-230.46 -229.51)"
     id="path17" />
  <path
     class="cls-2"
     d="M497.6,289.89H482.75v6.86h17.58v8.44H471.77V267.42h28.75v8.44H482.75v5.59H497.6Z"
     transform="translate(-230.46 -229.51)"
     id="path19" />
  <path
     class="cls-2"
     d="M530.11,291H514.55v14.22h-11V267.42h27.75v8.44H514.49v6.67h15.56V291Z"
     transform="translate(-230.46 -229.51)"
     id="path21" />
  <path
     class="cls-2"
     d="M560.58,289.89H545.73v6.86h17.58v8.44H534.74V267.42H563.5v8.44H545.73v5.59h14.85Z"
     transform="translate(-230.46 -229.51)"
     id="path23" />
  <path
     class="cls-2"
     d="M581.09,267.42,589,291.54l7.87-24.12h14.6v37.77h-11v-5.84l1.08-20.19-9,26h-7l-9-26,1.14,20.19v5.84h-11V267.42Z"
     transform="translate(-230.46 -229.51)"
     id="path25" />
  <g
     id="g833"
     transform="matrix(0.69996616,0,0,0.69996616,24.36493,-106.39712)">
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="181.58182"
       x="49.328617"
       height="86.368324"
       width="21.264048"
       id="rect1411"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="181.58182"
       x="64.966545"
       height="21.592081"
       width="53.160122"
       id="rect1413"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="218.71571"
       x="72.469795"
       height="16.194061"
       width="21.264048"
       id="rect1415"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="205.23866"
       x="95.834"
       height="86.368324"
       width="21.264048"
       id="rect1411-6"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="205.23866"
       x="111.47193"
       height="21.592081"
       width="53.160122"
       id="rect1413-7"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="242.37254"
       x="118.97518"
       height="16.194061"
       width="21.264048"
       id="rect1415-5"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
  </g>
</svg>
			<a class="closebtn" href="#" onclick="closeNav()"><i class="fas fa-times"></i></a>
		</div>
		<div id="dynamicSideNav">
		</div>
	</div>
	<div class="search-container">
	<label id="search-icon" for="searchInput"><i class="fas fa-search"></i></label>
	<input type="search" placeholder="Type to start searching" id="searchInput">
	<label id="search-overlay" onclick="removeOverlay()"></label>
	<div class="search-toggle">
		<input type="checkbox" id="checkbox-search-toggle"/>
		<label for="checkbox-search"> search in examples &emsp;&emsp; NEW !! toggle between documentation or examples (or press CTRL key)</label>
	</div>
	<div id="searchResults"></div>
</div>
	
</nav>
	

	<div id="subnav">
	<div class="subnav-toc", style="display: none">
		<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html"><strong>Introduction</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Learning by Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="notations.html">Notations</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Mesh Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-type-mesh-in-2-dimension"><strong>The type mesh in 2 dimension</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-type-mesh3-in-3-dimension"><strong>The type mesh3 in 3 dimension</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-type-meshs-in-3-dimension"><strong>The type meshS in 3 dimension</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-type-meshl-in-3-dimension"><strong>The type meshL in 3 dimension</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#read-write-statements-for-meshes">Read/Write Statements for meshes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#medit">Medit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mshmet">Mshmet</a></li>
<li class="toctree-l3"><a class="reference internal" href="#freeyams">FreeYams</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mmg3d">mmg3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-first-3d-isotrope-mesh-adaptation-process">A first 3d isotrope mesh adaptation process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-a-2d-mesh-from-an-isoline">Build a 2d mesh from an isoline</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="finite-element.html">Finite element</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="algorithms-and-optimization.html">Algorithms &amp; Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallelization.html">Parallelization</a></li>
<li class="toctree-l2"><a class="reference internal" href="petsc/index.html">PETSc and SLEPc</a></li>
<li class="toctree-l2"><a class="reference internal" href="BEM.html">The Boundary Element Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="composite.html">Composite finite element spaces <span class="red">NEW!</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="developers.html">Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="ffddm/index.html">ffddm</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references/index.html">Language references</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models/index.html">Mathematical Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

	</div>
	<div class="tag-tree" style="display: none">
		<strong> Filter by categories <br> &#9888; Work in progress ! <br> <br> </strong>
		<div class="tag-tree-container">
		</div>
	</div>
</div>
	
	<div id="content">
		<div id="content-examples" style="display: none">
			<div id="exampleWelcome">
				<ul>
					<li><h4>Here you can use the search bar to search in all FreeFEM examples instead</h4></li>
					<li><h4>The list of all matching examples on the right is updated for each new query</h4></li>
					<li><h4>Clicking on a search hit or on an example on the right brings up the corresponding script from GitHub</h4></li>
					<li><h4>You can also filter the list on the right by selecting one or more intersecting categories on the left tree </h4></li>
				</ul>
			</div>
			<div id="exampleCode" spellcheck="false" style="display: none">
				<h2><div id='ExampleLinkToGitHub'></div> <!-- <span id="exampleSave">Save as EDP</span> --></h2>
				<textarea id="code"></textarea>
			</div>
		</div>
		<div id="content-doc">
			
   <section id="mesh-generation">
<span id="meshgeneration"></span><h1>Mesh Generation<a class="headerlink" href="#mesh-generation" title="Link to this heading"></a></h1>
<p>In this section, operators and tools on meshes are presented.</p>
<p>FreeFEM type for mesh variable:</p>
<ul class="simple">
<li><p>1D mesh: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshL</span></code></p></li>
</ul>
<ul class="simple" id="index-0">
<li><p>2D mesh: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh</span></code></p></li>
</ul>
<ul class="simple" id="index-1">
<li><p>3D volume mesh: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code></p></li>
<li><dl class="simple">
<dt>3D border meshes</dt><dd><ul>
<li><p>3D surface <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code></p></li>
<li><p>3D curve <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshL</span></code></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Through this presentation, the principal commands for the mesh generation and links between <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh</span></code> - <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code> - <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code> - <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshL</span></code> are described.</p>
<section id="the-type-mesh-in-2-dimension">
<span id="mesh2d"></span><h2><strong>The type mesh in 2 dimension</strong><a class="headerlink" href="#the-type-mesh-in-2-dimension" title="Link to this heading"></a></h2>
<section id="commands-for-2d-mesh-generation">
<h3>Commands for 2d mesh Generation<a class="headerlink" href="#commands-for-2d-mesh-generation" title="Link to this heading"></a></h3>
<p>The <strong>FreeFEM</strong> type to define a 2d mesh object is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh</span></code>.</p>
<section id="the-command-square">
<span id="meshsquare"></span><h4>The command <em>square</em><a class="headerlink" href="#the-command-square" title="Link to this heading"></a></h4>
<p>The command <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">square</span></code> triangulates the unit square.</p>
<p>The following generates a <span class="math notranslate nohighlight">\(4\times 5\)</span> grid in the unit square <span class="math notranslate nohighlight">\([0,1]^2\)</span>. The labels of the boundaries are shown in <a class="reference internal" href="#figboundarylabels"><span class="std std-numref">Fig. 57</span></a>.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
</pre></div>
</div>
<figure class="align-default" id="figboundarylabels">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Square.png"><img alt="../_images/MeshGeneration_Square.png" src="../_images/MeshGeneration_Square.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 57 </span><span class="caption-text">Boundary labels of the mesh by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span></code></span><a class="headerlink" href="#figboundarylabels" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>To construct a <span class="math notranslate nohighlight">\(n\times m\)</span> grid in the rectangle <span class="math notranslate nohighlight">\([x_0,x_1]\times [y_0,y_1]\)</span>, proceed as follows:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">real</span><span class="w"> </span><span class="n">x0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.2</span><span class="p">;</span>
<span class="linenos">2</span><span class="kt">real</span><span class="w"> </span><span class="n">x1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.8</span><span class="p">;</span>
<span class="linenos">3</span><span class="kt">real</span><span class="w"> </span><span class="nf">y0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">4</span><span class="kt">real</span><span class="w"> </span><span class="nf">y1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos">5</span><span class="kt">int</span><span class="w"> </span><span class="kr">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="linenos">6</span><span class="kt">real</span><span class="w"> </span><span class="kr">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
<span class="linenos">7</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span><span class="w"> </span><span class="kr">m</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">x0</span><span class="o">+</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="nf">y0</span><span class="o">+</span><span class="p">(</span><span class="nf">y1</span><span class="o">-</span><span class="nf">y0</span><span class="p">)</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Adding the named parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">flags</span><span class="o">=</span><span class="n">icase</span></code> with icase:</p>
<ol class="arabic simple" start="0">
<li><p>will produce a mesh where all quads are split with diagonal <span class="math notranslate nohighlight">\(x-y=constant\)</span></p></li>
<li><p>will produce a <em>Union Jack flag</em> type of mesh</p></li>
<li><p>will produce a mesh where all quads are split with diagonal <span class="math notranslate nohighlight">\(x+y=constant\)</span></p></li>
<li><p>same as in case 0, except two corners where the triangles are the same as case 2, to avoid having 3 vertices on the boundary</p></li>
<li><p>same as in case 2, except two corners where the triangles are the same as case 0, to avoid having 3 vertices on the boundary</p></li>
</ol>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span><span class="w"> </span><span class="kr">m</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">x0</span><span class="o">+</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="nf">y0</span><span class="o">+</span><span class="p">(</span><span class="nf">y1</span><span class="o">-</span><span class="nf">y0</span><span class="p">)</span><span class="o">*</span><span class="kr">y</span><span class="p">],</span><span class="w"> </span><span class="kp">flags</span><span class="o">=</span><span class="n">icase</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Adding the named parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span><span class="o">=</span><span class="n">labs</span></code> will
change the 4 default label numbers to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">labs</span><span class="p">[</span><span class="n">i</span><span class="mi">-1</span><span class="p">]</span></code>, for
example <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">labs</span><span class="o">=</span><span class="p">[</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">]</span></code>, and adding the
named parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">region</span><span class="o">=</span><span class="mi">10</span></code> will change the region number
to <span class="math notranslate nohighlight">\(10\)</span>, for instance (v 3.8).</p>
<p>To see all of these flags at work, check <a class="reference internal" href="../examples/mesh-generation.html#examplemeshsquare"><span class="std std-ref">Square mesh example</span></a>:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="linenos">2</span><span class="w">   </span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">labs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">];</span>
<span class="linenos">3</span><span class="w">   </span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kp">flags</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">labs</span><span class="p">,</span><span class="w"> </span><span class="kr">region</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
<span class="linenos">4</span><span class="w">   </span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;square flags = &quot;</span><span class="o">+</span><span class="n">i</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">5</span><span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="the-command-buildmesh">
<span id="meshborder"></span><h4>The command <em>buildmesh</em><a class="headerlink" href="#the-command-buildmesh" title="Link to this heading"></a></h4>
<p><em>mesh building with</em> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">border</span></code></p>
<p>Boundaries are defined piecewise by parametrized curves. The pieces can only intersect at their endpoints, but it is possible to join more than two endpoints. This can be used to structure the mesh if an area touches a border and create new regions by dividing larger ones:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">int</span><span class="w"> </span><span class="n">upper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos"> 2</span><span class="kt">int</span><span class="w"> </span><span class="n">others</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="linenos"> 3</span><span class="kt">int</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="kt">border</span><span class="w"> </span><span class="nf">C01</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">-1</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">upper</span><span class="p">;}</span>
<span class="linenos"> 6</span><span class="kt">border</span><span class="w"> </span><span class="nf">C02</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">1.5-1.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">-1</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">upper</span><span class="p">;}</span>
<span class="linenos"> 7</span><span class="kt">border</span><span class="w"> </span><span class="nf">C03</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">1.5</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">upper</span><span class="p">;}</span>
<span class="linenos"> 8</span><span class="kt">border</span><span class="w"> </span><span class="nf">C04</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">others</span><span class="p">;}</span>
<span class="linenos"> 9</span><span class="kt">border</span><span class="w"> </span><span class="nf">C05</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">others</span><span class="p">;}</span>
<span class="linenos">10</span><span class="kt">border</span><span class="w"> </span><span class="nf">C06</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">others</span><span class="p">;}</span>
<span class="linenos">11</span><span class="kt">border</span><span class="w"> </span><span class="nf">C11</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">-0.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">inner</span><span class="p">;}</span>
<span class="linenos">12</span><span class="kt">border</span><span class="w"> </span><span class="nf">C12</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">-0.5</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">inner</span><span class="p">;}</span>
<span class="linenos">13</span><span class="kt">border</span><span class="w"> </span><span class="nf">C13</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">-0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">inner</span><span class="p">;}</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="kt">int</span><span class="w"> </span><span class="kr">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="linenos">16</span><span class="nf">plot</span><span class="p">(</span><span class="n">C01</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C02</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C03</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C04</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C05</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span>
<span class="linenos">17</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">C06</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C11</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C12</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C13</span><span class="p">(</span><span class="kr">n</span><span class="p">),</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">C01</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C02</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C03</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C04</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C05</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span>
<span class="linenos">20</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">C06</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C11</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C12</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C13</span><span class="p">(</span><span class="kr">n</span><span class="p">));</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Part 1 has region number &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.25</span><span class="p">).</span><span class="kr">region</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">25</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Part 2 has redion number &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.25</span><span class="p">).</span><span class="kr">region</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>Borders and mesh are respectively shown in <a class="reference internal" href="#figmultipleborder"><span class="std std-numref">Fig. 58</span></a> and <a class="reference internal" href="#figgeneratedmesh"><span class="std std-numref">Fig. 59</span></a>.</p>
<div class="figure compound align-center" id="MeshGeneration_Border">
<figure class="align-default" id="id31">
<span id="figmultipleborder"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Border1.png"><img alt="MeshGeneration_Border1" src="../_images/MeshGeneration_Border1.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 58 </span><span class="caption-text">Multiple border ends intersect</span><a class="headerlink" href="#id31" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id32">
<span id="figgeneratedmesh"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Border2.png"><img alt="MeshGeneration_Border2" src="../_images/MeshGeneration_Border2.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 59 </span><span class="caption-text">Generated mesh</span><a class="headerlink" href="#id32" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><span class="caption-text">Border</span></p>
</div><p id="MeshGeneration_Border">Triangulation keywords assume that the domain is defined as being on the <em>left</em> (resp <em>right</em>) of its oriented parameterized boundary</p>
<div class="math notranslate nohighlight">
\[\Gamma_j = \{(x,y)\left|\; x=\varphi_x(t),\, y=\varphi_y(t),\, a_j\le t\le b_j\right.\}\]</div>
<p>To check the orientation plot <span class="math notranslate nohighlight">\(t\mapsto (\varphi_x(t),\varphi_y(t)),\, t_0\le t\le t_1\)</span>. If it is as in <a class="reference internal" href="#figborder"><span class="std std-numref">Fig. 60</span></a>, then the domain lies on the shaded area, otherwise it lies on the opposite side.</p>
<figure class="align-default" id="figborder">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Border3.png"><img alt="../_images/MeshGeneration_Border3.png" src="../_images/MeshGeneration_Border3.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 60 </span><span class="caption-text">Orientation of the boundary defined by <span class="math notranslate nohighlight">\((\phi_x(t),\phi_y(t))\)</span></span><a class="headerlink" href="#figborder" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The general expression to define a triangulation with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">buildmesh</span></code> is</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Mesh_Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span><span class="o">+</span><span class="p">...</span><span class="o">+</span><span class="n">GammaJ</span><span class="p">(</span><span class="n">mj</span><span class="p">),</span><span class="w"> </span><span class="n">OptionalParameter</span><span class="p">);</span>
</pre></div>
</div>
<p>where <span class="math notranslate nohighlight">\(m_j\)</span> are positive or negative numbers to indicate how many vertices should be on <span class="math notranslate nohighlight">\(\Gamma_j,\, \Gamma=\cup_{j=1}^J \Gamma_J\)</span>, and the optional parameter (see also <a class="reference internal" href="../references/functions.html#referencebuildmesh"><span class="std std-ref">References</span></a>), separated with a comma, can be:</p>
<ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbvx</span><span class="o">=</span><span class="w"> </span><span class="kt">int</span></code>, to set the maximum number of vertices in the mesh.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">fixedborder</span><span class="o">=</span><span class="w"> </span><span class="kt">bool</span></code>, to say if the mesh generator can change the boundary mesh or not (by default the boundary mesh can change; beware that with periodic boundary conditions (see. <a class="reference internal" href="finite-element.html#finiteelement"><span class="std std-ref">Finite Element</span></a>), it can be dangerous.</p></li>
</ul>
<p>The orientation of boundaries can be changed by changing the sign of <span class="math notranslate nohighlight">\(m_j\)</span>.</p>
<p>The following example shows how to change the orientation. The example generates the unit disk with a small circular hole, and assigns “1” to the unit disk (“2” to the circle inside). The boundary label <strong>must be non-zero</strong>, but it can also be omitted.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">border</span><span class="w"> </span><span class="nf">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos">2</span><span class="kt">border</span><span class="w"> </span><span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.3</span><span class="o">+</span><span class="mf">0.3</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">0.3</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">2</span><span class="p">;}</span>
<span class="linenos">3</span><span class="nf">plot</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="mi">30</span><span class="p">));</span><span class="w"> </span><span class="c1">//to see a plot of the border mesh</span>
<span class="linenos">4</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Thwithouthole</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="mi">30</span><span class="p">));</span>
<span class="linenos">5</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Thwithhole</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="mi">-30</span><span class="p">));</span>
<span class="linenos">6</span><span class="nf">plot</span><span class="p">(</span><span class="n">Thwithouthole</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;Thwithouthole.eps&quot;</span><span class="p">);</span>
<span class="linenos">7</span><span class="nf">plot</span><span class="p">(</span><span class="n">Thwithhole</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;Thwithhole.eps&quot;</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notice that the orientation is changed by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">b</span><span class="p">(</span><span class="mi">-30</span><span class="p">)</span></code> in the 5th line. In the 7th line, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;fileName&quot;</span></code> is used to generate a postscript file with identification shown on the figure.</p>
</div>
<div class="figure compound align-center" id="MeshWithHole">
<figure class="align-default" id="id33">
<span id="figmeswithouthhole"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Border4.png"><img alt="MeshGeneration_Border4" src="../_images/MeshGeneration_Border4.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 61 </span><span class="caption-text">Mesh without hole</span><a class="headerlink" href="#id33" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id34">
<span id="figmeshwithhole"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Border5.png"><img alt="MeshGeneration_Border5" src="../_images/MeshGeneration_Border5.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 62 </span><span class="caption-text">Mesh with hole</span><a class="headerlink" href="#id34" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><span class="caption-text">Mesh with a hole</span></p>
</div><div class="admonition note" id="MeshWithHole">
<p class="admonition-title">Note</p>
<p>Borders are evaluated only at the time <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">plot</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">buildmesh</span></code> is called so the global variables are defined at this time. In this case, since <span class="math notranslate nohighlight">\(r\)</span> is changed between the two border calls, the following code will not work because the first border will be computed with r=0.3:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">real</span><span class="w"> </span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="linenos">2</span><span class="kt">border</span><span class="w"> </span><span class="nf">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">r</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="n">r</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos">3</span><span class="n">r</span><span class="o">=</span><span class="mf">0.3</span><span class="p">;</span>
<span class="linenos">4</span><span class="kt">border</span><span class="w"> </span><span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">r</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="n">r</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos">5</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Thwithhole</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="mi">-30</span><span class="p">));</span><span class="w"> </span><span class="c1">// bug (a trap) because</span>
<span class="linenos">6</span><span class="w">    </span><span class="c1">// the two circles have the same radius = :math:`0.3`</span>
</pre></div>
</div>
</div>
<p><em>mesh building with array of</em> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">border</span></code></p>
<p>Sometimes it can be useful to make an array of the border, but unfortunately it is incompatible with the <strong>FreeFEM</strong> syntax. To bypass this problem, if the number of segments of the discretization <span class="math notranslate nohighlight">\(n\)</span> is an array, we make an implicit loop on all of the values of the array, and the index variable <span class="math notranslate nohighlight">\(i\)</span> of the loop is defined after the parameter definition, like in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">border</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="p">)</span></code> …</p>
<p>A first very small example:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">border</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos">2</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">];</span>
<span class="linenos">3</span><span class="nf">plot</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">nn</span><span class="p">));</span><span class="w"> </span><span class="c1">//plot 3 circles with 10, 20, 30 points</span>
</pre></div>
</div>
<p>And a more complex example to define a square with small circles:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">xx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="linenos"> 2</span><span class="w">          </span><span class="n">yy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="linenos"> 3</span><span class="c1">//radius, center of the 4 circles</span>
<span class="linenos"> 4</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">RC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.05</span><span class="p">,</span><span class="w"> </span><span class="mf">0.05</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">],</span>
<span class="linenos"> 5</span><span class="w">          </span><span class="n">XC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8</span><span class="p">],</span>
<span class="linenos"> 6</span><span class="w">          </span><span class="n">YC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">];</span>
<span class="linenos"> 7</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">NC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">-10</span><span class="p">,</span><span class="mi">-11</span><span class="p">,</span><span class="mi">-12</span><span class="p">,</span><span class="mi">13</span><span class="p">];</span><span class="w"> </span><span class="c1">//list number of :math:`\pm` segments of the 4 circles borders</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="kt">border</span><span class="w"> </span><span class="kp">bb</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="linenos">10</span><span class="p">{</span>
<span class="linenos">11</span><span class="w">    </span><span class="c1">// i is the index variable of the multi border loop</span>
<span class="linenos">12</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">4</span><span class="p">;</span>
<span class="linenos">13</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span>
<span class="linenos">14</span><span class="w">    </span><span class="kr">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">t1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xx</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span>
<span class="linenos">15</span><span class="w">    </span><span class="kr">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">t1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">yy</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span>
<span class="linenos">16</span><span class="w">    </span><span class="kr">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">17</span><span class="p">}</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="kt">border</span><span class="w"> </span><span class="n">cc</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="linenos">20</span><span class="p">{</span>
<span class="linenos">21</span><span class="w">    </span><span class="kr">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">XC</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos">22</span><span class="w">    </span><span class="kr">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">YC</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos">23</span><span class="w">    </span><span class="kr">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos">24</span><span class="p">}</span>
<span class="linenos">25</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">];</span><span class="w"> </span><span class="c1">//4 border, with 4, 4, 5, 7 segment respectively</span>
<span class="linenos">26</span><span class="nf">plot</span><span class="p">(</span><span class="kp">bb</span><span class="p">(</span><span class="n">nn</span><span class="p">),</span><span class="w"> </span><span class="n">cc</span><span class="p">(</span><span class="n">NC</span><span class="p">),</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">27</span><span class="kt">mesh</span><span class="w"> </span><span class="n">th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="kp">bb</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cc</span><span class="p">(</span><span class="n">NC</span><span class="p">));</span>
<span class="linenos">28</span><span class="nf">plot</span><span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
<section id="mesh-connectivity-and-data">
<h3>Mesh Connectivity and data<a class="headerlink" href="#mesh-connectivity-and-data" title="Link to this heading"></a></h3>
<p>The following example explains methods to obtain mesh information.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="c1">// Mesh</span>
<span class="linenos">  2</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="linenos">  3</span>
<span class="linenos">  4</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;// Get data of the mesh&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">  5</span><span class="p">{</span>
<span class="linenos">  6</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">NbTriangles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">nt</span><span class="p">;</span>
<span class="linenos">  7</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">MeshArea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">measure</span><span class="p">;</span>
<span class="linenos">  8</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">BorderLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">bordermeasure</span><span class="p">;</span>
<span class="linenos">  9</span>
<span class="linenos"> 10</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Number of triangle(s) = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">NbTriangles</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 11</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Mesh area = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">MeshArea</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 12</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Border length = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">BorderLength</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 13</span>
<span class="linenos"> 14</span><span class="w">    </span><span class="c1">// Th(i) return the vextex i of Th</span>
<span class="linenos"> 15</span><span class="w">    </span><span class="c1">// Th[k] return the triangle k of Th</span>
<span class="linenos"> 16</span><span class="w">    </span><span class="c1">// Th[k][i] return the vertex i of the triangle k of Th</span>
<span class="linenos"> 17</span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">NbTriangles</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos"> 18</span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="linenos"> 19</span><span class="w">            </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; - Th[i][j] = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
<span class="linenos"> 20</span><span class="w">                 </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, x = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">].</span><span class="kr">x</span>
<span class="linenos"> 21</span><span class="w">                 </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, y= &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">].</span><span class="kr">y</span>
<span class="linenos"> 22</span><span class="w">                 </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, label=&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">].</span><span class="kr">label</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 23</span><span class="p">}</span>
<span class="linenos"> 24</span>
<span class="linenos"> 25</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;// Hack to get vertex coordinates&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 26</span><span class="p">{</span>
<span class="linenos"> 27</span><span class="w">    </span><span class="kt">fespace</span><span class="w"> </span><span class="nf">femp1</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos"> 28</span><span class="w">    </span><span class="n">femp1</span><span class="w"> </span><span class="n">Thx</span><span class="o">=</span><span class="kr">x</span><span class="p">,</span><span class="n">Thy</span><span class="o">=</span><span class="kr">y</span><span class="p">;</span>
<span class="linenos"> 29</span>
<span class="linenos"> 30</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">NbVertices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">nv</span><span class="p">;</span>
<span class="linenos"> 31</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Number of vertices = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">NbVertices</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 32</span>
<span class="linenos"> 33</span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">NbVertices</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos"> 34</span><span class="w">        </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Th(&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;) : &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="kr">x</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="kr">y</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="kr">label</span>
<span class="linenos"> 35</span><span class="w">             </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\t</span><span class="s">old method: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Thx</span><span class="p">[][</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Thy</span><span class="p">[][</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 36</span><span class="p">}</span>
<span class="linenos"> 37</span>
<span class="linenos"> 38</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;// Method to find information of point (0.55,0.6)&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 39</span><span class="p">{</span>
<span class="linenos"> 40</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">TNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p">).</span><span class="kr">nuTriangle</span><span class="p">;</span><span class="w"> </span><span class="c1">//the triangle number</span>
<span class="linenos"> 41</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">RLabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p">).</span><span class="kr">region</span><span class="p">;</span><span class="w"> </span><span class="c1">//the region label</span>
<span class="linenos"> 42</span>
<span class="linenos"> 43</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Triangle number in point (0.55, 0.6): &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">TNumber</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 44</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Region label in point (0.55, 0.6): &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">RLabel</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 45</span><span class="p">}</span>
<span class="linenos"> 46</span>
<span class="linenos"> 47</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;// Information of triangle&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 48</span><span class="p">{</span>
<span class="linenos"> 49</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">TNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p">).</span><span class="kr">nuTriangle</span><span class="p">;</span>
<span class="linenos"> 50</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">TArea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">[</span><span class="n">TNumber</span><span class="p">].</span><span class="kr">area</span><span class="p">;</span><span class="w"> </span><span class="c1">//triangle area</span>
<span class="linenos"> 51</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">TRegion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">[</span><span class="n">TNumber</span><span class="p">].</span><span class="kr">region</span><span class="p">;</span><span class="w"> </span><span class="c1">//triangle region</span>
<span class="linenos"> 52</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">TLabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">[</span><span class="n">TNumber</span><span class="p">].</span><span class="kr">label</span><span class="p">;</span><span class="w"> </span><span class="c1">//triangle label, same as region for triangles</span>
<span class="linenos"> 53</span>
<span class="linenos"> 54</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Area of triangle &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">TNumber</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">TArea</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 55</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Region of triangle &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">TNumber</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">TRegion</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 56</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Label of triangle &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">TNumber</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">TLabel</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 57</span><span class="p">}</span>
<span class="linenos"> 58</span>
<span class="linenos"> 59</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;// Hack to get a triangle containing point x, y or region number (old method)&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 60</span><span class="p">{</span>
<span class="linenos"> 61</span><span class="w">    </span><span class="kt">fespace</span><span class="w"> </span><span class="nf">femp0</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P0</span><span class="p">);</span>
<span class="linenos"> 62</span><span class="w">    </span><span class="n">femp0</span><span class="w"> </span><span class="n">TNumbers</span><span class="p">;</span><span class="w"> </span><span class="c1">//a P0 function to get triangle numbering</span>
<span class="linenos"> 63</span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">nt</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos"> 64</span><span class="w">        </span><span class="n">TNumbers</span><span class="p">[][</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="linenos"> 65</span><span class="w">    </span><span class="n">femp0</span><span class="w"> </span><span class="n">RNumbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">region</span><span class="p">;</span><span class="w"> </span><span class="c1">//a P0 function to get the region number</span>
<span class="linenos"> 66</span>
<span class="linenos"> 67</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">TNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TNumbers</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p">);</span><span class="w"> </span><span class="c1">// Number of the triangle containing (0.55, 0,6)</span>
<span class="linenos"> 68</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">RNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RNumbers</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p">);</span><span class="w"> </span><span class="c1">// Number of the region containing (0.55, 0,6)</span>
<span class="linenos"> 69</span>
<span class="linenos"> 70</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Point (0.55,0,6) :&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 71</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Triangle number = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">TNumber</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 72</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Region number = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">RNumber</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 73</span><span class="p">}</span>
<span class="linenos"> 74</span>
<span class="linenos"> 75</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;// New method to get boundary information and mesh adjacent&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 76</span><span class="p">{</span>
<span class="linenos"> 77</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 78</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="linenos"> 79</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">e</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="linenos"> 80</span>
<span class="linenos"> 81</span><span class="w">    </span><span class="c1">// Number of boundary elements</span>
<span class="linenos"> 82</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">NbBoundaryElements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">nbe</span><span class="p">;</span>
<span class="linenos"> 83</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Number of boundary element = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">NbBoundaryElements</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 84</span><span class="w">    </span><span class="c1">// Boundary element k in {0, ..., Th.nbe}</span>
<span class="linenos"> 85</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">BoundaryElement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">be</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>
<span class="linenos"> 86</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Boundary element &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">BoundaryElement</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 87</span><span class="w">    </span><span class="c1">// Vertice l in {0, 1} of boundary element k</span>
<span class="linenos"> 88</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">Vertex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">be</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="n">l</span><span class="p">];</span>
<span class="linenos"> 89</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Vertex &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; of boundary element &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Vertex</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 90</span><span class="w">    </span><span class="c1">// Triangle containg the boundary element k</span>
<span class="linenos"> 91</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">Triangle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">be</span><span class="p">(</span><span class="n">k</span><span class="p">).</span><span class="n">Element</span><span class="p">;</span>
<span class="linenos"> 92</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Triangle containing the boundary element &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Triangle</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 93</span><span class="w">    </span><span class="c1">// Triangle egde nubmer containing the boundary element k</span>
<span class="linenos"> 94</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">Edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">be</span><span class="p">(</span><span class="n">k</span><span class="p">).</span><span class="kr">whoinElement</span><span class="p">;</span>
<span class="linenos"> 95</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Triangle edge number containing the boundary element &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Edge</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 96</span><span class="w">    </span><span class="c1">// Adjacent triangle of the triangle k by edge e</span>
<span class="linenos"> 97</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">Adjacent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="kr">adj</span><span class="p">(</span><span class="n">e</span><span class="p">);</span><span class="w"> </span><span class="c1">//The value of e is changed to the corresponding edge in the adjacent triangle</span>
<span class="linenos"> 98</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Adjacent triangle of the triangle &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; by edge &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Adjacent</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 99</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Corresponding edge = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">100</span><span class="w">    </span><span class="c1">// If there is no adjacent triangle by edge e, the same triangle is returned</span>
<span class="linenos">101</span><span class="w">    </span><span class="c1">//Th[k] == Th[k].adj(e)</span>
<span class="linenos">102</span><span class="w">    </span><span class="c1">// Else a different triangle is returned</span>
<span class="linenos">103</span><span class="w">    </span><span class="c1">//Th[k] != Th[k].adj(e)</span>
<span class="linenos">104</span><span class="p">}</span>
<span class="linenos">105</span>
<span class="linenos">106</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;// Print mesh connectivity &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">107</span><span class="p">{</span>
<span class="linenos">108</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">NbTriangles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">nt</span><span class="p">;</span>
<span class="linenos">109</span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">NbTriangles</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">110</span><span class="w">        </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; : &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="linenos">111</span><span class="w">             </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
<span class="linenos">112</span><span class="w">             </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, label &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="kr">label</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">113</span>
<span class="linenos">114</span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">NbTriangles</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">115</span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">ee</span><span class="p">;</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="n">e</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">116</span><span class="w">            </span><span class="c1">//set ee to e, and ee is change by method adj,</span>
<span class="linenos">117</span><span class="w">            </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &lt;=&gt; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="kr">adj</span><span class="p">((</span><span class="n">ee</span><span class="o">=</span><span class="n">e</span><span class="p">)))</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">ee</span>
<span class="linenos">118</span><span class="w">                 </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, adj: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="kr">adj</span><span class="p">((</span><span class="n">ee</span><span class="o">=</span><span class="n">e</span><span class="p">))</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">Th</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">119</span>
<span class="linenos">120</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">NbBoundaryElements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">nbe</span><span class="p">;</span>
<span class="linenos">121</span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">NbBoundaryElements</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">122</span><span class="w">        </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; : &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">be</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">be</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">123</span><span class="w">             </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; , label &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">be</span><span class="p">(</span><span class="n">k</span><span class="p">).</span><span class="kr">label</span>
<span class="linenos">124</span><span class="w">             </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, triangle &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span><span class="n">Th</span><span class="p">.</span><span class="kr">be</span><span class="p">(</span><span class="n">k</span><span class="p">).</span><span class="n">Element</span><span class="p">)</span>
<span class="linenos">125</span><span class="w">             </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">be</span><span class="p">(</span><span class="n">k</span><span class="p">).</span><span class="kr">whoinElement</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">126</span>
<span class="linenos">127</span><span class="w">    </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="kp">bb</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="linenos">128</span><span class="w">    </span><span class="n">boundingbox</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">bb</span><span class="p">);</span>
<span class="linenos">129</span><span class="w">    </span><span class="c1">// bb[0] = xmin, bb[1] = xmax, bb[2] = ymin, bb[3] =ymax</span>
<span class="linenos">130</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;boundingbox:&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">131</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;xmin = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kp">bb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">132</span><span class="w">         </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, xmax = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kp">bb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">133</span><span class="w">         </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, ymin = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kp">bb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="linenos">134</span><span class="w">         </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, ymax = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kp">bb</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">135</span><span class="p">}</span>
</pre></div>
</div>
<p>The output is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span>//<span class="w"> </span>Get<span class="w"> </span>data<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>mesh
<span class="linenos">  2</span>Number<span class="w"> </span>of<span class="w"> </span><span class="nv">triangle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span>
<span class="linenos">  3</span>Mesh<span class="w"> </span><span class="nv">area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="linenos">  4</span>Border<span class="w"> </span><span class="nv">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span>
<span class="linenos">  5</span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">4</span>
<span class="linenos">  6</span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">1</span>
<span class="linenos">  7</span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">0</span>
<span class="linenos">  8</span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">4</span>
<span class="linenos">  9</span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">0</span>
<span class="linenos"> 10</span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">4</span>
<span class="linenos"> 11</span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">1</span>
<span class="linenos"> 12</span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">2</span>
<span class="linenos"> 13</span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">2</span>
<span class="linenos"> 14</span><span class="m">3</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">1</span>
<span class="linenos"> 15</span><span class="m">3</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">2</span>
<span class="linenos"> 16</span><span class="m">3</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">0</span>
<span class="linenos"> 17</span><span class="m">4</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">4</span>
<span class="linenos"> 18</span><span class="m">4</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">0</span>
<span class="linenos"> 19</span><span class="m">4</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">3</span>
<span class="linenos"> 20</span><span class="m">5</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">4</span>
<span class="linenos"> 21</span><span class="m">5</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">3</span>
<span class="linenos"> 22</span><span class="m">5</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">4</span>
<span class="linenos"> 23</span><span class="m">6</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">0</span>
<span class="linenos"> 24</span><span class="m">6</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">2</span>
<span class="linenos"> 25</span><span class="m">6</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">3</span>
<span class="linenos"> 26</span><span class="m">7</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">0</span>
<span class="linenos"> 27</span><span class="m">7</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">3</span>
<span class="linenos"> 28</span><span class="m">7</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>-<span class="w"> </span>Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span>,<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="nv">y</span><span class="o">=</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="m">3</span>
<span class="linenos"> 29</span>//<span class="w"> </span>Hack<span class="w"> </span>to<span class="w"> </span>get<span class="w"> </span>vertex<span class="w"> </span>coordinates
<span class="linenos"> 30</span>Number<span class="w"> </span>of<span class="w"> </span><span class="nv">vertices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">9</span>
<span class="linenos"> 31</span>Th<span class="o">(</span><span class="m">0</span><span class="o">)</span><span class="w"> </span>:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">4</span>
<span class="linenos"> 32</span><span class="w">   </span>old<span class="w"> </span>method:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="linenos"> 33</span>Th<span class="o">(</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>:<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span>
<span class="linenos"> 34</span><span class="w">   </span>old<span class="w"> </span>method:<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 35</span>Th<span class="o">(</span><span class="m">2</span><span class="o">)</span><span class="w"> </span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span>
<span class="linenos"> 36</span><span class="w">   </span>old<span class="w"> </span>method:<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span>
<span class="linenos"> 37</span>Th<span class="o">(</span><span class="m">3</span><span class="o">)</span><span class="w"> </span>:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">4</span>
<span class="linenos"> 38</span><span class="w">   </span>old<span class="w"> </span>method:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>.5
<span class="linenos"> 39</span>Th<span class="o">(</span><span class="m">4</span><span class="o">)</span><span class="w"> </span>:<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 40</span><span class="w">   </span>old<span class="w"> </span>method:<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.5
<span class="linenos"> 41</span>Th<span class="o">(</span><span class="m">5</span><span class="o">)</span><span class="w"> </span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">2</span>
<span class="linenos"> 42</span><span class="w">   </span>old<span class="w"> </span>method:<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span>.5
<span class="linenos"> 43</span>Th<span class="o">(</span><span class="m">6</span><span class="o">)</span><span class="w"> </span>:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">4</span>
<span class="linenos"> 44</span><span class="w">   </span>old<span class="w"> </span>method:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span>
<span class="linenos"> 45</span>Th<span class="o">(</span><span class="m">7</span><span class="o">)</span><span class="w"> </span>:<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">3</span>
<span class="linenos"> 46</span><span class="w">   </span>old<span class="w"> </span>method:<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">1</span>
<span class="linenos"> 47</span>Th<span class="o">(</span><span class="m">8</span><span class="o">)</span><span class="w"> </span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">3</span>
<span class="linenos"> 48</span><span class="w">   </span>old<span class="w"> </span>method:<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span>
<span class="linenos"> 49</span>//<span class="w"> </span>Method<span class="w"> </span>to<span class="w"> </span>find<span class="w"> </span>the<span class="w"> </span>information<span class="w"> </span>of<span class="w"> </span>point<span class="w"> </span><span class="o">(</span><span class="m">0</span>.55,0.6<span class="o">)</span>
<span class="linenos"> 50</span>Triangle<span class="w"> </span>number<span class="w"> </span><span class="k">in</span><span class="w"> </span>point<span class="w"> </span><span class="o">(</span><span class="m">0</span>.55,<span class="w"> </span><span class="m">0</span>.6<span class="o">)</span>:<span class="w"> </span><span class="m">7</span>
<span class="linenos"> 51</span>Region<span class="w"> </span>label<span class="w"> </span><span class="k">in</span><span class="w"> </span>point<span class="w"> </span><span class="o">(</span><span class="m">0</span>.55,<span class="w"> </span><span class="m">0</span>.6<span class="o">)</span>:<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 52</span>//<span class="w"> </span>Information<span class="w"> </span>of<span class="w"> </span>a<span class="w"> </span>triangle
<span class="linenos"> 53</span>Area<span class="w"> </span>of<span class="w"> </span>triangle<span class="w"> </span><span class="m">7</span>:<span class="w"> </span><span class="m">0</span>.125
<span class="linenos"> 54</span>Region<span class="w"> </span>of<span class="w"> </span>triangle<span class="w"> </span><span class="m">7</span>:<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 55</span>Label<span class="w"> </span>of<span class="w"> </span>triangle<span class="w"> </span><span class="m">7</span>:<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 56</span>//<span class="w"> </span>Hack<span class="w"> </span>to<span class="w"> </span>get<span class="w"> </span>a<span class="w"> </span>triangle<span class="w"> </span>containing<span class="w"> </span>point<span class="w"> </span>x,<span class="w"> </span>y<span class="w"> </span>or<span class="w"> </span>region<span class="w"> </span>number<span class="w"> </span><span class="o">(</span>old<span class="w"> </span>method<span class="o">)</span>
<span class="linenos"> 57</span>Point<span class="w"> </span><span class="o">(</span><span class="m">0</span>.55,0,6<span class="o">)</span><span class="w"> </span>:
<span class="linenos"> 58</span><span class="w">   </span>Triangle<span class="w"> </span><span class="nv">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span>
<span class="linenos"> 59</span><span class="w">   </span>Region<span class="w"> </span><span class="nv">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="linenos"> 60</span>//<span class="w"> </span>New<span class="w"> </span>method<span class="w"> </span>to<span class="w"> </span>get<span class="w"> </span>boundary<span class="w"> </span>information<span class="w"> </span>and<span class="w"> </span>mesh<span class="w"> </span>adjacent
<span class="linenos"> 61</span>Number<span class="w"> </span>of<span class="w"> </span>boundary<span class="w"> </span><span class="nv">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span>
<span class="linenos"> 62</span>Boundary<span class="w"> </span>element<span class="w"> </span><span class="nv">0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="linenos"> 63</span>Vertex<span class="w"> </span><span class="m">1</span><span class="w"> </span>of<span class="w"> </span>boundary<span class="w"> </span>element<span class="w"> </span><span class="nv">0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="linenos"> 64</span>Triangle<span class="w"> </span>containing<span class="w"> </span>the<span class="w"> </span>boundary<span class="w"> </span>element<span class="w"> </span><span class="nv">0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="linenos"> 65</span>Triangle<span class="w"> </span>edge<span class="w"> </span>number<span class="w"> </span>containing<span class="w"> </span>the<span class="w"> </span>boundary<span class="w"> </span>element<span class="w"> </span><span class="nv">0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
<span class="linenos"> 66</span>Adjacent<span class="w"> </span>triangle<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>triangle<span class="w"> </span><span class="m">0</span><span class="w"> </span>by<span class="w"> </span>edge<span class="w"> </span><span class="nv">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="linenos"> 67</span><span class="w">   </span>Corresponding<span class="w"> </span><span class="nv">edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
<span class="linenos"> 68</span>//<span class="w"> </span>Print<span class="w"> </span>mesh<span class="w"> </span>connectivity
<span class="linenos"> 69</span><span class="m">0</span><span class="w"> </span>:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">4</span>,<span class="w"> </span>label<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 70</span><span class="m">1</span><span class="w"> </span>:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">3</span>,<span class="w"> </span>label<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 71</span><span class="m">2</span><span class="w"> </span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5</span>,<span class="w"> </span>label<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 72</span><span class="m">3</span><span class="w"> </span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">4</span>,<span class="w"> </span>label<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 73</span><span class="m">4</span><span class="w"> </span>:<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">7</span>,<span class="w"> </span>label<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 74</span><span class="m">5</span><span class="w"> </span>:<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">6</span>,<span class="w"> </span>label<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 75</span><span class="m">6</span><span class="w"> </span>:<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">8</span>,<span class="w"> </span>label<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 76</span><span class="m">7</span><span class="w"> </span>:<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">7</span>,<span class="w"> </span>label<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 77</span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">1</span>
<span class="linenos"> 78</span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">1</span>
<span class="linenos"> 79</span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 80</span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">2</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">1</span>
<span class="linenos"> 81</span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 82</span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">1</span>
<span class="linenos"> 83</span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 84</span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">2</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">1</span>
<span class="linenos"> 85</span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 86</span><span class="m">3</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">2</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">1</span>
<span class="linenos"> 87</span><span class="m">3</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">1</span>
<span class="linenos"> 88</span><span class="m">3</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">1</span>
<span class="linenos"> 89</span><span class="m">4</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">1</span>
<span class="linenos"> 90</span><span class="m">4</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">2</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">1</span>
<span class="linenos"> 91</span><span class="m">4</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">1</span>
<span class="linenos"> 92</span><span class="m">5</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 93</span><span class="m">5</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 94</span><span class="m">5</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">1</span>
<span class="linenos"> 95</span><span class="m">6</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 96</span><span class="m">6</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">2</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">1</span>
<span class="linenos"> 97</span><span class="m">6</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">1</span>
<span class="linenos"> 98</span><span class="m">7</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">0</span>
<span class="linenos"> 99</span><span class="m">7</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">1</span>
<span class="linenos">100</span><span class="m">7</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>&lt;<span class="o">=</span>&gt;<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span>adj:<span class="w"> </span><span class="m">1</span>
<span class="linenos">101</span><span class="m">0</span><span class="w"> </span>:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>,<span class="w"> </span>label<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>triangle<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span>
<span class="linenos">102</span><span class="m">1</span><span class="w"> </span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>,<span class="w"> </span>label<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>triangle<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span>
<span class="linenos">103</span><span class="m">2</span><span class="w"> </span>:<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5</span><span class="w"> </span>,<span class="w"> </span>label<span class="w"> </span><span class="m">2</span>,<span class="w"> </span>triangle<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span>
<span class="linenos">104</span><span class="m">3</span><span class="w"> </span>:<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">8</span><span class="w"> </span>,<span class="w"> </span>label<span class="w"> </span><span class="m">2</span>,<span class="w"> </span>triangle<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">0</span>
<span class="linenos">105</span><span class="m">4</span><span class="w"> </span>:<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">7</span><span class="w"> </span>,<span class="w"> </span>label<span class="w"> </span><span class="m">3</span>,<span class="w"> </span>triangle<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">0</span>
<span class="linenos">106</span><span class="m">5</span><span class="w"> </span>:<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">8</span><span class="w"> </span>,<span class="w"> </span>label<span class="w"> </span><span class="m">3</span>,<span class="w"> </span>triangle<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">0</span>
<span class="linenos">107</span><span class="m">6</span><span class="w"> </span>:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">3</span><span class="w"> </span>,<span class="w"> </span>label<span class="w"> </span><span class="m">4</span>,<span class="w"> </span>triangle<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span>
<span class="linenos">108</span><span class="m">7</span><span class="w"> </span>:<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">6</span><span class="w"> </span>,<span class="w"> </span>label<span class="w"> </span><span class="m">4</span>,<span class="w"> </span>triangle<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span>
<span class="linenos">109</span>boundingbox:
<span class="linenos">110</span><span class="nv">xmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="nv">xmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">ymin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="nv">ymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
<p>The real characteristic function of a mesh <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code> is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">chi</span><span class="p">(</span><span class="n">Th</span><span class="p">)</span></code> in 2D and 3D where:</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">chi</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="kr">P</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span></code> if <span class="math notranslate nohighlight">\(P\in Th\)</span></p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">chi</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="kr">P</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span></code> if <span class="math notranslate nohighlight">\(P\not\in Th\)</span></p>
</section>
<section id="the-keyword-triangulate">
<h3>The keyword “triangulate”<a class="headerlink" href="#the-keyword-triangulate" title="Link to this heading"></a></h3>
<p><strong>FreeFEM</strong> is able to build a triangulation from a set of points.
This triangulation is a Delaunay mesh of the convex hull of the set of points.
It can be useful to build a mesh from a table function.</p>
<p>The coordinates of the points and the value of the table function are defined separately with rows of the form: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">x</span><span class="w"> </span><span class="kr">y</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">)</span></code> in a file such as:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="mf">0.51387</span><span class="w"> </span><span class="mf">0.175741</span><span class="w"> </span><span class="mf">0.636237</span>
<span class="linenos">2</span><span class="mf">0.308652</span><span class="w"> </span><span class="mf">0.534534</span><span class="w"> </span><span class="mf">0.746765</span>
<span class="linenos">3</span><span class="mf">0.947628</span><span class="w"> </span><span class="mf">0.171736</span><span class="w"> </span><span class="mf">0.899823</span>
<span class="linenos">4</span><span class="mf">0.702231</span><span class="w"> </span><span class="mf">0.226431</span><span class="w"> </span><span class="mf">0.800819</span>
<span class="linenos">5</span><span class="mf">0.494773</span><span class="w"> </span><span class="mf">0.12472</span><span class="w"> </span><span class="mf">0.580623</span>
<span class="linenos">6</span><span class="mf">0.0838988</span><span class="w"> </span><span class="mf">0.389647</span><span class="w"> </span><span class="mf">0.456045</span>
<span class="linenos">7</span><span class="p">...............</span>
</pre></div>
</div>
<div class="figure compound align-center" id="Triangulate">
<figure class="align-default" id="id35">
<span id="figdelaunaymesh"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Triangulate1.png"><img alt="MeshGeneration_Triangulate1" src="../_images/MeshGeneration_Triangulate1.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 63 </span><span class="caption-text">Delaunay mesh of the convex hull of point set in file xy</span><a class="headerlink" href="#id35" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id36">
<span id="figisovalue"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Triangulate2.png"><img alt="MeshGeneration_Triangulate2" src="../_images/MeshGeneration_Triangulate2.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 64 </span><span class="caption-text">Isolvalue of table function</span><a class="headerlink" href="#id36" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><span class="caption-text">Triangulate</span></p>
</div><p id="Triangulate">The third column of each line is left untouched by the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">triangulate</span></code> command.
But you can use this third value to define a table function with rows of the form: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">x</span><span class="w"> </span><span class="kr">y</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">)</span></code>.</p>
<p>The following example shows how to make a mesh from the file <code class="docutils literal highlight highlight-python"><span></span><span class="n">xyf</span></code> with the format stated just above.
The command <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">triangulate</span></code> only uses the 1st and 2nd columns.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Build the Delaunay mesh of the convex hull</span>
<span class="linenos"> 2</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Thxy</span><span class="o">=</span><span class="nf">triangulate</span><span class="p">(</span><span class="s">&quot;xyf&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">//points are defined by the first 2 columns of file `xyf`</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1">// Plot the created mesh</span>
<span class="linenos"> 5</span><span class="nf">plot</span><span class="p">(</span><span class="n">Thxy</span><span class="p">);</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1">// Fespace</span>
<span class="linenos"> 8</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vhxy</span><span class="p">(</span><span class="n">Thxy</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos"> 9</span><span class="n">Vhxy</span><span class="w"> </span><span class="n">fxy</span><span class="p">;</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="c1">// Reading the 3rd column to define the function fxy</span>
<span class="linenos">12</span><span class="p">{</span>
<span class="linenos">13</span><span class="w">    </span><span class="kt">ifstream</span><span class="w"> </span><span class="kp">file</span><span class="p">(</span><span class="s">&quot;xyf&quot;</span><span class="p">);</span>
<span class="linenos">14</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">yy</span><span class="p">;</span>
<span class="linenos">15</span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">fxy</span><span class="p">.</span><span class="kr">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">16</span><span class="w">        </span><span class="kp">file</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">xx</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">yy</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fxy</span><span class="p">[][</span><span class="n">i</span><span class="p">];</span><span class="w"> </span><span class="c1">//to read third row only.</span>
<span class="linenos">17</span><span class="w">                                      </span><span class="c1">//xx and yy are just skipped</span>
<span class="linenos">18</span><span class="p">}</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="c1">// Plot</span>
<span class="linenos">21</span><span class="nf">plot</span><span class="p">(</span><span class="n">fxy</span><span class="p">);</span>
</pre></div>
</div>
<p>One new way to build a mesh is to have two arrays: one for the <span class="math notranslate nohighlight">\(x\)</span> values and the other for the <span class="math notranslate nohighlight">\(y\)</span> values.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">//set two arrays for the x&#39;s and y&#39;s</span>
<span class="linenos">2</span><span class="n">Vhxy</span><span class="w"> </span><span class="n">xx</span><span class="o">=</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="n">yy</span><span class="o">=</span><span class="kr">y</span><span class="p">;</span>
<span class="linenos">3</span><span class="c1">//build the mesh</span>
<span class="linenos">4</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">triangulate</span><span class="p">(</span><span class="n">xx</span><span class="p">[],</span><span class="w"> </span><span class="n">yy</span><span class="p">[]);</span>
</pre></div>
</div>
</section>
<section id="d-finite-element-space-on-a-boundary">
<h3>2d Finite Element space on a boundary<a class="headerlink" href="#d-finite-element-space-on-a-boundary" title="Link to this heading"></a></h3>
<p>To define a Finite Element space on a boundary, we came up with the idea of a mesh with no internal points (called empty mesh).
It can be useful to handle Lagrange multipliers in mixed and mortar methods.</p>
<p>So the function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">emptymesh</span></code> removes all the internal points of a mesh except points on internal boundaries.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="p">{</span>
<span class="linenos">2</span><span class="w">    </span><span class="kt">border</span><span class="w"> </span><span class="nf">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos">3</span><span class="w">    </span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">20</span><span class="p">));</span>
<span class="linenos">4</span><span class="w">    </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">emptymesh</span><span class="p">(</span><span class="n">Th</span><span class="p">);</span>
<span class="linenos">5</span><span class="w">    </span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">);</span>
<span class="linenos">6</span><span class="p">}</span>
</pre></div>
</div>
<p>It is also possible to build an empty mesh of a pseudo subregion with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">emptymesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">ssd</span><span class="p">)</span></code> using the set of edges from the mesh <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code>; an edge <span class="math notranslate nohighlight">\(e\)</span> is in this set when, with the two adjacent triangles <span class="math notranslate nohighlight">\(e =t1\cap t2\)</span> and <span class="math notranslate nohighlight">\(ssd[T1] \neq ssd[T2]\)</span> where <span class="math notranslate nohighlight">\(ssd\)</span> refers to the pseudo region numbering of triangles, they are stored in the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> array of size “the number of triangles”.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="p">{</span>
<span class="linenos"> 2</span><span class="w">    </span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="linenos"> 3</span><span class="w">    </span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">ssd</span><span class="p">(</span><span class="n">Th</span><span class="p">.</span><span class="kr">nt</span><span class="p">);</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="c1">//build the pseudo region numbering</span>
<span class="linenos"> 5</span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ssd</span><span class="p">.</span><span class="kr">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="linenos"> 6</span><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">iq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="c1">//because 2 triangles per quad</span>
<span class="linenos"> 7</span><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">ix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iq</span><span class="o">%</span><span class="mi">10</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">iy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iq</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>
<span class="linenos"> 9</span><span class="w">        </span><span class="n">ssd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">ix</span><span class="o">&gt;=</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">iy</span><span class="o">&gt;=</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span>
<span class="linenos">10</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">11</span><span class="w">    </span><span class="c1">//build emtpy with all edges $e=T1 \cap T2$ and $ssd[T1] \neq ssd[T2]$</span>
<span class="linenos">12</span><span class="w">    </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">emptymesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">ssd</span><span class="p">);</span>
<span class="linenos">13</span><span class="w">    </span><span class="c1">//plot</span>
<span class="linenos">14</span><span class="w">    </span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">);</span>
<span class="linenos">15</span><span class="w">    </span><span class="nf">savemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;emptymesh.msh&quot;</span><span class="p">);</span>
<span class="linenos">16</span><span class="p">}</span>
</pre></div>
</div>
<div class="figure compound align-center" id="EmptyMesh">
<figure class="align-default" id="id37">
<span id="figemptymesh1"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_EmptyMesh1.png"><img alt="MeshGeneration_EmptyMesh1" src="../_images/MeshGeneration_EmptyMesh1.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 65 </span><span class="caption-text">The empty mesh with boundary</span><a class="headerlink" href="#id37" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id38">
<span id="figemptymesh2"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_EmptyMesh2.png"><img alt="MeshGeneration_EmptyMesh2" src="../_images/MeshGeneration_EmptyMesh2.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 66 </span><span class="caption-text">An empty mesh defined from a pseudo region numbering of triangle</span><a class="headerlink" href="#id38" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><span class="caption-text">Empty mesh</span></p>
</div></section>
<section id="remeshing">
<span id="EmptyMesh"></span><h3>Remeshing<a class="headerlink" href="#remeshing" title="Link to this heading"></a></h3>
<section id="the-command-movemesh">
<span id="meshgenerationmovemesh"></span><h4>The command <em>movemesh</em><a class="headerlink" href="#the-command-movemesh" title="Link to this heading"></a></h4>
<p>Meshes can be translated, rotated, and deformed by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">movemesh</span></code>; this is useful for elasticity to watch the deformation due to the displacement <span class="math notranslate nohighlight">\(\mathbf{\Phi}(x,y)=(\Phi_1(x,y),\Phi_2(x,y))\)</span> of shape.</p>
<p>It is also useful to handle free boundary problems or optimal shape problems.</p>
<p>If <span class="math notranslate nohighlight">\(\Omega\)</span> is triangulated as <span class="math notranslate nohighlight">\(T_h(\Omega)\)</span>, and <span class="math notranslate nohighlight">\(\mathbf{\Phi}\)</span> is a displacement vector then <span class="math notranslate nohighlight">\(\mathbf{\Phi}(T_h)\)</span> is obtained by:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,[</span><span class="n">Phi1</span><span class="p">,</span><span class="w"> </span><span class="n">Phi2</span><span class="p">]);</span>
</pre></div>
</div>
<p>Sometimes the transformed mesh is invalid because some triangles have flipped over (meaning it now has a negative area).
To spot such problems, one may check the minimum triangle area in the transformed mesh with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">checkmovemesh</span></code> before any real transformation.</p>
<p>For example:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{rcl}
    \Phi_1(x,y) &amp;=&amp; x+k*\sin(y*\pi)/10)\\
    \Phi_2(x,y) &amp;=&amp; y+k*\cos(y\pi)/10)
\end{array}\end{split}\]</div>
<p>for a big number <span class="math notranslate nohighlight">\(k&gt;1\)</span>.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kr">verbosity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="c1">// Parameters</span>
<span class="linenos"> 4</span><span class="kt">real</span><span class="w"> </span><span class="kp">coef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="c1">// Mesh</span>
<span class="linenos"> 7</span><span class="kt">border</span><span class="w"> </span><span class="nf">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="linenos"> 8</span><span class="kt">border</span><span class="w"> </span><span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="linenos"> 9</span><span class="kt">border</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="linenos">10</span><span class="kt">border</span><span class="w"> </span><span class="nf">d</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="linenos">11</span><span class="kt">border</span><span class="w"> </span><span class="nf">e</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="linenos">12</span><span class="kt">border</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="linenos">13</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">d</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">6</span><span class="p">));</span>
<span class="linenos">14</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="kp">fill</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;Lshape.eps&quot;</span><span class="p">);</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="c1">// Function</span>
<span class="linenos">17</span><span class="kt">func</span><span class="w"> </span><span class="n">uu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="o">*</span><span class="kr">pi</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>
<span class="linenos">18</span><span class="kt">func</span><span class="w"> </span><span class="n">vv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="o">*</span><span class="kr">pi</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="c1">// Checkmovemesh</span>
<span class="linenos">21</span><span class="kt">real</span><span class="w"> </span><span class="n">minT0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">checkmovemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="p">]);</span><span class="w"> </span><span class="c1">//return the min triangle area</span>
<span class="linenos">22</span><span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span><span class="w"> </span><span class="c1">// find a correct move mesh</span>
<span class="linenos">23</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">minT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">checkmovemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kr">x</span><span class="o">+</span><span class="kp">coef</span><span class="o">*</span><span class="n">uu</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="o">+</span><span class="kp">coef</span><span class="o">*</span><span class="n">vv</span><span class="p">]);</span>
<span class="linenos">24</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">minT</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">minT0</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">break</span><span class="p">;</span><span class="w"> </span><span class="c1">//if big enough</span>
<span class="linenos">25</span><span class="w">    </span><span class="kp">coef</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mf">1.5</span><span class="p">;</span>
<span class="linenos">26</span><span class="p">}</span>
<span class="linenos">27</span>
<span class="linenos">28</span><span class="c1">// Movemesh</span>
<span class="linenos">29</span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kr">x</span><span class="o">+</span><span class="kp">coef</span><span class="o">*</span><span class="n">uu</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="o">+</span><span class="kp">coef</span><span class="o">*</span><span class="n">vv</span><span class="p">]);</span>
<span class="linenos">30</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="kp">fill</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;MovedMesh.eps&quot;</span><span class="p">);</span>
</pre></div>
</div>
<div class="figure compound align-center" id="MoveMesh">
<figure class="align-default" id="id39">
<span id="figlshape"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_MoveMesh1.png"><img alt="MeshGeneration_MoveMesh1" src="../_images/MeshGeneration_MoveMesh1.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 67 </span><span class="caption-text">L-shape</span><a class="headerlink" href="#id39" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id40">
<span id="figmovedlshape"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_MoveMesh2.png"><img alt="MeshGeneration_MoveMesh2" src="../_images/MeshGeneration_MoveMesh2.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 68 </span><span class="caption-text">Moved L-shape</span><a class="headerlink" href="#id40" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><span class="caption-text">Move mesh</span></p>
</div><div class="admonition note" id="MoveMesh">
<p class="admonition-title">Note</p>
<p>Consider a function <span class="math notranslate nohighlight">\(u\)</span> defined on a mesh <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code>.
A statement like <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span><span class="o">=</span><span class="nf">movemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">...)</span></code> does not change <span class="math notranslate nohighlight">\(u\)</span> and so the old mesh still exists.
It will be destroyed when no function uses it.
A statement like <span class="math notranslate nohighlight">\(u=u\)</span> redefines <span class="math notranslate nohighlight">\(u\)</span> on the new mesh <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code> with interpolation and therefore destroys the old <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code>, if <span class="math notranslate nohighlight">\(u\)</span> was the only function using it.</p>
</div>
<p>Now, we give an example of moving a mesh with a Lagrangian function <span class="math notranslate nohighlight">\(u\)</span> defined on the moving mesh.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Parameters</span>
<span class="linenos"> 2</span><span class="kt">int</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="linenos"> 3</span><span class="kt">real</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="c1">// Mesh</span>
<span class="linenos"> 6</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="n">nn</span><span class="p">);</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="c1">// Fespace</span>
<span class="linenos"> 9</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos">10</span><span class="n">Vh</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="kr">y</span><span class="p">;</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="c1">// Loop</span>
<span class="linenos">13</span><span class="kt">real</span><span class="w"> </span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">14</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="linenos">15</span><span class="w">    </span><span class="kp">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="o">*</span><span class="n">dt</span><span class="p">;</span>
<span class="linenos">16</span><span class="w">    </span><span class="n">Vh</span><span class="w"> </span><span class="n">f</span><span class="o">=</span><span class="kr">x</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span>
<span class="linenos">17</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">minarea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">checkmovemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="o">+</span><span class="n">f</span><span class="p">]);</span>
<span class="linenos">18</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">minarea</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="c1">//movemesh will be ok</span>
<span class="linenos">19</span><span class="w">    </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="o">+</span><span class="n">f</span><span class="p">]);</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; Min area = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">minarea</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">22</span>
<span class="linenos">23</span><span class="w">    </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">tmp</span><span class="p">(</span><span class="n">u</span><span class="p">[].</span><span class="kr">n</span><span class="p">);</span>
<span class="linenos">24</span><span class="w">    </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="p">[];</span><span class="w"> </span><span class="c1">//save the value</span>
<span class="linenos">25</span><span class="w">    </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="c1">//to change the FEspace and mesh associated with u</span>
<span class="linenos">26</span><span class="w">    </span><span class="n">u</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span><span class="p">;</span><span class="c1">//set the value of u without any mesh update</span>
<span class="linenos">27</span><span class="w">    </span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos">28</span><span class="p">}</span>
<span class="linenos">29</span><span class="c1">// In this program, since u is only defined on the last mesh, all the</span>
<span class="linenos">30</span><span class="c1">// previous meshes are deleted from memory.</span>
</pre></div>
</div>
</section>
<section id="the-command-htriangle">
<span id="meshregulartriangulation"></span><h4>The command <em>hTriangle</em><a class="headerlink" href="#the-command-htriangle" title="Link to this heading"></a></h4>
<p>This section presents the way to obtain a regular triangulation with <strong>FreeFEM</strong>.</p>
<p>For a set <span class="math notranslate nohighlight">\(S\)</span>, we define the diameter of <span class="math notranslate nohighlight">\(S\)</span> by</p>
<div class="math notranslate nohighlight">
\[\textrm{diam}(S)=\sup\{|\mathbf{x}-\mathbf{y}|; \; \mathbf{x},\, \mathbf{y}\in S\}\]</div>
<p>The sequence <span class="math notranslate nohighlight">\(\{\mathcal{T}_h\}_{h\rightarrow 0}\)</span> of
<span class="math notranslate nohighlight">\(\Omega\)</span> is called <em>regular</em> if they satisfy the following:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\lim_{h\rightarrow 0}\max\{\textrm{diam}(T_k)|\; T_k\in \mathcal{T}_h\}=0\)</span></p></li>
<li><p>There is a number <span class="math notranslate nohighlight">\(\sigma&gt;0\)</span> independent of <span class="math notranslate nohighlight">\(h\)</span> such that <span class="math notranslate nohighlight">\(\frac{\rho(T_k)}{\textrm{diam}(T_k)}\ge \sigma\quad \textrm{for all }T_k\in \mathcal{T}_h\)</span> where <span class="math notranslate nohighlight">\(\rho(T_k)\)</span> are the diameter of the inscribed circle of <span class="math notranslate nohighlight">\(T_k\)</span>.</p></li>
</ol>
<p>We put <span class="math notranslate nohighlight">\(h(\mathcal{T}_h)=\max\{\textrm{diam}(T_k)|\; T_k\in \mathcal{T}_h\}\)</span>, which is obtained by</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">......;</span>
<span class="linenos">2</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Ph</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P0</span><span class="p">);</span>
<span class="linenos">3</span><span class="n">Ph</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">hTriangle</span><span class="p">;</span>
<span class="linenos">4</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;size of mesh = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">h</span><span class="p">[].</span><span class="kr">max</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="the-command-adaptmesh">
<h4>The command <em>adaptmesh</em><a class="headerlink" href="#the-command-adaptmesh" title="Link to this heading"></a></h4>
<p>The function:</p>
<div class="math notranslate nohighlight">
\[f(x,y) = 10.0x^3+y^3+\tan^{-1}[\varepsilon/(\sin(5.0y)-2.0x)],\ \varepsilon = 0.0001\]</div>
<p>sharply varies in value and the initial mesh given by one of the commands in the <a class="reference internal" href="#meshgeneration"><span class="std std-ref">Mesh Generation part</span></a> cannot reflect its sharp variations.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Parameters</span>
<span class="linenos"> 2</span><span class="kt">real</span><span class="w"> </span><span class="kp">eps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0001</span><span class="p">;</span>
<span class="linenos"> 3</span><span class="kt">real</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos"> 4</span><span class="kt">real</span><span class="w"> </span><span class="kp">hmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.05</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="kt">func</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10.0</span><span class="o">*</span><span class="kr">x</span><span class="o">^</span><span class="mi">3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="kr">y</span><span class="o">^</span><span class="mi">3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">h</span><span class="o">*</span><span class="nf">atan2</span><span class="p">(</span><span class="kp">eps</span><span class="p">,</span><span class="w"> </span><span class="nf">sin</span><span class="p">(</span><span class="mf">5.0</span><span class="o">*</span><span class="kr">y</span><span class="p">)</span><span class="mf">-2.0</span><span class="o">*</span><span class="kr">x</span><span class="p">);</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1">// Mesh</span>
<span class="linenos"> 8</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">-1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1">// Fespace</span>
<span class="linenos">11</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos">12</span><span class="n">Vh</span><span class="w"> </span><span class="n">fh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">;</span>
<span class="linenos">13</span><span class="nf">plot</span><span class="p">(</span><span class="n">fh</span><span class="p">);</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="c1">// Adaptmesh</span>
<span class="linenos">16</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="linenos">17</span><span class="w">    </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">fh</span><span class="p">);</span>
<span class="linenos">18</span><span class="w">    </span><span class="n">fh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">;</span><span class="w"> </span><span class="c1">//old mesh is deleted</span>
<span class="linenos">19</span><span class="w">    </span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">fh</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos">20</span><span class="p">}</span>
</pre></div>
</div>
<figure class="align-default" id="figmeshadaptation">
<a class="reference internal image-reference" href="../_images/MeshGeneration_AdaptMesh1.png"><img alt="../_images/MeshGeneration_AdaptMesh1.png" src="../_images/MeshGeneration_AdaptMesh1.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 69 </span><span class="caption-text">3D graphs for the initial mesh and 1st and 2nd mesh adaptations</span><a class="headerlink" href="#figmeshadaptation" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><strong>FreeFEM</strong> uses a variable metric/Delaunay automatic meshing algorithm.</p>
<p>The command:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">mesh</span><span class="w"> </span><span class="n">ATh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">);</span>
</pre></div>
</div>
<p>create the new mesh <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ATh</span></code> adapted to the Hessian</p>
<div class="math notranslate nohighlight">
\[D^2f=(\partial^2 f/\partial x^2,\, \partial^2 f/\partial x\partial y, \partial^2 f/\partial y^2)\]</div>
<p>of a function (formula or FE-function).</p>
<p>Mesh adaptation is a very powerful tool when the solution of a problem varies locally and sharply.</p>
<p>Here we solve the <a class="reference internal" href="../tutorials/poisson.html#tutorialpoisson"><span class="std std-ref">Poisson’s problem</span></a>, when <span class="math notranslate nohighlight">\(f=1\)</span> and <span class="math notranslate nohighlight">\(\Omega\)</span> is an L-shape domain.</p>
<div class="figure compound align-center" id="AdaptMesh">
<figure class="align-default" id="id41">
<span id="adaptmesh2"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_AdaptMesh2.png"><img alt="MeshGeneration_AdaptMesh2" src="../_images/MeshGeneration_AdaptMesh2.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 70 </span><span class="caption-text">L-shape domain and its boundary name</span><a class="headerlink" href="#id41" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id42">
<span id="adaptmesh3"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_AdaptMesh3.png"><img alt="MeshGeneration_AdaptMesh3" src="../_images/MeshGeneration_AdaptMesh3.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 71 </span><span class="caption-text">Final solution after 4-times adaptation</span><a class="headerlink" href="#id42" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><span class="caption-text">Mesh adaptation</span></p>
</div><div class="admonition tip" id="AdaptMesh">
<p class="admonition-title">Tip</p>
<p>The solution has the singularity <span class="math notranslate nohighlight">\(r^{3/2},\, r=|x-\gamma|\)</span> at the point <span class="math notranslate nohighlight">\(\gamma\)</span> of the intersection of two lines <span class="math notranslate nohighlight">\(bc\)</span> and <span class="math notranslate nohighlight">\(bd\)</span> (see <a class="reference internal" href="#adaptmesh2"><span class="std std-numref">Fig. 70</span></a>).</p>
</div>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Parameters</span>
<span class="linenos"> 2</span><span class="kt">real</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1">// Mesh</span>
<span class="linenos"> 5</span><span class="kt">border</span><span class="w"> </span><span class="nf">ba</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos"> 6</span><span class="kt">border</span><span class="w"> </span><span class="kp">bb</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos"> 7</span><span class="kt">border</span><span class="w"> </span><span class="nf">bc</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos"> 8</span><span class="kt">border</span><span class="w"> </span><span class="nf">bd</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos"> 9</span><span class="kt">border</span><span class="w"> </span><span class="kr">be</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos">10</span><span class="kt">border</span><span class="w"> </span><span class="nf">bf</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos">11</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">ba</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="kp">bb</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">bc</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">bd</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="kr">be</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">bf</span><span class="p">(</span><span class="mi">6</span><span class="p">));</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="c1">// Fespace</span>
<span class="linenos">14</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos">15</span><span class="n">Vh</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="c1">// Function</span>
<span class="linenos">18</span><span class="kt">func</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="c1">// Problem</span>
<span class="linenos">21</span><span class="kt">problem</span><span class="w"> </span><span class="nf">Poisson</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">,</span><span class="w"> </span><span class="kp">eps</span><span class="o">=</span><span class="mf">1.</span><span class="n">e</span><span class="mi">-6</span><span class="p">)</span>
<span class="linenos">22</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos">23</span><span class="w">          </span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos">24</span><span class="w">        </span><span class="o">+</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos">25</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">26</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos">27</span><span class="w">          </span><span class="n">f</span><span class="o">*</span><span class="n">v</span>
<span class="linenos">28</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">29</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
<span class="linenos">30</span>
<span class="linenos">31</span><span class="c1">// Adaptmesh loop</span>
<span class="linenos">32</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="linenos">33</span><span class="w">    </span><span class="n">Poisson</span><span class="p">;</span>
<span class="linenos">34</span><span class="w">    </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kp">err</span><span class="o">=</span><span class="n">error</span><span class="p">);</span>
<span class="linenos">35</span><span class="w">    </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="linenos">36</span><span class="p">}</span>
<span class="linenos">37</span>
<span class="linenos">38</span><span class="c1">// Plot</span>
<span class="linenos">39</span><span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
</pre></div>
</div>
<p>To speed up the adaptation, the default parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">err</span></code> of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">adaptmesh</span></code> is changed by hand; it specifies the required precision, so as to make the new mesh finer or coarser.</p>
<p>The problem is coercive and symmetric, so the linear system can be solved with the conjugate gradient method (parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span></code>) with the stopping criteria on the residual, here <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">eps</span><span class="o">=</span><span class="mf">1.</span><span class="n">e</span><span class="mi">-6</span></code>).</p>
<p>By <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">adaptmesh</span></code>, the slope of the final solution is correctly computed near the point of intersection of <span class="math notranslate nohighlight">\(bc\)</span> and <span class="math notranslate nohighlight">\(bd\)</span> as in <a class="reference internal" href="#adaptmesh3"><span class="std std-numref">Fig. 71</span></a>.</p>
<p>This method is described in detail in <a class="reference internal" href="../bibliography.html#hecht1998" id="id1"><span>[HECHT1998]</span></a>.
It has a number of default parameters which can be modified.</p>
<p>If <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span></code> are functions and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">thold</span><span class="p">,</span><span class="w"> </span><span class="n">Thnew</span></code> are meshes:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w">   </span><span class="n">Thnew</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Thold</span><span class="p">,</span><span class="w"> </span><span class="n">f1</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">2</span><span class="w">   </span><span class="n">Thnew</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Thold</span><span class="p">,</span><span class="w"> </span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">]);</span>
<span class="linenos">3</span><span class="w">   </span><span class="n">Thnew</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Thold</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">]</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">);</span>
</pre></div>
</div>
<p>The additional parameters of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">adaptmesh</span></code> are:</p>
<p>See <a class="reference internal" href="../references/functions.html#referenceadaptmesh"><span class="std std-ref">Reference part</span></a> for more inforamtions</p>
<ul>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">hmin</span><span class="o">=</span></code> Minimum edge size.</dt><dd><p>Its default is related to the size of the domain to be meshed and the precision of the mesh generator.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">hmax</span><span class="o">=</span></code> Maximum edge size.</dt><dd><p>It defaults to the diameter of the domain to be meshed.</p>
</dd>
</dl>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">err</span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(P_1\)</span> interpolation error level (0.01 is the default).</p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">errg</span><span class="o">=</span></code> Relative geometrical error.</dt><dd><p>By default this error is 0.01, and in any case it must be lower than <span class="math notranslate nohighlight">\(1/\sqrt{2}\)</span>.
Meshes created with this option may have some edges smaller than the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="o">-</span><span class="kp">hmin</span></code> due to geometrical constraints.</p>
</dd>
</dl>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbvx</span><span class="o">=</span></code> Maximum number of vertices generated by the mesh generator (9000 is the default).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbsmooth</span><span class="o">=</span></code> number of iterations of the smoothing procedure (5 is the default).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbjacoby</span><span class="o">=</span></code> number of iterations in a smoothing procedure during the metric construction, 0 means no smoothing, 6 is the default.</p></li>
<li><dl>
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ratio</span><span class="o">=</span></code> ratio for a prescribed smoothing on the metric.</dt><dd><p>If the value is 0 or less than 1.1 no smoothing is done on the metric. 1.8 is the default.
If <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ratio</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">1.1</span></code>, the speed of mesh size variations is bounded by <span class="math notranslate nohighlight">\(log(\mathtt{ratio})\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ratio</span></code> gets closer to 1, the number of generated vertices increases.
This may be useful to control the thickness of refined regions near shocks or boundary layers.</p>
</div>
</dd>
</dl>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">omega</span><span class="o">=</span></code> relaxation parameter for the smoothing procedure. 1.0 is the default.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">iso</span><span class="o">=</span></code> If true, forces the metric to be isotropic. <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">false</span></code> is the default.</p></li>
<li><dl>
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">abserror</span><span class="o">=</span></code> If false, the metric is evaluated using the criteria of equi-repartion of relative error.</dt><dd><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">false</span></code> is the default.
In this case the metric is defined by:</p>
<div class="math notranslate nohighlight">
\[\mathcal{M} = \left({1\over\mathtt{err}\,\, \mathtt{coef}^2} \quad {
|\mathcal{H}| \over max(\mathtt{CutOff},|\eta|)}\right)^p\]</div>
<p>Otherwise, the metric is evaluated using the criteria of equi-distribution of errors.
In this case the metric is defined by:</p>
<div class="math notranslate nohighlight">
\[\mathcal{M} = \left({1\over \mathtt{err}\,\,\mathtt{coef}^2} \quad
{|{\mathcal{H}|} \over
{\sup(\eta)-\inf(\eta)}}\right)^p.\label{eq err abs}\]</div>
</dd>
</dl>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">cutoff</span><span class="o">=</span></code> lower limit for the relative error evaluation.
1.0e-6 is the default.</p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">verbosity</span><span class="o">=</span></code> informational messages level (can be chosen between 0 and <span class="math notranslate nohighlight">\(\infty\)</span>).</dt><dd><p>Also changes the value of the global variable verbosity (obsolete).</p>
</dd>
</dl>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">inquire</span><span class="o">=</span></code> To inquire graphically about the mesh.
<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">false</span></code> is the default.</p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">splitpbedge</span><span class="o">=</span></code> If true, splits all internal edges in half with two boundary vertices.</dt><dd><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">true</span></code> is the default.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">maxsubdiv</span><span class="o">=</span></code> Changes the metric such that the maximum subdivision of a background edge is bound by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">val</span></code>.</dt><dd><p>Always limited by 10, and 10 is also the default.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">rescaling</span><span class="o">=</span></code> if true, the function, with respect to which the mesh is adapted, is rescaled to be between 0 and 1.</dt><dd><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">true</span></code> is the default.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">keepbackvertices</span><span class="o">=</span></code> if true, tries to keep as many vertices from the original mesh as possible.</dt><dd><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">true</span></code> is the default.</p>
</dd>
</dl>
</li>
<li><dl>
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">IsMetric</span><span class="o">=</span></code> if true, the metric is defined explicitly.</dt><dd><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">false</span></code> is the default.
If the 3 functions <span class="math notranslate nohighlight">\(m_{11}, m_{12}, m_{22}\)</span> are given, they directly define a symmetric matrix field whose Hessian is computed to define a metric.
If only one function is given, then it represents the isotropic mesh size at every point.</p>
<p>For example, if the partial derivatives <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">fxx</span></code> (<span class="math notranslate nohighlight">\(=\partial^2 f/\partial x^2\)</span>), <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">fxy</span></code> (<span class="math notranslate nohighlight">\(=\partial^2 f/\partial x\partial y\)</span>), <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">fyy</span></code> (<span class="math notranslate nohighlight">\(=\partial^2 f/\partial y^2\)</span>) are given, we can set <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">fxx</span><span class="p">,</span><span class="w"> </span><span class="n">fxy</span><span class="p">,</span><span class="w"> </span><span class="n">fyy</span><span class="p">,</span><span class="w"> </span><span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">nbvx</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span><span class="w"> </span><span class="kp">hmin</span><span class="o">=</span><span class="kp">hmin</span><span class="p">);</span></code></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">power</span><span class="o">=</span></code> exponent power of the Hessian used to compute the metric.</dt><dd><p>1 is the default.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">thetamax</span><span class="o">=</span></code> minimum corner angle in degrees.</dt><dd><p>Default is <span class="math notranslate nohighlight">\(10^\circ\)</span> where the corner is <span class="math notranslate nohighlight">\(ABC\)</span> and the angle is the angle of the two vectors <span class="math notranslate nohighlight">\({AB}, {BC}\)</span>, (<span class="math notranslate nohighlight">\(0\)</span> imply no corner, <span class="math notranslate nohighlight">\(90\)</span> imply perpendicular corner, …).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">splitin2</span><span class="o">=</span></code> boolean value.</dt><dd><p>If true, splits all triangles of the final mesh into 4 sub-triangles.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">metric</span><span class="o">=</span></code> an array of 3 real arrays to set or get metric data information.</dt><dd><p>The size of these three arrays must be the number of vertices.
So if <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">m11</span><span class="p">,</span><span class="n">m12</span><span class="p">,</span><span class="n">m22</span></code> are three P1 finite elements related to the mesh to adapt, you can write: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">metric</span><span class="o">=</span><span class="p">[</span><span class="n">m11</span><span class="p">[],</span><span class="n">m12</span><span class="p">[],</span><span class="n">m22</span><span class="p">[]]</span></code> (see file <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">convect</span><span class="o">-</span><span class="n">apt</span><span class="p">.</span><span class="n">edp</span></code> for a full example)</p>
</dd>
</dl>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nomeshgeneration</span><span class="o">=</span></code> If true, no adapted mesh is generated (useful to compute only a metric).</p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">periodic</span><span class="o">=</span></code> Writing <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">periodic</span><span class="o">=</span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span><span class="kr">y</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="kr">y</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="kr">x</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="kr">x</span><span class="p">]];</span></code> builds an adapted periodic mesh.</dt><dd><p>The sample builds a biperiodic mesh of a square.
(see <a class="reference internal" href="finite-element.html#finiteelement"><span class="std std-ref">periodic finite element spaces</span></a>, and see <a class="reference internal" href="../examples/mesh-generation.html#examplesphere"><span class="std std-ref">the Sphere example</span></a> for a full example)</p>
</dd>
</dl>
</li>
</ul>
<p>We can use the command <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">adaptmesh</span></code> to build a uniform mesh with a constant mesh size.
To build a mesh with a constant mesh size equal to <span class="math notranslate nohighlight">\(\frac{1}{30}\)</span> try:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="o">=</span><span class="nf">square</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="c1">//the initial mesh</span>
<span class="linenos">2</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;square-0.eps&quot;</span><span class="p">);</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="mf">30.</span><span class="p">,</span><span class="w"> </span><span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">nbvx</span><span class="o">=</span><span class="mi">10000</span><span class="p">);</span>
<span class="linenos">5</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;square-1.eps&quot;</span><span class="p">);</span>
<span class="linenos">6</span>
<span class="linenos">7</span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="mf">30.</span><span class="p">,</span><span class="w"> </span><span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">nbvx</span><span class="o">=</span><span class="mi">10000</span><span class="p">);</span><span class="w"> </span><span class="c1">//More the one time du to</span>
<span class="linenos">8</span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="mf">30.</span><span class="p">,</span><span class="w"> </span><span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">nbvx</span><span class="o">=</span><span class="mi">10000</span><span class="p">);</span><span class="w"> </span><span class="c1">//Adaptation bound `maxsubdiv=`</span>
<span class="linenos">9</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;square-2.eps&quot;</span><span class="p">);</span>
</pre></div>
</div>
<div class="figure compound align-center" id="AdaptMesh2">
<figure class="align-default" id="id43">
<span id="adaptmesh4"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_AdaptMesh4.png"><img alt="MeshGeneration_AdaptMesh4" src="../_images/MeshGeneration_AdaptMesh4.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 72 </span><span class="caption-text">Initial mesh</span><a class="headerlink" href="#id43" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id44">
<span id="adaptmesh5"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_AdaptMesh5.png"><img alt="MeshGeneration_AdaptMesh5" src="../_images/MeshGeneration_AdaptMesh5.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 73 </span><span class="caption-text">First iteration</span><a class="headerlink" href="#id44" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id45">
<span id="adaptmesh6"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_AdaptMesh6.png"><img alt="MeshGeneration_AdaptMesh6" src="../_images/MeshGeneration_AdaptMesh6.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 74 </span><span class="caption-text">Last iteration</span><a class="headerlink" href="#id45" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><span class="caption-text">Mesh adaptation</span></p>
</div></section>
<section id="the-command-trunc">
<span id="AdaptMesh2"></span><h4>The command <em>trunc</em><a class="headerlink" href="#the-command-trunc" title="Link to this heading"></a></h4>
<p>Two operators have been introduced to remove triangles from a mesh or to divide them.
Operator <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">trunc</span></code> has the following parameters:</p>
<ul class="simple">
<li><p>boolean function to keep or remove elements</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span><span class="o">=</span></code> sets the label number of new boundary item, one by default.</p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">split</span><span class="o">=</span></code> sets the level <span class="math notranslate nohighlight">\(n\)</span> of triangle splitting.</dt><dd><p>Each triangle is split in <span class="math notranslate nohighlight">\(n\times n\)</span>, one by default.</p>
</dd>
</dl>
</li>
</ul>
<p>To create the mesh <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th3</span></code> where all triangles of a mesh <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code> are split in <span class="math notranslate nohighlight">\(3{\times}3\)</span>, just write:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">trunc</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">split</span><span class="o">=</span><span class="mi">3</span><span class="p">);</span>
</pre></div>
</div>
<p>The following example construct all “trunced” meshes to the support of the basic function of the space <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Vh</span></code> (cf. <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">abs</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span></code>), split all the triangles in <span class="math notranslate nohighlight">\(5{\times} 5\)</span>, and put a label number to <span class="math notranslate nohighlight">\(2\)</span> on a new boundary.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Mesh</span>
<span class="linenos"> 2</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1">// Fespace</span>
<span class="linenos"> 5</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos"> 6</span><span class="n">Vh</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="c1">// Loop on all degrees of freedom</span>
<span class="linenos"> 9</span><span class="kt">int</span><span class="w"> </span><span class="kr">n</span><span class="o">=</span><span class="n">u</span><span class="p">.</span><span class="kr">n</span><span class="p">;</span>
<span class="linenos">10</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="kr">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="linenos">11</span><span class="w">    </span><span class="n">u</span><span class="p">[][</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// The basis function i</span>
<span class="linenos">12</span><span class="w">    </span><span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos">13</span><span class="w">    </span><span class="kt">mesh</span><span class="w"> </span><span class="n">Sh1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">trunc</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">1.</span><span class="n">e</span><span class="mi">-10</span><span class="p">,</span><span class="w"> </span><span class="kp">split</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos">14</span><span class="w">    </span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">Sh1</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;</span><span class="nf">trunc</span><span class="s">&quot;</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="s">&quot;.eps&quot;</span><span class="p">);</span>
<span class="linenos">15</span><span class="w">    </span><span class="n">u</span><span class="p">[][</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// reset</span>
<span class="linenos">16</span><span class="p">}</span>
</pre></div>
</div>
<div class="figure compound align-center" id="Trunc">
<figure class="align-default" id="id46">
<span id="trunc1"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Trunc1.png"><img alt="MeshGeneration_Trunc1" src="../_images/MeshGeneration_Trunc1.png" style="width: 49%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 75 </span><span class="caption-text">Mesh of support the function P1 number 0, split in <span class="math notranslate nohighlight">\(5{\times}5\)</span></span><a class="headerlink" href="#id46" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id47">
<span id="trunc6"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Trunc1.png"><img alt="MeshGeneration_Trunc1" src="../_images/MeshGeneration_Trunc1.png" style="width: 49%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 76 </span><span class="caption-text">Mesh of support the function P1 number 6, split in <span class="math notranslate nohighlight">\(5{\times}5\)</span></span><a class="headerlink" href="#id47" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><span class="caption-text">Trunc</span></p>
</div></section>
<section id="the-command-change">
<span id="Trunc"></span><h4>The command <em>change</em><a class="headerlink" href="#the-command-change" title="Link to this heading"></a></h4>
<p>This command changes the label of elements and border elements of a mesh.</p>
<p>Changing the label of elements and border elements will be done using the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">change</span></code>.
The parameters for this command line are for two dimensional and three dimensional cases:</p>
<ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">refe</span><span class="o">=</span></code> is an array of integers to change the references on edges</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">reft</span><span class="o">=</span></code> is an array of integers to change the references on triangles</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span><span class="o">=</span></code> is an array of integers to change the 4 default label numbers</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">region</span><span class="o">=</span></code> is an array of integers to change the default region numbers</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">renumv</span><span class="o">=</span></code> is an array of integers, which explicitly gives the new numbering of vertices in the new mesh. By default, this numbering is that of the original mesh</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">renumt</span><span class="o">=</span></code> is an array of integers, which explicitly gives the new numbering of elements in the new mesh, according the new vertices numbering given by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">renumv</span><span class="o">=</span></code>. By default, this numbering is that of the original mesh</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">flabel</span><span class="o">=</span></code> is an integer function given the new value of the label</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">fregion</span><span class="o">=</span></code> is an integer function given the new value of the region</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">rmledges</span><span class="o">=</span></code> is an integer to remove edges in the new mesh, following a label</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">rmInternalEdges</span><span class="o">=</span></code> is a boolean, if equal to true to remove the internal edges. By default, the internal edges are stored</p></li>
</ul>
<p>These vectors are composed of <span class="math notranslate nohighlight">\(n_{l}\)</span> successive pairs of numbers <span class="math notranslate nohighlight">\(O,N\)</span> where <span class="math notranslate nohighlight">\(n_{l}\)</span> is the number (label or region) that we want to change.
For example, we have :</p>
<div class="math notranslate nohighlight" id="equation-eq-org-vector-change-label">
<span class="eqno">(8)<a class="headerlink" href="#equation-eq-org-vector-change-label" title="Link to this equation"></a></span>\[\begin{split}\mathtt{label} &amp;= [ O_{1}, N_{1}, ..., O_{n_{l}},N_{n_{l}} ] \\
\mathtt{region} &amp;= [ O_{1}, N_{1}, ..., O_{n_{l}},N_{n_{l}} ]\end{split}\]</div>
<p>An application example is given here:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Mesh</span>
<span class="linenos"> 2</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="linenos"> 3</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kr">x</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="p">]);</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">r1</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span>
<span class="linenos"> 6</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th1</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="n">Th1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">change</span><span class="p">(</span><span class="n">Th1</span><span class="p">,</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">r1</span><span class="p">);</span><span class="w"> </span><span class="c1">//change the label of Edges 2 in 0.</span>
<span class="linenos"> 9</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th1</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="c1">// boundary label: 1 -&gt; 1 bottom, 2 -&gt; 1 right, 3-&gt;1 top, 4-&gt;1 left boundary label is 1</span>
<span class="linenos">12</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="kr">re</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">13</span><span class="n">Th2</span><span class="o">=</span><span class="nf">change</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span><span class="kp">refe</span><span class="o">=</span><span class="kr">re</span><span class="p">);</span>
<span class="linenos">14</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span><span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="the-command-splitmesh">
<h4>The command <em>splitmesh</em><a class="headerlink" href="#the-command-splitmesh" title="Link to this heading"></a></h4>
<p>Another way to split mesh triangles is to use <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">splitmesh</span></code>, for example:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">// Mesh</span>
<span class="linenos">2</span><span class="kt">border</span><span class="w"> </span><span class="nf">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos">3</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">20</span><span class="p">));</span>
<span class="linenos">4</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;NotSplittedMesh.eps&quot;</span><span class="p">);</span>
<span class="linenos">5</span>
<span class="linenos">6</span><span class="c1">// Splitmesh</span>
<span class="linenos">7</span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">splitmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="nf">square</span><span class="p">(</span><span class="kr">x</span><span class="mf">-0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="kr">y</span><span class="o">*</span><span class="kr">y</span><span class="p">));</span>
<span class="linenos">8</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;SplittedMesh.eps&quot;</span><span class="p">);</span>
</pre></div>
</div>
<div class="figure compound align-center" id="SplitMesh">
<figure class="align-default" id="id48">
<span id="splitmesh1"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_SplitMesh1.png"><img alt="MeshGeneration_SplitMesh1" src="../_images/MeshGeneration_SplitMesh1.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 77 </span><span class="caption-text">Initial mesh</span><a class="headerlink" href="#id48" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id49">
<span id="splitmesh2"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_SplitMesh2.png"><img alt="MeshGeneration_SplitMesh2" src="../_images/MeshGeneration_SplitMesh2.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 78 </span><span class="caption-text">All left mesh triangle is split conformaly in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="nf">square</span><span class="p">(</span><span class="kr">x</span><span class="mf">-0.5</span><span class="p">)</span><span class="o">+</span><span class="kr">y</span><span class="o">*</span><span class="kr">y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span></code> triangles</span><a class="headerlink" href="#id49" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><span class="caption-text">Split mesh</span></p>
</div></section>
</section>
<section id="meshing-examples">
<span id="meshexamples"></span><span id="SplitMesh"></span><h3>Meshing Examples<a class="headerlink" href="#meshing-examples" title="Link to this heading"></a></h3>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Two rectangles touching by a side</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">border</span><span class="w"> </span><span class="nf">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;};</span>
<span class="linenos"> 2</span><span class="kt">border</span><span class="w"> </span><span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;};</span>
<span class="linenos"> 3</span><span class="kt">border</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="linenos"> 4</span><span class="kt">border</span><span class="w"> </span><span class="nf">d</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;};</span>
<span class="linenos"> 5</span><span class="kt">border</span><span class="w"> </span><span class="nf">c1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="linenos"> 6</span><span class="kt">border</span><span class="w"> </span><span class="nf">e</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="kp">t</span><span class="p">;};</span>
<span class="linenos"> 7</span><span class="kt">border</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">1.2</span><span class="p">;};</span>
<span class="linenos"> 8</span><span class="kt">border</span><span class="w"> </span><span class="nf">g</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="kp">t</span><span class="p">;};</span>
<span class="linenos"> 9</span><span class="kt">int</span><span class="w"> </span><span class="kr">n</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="linenos">10</span><span class="kt">mesh</span><span class="w"> </span><span class="n">th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">d</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="kr">n</span><span class="p">));</span>
<span class="linenos">11</span><span class="kt">mesh</span><span class="w"> </span><span class="n">TH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">c1</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="kr">n</span><span class="p">));</span>
<span class="linenos">12</span><span class="nf">plot</span><span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="w"> </span><span class="n">TH</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;TouchSide.esp&quot;</span><span class="p">);</span>
</pre></div>
</div>
<figure class="align-default" id="naca00121">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_NACA0012_1.png"><img alt="../_images/MeshGeneration_Example_NACA0012_1.png" src="../_images/MeshGeneration_Example_NACA0012_1.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 79 </span><span class="caption-text">Two rectangles touching by a side</span><a class="headerlink" href="#naca00121" title="Link to this image"></a></p>
</figcaption>
</figure>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>NACA0012 Airfoil</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">border</span><span class="w"> </span><span class="nf">upper</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">0.17735</span><span class="o">*</span><span class="nf">sqrt</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.075597</span><span class="o">*</span><span class="kp">t</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.212836</span><span class="o">*</span><span class="p">(</span><span class="kp">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.17363</span><span class="o">*</span><span class="p">(</span><span class="kp">t</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.06254</span><span class="o">*</span><span class="p">(</span><span class="kp">t</span><span class="o">^</span><span class="mi">4</span><span class="p">);}</span>
<span class="linenos">2</span><span class="kt">border</span><span class="w"> </span><span class="nf">lower</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=-</span><span class="p">(</span><span class="mf">0.17735</span><span class="o">*</span><span class="nf">sqrt</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="w"> </span><span class="mf">-0.075597</span><span class="o">*</span><span class="kp">t</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.212836</span><span class="o">*</span><span class="p">(</span><span class="kp">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.17363</span><span class="o">*</span><span class="p">(</span><span class="kp">t</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.06254</span><span class="o">*</span><span class="p">(</span><span class="kp">t</span><span class="o">^</span><span class="mi">4</span><span class="p">));}</span>
<span class="linenos">3</span><span class="kt">border</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.8</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">0.8</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);}</span>
<span class="linenos">4</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">upper</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lower</span><span class="p">(</span><span class="mi">35</span><span class="p">));</span>
<span class="linenos">5</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;NACA0012.eps&quot;</span><span class="p">,</span><span class="w"> </span><span class="kp">bw</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</div>
<figure class="align-default" id="naca00122">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_NACA0012_2.png"><img alt="../_images/MeshGeneration_Example_NACA0012_2.png" src="../_images/MeshGeneration_Example_NACA0012_2.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 80 </span><span class="caption-text">NACA0012 Airfoil</span><a class="headerlink" href="#naca00122" title="Link to this image"></a></p>
</figcaption>
</figure>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Cardioid</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">real</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="linenos">2</span><span class="kt">border</span><span class="w"> </span><span class="nf">C</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="nf">cos</span><span class="p">((</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="kp">t</span><span class="o">/</span><span class="n">b</span><span class="p">);</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="nf">sin</span><span class="p">((</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="kp">t</span><span class="o">/</span><span class="n">b</span><span class="p">);}</span>
<span class="linenos">3</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="mi">50</span><span class="p">));</span>
<span class="linenos">4</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;Cardioid.eps&quot;</span><span class="p">,</span><span class="w"> </span><span class="kp">bw</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</div>
<figure class="align-default" id="cardioid1">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_Cardioid1.png"><img alt="../_images/MeshGeneration_Example_Cardioid1.png" src="../_images/MeshGeneration_Example_Cardioid1.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 81 </span><span class="caption-text">Domain with Cardioid curve boundary</span><a class="headerlink" href="#cardioid1" title="Link to this image"></a></p>
</figcaption>
</figure>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Cassini Egg</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">border</span><span class="w"> </span><span class="nf">C</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="kr">x</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="kp">t</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="kp">t</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);}</span>
<span class="linenos">2</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="mi">50</span><span class="p">));</span>
<span class="linenos">3</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;Cassini.eps&quot;</span><span class="p">,</span><span class="w"> </span><span class="kp">bw</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</div>
<figure class="align-default" id="cardioid2">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_Cardioid2.png"><img alt="../_images/MeshGeneration_Example_Cardioid2.png" src="../_images/MeshGeneration_Example_Cardioid2.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 82 </span><span class="caption-text">Domain with Cassini egg curve boundary</span><a class="headerlink" href="#cardioid2" title="Link to this image"></a></p>
</figcaption>
</figure>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>By cubic Bezier curve</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// A cubic Bezier curve connecting two points with two control points</span>
<span class="linenos"> 2</span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">bzi</span><span class="p">(</span><span class="kt">real</span><span class="w"> </span><span class="n">p0</span><span class="p">,</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">q1</span><span class="p">,</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">q2</span><span class="p">,</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="kp">t</span><span class="p">){</span>
<span class="linenos"> 3</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">p0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q1</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="kp">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">)</span><span class="o">*</span><span class="kp">t</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p1</span><span class="o">*</span><span class="kp">t</span><span class="o">^</span><span class="mi">3</span><span class="p">;</span>
<span class="linenos"> 4</span><span class="p">}</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">p00</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">p01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">],</span><span class="w"> </span><span class="n">q00</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">],</span><span class="w"> </span><span class="n">q01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.5</span><span class="p">];</span>
<span class="linenos"> 7</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">p11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mf">-0.9</span><span class="p">],</span><span class="w"> </span><span class="n">q10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.95</span><span class="p">],</span><span class="w"> </span><span class="n">q11</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">];</span>
<span class="linenos"> 8</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">p21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7</span><span class="p">],</span><span class="w"> </span><span class="n">q20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.4</span><span class="p">],</span><span class="w"> </span><span class="n">q21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">];</span>
<span class="linenos"> 9</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">q30</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">1.1</span><span class="p">],</span><span class="w"> </span><span class="n">q31</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.5</span><span class="p">,</span><span class="w"> </span><span class="mf">1.2</span><span class="p">];</span>
<span class="linenos">10</span><span class="kt">border</span><span class="w"> </span><span class="nf">G1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span>
<span class="linenos">11</span><span class="w">    </span><span class="kr">x</span><span class="o">=</span><span class="n">bzi</span><span class="p">(</span><span class="n">p00</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">p01</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">q00</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">q01</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="kp">t</span><span class="p">);</span>
<span class="linenos">12</span><span class="w">    </span><span class="kr">y</span><span class="o">=</span><span class="n">bzi</span><span class="p">(</span><span class="n">p00</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">p01</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">q00</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">q01</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="kp">t</span><span class="p">);</span>
<span class="linenos">13</span><span class="p">}</span>
<span class="linenos">14</span><span class="kt">border</span><span class="w"> </span><span class="nf">G2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span>
<span class="linenos">15</span><span class="w">    </span><span class="kr">x</span><span class="o">=</span><span class="n">bzi</span><span class="p">(</span><span class="n">p01</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">p11</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">q10</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">q11</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="kp">t</span><span class="p">);</span>
<span class="linenos">16</span><span class="w">    </span><span class="kr">y</span><span class="o">=</span><span class="n">bzi</span><span class="p">(</span><span class="n">p01</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">p11</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">q10</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">q11</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="kp">t</span><span class="p">);</span>
<span class="linenos">17</span><span class="p">}</span>
<span class="linenos">18</span><span class="kt">border</span><span class="w"> </span><span class="nf">G3</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span>
<span class="linenos">19</span><span class="w">    </span><span class="kr">x</span><span class="o">=</span><span class="n">bzi</span><span class="p">(</span><span class="n">p11</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">p21</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">q20</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">q21</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="kp">t</span><span class="p">);</span>
<span class="linenos">20</span><span class="w">    </span><span class="kr">y</span><span class="o">=</span><span class="n">bzi</span><span class="p">(</span><span class="n">p11</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">p21</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">q20</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">q21</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="kp">t</span><span class="p">);</span>
<span class="linenos">21</span><span class="p">}</span>
<span class="linenos">22</span><span class="kt">border</span><span class="w"> </span><span class="nf">G4</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span>
<span class="linenos">23</span><span class="w">    </span><span class="kr">x</span><span class="o">=</span><span class="n">bzi</span><span class="p">(</span><span class="n">p21</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">p00</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">q30</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">q31</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="kp">t</span><span class="p">);</span>
<span class="linenos">24</span><span class="w">    </span><span class="kr">y</span><span class="o">=</span><span class="n">bzi</span><span class="p">(</span><span class="n">p21</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">p00</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">q30</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">q31</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="kp">t</span><span class="p">);</span>
<span class="linenos">25</span><span class="p">}</span>
<span class="linenos">26</span><span class="kt">int</span><span class="w"> </span><span class="kr">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="linenos">27</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">G1</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="kr">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">G2</span><span class="p">(</span><span class="kr">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">G3</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="kr">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">G4</span><span class="p">(</span><span class="kr">m</span><span class="p">));</span>
<span class="linenos">28</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;Bezier.eps&quot;</span><span class="p">,</span><span class="w"> </span><span class="kp">bw</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</div>
<figure class="align-default" id="bezier">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_Bezier.png"><img alt="../_images/MeshGeneration_Example_Bezier.png" src="../_images/MeshGeneration_Example_Bezier.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 83 </span><span class="caption-text">Boundary drawn by Bezier curves</span><a class="headerlink" href="#bezier" title="Link to this image"></a></p>
</figcaption>
</figure>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Section of Engine</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">real</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6.</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kt">border</span><span class="w"> </span><span class="nf">L1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="n">a</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">b</span><span class="mi">-2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="kp">t</span><span class="p">;}</span>
<span class="linenos"> 4</span><span class="kt">border</span><span class="w"> </span><span class="nf">L2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">-1</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="kr">x</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="kr">x</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3-2</span><span class="o">*</span><span class="nf">abs</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">/</span><span class="n">a</span><span class="w"> </span><span class="p">);}</span>
<span class="linenos"> 5</span><span class="kt">border</span><span class="w"> </span><span class="nf">L3</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">a</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">-1</span><span class="o">-</span><span class="n">b</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos"> 6</span><span class="kt">border</span><span class="w"> </span><span class="nf">L4</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">a</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
<span class="linenos"> 7</span><span class="kt">border</span><span class="w"> </span><span class="nf">L5</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="n">c</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="n">c</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;}</span>
<span class="linenos"> 8</span><span class="kt">border</span><span class="w"> </span><span class="nf">L6</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="n">c</span><span class="p">;}</span>
<span class="linenos"> 9</span><span class="kt">border</span><span class="w"> </span><span class="nf">L7</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">a</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="n">c</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">b</span><span class="o">-</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="kp">t</span><span class="p">;}</span>
<span class="linenos">10</span><span class="kt">border</span><span class="w"> </span><span class="nf">L8</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">a</span><span class="mi">-2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="kr">x</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="kr">x</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3-2</span><span class="o">*</span><span class="nf">abs</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">/</span><span class="n">a</span><span class="p">);}</span>
<span class="linenos">11</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">L1</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">L2</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">L3</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">L4</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">L5</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">L6</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">L7</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">L8</span><span class="p">(</span><span class="mi">30</span><span class="p">));</span>
<span class="linenos">12</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;Engine.eps&quot;</span><span class="p">,</span><span class="w"> </span><span class="kp">bw</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</div>
<figure class="align-default" id="engine">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_Engine.png"><img alt="../_images/MeshGeneration_Example_Engine.png" src="../_images/MeshGeneration_Example_Engine.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 84 </span><span class="caption-text">Section of Engine</span><a class="headerlink" href="#engine" title="Link to this image"></a></p>
</figcaption>
</figure>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Domain with U-shape channel</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">real</span><span class="w"> </span><span class="nf">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="c1">//width of U-shape</span>
<span class="linenos"> 2</span><span class="kt">border</span><span class="w"> </span><span class="nf">L1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="o">-</span><span class="nf">d</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">-1</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=-</span><span class="nf">d</span><span class="o">-</span><span class="kp">t</span><span class="p">;}</span>
<span class="linenos"> 3</span><span class="kt">border</span><span class="w"> </span><span class="nf">L2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="o">-</span><span class="nf">d</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">-1</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;}</span>
<span class="linenos"> 4</span><span class="kt">border</span><span class="w"> </span><span class="kp">B</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">-1</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">-1</span><span class="p">;}</span>
<span class="linenos"> 5</span><span class="kt">border</span><span class="w"> </span><span class="nf">C1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="mi">-1</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="nf">d</span><span class="p">;}</span>
<span class="linenos"> 6</span><span class="kt">border</span><span class="w"> </span><span class="nf">C2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nf">d</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="nf">d</span><span class="o">-</span><span class="kp">t</span><span class="p">;}</span>
<span class="linenos"> 7</span><span class="kt">border</span><span class="w"> </span><span class="nf">C3</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=-</span><span class="nf">d</span><span class="p">;}</span>
<span class="linenos"> 8</span><span class="kt">border</span><span class="w"> </span><span class="nf">R</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">-1</span><span class="o">+</span><span class="kp">t</span><span class="p">;}</span>
<span class="linenos"> 9</span><span class="kt">border</span><span class="w"> </span><span class="nf">T</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos">10</span><span class="kt">int</span><span class="w"> </span><span class="kr">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="linenos">11</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">L1</span><span class="p">(</span><span class="kr">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">L2</span><span class="p">(</span><span class="kr">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="kp">B</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C1</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C3</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">R</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="kr">n</span><span class="p">));</span>
<span class="linenos">12</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;U-shape.eps&quot;</span><span class="p">,</span><span class="w"> </span><span class="kp">bw</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</div>
<figure class="align-default" id="ushape">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_UShape.png"><img alt="../_images/MeshGeneration_Example_UShape.png" src="../_images/MeshGeneration_Example_UShape.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 85 </span><span class="caption-text">Domain with U-shape channel changed by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">d</span></code></span><a class="headerlink" href="#ushape" title="Link to this image"></a></p>
</figcaption>
</figure>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Domain with V-shape cut</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">real</span><span class="w"> </span><span class="n">dAg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.02</span><span class="p">;</span><span class="w"> </span><span class="c1">//angle of V-shape</span>
<span class="linenos"> 2</span><span class="kt">border</span><span class="w"> </span><span class="nf">C</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="n">dAg</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">-</span><span class="n">dAg</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);};</span>
<span class="linenos"> 3</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">pa</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">pb</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">pc</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos"> 4</span><span class="n">pa</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cos</span><span class="p">(</span><span class="n">dAg</span><span class="p">);</span>
<span class="linenos"> 5</span><span class="n">pa</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sin</span><span class="p">(</span><span class="n">dAg</span><span class="p">);</span>
<span class="linenos"> 6</span><span class="n">pb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">-</span><span class="n">dAg</span><span class="p">);</span>
<span class="linenos"> 7</span><span class="n">pb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">-</span><span class="n">dAg</span><span class="p">);</span>
<span class="linenos"> 8</span><span class="n">pc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 9</span><span class="n">pc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">10</span><span class="kt">border</span><span class="w"> </span><span class="nf">seg1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">)</span><span class="o">*</span><span class="n">pb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="kp">t</span><span class="o">*</span><span class="n">pc</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">)</span><span class="o">*</span><span class="n">pb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="kp">t</span><span class="o">*</span><span class="n">pc</span><span class="p">[</span><span class="mi">1</span><span class="p">];};</span>
<span class="linenos">11</span><span class="kt">border</span><span class="w"> </span><span class="nf">seg2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">)</span><span class="o">*</span><span class="n">pc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="kp">t</span><span class="o">*</span><span class="n">pa</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">)</span><span class="o">*</span><span class="n">pc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="kp">t</span><span class="o">*</span><span class="n">pa</span><span class="p">[</span><span class="mi">1</span><span class="p">];};</span>
<span class="linenos">12</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">seg1</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">seg2</span><span class="p">(</span><span class="mi">20</span><span class="p">));</span>
<span class="linenos">13</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;V-shape.eps&quot;</span><span class="p">,</span><span class="w"> </span><span class="kp">bw</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</div>
<figure class="align-default" id="vshape">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_VShape.png"><img alt="../_images/MeshGeneration_Example_VShape.png" src="../_images/MeshGeneration_Example_VShape.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 86 </span><span class="caption-text">Domain with V-shape cut changed by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">dAg</span></code></span><a class="headerlink" href="#vshape" title="Link to this image"></a></p>
</figcaption>
</figure>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Smiling face</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">real</span><span class="w"> </span><span class="nf">d</span><span class="o">=</span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="kr">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.5</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.7</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="p">;</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kt">border</span><span class="w"> </span><span class="nf">F</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="n">b</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);}</span>
<span class="linenos"> 4</span><span class="kt">border</span><span class="w"> </span><span class="nf">E1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.2</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="mf">-0.5</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">0.2</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">;}</span>
<span class="linenos"> 5</span><span class="kt">border</span><span class="w"> </span><span class="nf">E2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.2</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">0.2</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">;}</span>
<span class="linenos"> 6</span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">st</span><span class="p">(</span><span class="kt">real</span><span class="w"> </span><span class="kp">t</span><span class="p">){</span>
<span class="linenos"> 7</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">sin</span><span class="p">(</span><span class="kr">pi</span><span class="o">*</span><span class="kp">t</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="kr">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="p">}</span>
<span class="linenos"> 9</span><span class="kt">border</span><span class="w"> </span><span class="n">C1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">-0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nf">d</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="n">st</span><span class="p">(</span><span class="kp">t</span><span class="p">));</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nf">d</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="n">st</span><span class="p">(</span><span class="kp">t</span><span class="p">));}</span>
<span class="linenos">10</span><span class="kt">border</span><span class="w"> </span><span class="n">C2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="nf">d</span><span class="p">)</span><span class="o">+</span><span class="nf">d</span><span class="o">*</span><span class="kp">t</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="n">st</span><span class="p">(</span><span class="mf">0.5</span><span class="p">));</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="nf">d</span><span class="p">)</span><span class="o">+</span><span class="nf">d</span><span class="o">*</span><span class="kp">t</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="n">st</span><span class="p">(</span><span class="mf">0.5</span><span class="p">));}</span>
<span class="linenos">11</span><span class="kt">border</span><span class="w"> </span><span class="n">C3</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">c</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="n">st</span><span class="p">(</span><span class="kp">t</span><span class="p">));</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="n">c</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="n">st</span><span class="p">(</span><span class="kp">t</span><span class="p">));}</span>
<span class="linenos">12</span><span class="kt">border</span><span class="w"> </span><span class="n">C4</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nf">d</span><span class="o">*</span><span class="kp">t</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="n">st</span><span class="p">(</span><span class="mf">-0.5</span><span class="p">));</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nf">d</span><span class="o">*</span><span class="kp">t</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="n">st</span><span class="p">(</span><span class="mf">-0.5</span><span class="p">));}</span>
<span class="linenos">13</span><span class="kt">border</span><span class="w"> </span><span class="n">C0</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);}</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="o">=</span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="kr">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C1</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="kr">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C3</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="kr">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C4</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="linenos">16</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">C0</span><span class="p">(</span><span class="kr">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">E1</span><span class="p">(</span><span class="mi">-2</span><span class="o">*</span><span class="kr">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">E2</span><span class="p">(</span><span class="mi">-2</span><span class="o">*</span><span class="kr">m</span><span class="p">));</span>
<span class="linenos">17</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;SmileFace.eps&quot;</span><span class="p">,</span><span class="w"> </span><span class="kp">bw</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</div>
<figure class="align-default" id="smilingface">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_SmilingFace.png"><img alt="../_images/MeshGeneration_Example_SmilingFace.png" src="../_images/MeshGeneration_Example_SmilingFace.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 87 </span><span class="caption-text">Smiling face (Mouth is changeable)</span><a class="headerlink" href="#smilingface" title="Link to this image"></a></p>
</figcaption>
</figure>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>3 points bending</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Square for Three-Point Bend Specimens fixed on Fix1, Fix2</span>
<span class="linenos"> 2</span><span class="c1">// It will be loaded on Load.</span>
<span class="linenos"> 3</span><span class="kt">real</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span>
<span class="linenos"> 4</span><span class="kt">int</span><span class="w"> </span><span class="kr">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="kr">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="o">*</span><span class="kr">n</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="kt">border</span><span class="w"> </span><span class="nf">Left</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="n">a</span><span class="o">-</span><span class="kp">t</span><span class="p">;}</span>
<span class="linenos"> 6</span><span class="kt">border</span><span class="w"> </span><span class="nf">Bot1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">c</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="n">b</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=-</span><span class="n">a</span><span class="p">;}</span>
<span class="linenos"> 7</span><span class="kt">border</span><span class="w"> </span><span class="nf">Fix1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">c</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=-</span><span class="n">a</span><span class="p">;}</span>
<span class="linenos"> 8</span><span class="kt">border</span><span class="w"> </span><span class="nf">Bot2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="mi">-2</span><span class="o">*</span><span class="n">c</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=-</span><span class="n">a</span><span class="p">;}</span>
<span class="linenos"> 9</span><span class="kt">border</span><span class="w"> </span><span class="nf">Fix2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">c</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=-</span><span class="n">a</span><span class="p">;}</span>
<span class="linenos">10</span><span class="kt">border</span><span class="w"> </span><span class="nf">Bot3</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">c</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=-</span><span class="n">a</span><span class="p">;}</span>
<span class="linenos">11</span><span class="kt">border</span><span class="w"> </span><span class="nf">Right</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=-</span><span class="n">a</span><span class="o">+</span><span class="kp">t</span><span class="p">;}</span>
<span class="linenos">12</span><span class="kt">border</span><span class="w"> </span><span class="nf">Top1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="o">-</span><span class="n">c</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">b</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="n">a</span><span class="p">;}</span>
<span class="linenos">13</span><span class="kt">border</span><span class="w"> </span><span class="nf">Load</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">c</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="n">a</span><span class="p">;}</span>
<span class="linenos">14</span><span class="kt">border</span><span class="w"> </span><span class="nf">Top2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="o">-</span><span class="n">c</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="n">c</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="n">a</span><span class="p">;}</span>
<span class="linenos">15</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">Left</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Bot1</span><span class="p">(</span><span class="kr">m</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Fix1</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Bot2</span><span class="p">(</span><span class="kr">m</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="linenos">16</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">Fix2</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Bot3</span><span class="p">(</span><span class="kr">m</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Right</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Top1</span><span class="p">(</span><span class="kr">m</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Load</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Top2</span><span class="p">(</span><span class="kr">m</span><span class="o">/</span><span class="mi">2</span><span class="p">));</span>
<span class="linenos">17</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;ThreePoint.eps&quot;</span><span class="p">,</span><span class="w"> </span><span class="kp">bw</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</div>
<figure class="align-default" id="threepoints">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_ThreePoints.png"><img alt="../_images/MeshGeneration_Example_ThreePoints.png" src="../_images/MeshGeneration_Example_ThreePoints.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 88 </span><span class="caption-text">Domain for three-point bending test</span><a class="headerlink" href="#threepoints" title="Link to this image"></a></p>
</figcaption>
</figure>
</div>
</section>
</section>
<section id="the-type-mesh3-in-3-dimension">
<h2><strong>The type mesh3 in 3 dimension</strong><a class="headerlink" href="#the-type-mesh3-in-3-dimension" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Up to the version 3, FreeFEM allowed to consider a surface problem such as the PDE
is treated like boundary conditions on the boundary domain (on triangles describing
the boundary domain). With the version 4, in particular 4.2.1, a completed model for
surface problem is possible, with the definition of a surface mesh and a surface problem
with a variational form on domain ( with triangle elements) and application of boundary
conditions on border domain (describing by edges). The keywords to define a surface
mesh is <strong>meshS</strong>.</p>
</div>
<section id="d-mesh-generation">
<h3>3d mesh generation<a class="headerlink" href="#d-mesh-generation" title="Link to this heading"></a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For 3D mesh tools, put <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span></code> at the top of the .edp script.</p>
</div>
<section id="the-command-cube">
<h4>The command <em>cube</em><a class="headerlink" href="#the-command-cube" title="Link to this heading"></a></h4>
<p>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">cube</span></code> like its 2d function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">square</span></code> is a simple way to build cubic objects, it is contained in plugin <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">msh3</span></code> (import with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span></code>).</p>
<p>The following code generates a <span class="math notranslate nohighlight">\(3\times 4 \times 5\)</span> grid in the unit cube <span class="math notranslate nohighlight">\([0, 1]^3\)</span>.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cube</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
</pre></div>
</div>
<p>By default the labels are :</p>
<ol class="arabic simple">
<li><p>face <span class="math notranslate nohighlight">\(y=0\)</span>,</p></li>
<li><p>face <span class="math notranslate nohighlight">\(x=1\)</span>,</p></li>
<li><p>face <span class="math notranslate nohighlight">\(y=1\)</span>,</p></li>
<li><p>face <span class="math notranslate nohighlight">\(x=0\)</span>,</p></li>
<li><p>face <span class="math notranslate nohighlight">\(z=0\)</span>,</p></li>
<li><p>face <span class="math notranslate nohighlight">\(z=1\)</span></p></li>
</ol>
<p>and the region number is <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>A full example of this function to build a mesh of cube <span class="math notranslate nohighlight">\(]-1,1[^3\)</span> with face label given by <span class="math notranslate nohighlight">\((ix + 4*(iy+1) + 16*(iz+1))\)</span> where <span class="math notranslate nohighlight">\((ix, iy, iz)\)</span> are the coordinates of the barycenter of the current face, is given below.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">l6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">37</span><span class="p">,</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w"> </span><span class="mi">45</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="mi">57</span><span class="p">];</span>
<span class="linenos"> 4</span><span class="kt">int</span><span class="w"> </span><span class="n">r11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cube</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kr">x</span><span class="o">*</span><span class="mi">2-1</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="o">*</span><span class="mi">2-1</span><span class="p">,</span><span class="w"> </span><span class="kr">z</span><span class="o">*</span><span class="mi">2-1</span><span class="p">],</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">l6</span><span class="p">,</span><span class="w"> </span><span class="kp">flags</span><span class="w"> </span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kr">region</span><span class="o">=</span><span class="n">r11</span><span class="p">);</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Volume = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">measure</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, border area = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">bordermeasure</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="kt">int</span><span class="w"> </span><span class="kp">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">10</span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="linenos">11</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">i</span><span class="p">)(</span><span class="mf">1.</span><span class="p">);</span>
<span class="linenos">12</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">sx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">i</span><span class="p">)(</span><span class="kr">x</span><span class="p">);</span>
<span class="linenos">13</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">sy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">i</span><span class="p">)(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">14</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">i</span><span class="p">)(</span><span class="kr">z</span><span class="p">);</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">s</span><span class="p">){</span>
<span class="linenos">17</span><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">ix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">sx</span><span class="o">/</span><span class="n">s</span><span class="o">+</span><span class="mf">1.5</span><span class="p">);</span>
<span class="linenos">18</span><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">iy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">sy</span><span class="o">/</span><span class="n">s</span><span class="o">+</span><span class="mf">1.5</span><span class="p">);</span>
<span class="linenos">19</span><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">iz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">sz</span><span class="o">/</span><span class="n">s</span><span class="o">+</span><span class="mf">1.5</span><span class="p">);</span>
<span class="linenos">20</span><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ix</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">iy</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">16</span><span class="o">*</span><span class="p">(</span><span class="n">iz</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">21</span><span class="w">        </span><span class="c1">//value of ix,iy,iz =&gt; face min 0, face max 2, no face 1</span>
<span class="linenos">22</span><span class="w">        </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Label = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, s = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">ix</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">iy</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">iz</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; : &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">23</span><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kp">err</span><span class="o">++</span><span class="p">;</span>
<span class="linenos">24</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">25</span><span class="p">}</span>
<span class="linenos">26</span><span class="kt">real</span><span class="w"> </span><span class="n">volr11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">r11</span><span class="p">)(</span><span class="mf">1.</span><span class="p">);</span>
<span class="linenos">27</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Volume region = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">volr11</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">28</span><span class="k">if</span><span class="p">((</span><span class="n">volr11</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">measure</span><span class="w"> </span><span class="p">)</span><span class="o">&gt;</span><span class="mf">1e-8</span><span class="p">)</span><span class="w"> </span><span class="kp">err</span><span class="o">++</span><span class="p">;</span>
<span class="linenos">29</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">fill</span><span class="o">=</span><span class="kr">false</span><span class="p">);</span>
<span class="linenos">30</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Nb err = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kp">err</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">31</span><span class="nf">assert</span><span class="p">(</span><span class="kp">err</span><span class="o">==</span><span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
<p>The output of this script is:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nl">Enter</span><span class="o">:</span><span class="w"> </span><span class="n">BuildCube</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span>
<span class="linenos"> 2</span><span class="w">  </span><span class="n">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="kr">n</span><span class="w"> </span><span class="n">tet</span><span class="w"> </span><span class="n">Cube</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="kr">n</span><span class="w"> </span><span class="n">slip</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">19</span>
<span class="linenos"> 3</span><span class="n">Cube</span><span class="w">  </span><span class="kr">nv</span><span class="o">=</span><span class="mi">210</span><span class="w"> </span><span class="kr">nt</span><span class="o">=</span><span class="mi">720</span><span class="w"> </span><span class="kr">nbe</span><span class="o">=</span><span class="mi">296</span>
<span class="linenos"> 4</span><span class="nl">Out</span><span class="o">:</span><span class="w">  </span><span class="n">BuildCube</span>
<span class="linenos"> 5</span><span class="n">Volume</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="kt">border</span><span class="w"> </span><span class="kr">area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">24</span>
<span class="linenos"> 6</span><span class="n">Label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">110</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">25</span>
<span class="linenos"> 7</span><span class="n">Label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">37</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">101</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">37</span>
<span class="linenos"> 8</span><span class="n">Label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mo">011</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">40</span>
<span class="linenos"> 9</span><span class="n">Label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">211</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">42</span>
<span class="linenos">10</span><span class="n">Label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">45</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">121</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">45</span>
<span class="linenos">11</span><span class="n">Label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">57</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">112</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">57</span>
<span class="linenos">12</span><span class="n">Volume</span><span class="w"> </span><span class="kr">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="w"> </span><span class="mi">8</span>
<span class="linenos">13</span><span class="n">Nb</span><span class="w"> </span><span class="kp">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
</pre></div>
</div>
<figure class="align-default" id="meshgeneration-cube">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Cube.jpg"><img alt="../_images/MeshGeneration_Cube.jpg" src="../_images/MeshGeneration_Cube.jpg" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 89 </span><span class="caption-text">The 3D mesh of function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">cube</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="kp">flags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code></span><a class="headerlink" href="#meshgeneration-cube" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="the-command-buildlayers">
<span id="meshreadwrite3d"></span><h4>The command <em>buildlayers</em><a class="headerlink" href="#the-command-buildlayers" title="Link to this heading"></a></h4>
<p>This mesh is obtained by extending a two dimensional mesh in the <span class="math notranslate nohighlight">\(z\)</span>-axis.</p>
<p>The domain <span class="math notranslate nohighlight">\(\Omega_{3d}\)</span> defined by the layer mesh is equal to <span class="math notranslate nohighlight">\(\Omega_{3d} = \Omega_{2d} \times [zmin, zmax]\)</span> where <span class="math notranslate nohighlight">\(\Omega_{2d}\)</span> is the domain defined by the two dimensional meshes.
<span class="math notranslate nohighlight">\(zmin\)</span> and <span class="math notranslate nohighlight">\(zmax\)</span> are functions of <span class="math notranslate nohighlight">\(\Omega_{2d}\)</span> in <span class="math notranslate nohighlight">\(\R\)</span> that defines respectively the lower surface and upper surface of <span class="math notranslate nohighlight">\(\Omega_{3d}\)</span>.</p>
<figure class="align-default" id="meshgenerationlayermesh">
<a class="reference internal image-reference" href="../_images/MeshGeneration_LayerMesh.png"><img alt="../_images/MeshGeneration_LayerMesh.png" src="../_images/MeshGeneration_LayerMesh.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 90 </span><span class="caption-text">Example of Layer mesh in three dimensions.</span><a class="headerlink" href="#meshgenerationlayermesh" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>For a vertex of a two dimensional mesh <span class="math notranslate nohighlight">\(V_{i}^{2d} = (x_{i},y_{i})\)</span>, we introduce the number of associated vertices in the <span class="math notranslate nohighlight">\(z-\)</span>axis <span class="math notranslate nohighlight">\(M_{i}+1\)</span>.</p>
<p>We denote by <span class="math notranslate nohighlight">\(M\)</span> the maximum of <span class="math notranslate nohighlight">\(M_{i}\)</span> over the vertices of the two dimensional mesh.
This value is called the number of layers (if <span class="math notranslate nohighlight">\(\forall i, \; M_{i}=M\)</span> then there are <span class="math notranslate nohighlight">\(M\)</span> layers in the mesh of <span class="math notranslate nohighlight">\(\Omega_{3d}\)</span>).
<span class="math notranslate nohighlight">\(V_{i}^{2d}\)</span> generated <span class="math notranslate nohighlight">\(M+1\)</span> vertices which are defined by:</p>
<div class="math notranslate nohighlight">
\[\forall j=0, \ldots, M, \quad V_{i,j}^{3d} = ( x_{i}, y_{i}, \theta_{i}(z_{i,j}) ),\]</div>
<p>where <span class="math notranslate nohighlight">\((z_{i,j})_{j=0,\ldots,M}\)</span> are the <span class="math notranslate nohighlight">\(M+1\)</span> equidistant points on the interval <span class="math notranslate nohighlight">\([zmin( V_{i}^{2d} ), zmax( V_{i}^{2d})]\)</span>:</p>
<div class="math notranslate nohighlight">
\[z_{i,j} = j \: \delta \alpha + zmin(V_{i}^{2d}), \quad \delta \alpha= \frac{ zmax( V_{i}^{2d} ) - zmin( V_{i}^{2d}) }{M}.\]</div>
<p>The function <span class="math notranslate nohighlight">\(\theta_{i}\)</span>, defined on <span class="math notranslate nohighlight">\([zmin( V_{i}^{2d} ), zmax( V_{i}^{2d} )]\)</span>, is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\theta_{i}(z) = \left \{
\begin{array}{cl}
\theta_{i,0} &amp; \mbox{if} \: z=zmin(V_{i}^{2d}), \\
\theta_{i,j} &amp; \mbox{if} \: z \in ] \theta_{i,j-1}, \theta_{i,j}],\\
\end{array}
\right.\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\((\theta_{i,j})_{j=0,\ldots,M_{i}}\)</span> are the <span class="math notranslate nohighlight">\(M_{i}+1\)</span> equidistant points on the interval <span class="math notranslate nohighlight">\([zmin( V_{i}^{2d} ), zmax( V_{i}^{2d} )]\)</span>.</p>
<p>Set a triangle <span class="math notranslate nohighlight">\(K=(V_{i1}^{2d}\)</span>, <span class="math notranslate nohighlight">\(V_{i2}^{2d}\)</span>, <span class="math notranslate nohighlight">\(V_{i3}^{2d})\)</span> of the two dimensional mesh.
<span class="math notranslate nohighlight">\(K\)</span> is associated with a triangle on the upper surface (resp. on the lower surface) of layer mesh:</p>
<p><span class="math notranslate nohighlight">\(( V_{i1,M}^{3d}, V_{i2,M}^{3d}, V_{i3,M}^{3d} )\)</span> (resp. <span class="math notranslate nohighlight">\(( V_{i1,0}^{3d}, V_{i2,0}^{3d}, V_{i3,0}^{3d})\)</span>).</p>
<p>Also <span class="math notranslate nohighlight">\(K\)</span> is associated with <span class="math notranslate nohighlight">\(M\)</span> volume prismatic elements which are defined by:</p>
<div class="math notranslate nohighlight">
\[\forall j=0,\ldots,M, \quad H_{j} = ( V_{i1,j}^{3d}, V_{i2,j}^{3d}, V_{i3,j}^{3d}, V_{i1,j+1}^{3d}, V_{i2,j+1}^{3d}, V_{i3,j+1}^{3d} ).\]</div>
<p>Theses volume elements can have some merged point:</p>
<ul class="simple">
<li><p>0 merged point : prism</p></li>
<li><p>1 merged points : pyramid</p></li>
<li><p>2 merged points : tetrahedra</p></li>
<li><p>3 merged points : no elements</p></li>
</ul>
<p>The elements with merged points are called degenerate elements.
To obtain a mesh with tetrahedra, we decompose the pyramid into two tetrahedra and the prism into three tetrahedra.
These tetrahedra are obtained by cutting the quadrilateral face of pyramid and prism with the diagonal which have the vertex with the maximum index (see <a class="reference internal" href="../bibliography.html#hecht1992" id="id2"><span>[HECHT1992]</span></a> for the reason of this choice).</p>
<p>The triangles on the middle surface obtained with the decomposition of the volume prismatic elements are the triangles generated by the edges on the border of the two dimensional mesh.
The label of triangles on the border elements and tetrahedra are defined with the label of these associated elements.</p>
<p>The arguments of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">buildlayers</span></code> is a two dimensional mesh and the number of layers <span class="math notranslate nohighlight">\(M\)</span>.</p>
<p>The parameters of this command are:</p>
<ul>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">zbound</span><span class="o">=</span></code> <span class="math notranslate nohighlight">\([zmin,zmax]\)</span> where <span class="math notranslate nohighlight">\(zmin\)</span> and <span class="math notranslate nohighlight">\(zmax\)</span> are functions expression.</dt><dd><p>Theses functions define the lower surface mesh and upper mesh of surface mesh.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">coef</span><span class="o">=</span></code> A function expression between [0,1].</dt><dd><p>This parameter is used to introduce degenerate element in mesh.</p>
</dd>
</dl>
<p>The number of associated points or vertex <span class="math notranslate nohighlight">\(V_{i}^{2d}\)</span> is the integer part of <span class="math notranslate nohighlight">\(coef(V_{i}^{2d}) M\)</span>.</p>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">region</span><span class="o">=</span></code> This vector is used to initialize the region of tetrahedra.</p>
<p>This vector contains successive pairs of the 2d region number at index <span class="math notranslate nohighlight">\(2i\)</span> and the corresponding 3d region number at index <span class="math notranslate nohighlight">\(2i+1\)</span>, like <a class="reference internal" href="#meshgenerationchangelabel"><span class="std std-ref">change</span></a>.</p>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">labelmid</span><span class="o">=</span></code> This vector is used to initialize the 3d labels number of the vertical face or mid face from the 2d label number.</p>
<p>This vector contains successive pairs of the 2d label number at index <span class="math notranslate nohighlight">\(2i\)</span> and the corresponding 3d label number at index <span class="math notranslate nohighlight">\(2i+1\)</span>, like <a class="reference internal" href="#meshgenerationchangelabel"><span class="std std-ref">change</span></a>.</p>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">labelup</span><span class="o">=</span></code> This vector is used to initialize the 3d label numbers of the upper/top face from the 2d region number.</p>
<p>This vector contains successive pairs of the 2d region number at index <span class="math notranslate nohighlight">\(2i\)</span> and the corresponding 3d label number at index <span class="math notranslate nohighlight">\(2i+1\)</span>, like <a class="reference internal" href="#meshgenerationchangelabel"><span class="std std-ref">change</span></a>.</p>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">labeldown</span><span class="o">=</span></code> Same as the previous case but for the lower/down face label.</p></li>
</ul>
<p>Moreover, we also add post processing parameters that allow to moving the mesh.
These parameters correspond to parameters <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">transfo</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">facemerge</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ptmerge</span></code> of the command line <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">movemesh</span></code>.</p>
<p>The vector <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">region</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">labelmid</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">labelup</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">labeldown</span></code> These vectors are composed of <span class="math notranslate nohighlight">\(n_{l}\)</span> successive pairs of number <span class="math notranslate nohighlight">\(O_i,N_l\)</span> where <span class="math notranslate nohighlight">\(n_{l}\)</span> is the number (label or region) that we want to get.</p>
<p>An example of this command is given in the <a class="reference internal" href="../examples/mesh-generation.html#examplebuildlayermesh"><span class="std std-ref">Build layer mesh example</span></a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Cube</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">//Cube.idp</span>
<span class="linenos"> 2</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="linenos"> 3</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="kt">func</span><span class="w"> </span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Cube</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">NN</span><span class="p">,</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">BB</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="n">L</span><span class="p">){</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">x0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BB</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">x1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BB</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos"> 7</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="nf">y0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BB</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="nf">y1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BB</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos"> 8</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">z0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BB</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">z1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BB</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">ny</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">nz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="w">    </span><span class="c1">// 2D mesh</span>
<span class="linenos">13</span><span class="w">    </span><span class="kt">mesh</span><span class="w"> </span><span class="n">Thx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span><span class="w"> </span><span class="n">ny</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">x0</span><span class="o">+</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="nf">y0</span><span class="o">+</span><span class="p">(</span><span class="nf">y1</span><span class="o">-</span><span class="nf">y0</span><span class="p">)</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="w">    </span><span class="c1">// 3D mesh</span>
<span class="linenos">16</span><span class="w">    </span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">rup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span><span class="w"> </span><span class="n">rdown</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)];</span>
<span class="linenos">17</span><span class="w">    </span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">rmid</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)];</span>
<span class="linenos">18</span><span class="w">    </span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildlayers</span><span class="p">(</span><span class="n">Thx</span><span class="p">,</span><span class="w"> </span><span class="n">nz</span><span class="p">,</span><span class="w"> </span><span class="kp">zbound</span><span class="o">=</span><span class="p">[</span><span class="n">z0</span><span class="p">,</span><span class="n">z1</span><span class="p">],</span>
<span class="linenos">19</span><span class="w">    </span><span class="kp">labelmid</span><span class="o">=</span><span class="n">rmid</span><span class="p">,</span><span class="w"> </span><span class="kp">labelup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rup</span><span class="p">,</span><span class="w"> </span><span class="kp">labeldown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rdown</span><span class="p">);</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Th</span><span class="p">;</span>
<span class="linenos">22</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Unit cube</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="cp">include</span><span class="w"> </span><span class="s">&quot;Cube.idp&quot;</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">NN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">];</span><span class="w"> </span><span class="c1">//the number of step in each direction</span>
<span class="linenos">4</span><span class="kt">real</span><span class="w"> </span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">BB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]];</span><span class="w"> </span><span class="c1">//the bounding box</span>
<span class="linenos">5</span><span class="kt">int</span><span class="w"> </span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]];</span><span class="w"> </span><span class="c1">//the label of the 6 face left,right, front, back, down, right</span>
<span class="linenos">6</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cube</span><span class="p">(</span><span class="n">NN</span><span class="p">,</span><span class="w"> </span><span class="n">BB</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">);</span>
<span class="linenos">7</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Th&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Th</span><span class="p">);</span>
</pre></div>
</div>
<figure class="align-default" id="meshgenerationlayermeshexample1">
<a class="reference internal image-reference" href="../_images/MeshGeneration_LayerMesh_Example1.png"><img alt="../_images/MeshGeneration_LayerMesh_Example1.png" src="../_images/MeshGeneration_LayerMesh_Example1.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 91 </span><span class="caption-text">The mesh of a cube made with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">cube</span><span class="p">.</span><span class="n">edp</span></code></span><a class="headerlink" href="#meshgenerationlayermeshexample1" title="Link to this image"></a></p>
</figcaption>
</figure>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Cone</p>
<p>An axisymtric mesh on a triangle with degenerateness</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos"> 2</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1">// Parameters</span>
<span class="linenos"> 5</span><span class="kt">real</span><span class="w"> </span><span class="n">RR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos"> 6</span><span class="kt">real</span><span class="w"> </span><span class="n">HH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="kt">int</span><span class="w"> </span><span class="n">nn</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1">// 2D mesh</span>
<span class="linenos">11</span><span class="kt">border</span><span class="w"> </span><span class="nf">Taxe</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">HH</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
<span class="linenos">12</span><span class="kt">border</span><span class="w"> </span><span class="nf">Hypo</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">HH</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="n">RR</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos">13</span><span class="kt">border</span><span class="w"> </span><span class="nf">Vert</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">RR</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">HH</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">2</span><span class="p">;}</span>
<span class="linenos">14</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">Taxe</span><span class="p">(</span><span class="n">HH</span><span class="o">*</span><span class="n">nn</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Hypo</span><span class="p">(</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">HH</span><span class="o">*</span><span class="n">HH</span><span class="o">+</span><span class="n">RR</span><span class="o">*</span><span class="n">RR</span><span class="p">)</span><span class="o">*</span><span class="n">nn</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Vert</span><span class="p">(</span><span class="n">RR</span><span class="o">*</span><span class="n">nn</span><span class="p">));</span>
<span class="linenos">15</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="c1">// 3D mesh</span>
<span class="linenos">18</span><span class="kt">real</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="n">nn</span><span class="p">;</span>
<span class="linenos">19</span><span class="kt">int</span><span class="w"> </span><span class="n">MaxLayersT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="n">RR</span><span class="o">/</span><span class="n">h</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">;</span><span class="c1">//number of layers</span>
<span class="linenos">20</span><span class="kt">real</span><span class="w"> </span><span class="n">zminT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">21</span><span class="kt">real</span><span class="w"> </span><span class="n">zmaxT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">;</span><span class="w"> </span><span class="c1">//height 2*pi</span>
<span class="linenos">22</span><span class="kt">func</span><span class="w"> </span><span class="n">fx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">y</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">z</span><span class="p">);</span>
<span class="linenos">23</span><span class="kt">func</span><span class="w"> </span><span class="n">fy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">y</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">z</span><span class="p">);</span>
<span class="linenos">24</span><span class="kt">func</span><span class="w"> </span><span class="n">fz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">x</span><span class="p">;</span>
<span class="linenos">25</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">r1T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">r2T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">r4T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">];</span>
<span class="linenos">26</span><span class="c1">//trick function:</span>
<span class="linenos">27</span><span class="c1">//The function defined the proportion</span>
<span class="linenos">28</span><span class="c1">//of number layer close to axis with reference MaxLayersT</span>
<span class="linenos">29</span><span class="kt">func</span><span class="w"> </span><span class="n">deg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">max</span><span class="p">(</span><span class="mf">.01</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="o">/</span><span class="kr">max</span><span class="p">(</span><span class="kr">x</span><span class="o">/</span><span class="n">HH</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4</span><span class="p">)</span><span class="o">/</span><span class="n">RR</span><span class="p">);</span>
<span class="linenos">30</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th3T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildlayers</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span><span class="w"> </span><span class="kp">coef</span><span class="o">=</span><span class="n">deg</span><span class="p">,</span><span class="w"> </span><span class="n">MaxLayersT</span><span class="p">,</span>
<span class="linenos">31</span><span class="w">    </span><span class="kp">zbound</span><span class="o">=</span><span class="p">[</span><span class="n">zminT</span><span class="p">,</span><span class="w"> </span><span class="n">zmaxT</span><span class="p">],</span><span class="w"> </span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">fx</span><span class="p">,</span><span class="w"> </span><span class="n">fy</span><span class="p">,</span><span class="w"> </span><span class="n">fz</span><span class="p">],</span>
<span class="linenos">32</span><span class="w">    </span><span class="kp">facemerge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="kr">region</span><span class="o">=</span><span class="n">r1T</span><span class="p">,</span><span class="w"> </span><span class="kp">labelmid</span><span class="o">=</span><span class="n">r2T</span><span class="p">);</span>
<span class="linenos">33</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;cone&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Th3T</span><span class="p">);</span>
</pre></div>
</div>
<figure class="align-default" id="meshgenerationlayermeshexample2">
<a class="reference internal image-reference" href="../_images/MeshGeneration_LayerMesh_Example2.png"><img alt="../_images/MeshGeneration_LayerMesh_Example2.png" src="../_images/MeshGeneration_LayerMesh_Example2.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 92 </span><span class="caption-text">The mesh of a cone made with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">cone</span><span class="p">.</span><span class="n">edp</span></code></span><a class="headerlink" href="#meshgenerationlayermeshexample2" title="Link to this image"></a></p>
</figcaption>
</figure>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Buildlayer mesh</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos"> 2</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;TetGen&quot;</span>
<span class="linenos"> 3</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="c1">// Parameters</span>
<span class="linenos"> 6</span><span class="kt">int</span><span class="w"> </span><span class="n">C1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">99</span><span class="p">;</span>
<span class="linenos"> 7</span><span class="kt">int</span><span class="w"> </span><span class="n">C2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">98</span><span class="p">;</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="c1">// 2D mesh</span>
<span class="linenos">10</span><span class="kt">border</span><span class="w"> </span><span class="nf">C01</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos">11</span><span class="kt">border</span><span class="w"> </span><span class="nf">C02</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="w"> </span><span class="kr">x</span><span class="o">=</span><span class="kr">pi</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos">12</span><span class="kt">border</span><span class="w"> </span><span class="nf">C03</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="kr">pi</span><span class="p">){</span><span class="w"> </span><span class="kr">x</span><span class="o">=</span><span class="kr">pi</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos">13</span><span class="kt">border</span><span class="w"> </span><span class="nf">C04</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="w"> </span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="kt">border</span><span class="w"> </span><span class="nf">C11</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">2.5</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">C1</span><span class="p">;}</span>
<span class="linenos">16</span><span class="kt">border</span><span class="w"> </span><span class="nf">C12</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">1.2</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">2.5</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">C1</span><span class="p">;}</span>
<span class="linenos">17</span><span class="kt">border</span><span class="w"> </span><span class="nf">C13</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">1.2</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">4.5</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">C1</span><span class="p">;}</span>
<span class="linenos">18</span><span class="kt">border</span><span class="w"> </span><span class="nf">C14</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">4.5</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">C1</span><span class="p">;}</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="kt">border</span><span class="w"> </span><span class="nf">C21</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">2.3</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">2.5</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">C2</span><span class="p">;}</span>
<span class="linenos">21</span><span class="kt">border</span><span class="w"> </span><span class="nf">C22</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">2.5</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">C2</span><span class="p">;}</span>
<span class="linenos">22</span><span class="kt">border</span><span class="w"> </span><span class="nf">C23</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">3</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">4.5</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">C2</span><span class="p">;}</span>
<span class="linenos">23</span><span class="kt">border</span><span class="w"> </span><span class="nf">C24</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">2.3</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">4.5</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">C2</span><span class="p">;}</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">C01</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C02</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C03</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C04</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="linenos">26</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">C11</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C12</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C13</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C14</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="linenos">27</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">C21</span><span class="p">(</span><span class="mi">-5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C22</span><span class="p">(</span><span class="mi">-5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C23</span><span class="p">(</span><span class="mi">-5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C24</span><span class="p">(</span><span class="mi">-5</span><span class="p">));</span>
<span class="linenos">28</span>
<span class="linenos">29</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Ths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">C01</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C02</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C03</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C04</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="linenos">30</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">C11</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C12</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C13</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C14</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span>
<span class="linenos">31</span>
<span class="linenos">32</span><span class="c1">// Construction of a box with one hole and two regions</span>
<span class="linenos">33</span><span class="kt">func</span><span class="w"> </span><span class="n">zmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span>
<span class="linenos">34</span><span class="kt">func</span><span class="w"> </span><span class="n">zmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span>
<span class="linenos">35</span><span class="kt">int</span><span class="w"> </span><span class="n">MaxLayer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="linenos">36</span>
<span class="linenos">37</span><span class="kt">func</span><span class="w"> </span><span class="n">XX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">x</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">38</span><span class="kt">func</span><span class="w"> </span><span class="n">YY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">x</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">39</span><span class="kt">func</span><span class="w"> </span><span class="n">ZZ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">z</span><span class="p">;</span>
<span class="linenos">40</span>
<span class="linenos">41</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">r1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">],</span><span class="w"> </span><span class="n">r2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">98</span><span class="p">,</span><span class="w"> </span><span class="mi">98</span><span class="p">,</span><span class="w"> </span><span class="mi">99</span><span class="p">,</span><span class="w"> </span><span class="mi">99</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">56</span><span class="p">];</span>
<span class="linenos">42</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">r3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">];</span><span class="w">  </span><span class="c1">//the triangles of uppper surface mesh</span>
<span class="linenos">43</span><span class="w">                        </span><span class="c1">//generated by the triangle in the 2D region</span>
<span class="linenos">44</span><span class="w">                        </span><span class="c1">//of mesh Th of label 4 as label 12</span>
<span class="linenos">45</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">45</span><span class="p">];</span><span class="w">  </span><span class="c1">//the triangles of lower surface mesh</span>
<span class="linenos">46</span><span class="w">                        </span><span class="c1">//generated by the triangle in the 2D region</span>
<span class="linenos">47</span><span class="w">                        </span><span class="c1">//of mesh Th of label 4 as label 45.</span>
<span class="linenos">48</span>
<span class="linenos">49</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildlayers</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">MaxLayer</span><span class="p">,</span><span class="w"> </span><span class="kp">zbound</span><span class="o">=</span><span class="p">[</span><span class="n">zmin</span><span class="p">,</span><span class="w"> </span><span class="n">zmax</span><span class="p">],</span><span class="w"> </span><span class="kr">region</span><span class="o">=</span><span class="n">r1</span><span class="p">,</span>
<span class="linenos">50</span><span class="w">    </span><span class="kp">labelmid</span><span class="o">=</span><span class="n">r2</span><span class="p">,</span><span class="w"> </span><span class="kp">labelup</span><span class="o">=</span><span class="n">r3</span><span class="p">,</span><span class="w"> </span><span class="kp">labeldown</span><span class="o">=</span><span class="n">r4</span><span class="p">);</span>
<span class="linenos">51</span><span class="w">    </span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;box 2 regions 1 hole&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Th3</span><span class="p">);</span>
<span class="linenos">52</span>
<span class="linenos">53</span><span class="c1">// Construction of a sphere with TetGen</span>
<span class="linenos">54</span><span class="kt">func</span><span class="w"> </span><span class="n">XX1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">);</span>
<span class="linenos">55</span><span class="kt">func</span><span class="w"> </span><span class="n">YY1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">);</span>
<span class="linenos">56</span><span class="kt">func</span><span class="w"> </span><span class="n">ZZ1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">);</span>
<span class="linenos">57</span>
<span class="linenos">58</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.001</span><span class="p">];</span>
<span class="linenos">59</span><span class="kt">string</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;paACQ&quot;</span><span class="p">;</span>
<span class="linenos">60</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;test = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">61</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th3sph</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">tetgtransfo</span><span class="p">(</span><span class="n">Ths</span><span class="p">,</span><span class="w"> </span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">XX1</span><span class="p">,</span><span class="w"> </span><span class="n">YY1</span><span class="p">,</span><span class="w"> </span><span class="n">ZZ1</span><span class="p">],</span>
<span class="linenos">62</span><span class="w">    </span><span class="kp">switch</span><span class="o">=</span><span class="n">test</span><span class="p">,</span><span class="w"> </span><span class="kp">nbofregions</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">regionlist</span><span class="o">=</span><span class="n">domain</span><span class="p">);</span>
<span class="linenos">63</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;sphere 2 regions&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Th3sph</span><span class="p">);</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="id3">
<h3>Remeshing<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<div class="admonition note" id="meshgenerationchangelabel">
<p class="admonition-title">Note</p>
<p>if an operation on a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code> is performed then the same operation is applyed on its surface part (its <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code> associated)</p>
</div>
<section id="id4">
<h4>The command <em>change</em><a class="headerlink" href="#id4" title="Link to this heading"></a></h4>
<p>This command changes the label of elements and border elements of a mesh. It’s the equivalent command in 2d mesh case.</p>
<p>Changing the label of elements and border elements will be done using the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">change</span></code>.
The parameters for this command line are for two dimensional and three dimensional cases:</p>
<ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">reftet</span><span class="o">=</span></code> is a vector of integer that contains successive pairs of the old label number to the new label number.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">refface</span><span class="o">=</span></code> is a vector of integer that contains successive pairs of the old region number to new region number.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">flabel</span><span class="o">=</span></code> is an integer function given the new value of the label.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">fregion</span><span class="o">=</span></code> is an integer function given the new value of the region.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">rmInternalFaces</span><span class="o">=</span></code> is a boolean, equal true to remove the internal faces.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">rmlfaces</span><span class="o">=</span></code> is a vector of integer, where triangle’s label given are remove of the mesh</p></li>
</ul>
<p>These vectors are composed of <span class="math notranslate nohighlight">\(n_{l}\)</span> successive pairs of numbers <span class="math notranslate nohighlight">\(O,N\)</span> where <span class="math notranslate nohighlight">\(n_{l}\)</span> is the number (label or region) that we want to change.
For example, we have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathtt{label} &amp;= [ O_{1}, N_{1}, ..., O_{n_{l}},N_{n_{l}} ] \\
\mathtt{region} &amp;= [ O_{1}, N_{1}, ..., O_{n_{l}},N_{n_{l}} ]\end{split}\]</div>
<p>An example of use:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Mesh</span>
<span class="linenos"> 2</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cube</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="linenos"> 3</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cube</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kr">x</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="p">,</span><span class="kr">z</span><span class="p">]);</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">r1</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span>
<span class="linenos"> 6</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th1</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="n">Th1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">change</span><span class="p">(</span><span class="n">Th1</span><span class="p">,</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">r1</span><span class="p">);</span><span class="w"> </span><span class="c1">//change the label of Edges 2 in 0.</span>
<span class="linenos"> 9</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th1</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="c1">// boundary label: 1 -&gt; 1 bottom, 2 -&gt; 1 right, 3-&gt;1 top, 4-&gt;1 left boundary label is 1</span>
<span class="linenos">12</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="kr">re</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">13</span><span class="n">Th2</span><span class="o">=</span><span class="nf">change</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span><span class="kp">refe</span><span class="o">=</span><span class="kr">re</span><span class="p">);</span>
<span class="linenos">14</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span><span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="meshgenerationtrunc">
<span id="id5"></span><h4>The command <em>trunc</em><a class="headerlink" href="#meshgenerationtrunc" title="Link to this heading"></a></h4>
<p>This operator have been introduce to remove a piece of mesh or/and split all element or for a particular label element
The three named parameter
- boolean function to keep or remove elements
- <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">split</span><span class="o">=</span></code> sets the level n of triangle splitting. each triangle is splitted in n × n ( one by default)
- freefem:<cite>label=</cite>   sets the label number of new boundary item (1 by default)</p>
<p>An example of use</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos">2</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="linenos">3</span><span class="kt">int</span><span class="w"> </span><span class="n">nn</span><span class="o">=</span><span class="mi">8</span><span class="p">;</span>
<span class="linenos">4</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th</span><span class="o">=</span><span class="nf">cube</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span><span class="n">nn</span><span class="p">,</span><span class="n">nn</span><span class="p">);</span>
<span class="linenos">5</span><span class="c1">//  remove the small cube $]1/2,1[^2$</span>
<span class="linenos">6</span><span class="n">Th</span><span class="o">=</span><span class="w"> </span><span class="nf">trunc</span><span class="p">(</span><span class="n">Th</span><span class="p">,((</span><span class="kr">x</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="p">(</span><span class="kr">y</span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="kr">z</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">)),</span><span class="w"> </span><span class="kp">split</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">3</span><span class="p">);</span>
<span class="linenos">7</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;</span><span class="nf">cube</span><span class="s">&quot;</span><span class="p">,</span><span class="n">Th</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="id6">
<h4>The command <em>movemesh</em><a class="headerlink" href="#id6" title="Link to this heading"></a></h4>
<p>3D meshes  can be translated, rotated, and deformed using the command line <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">movemesh</span></code> as in the 2D case (see <a class="reference internal" href="#meshgenerationmovemesh"><span class="std std-ref">section movemesh</span></a>).
If <span class="math notranslate nohighlight">\(\Omega\)</span> is tetrahedrized as <span class="math notranslate nohighlight">\(T_{h}(\Omega)\)</span>, and <span class="math notranslate nohighlight">\(\Phi(x,y)=(\Phi1(x,y,z), \Phi2(x,y,z), \Phi3(x,y,z))\)</span> is the transformation vector then <span class="math notranslate nohighlight">\(\Phi(T_{h})\)</span> is obtained by:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">Phi1</span><span class="p">,</span><span class="w"> </span><span class="n">Phi2</span><span class="p">,</span><span class="w"> </span><span class="n">Phi3</span><span class="p">],</span><span class="w"> </span><span class="p">...);</span>
<span class="linenos">2</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh3</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">Phi1</span><span class="p">,</span><span class="w"> </span><span class="n">Phi2</span><span class="p">,</span><span class="w"> </span><span class="n">Phi3</span><span class="p">],</span><span class="w"> </span><span class="p">...);</span><span class="w">  </span><span class="p">(</span><span class="n">syntax</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="kp">transfo</span><span class="o">=</span><span class="p">)</span>
</pre></div>
</div>
<p>The parameters of movemesh in three dimensions are:</p>
<ul>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">transfo</span><span class="o">=</span></code> sets the geometric transformation <span class="math notranslate nohighlight">\(\Phi(x,y)=(\Phi1(x,y,z), \Phi2(x,y,z), \Phi3(x,y,z))\)</span></p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">region</span><span class="o">=</span></code> sets the integer labels of the tetrahedra.</dt><dd><p>0 by default.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span><span class="o">=</span></code> sets the labels of the border faces.</dt><dd><p>This parameter is initialized as the label for the keyword <a class="reference internal" href="#meshgenerationchangelabel"><span class="std std-ref">change</span></a>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">facemerge</span><span class="o">=</span></code> An integer expression.</dt><dd><p>When you transform a mesh, some faces can be merged.
This parameter equals to one if the merges’ faces is considered.
Otherwise it equals to zero.
By default, this parameter is equal to 1.</p>
</dd>
</dl>
</li>
<li><dl>
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ptmerge</span><span class="w"> </span><span class="o">=</span></code> A real expression.</dt><dd><p>When you transform a mesh, some points can be merged.
This parameter is the criteria to define two merging points.
By default, we use</p>
<div class="math notranslate nohighlight">
\[ptmerge \: = \: 1e-7 \: \:Vol( B ),\]</div>
</dd>
</dl>
<p>where <span class="math notranslate nohighlight">\(B\)</span> is the smallest axis parallel boxes containing the discretion domain of <span class="math notranslate nohighlight">\(\Omega\)</span> and <span class="math notranslate nohighlight">\(Vol(B)\)</span> is the volume of this box.</p>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">orientation</span><span class="w"> </span><span class="o">=</span></code> An integer expression
equal 1, give the oientation of the triangulation, elements must be in the reference orientation (counter clock wise)
equal -1 reverse the orientation of the tetrahedra</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The orientation of tetrahedra are checked by the positivity of its area and automatically corrected during the building of the adjacency.</p>
</div>
<p>An example of this command can be found in the <a class="reference internal" href="../examples/misc.html#examplepoissonequation3d"><span class="std std-ref">Poisson’s equation 3D example</span></a>.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="linenos"> 2</span><span class="cp">include</span><span class="w"> </span><span class="s">&quot;cube.idp&quot;</span>
<span class="linenos"> 3</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w">  </span><span class="n">Nxyz</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">];</span>
<span class="linenos"> 4</span><span class="kt">real</span><span class="w"> </span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span><span class="w">  </span><span class="n">Bxyz</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">5.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]];</span>
<span class="linenos"> 5</span><span class="kt">int</span><span class="w"> </span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span><span class="w">  </span><span class="n">Lxyz</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]];</span>
<span class="linenos"> 6</span><span class="kt">real</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">21.5e4</span><span class="p">;</span>
<span class="linenos"> 7</span><span class="kt">real</span><span class="w"> </span><span class="kp">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.29</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="kt">real</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="kp">sigma</span><span class="p">));</span>
<span class="linenos"> 9</span><span class="kt">real</span><span class="w"> </span><span class="n">lambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="o">*</span><span class="kp">sigma</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="kp">sigma</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1-2</span><span class="o">*</span><span class="kp">sigma</span><span class="p">));</span>
<span class="linenos">10</span><span class="kt">real</span><span class="w"> </span><span class="n">gravity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.05</span><span class="p">;</span>
<span class="linenos">11</span><span class="kt">real</span><span class="w"> </span><span class="n">sqrt2</span><span class="o">=</span><span class="nf">sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">);</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th</span><span class="o">=</span><span class="n">Cube</span><span class="p">(</span><span class="n">Nxyz</span><span class="p">,</span><span class="n">Bxyz</span><span class="p">,</span><span class="n">Lxyz</span><span class="p">);</span>
<span class="linenos">14</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,[</span><span class="nc">P1</span><span class="p">,</span><span class="nc">P1</span><span class="p">,</span><span class="nc">P1</span><span class="p">]);</span>
<span class="linenos">15</span><span class="n">Vh</span><span class="w"> </span><span class="p">[</span><span class="n">u1</span><span class="p">,</span><span class="n">u2</span><span class="p">,</span><span class="n">u3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">];</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="kt">macro</span><span class="w"> </span><span class="n">epsilon</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u2</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="w">  </span><span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u1</span><span class="p">),</span><span class="nf">dy</span><span class="p">(</span><span class="n">u2</span><span class="p">),</span><span class="nf">dz</span><span class="p">(</span><span class="n">u3</span><span class="p">),(</span><span class="nf">dz</span><span class="p">(</span><span class="n">u2</span><span class="p">)</span><span class="o">+</span><span class="nf">dy</span><span class="p">(</span><span class="n">u3</span><span class="p">))</span><span class="o">/</span><span class="n">sqrt2</span><span class="p">,(</span><span class="nf">dz</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span><span class="o">+</span><span class="nf">dx</span><span class="p">(</span><span class="n">u3</span><span class="p">))</span><span class="o">/</span><span class="n">sqrt2</span><span class="p">,(</span><span class="nf">dy</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span><span class="o">+</span><span class="nf">dx</span><span class="p">(</span><span class="n">u2</span><span class="p">))</span><span class="o">/</span><span class="n">sqrt2</span><span class="p">]</span><span class="w"> </span><span class="c1">// EOM</span>
<span class="linenos">18</span><span class="kt">macro</span><span class="w"> </span><span class="n">div</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u2</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nf">dx</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span><span class="o">+</span><span class="nf">dy</span><span class="p">(</span><span class="n">u2</span><span class="p">)</span><span class="o">+</span><span class="nf">dz</span><span class="p">(</span><span class="n">u3</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="c1">// EOM</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="kt">solve</span><span class="w"> </span><span class="n">Lame</span><span class="p">([</span><span class="n">u1</span><span class="p">,</span><span class="n">u2</span><span class="p">,</span><span class="n">u3</span><span class="p">],[</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">])</span><span class="o">=</span>
<span class="linenos">21</span><span class="w">  </span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos">22</span><span class="w">            </span><span class="n">lambda</span><span class="o">*</span><span class="n">div</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u2</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">*</span><span class="n">div</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">)</span>
<span class="linenos">23</span><span class="w">            </span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="p">(</span><span class="w"> </span><span class="n">epsilon</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u2</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">&#39;*</span><span class="n">epsilon</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">24</span><span class="w">              </span><span class="p">)</span>
<span class="linenos">25</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">gravity</span><span class="o">*</span><span class="n">v3</span><span class="p">)</span>
<span class="linenos">26</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">u1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">u2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">u3</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
<span class="linenos">27</span>
<span class="linenos">28</span><span class="kt">real</span><span class="w"> </span><span class="n">dmax</span><span class="o">=</span><span class="w"> </span><span class="n">u1</span><span class="p">[].</span><span class="kr">max</span><span class="p">;</span>
<span class="linenos">29</span><span class="kt">real</span><span class="w"> </span><span class="kp">coef</span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="o">/</span><span class="n">dmax</span><span class="p">;</span>
<span class="linenos">30</span>
<span class="linenos">31</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">ref2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span><span class="w"> </span><span class="c1">// array</span>
<span class="linenos">32</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Thm</span><span class="o">=</span><span class="nf">movemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,[</span><span class="kr">x</span><span class="o">+</span><span class="n">u1</span><span class="o">*</span><span class="kp">coef</span><span class="p">,</span><span class="kr">y</span><span class="o">+</span><span class="n">u2</span><span class="o">*</span><span class="kp">coef</span><span class="p">,</span><span class="kr">z</span><span class="o">+</span><span class="n">u3</span><span class="o">*</span><span class="kp">coef</span><span class="p">],</span><span class="kr">label</span><span class="o">=</span><span class="n">ref2</span><span class="p">);</span>
<span class="linenos">33</span><span class="c1">// mesh3 Thm=movemesh3(Th,transfo=[x+u1*coef,y+u2*coef,z+u3*coef],label=ref2); older syntax</span>
<span class="linenos">34</span><span class="n">Thm</span><span class="o">=</span><span class="nf">change</span><span class="p">(</span><span class="n">Thm</span><span class="p">,</span><span class="kr">label</span><span class="o">=</span><span class="n">ref2</span><span class="p">);</span>
<span class="linenos">35</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">Thm</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;coef  amplification = &quot;</span><span class="o">+</span><span class="kp">coef</span><span class="w"> </span><span class="p">);</span>
</pre></div>
</div>
<p>movemesh doesn’t use the prefix tranfo= [.,.,.], the geometric transformation is directly given by  [.,.,.] in the arguments list</p>
</section>
<section id="the-command-extract">
<h4>The command <em>extract</em><a class="headerlink" href="#the-command-extract" title="Link to this heading"></a></h4>
<p>This command offers the possibility to extract a boundary part of a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code></p>
<ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">refface</span></code>     , is a vector of integer that contains a list of triangle face references, where the extract function must be apply.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span></code>       , is a vector of integer that contains a list of tetrahedra label</p></li>
</ul>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="cp">load</span><span class="s">&quot;msh3&quot;</span>
<span class="linenos">2</span><span class="kt">int</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span>
<span class="linenos">3</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">labs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">];</span><span class="w"> </span><span class="c1">// Label numbering</span>
<span class="linenos">4</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cube</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">labs</span><span class="p">);</span>
<span class="linenos">5</span><span class="c1">// extract the surface (boundary) of the cube</span>
<span class="linenos">6</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">llabs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">];</span>
<span class="linenos">7</span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">extract</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="kr">label</span><span class="o">=</span><span class="n">llabs</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="the-command-buildsurface">
<h4>The command <em>buildSurface</em><a class="headerlink" href="#the-command-buildsurface" title="Link to this heading"></a></h4>
<p>This new function allows to build the surface mesh of a volume mesh, under the condition the surface is the boundary of the volume.
By definition, a <strong>mesh3</strong> is defined by a list of vertices, tetrahedron elements and triangle border elements. <em>buildSurface</em> function create the meshS corresponding, given
the list vertices which are on the border domain, the triangle elements and build the list of edges.
Remark, for a closed surface mesh, the edges list is empty.</p>
</section>
<section id="the-command-movemesh23">
<h4>The command <em>movemesh23</em><a class="headerlink" href="#the-command-movemesh23" title="Link to this heading"></a></h4>
<p>A simple method to tranform a 2D mesh in 3D Surface mesh. The principe is to project a two dimensional domain in a three dimensional space, 2d surface in the (x,y,z)-space to create a surface mesh 3D, <strong>meshS</strong>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since the release 4.2.1, the <strong>FreeFEM</strong> function movemesh23 returns a meshS type.</p>
</div>
<p>This corresponds to translate, rotate or deforme the domain by a displacement vector of this form <span class="math notranslate nohighlight">\(\mathbf{\Phi(x,y)} = (\Phi1(x,y), \Phi2(x,y), \Phi3(x,y))\)</span>.</p>
<p>The result of moving a two dimensional mesh Th2 by this three dimensional displacement is obtained using:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="o">**</span><span class="kt">meshS</span><span class="o">**</span><span class="w"> </span><span class="n">Th3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span><span class="w"> </span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">Phi</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">Phi</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">Phi</span><span class="p">(</span><span class="mi">3</span><span class="p">)]);</span>
</pre></div>
</div>
<p>The parameters of this command line are:</p>
<ul>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">transfo</span><span class="o">=</span></code> [<span class="math notranslate nohighlight">\(\Phi 1\)</span>, <span class="math notranslate nohighlight">\(\Phi 2\)</span>, <span class="math notranslate nohighlight">\(\Phi 3\)</span>] sets the displacement vector of transformation <span class="math notranslate nohighlight">\(\mathbf{\Phi(x,y)} = [\Phi1(x,y), \Phi2(x,y), \Phi3(x,y)]\)</span>.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span><span class="o">=</span></code> sets an integer label of triangles.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">orientation</span><span class="o">=</span></code> sets an integer orientation to give the global orientation of the surface of mesh. Equal 1, give a triangulation in the reference orientation (counter clock wise)
equal -1 reverse the orientation of the triangles</p></li>
<li><dl>
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ptmerge</span><span class="o">=</span></code> A real expression.</dt><dd><p>When you transform a mesh, some points can be merged.
This parameter is the criteria to define two merging points.
By default, we use</p>
<div class="math notranslate nohighlight">
\[ptmerge \: = \: 1e-7 \: \:Vol( B ),\]</div>
</dd>
</dl>
<p>where <span class="math notranslate nohighlight">\(B\)</span> is the smallest axis, parallel boxes containing the discretized domain of <span class="math notranslate nohighlight">\(\Omega\)</span> and <span class="math notranslate nohighlight">\(Vol(B)\)</span> is the volume of this box.</p>
</li>
</ul>
<p>We can do a “gluing” of surface meshes using the process given in <a class="reference internal" href="#meshgenerationchangelabel"><span class="std std-ref">Change section</span></a>.
An example to obtain a three dimensional mesh using the command line <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">tetg</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">movemesh23</span></code> is given below.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos"> 2</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;tetgen&quot;</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1">// Parameters</span>
<span class="linenos"> 5</span><span class="kt">real</span><span class="w"> </span><span class="n">x10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span>
<span class="linenos"> 6</span><span class="kt">real</span><span class="w"> </span><span class="n">x11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.</span><span class="p">;</span>
<span class="linenos"> 7</span><span class="kt">real</span><span class="w"> </span><span class="n">y10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="kt">real</span><span class="w"> </span><span class="n">y11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="p">;</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="kt">func</span><span class="w"> </span><span class="n">ZZ1min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">11</span><span class="kt">func</span><span class="w"> </span><span class="n">ZZ1max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.5</span><span class="p">;</span>
<span class="linenos">12</span><span class="kt">func</span><span class="w"> </span><span class="n">XX1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">x</span><span class="p">;</span>
<span class="linenos">13</span><span class="kt">func</span><span class="w"> </span><span class="n">YY1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">y</span><span class="p">;</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="kt">real</span><span class="w"> </span><span class="n">x20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span>
<span class="linenos">16</span><span class="kt">real</span><span class="w"> </span><span class="n">x21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.</span><span class="p">;</span>
<span class="linenos">17</span><span class="kt">real</span><span class="w"> </span><span class="n">y20</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span>
<span class="linenos">18</span><span class="kt">real</span><span class="w"> </span><span class="n">y21</span><span class="o">=</span><span class="mf">1.5</span><span class="p">;</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="kt">func</span><span class="w"> </span><span class="n">ZZ2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">y</span><span class="p">;</span>
<span class="linenos">21</span><span class="kt">func</span><span class="w"> </span><span class="n">XX2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">x</span><span class="p">;</span>
<span class="linenos">22</span><span class="kt">func</span><span class="w"> </span><span class="n">YY2min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span>
<span class="linenos">23</span><span class="kt">func</span><span class="w"> </span><span class="n">YY2max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">;</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="kt">real</span><span class="w"> </span><span class="n">x30</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span>
<span class="linenos">26</span><span class="kt">real</span><span class="w"> </span><span class="n">x31</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">;</span>
<span class="linenos">27</span><span class="kt">real</span><span class="w"> </span><span class="n">y30</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span>
<span class="linenos">28</span><span class="kt">real</span><span class="w"> </span><span class="n">y31</span><span class="o">=</span><span class="mf">1.5</span><span class="p">;</span>
<span class="linenos">29</span>
<span class="linenos">30</span><span class="kt">func</span><span class="w"> </span><span class="n">XX3min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span>
<span class="linenos">31</span><span class="kt">func</span><span class="w"> </span><span class="n">XX3max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.</span><span class="p">;</span>
<span class="linenos">32</span><span class="kt">func</span><span class="w"> </span><span class="n">YY3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">x</span><span class="p">;</span>
<span class="linenos">33</span><span class="kt">func</span><span class="w"> </span><span class="n">ZZ3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">y</span><span class="p">;</span>
<span class="linenos">34</span>
<span class="linenos">35</span><span class="c1">// Mesh</span>
<span class="linenos">36</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Thsq1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">35</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">x10</span><span class="o">+</span><span class="p">(</span><span class="n">x11</span><span class="o">-</span><span class="n">x10</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="n">y10</span><span class="o">+</span><span class="p">(</span><span class="n">y11</span><span class="o">-</span><span class="n">y10</span><span class="p">)</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>
<span class="linenos">37</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Thsq2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">x20</span><span class="o">+</span><span class="p">(</span><span class="n">x21</span><span class="o">-</span><span class="n">x20</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="n">y20</span><span class="o">+</span><span class="p">(</span><span class="n">y21</span><span class="o">-</span><span class="n">y20</span><span class="p">)</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>
<span class="linenos">38</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Thsq3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">x30</span><span class="o">+</span><span class="p">(</span><span class="n">x31</span><span class="o">-</span><span class="n">x30</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="n">y30</span><span class="o">+</span><span class="p">(</span><span class="n">y31</span><span class="o">-</span><span class="n">y30</span><span class="p">)</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>
<span class="linenos">39</span>
<span class="linenos">40</span><span class="c1">// Mesh 2D to 3D surface</span>
<span class="linenos">41</span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th31h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thsq1</span><span class="p">,</span><span class="w"> </span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">XX1</span><span class="p">,</span><span class="w"> </span><span class="n">YY1</span><span class="p">,</span><span class="w"> </span><span class="n">ZZ1max</span><span class="p">],</span><span class="w"> </span><span class="kp">orientation</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">42</span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th31b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thsq1</span><span class="p">,</span><span class="w"> </span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">XX1</span><span class="p">,</span><span class="w"> </span><span class="n">YY1</span><span class="p">,</span><span class="w"> </span><span class="n">ZZ1min</span><span class="p">],</span><span class="w"> </span><span class="kp">orientation</span><span class="o">=</span><span class="mi">-1</span><span class="p">);</span>
<span class="linenos">43</span>
<span class="linenos">44</span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th32h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thsq2</span><span class="p">,</span><span class="w"> </span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">XX2</span><span class="p">,</span><span class="w"> </span><span class="n">YY2max</span><span class="p">,</span><span class="w"> </span><span class="n">ZZ2</span><span class="p">],</span><span class="w"> </span><span class="kp">orientation</span><span class="o">=</span><span class="mi">-1</span><span class="p">);</span>
<span class="linenos">45</span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th32b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thsq2</span><span class="p">,</span><span class="w"> </span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">XX2</span><span class="p">,</span><span class="w"> </span><span class="n">YY2min</span><span class="p">,</span><span class="w"> </span><span class="n">ZZ2</span><span class="p">],</span><span class="w"> </span><span class="kp">orientation</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">46</span>
<span class="linenos">47</span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th33h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thsq3</span><span class="p">,</span><span class="w"> </span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">XX3max</span><span class="p">,</span><span class="w"> </span><span class="n">YY3</span><span class="p">,</span><span class="w"> </span><span class="n">ZZ3</span><span class="p">],</span><span class="w"> </span><span class="kp">orientation</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">48</span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th33b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thsq3</span><span class="p">,</span><span class="w"> </span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">XX3min</span><span class="p">,</span><span class="w"> </span><span class="n">YY3</span><span class="p">,</span><span class="w"> </span><span class="n">ZZ3</span><span class="p">],</span><span class="w"> </span><span class="kp">orientation</span><span class="o">=</span><span class="mi">-1</span><span class="p">);</span>
<span class="linenos">49</span>
<span class="linenos">50</span><span class="c1">// Gluing surfaces</span>
<span class="linenos">51</span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th33</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th31h</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Th31b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Th32h</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Th32b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Th33h</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Th33b</span><span class="p">;</span>
<span class="linenos">52</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th33</span><span class="p">,</span><span class="w"> </span><span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;Th33&quot;</span><span class="p">);</span>
<span class="linenos">53</span>
<span class="linenos">54</span><span class="c1">// Tetrahelize the interior of the cube with TetGen</span>
<span class="linenos">55</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="o">=</span><span class="p">[</span><span class="mf">1.5</span><span class="p">,</span><span class="w"> </span><span class="kr">pi</span><span class="p">,</span><span class="w"> </span><span class="mf">0.75</span><span class="p">,</span><span class="w"> </span><span class="mi">145</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0025</span><span class="p">];</span>
<span class="linenos">56</span><span class="kt">meshS</span><span class="w"> </span><span class="n">Thfinal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">tetg</span><span class="p">(</span><span class="n">Th33</span><span class="p">,</span><span class="w"> </span><span class="kp">switch</span><span class="o">=</span><span class="s">&quot;paAAQY&quot;</span><span class="p">,</span><span class="w"> </span><span class="kp">regionlist</span><span class="o">=</span><span class="n">domain</span><span class="p">);</span>
<span class="linenos">57</span><span class="nf">plot</span><span class="p">(</span><span class="n">Thfinal</span><span class="p">,</span><span class="w"> </span><span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;Thfinal&quot;</span><span class="p">);</span>
<span class="linenos">58</span>
<span class="linenos">59</span><span class="c1">// Build a mesh of a half cylindrical shell of interior radius 1, and exterior radius 2 and a height of 1.5</span>
<span class="linenos">60</span><span class="kt">func</span><span class="w"> </span><span class="n">mv2x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">x</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">61</span><span class="kt">func</span><span class="w"> </span><span class="n">mv2y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">x</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">62</span><span class="kt">func</span><span class="w"> </span><span class="n">mv2z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">z</span><span class="p">;</span>
<span class="linenos">63</span><span class="kt">meshS</span><span class="w"> </span><span class="n">Thmv2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh</span><span class="p">(</span><span class="n">Thfinal</span><span class="p">,</span><span class="w"> </span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">mv2x</span><span class="p">,</span><span class="w"> </span><span class="n">mv2y</span><span class="p">,</span><span class="w"> </span><span class="n">mv2z</span><span class="p">],</span><span class="w"> </span><span class="kp">facemerge</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
<span class="linenos">64</span><span class="nf">plot</span><span class="p">(</span><span class="n">Thmv2</span><span class="p">,</span><span class="w"> </span><span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;Thmv2&quot;</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
<section id="d-meshing-examples">
<span id="meshing-examples-1"></span><h3>3d Meshing examples<a class="headerlink" href="#d-meshing-examples" title="Link to this heading"></a></h3>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Lake</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos"> 2</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1">// Parameters</span>
<span class="linenos"> 5</span><span class="kt">int</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1">// 2D mesh</span>
<span class="linenos"> 8</span><span class="kt">border</span><span class="w"> </span><span class="nf">cc</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="linenos"> 9</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">cc</span><span class="p">(</span><span class="mi">100</span><span class="p">));</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="c1">// 3D mesh</span>
<span class="linenos">12</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">rup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">rlow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="linenos">13</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">rmid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="linenos">14</span><span class="kt">func</span><span class="w"> </span><span class="n">zmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">-</span><span class="nf">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="p">(</span><span class="kr">x</span><span class="o">*</span><span class="kr">x</span><span class="o">+</span><span class="kr">y</span><span class="o">*</span><span class="kr">y</span><span class="p">));</span>
<span class="linenos">15</span><span class="kt">func</span><span class="w"> </span><span class="n">zmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">-</span><span class="nf">sqrt</span><span class="p">(</span><span class="mf">3.</span><span class="p">);</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildlayers</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span><span class="w"> </span><span class="n">nn</span><span class="p">,</span>
<span class="linenos">18</span><span class="w">    </span><span class="kp">coef</span><span class="o">=</span><span class="kr">max</span><span class="p">((</span><span class="n">zmax</span><span class="o">-</span><span class="n">zmin</span><span class="p">)</span><span class="o">/</span><span class="n">zmax</span><span class="p">,</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="n">nn</span><span class="p">),</span>
<span class="linenos">19</span><span class="w">    </span><span class="kp">zbound</span><span class="o">=</span><span class="p">[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span>
<span class="linenos">20</span><span class="w">    </span><span class="kp">labelmid</span><span class="o">=</span><span class="n">rmid</span><span class="p">,</span>
<span class="linenos">21</span><span class="w">    </span><span class="kp">labelup</span><span class="o">=</span><span class="n">rup</span><span class="p">,</span>
<span class="linenos">22</span><span class="w">    </span><span class="kp">labeldown</span><span class="o">=</span><span class="n">rlow</span><span class="p">);</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Th&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Th</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Hole region</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos"> 2</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;TetGen&quot;</span>
<span class="linenos"> 3</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="c1">// 2D mesh</span>
<span class="linenos"> 6</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kr">x</span><span class="o">*</span><span class="kr">pi</span><span class="o">-</span><span class="kr">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">y</span><span class="o">*</span><span class="kr">pi</span><span class="p">]);</span><span class="w"> </span><span class="c1">// ]-pi/2, pi/2[X]0,2pi[</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="c1">// 3D mesh</span>
<span class="linenos"> 9</span><span class="c1">//parametrization of a sphere</span>
<span class="linenos">10</span><span class="kt">func</span><span class="w"> </span><span class="n">f1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">11</span><span class="kt">func</span><span class="w"> </span><span class="n">f2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">12</span><span class="kt">func</span><span class="w"> </span><span class="n">f3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">);</span>
<span class="linenos">13</span><span class="c1">//partial derivative of the parametrization</span>
<span class="linenos">14</span><span class="kt">func</span><span class="w"> </span><span class="n">f1x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">15</span><span class="kt">func</span><span class="w"> </span><span class="n">f1y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">16</span><span class="kt">func</span><span class="w"> </span><span class="n">f2x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">17</span><span class="kt">func</span><span class="w"> </span><span class="n">f2y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">18</span><span class="kt">func</span><span class="w"> </span><span class="n">f3x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">);</span>
<span class="linenos">19</span><span class="kt">func</span><span class="w"> </span><span class="n">f3y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">20</span><span class="c1">//M = DF^t DF</span>
<span class="linenos">21</span><span class="kt">func</span><span class="w"> </span><span class="n">m11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f1x</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f2x</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f3x</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
<span class="linenos">22</span><span class="kt">func</span><span class="w"> </span><span class="n">m21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f1x</span><span class="o">*</span><span class="n">f1y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f2x</span><span class="o">*</span><span class="n">f2y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f3x</span><span class="o">*</span><span class="n">f3y</span><span class="p">;</span>
<span class="linenos">23</span><span class="kt">func</span><span class="w"> </span><span class="n">m22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f1y</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f2y</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f3y</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="kt">func</span><span class="w"> </span><span class="n">perio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kr">x</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kr">x</span><span class="p">]];</span>
<span class="linenos">26</span><span class="kt">real</span><span class="w"> </span><span class="n">hh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span>
<span class="linenos">27</span><span class="kt">real</span><span class="w"> </span><span class="n">vv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="nf">square</span><span class="p">(</span><span class="n">hh</span><span class="p">);</span>
<span class="linenos">28</span><span class="kr">verbosity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="linenos">29</span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">m11</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="w"> </span><span class="n">m21</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="w"> </span><span class="n">m22</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="w"> </span><span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">periodic</span><span class="o">=</span><span class="n">perio</span><span class="p">);</span>
<span class="linenos">30</span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">m11</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="w"> </span><span class="n">m21</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="w"> </span><span class="n">m22</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="w"> </span><span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">periodic</span><span class="o">=</span><span class="n">perio</span><span class="p">);</span>
<span class="linenos">31</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos">32</span>
<span class="linenos">33</span><span class="c1">//construction of the surface of spheres</span>
<span class="linenos">34</span><span class="kt">real</span><span class="w"> </span><span class="n">Rmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span>
<span class="linenos">35</span><span class="kt">func</span><span class="w"> </span><span class="n">f1min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rmin</span><span class="o">*</span><span class="n">f1</span><span class="p">;</span>
<span class="linenos">36</span><span class="kt">func</span><span class="w"> </span><span class="n">f2min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rmin</span><span class="o">*</span><span class="n">f2</span><span class="p">;</span>
<span class="linenos">37</span><span class="kt">func</span><span class="w"> </span><span class="n">f3min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rmin</span><span class="o">*</span><span class="n">f3</span><span class="p">;</span>
<span class="linenos">38</span>
<span class="linenos">39</span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThSsph</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">f1min</span><span class="p">,</span><span class="w"> </span><span class="n">f2min</span><span class="p">,</span><span class="w"> </span><span class="n">f3min</span><span class="p">]);</span>
<span class="linenos">40</span>
<span class="linenos">41</span><span class="kt">real</span><span class="w"> </span><span class="n">Rmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.</span><span class="p">;</span>
<span class="linenos">42</span><span class="kt">func</span><span class="w"> </span><span class="n">f1max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rmax</span><span class="o">*</span><span class="n">f1</span><span class="p">;</span>
<span class="linenos">43</span><span class="kt">func</span><span class="w"> </span><span class="n">f2max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rmax</span><span class="o">*</span><span class="n">f2</span><span class="p">;</span>
<span class="linenos">44</span><span class="kt">func</span><span class="w"> </span><span class="n">f3max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rmax</span><span class="o">*</span><span class="n">f3</span><span class="p">;</span>
<span class="linenos">45</span>
<span class="linenos">46</span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThSsph2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">f1max</span><span class="p">,</span><span class="w"> </span><span class="n">f2max</span><span class="p">,</span><span class="w"> </span><span class="n">f3max</span><span class="p">]);</span>
<span class="linenos">47</span>
<span class="linenos">48</span><span class="c1">//gluing meshes</span>
<span class="linenos">49</span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ThSsph</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ThSsph2</span><span class="p">;</span>
<span class="linenos">50</span>
<span class="linenos">51</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; TetGen call without hole &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">52</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">domain2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mi">145</span><span class="p">,</span><span class="w"> </span><span class="mf">0.001</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mi">18</span><span class="p">,</span><span class="w"> </span><span class="mf">0.001</span><span class="p">];</span>
<span class="linenos">53</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th3fin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">tetg</span><span class="p">(</span><span class="n">ThS</span><span class="p">,</span><span class="w"> </span><span class="kp">switch</span><span class="o">=</span><span class="s">&quot;paAAQYY&quot;</span><span class="p">,</span><span class="w"> </span><span class="kp">nbofregions</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="kp">regionlist</span><span class="o">=</span><span class="n">domain2</span><span class="p">);</span>
<span class="linenos">54</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Sphere with two regions&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Th3fin</span><span class="p">);</span>
<span class="linenos">55</span>
<span class="linenos">56</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; TetGen call with hole &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">57</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">hole</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">];</span>
<span class="linenos">58</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mi">53</span><span class="p">,</span><span class="w"> </span><span class="mf">0.001</span><span class="p">];</span>
<span class="linenos">59</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th3finhole</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">tetg</span><span class="p">(</span><span class="n">ThS</span><span class="p">,</span><span class="w"> </span><span class="kp">switch</span><span class="o">=</span><span class="s">&quot;paAAQYY&quot;</span><span class="p">,</span>
<span class="linenos">60</span><span class="w">    </span><span class="kp">nbofholes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">holelist</span><span class="o">=</span><span class="n">hole</span><span class="p">,</span><span class="w"> </span><span class="kp">nbofregions</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">regionlist</span><span class="o">=</span><span class="n">domain</span><span class="p">);</span>
<span class="linenos">61</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Sphere with a hole&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Th3finhole</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Build a 3d mesh of a cube with a balloon</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos"> 2</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;TetGen&quot;</span>
<span class="linenos"> 3</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="linenos"> 4</span><span class="cp">include</span><span class="w"> </span><span class="s">&quot;MeshSurface.idp&quot;</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="c1">// Parameters</span>
<span class="linenos"> 7</span><span class="kt">real</span><span class="w"> </span><span class="n">hs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="c1">//mesh size on sphere</span>
<span class="linenos"> 8</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="kr">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">];</span>
<span class="linenos"> 9</span><span class="kt">real</span><span class="w"> </span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="kp">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]];</span>
<span class="linenos">10</span><span class="kt">int</span><span class="w"> </span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">]];</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="c1">// Meshes</span>
<span class="linenos">13</span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SurfaceHex</span><span class="p">(</span><span class="kr">N</span><span class="p">,</span><span class="w"> </span><span class="kp">B</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">14</span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sphere</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">hs</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThHS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ThH</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ThS</span><span class="p">;</span>
<span class="linenos">17</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Hex-Sphere&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ThHS</span><span class="p">);</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="kt">real</span><span class="w"> </span><span class="n">voltet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">hs</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">6.</span><span class="p">;</span>
<span class="linenos">20</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;voltet = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">voltet</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">21</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">voltet</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">voltet</span><span class="p">];</span>
<span class="linenos">22</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">tetg</span><span class="p">(</span><span class="n">ThHS</span><span class="p">,</span><span class="w"> </span><span class="kp">switch</span><span class="o">=</span><span class="s">&quot;pqaAAYYQ&quot;</span><span class="p">,</span><span class="w"> </span><span class="kp">nbofregions</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="kp">regionlist</span><span class="o">=</span><span class="n">domain</span><span class="p">);</span>
<span class="linenos">23</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Cube with ball&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Th</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="figure compound align-center" id="CubeSphere">
<figure class="align-default" id="id50">
<span id="meshgenerationcubesphere1"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_CubeSphere1.png"><img alt="MeshGeneration_CubeSphere1" src="../_images/MeshGeneration_CubeSphere1.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 93 </span><span class="caption-text">The surface mesh of the hex with internal sphere</span><a class="headerlink" href="#id50" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id51">
<span id="meshgenerationcubesphere2"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_CubeSphere2.png"><img alt="MeshGeneration_CubeSphere2" src="../_images/MeshGeneration_CubeSphere2.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 94 </span><span class="caption-text">The tetrahedral mesh of the cube with internal ball</span><a class="headerlink" href="#id51" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><span class="caption-text">Cube sphere</span></p>
</div></section>
</section>
<section id="the-type-meshs-in-3-dimension">
<span id="meshstype"></span><span id="CubeSphere"></span><h2><strong>The type meshS in 3 dimension</strong><a class="headerlink" href="#the-type-meshs-in-3-dimension" title="Link to this heading"></a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since the release 4.2.1, the surface <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code> object (list of vertices and border elements, without tetahedra elements) is remplaced by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code> type.</p>
</div>
<section id="commands-for-3d-surface-mesh-generation">
<h3>Commands for 3d surface mesh generation<a class="headerlink" href="#commands-for-3d-surface-mesh-generation" title="Link to this heading"></a></h3>
<section id="the-command-square3">
<h4>The command <em>square3</em><a class="headerlink" href="#the-command-square3" title="Link to this heading"></a></h4>
<p>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">square3</span></code> like the function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">square</span></code> in 2d is the simple way to a build the unit square plan in the space <span class="math notranslate nohighlight">\(\mathbb{R^3}\)</span>.
To use this command, it is necessary to load the pluging <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">msh3</span></code> (need <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span></code>).
A square in 3d consists in building a 2d square which is projected from <span class="math notranslate nohighlight">\(\mathbb{R^2}\)</span> to <span class="math notranslate nohighlight">\(\mathbb{R^3}\)</span>.
The parameters of this command line are:</p>
<blockquote>
<div><ul class="simple">
<li><p>n,m  generates a n×m grid in the unit square</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[.,.,.]</span></code> is  [ <span class="math notranslate nohighlight">\(\Phi 1\)</span>, <span class="math notranslate nohighlight">\(\Phi 2\)</span>, <span class="math notranslate nohighlight">\(\Phi 3\)</span> ] is the geometric transformation from <span class="math notranslate nohighlight">\(\mathbb{R^2}\)</span> to <span class="math notranslate nohighlight">\(\mathbb{R^3}\)</span>. By default, [ <span class="math notranslate nohighlight">\(\Phi 1\)</span>, <span class="math notranslate nohighlight">\(\Phi 2\)</span>, <span class="math notranslate nohighlight">\(\Phi 3\)</span> ] = [x,y,0]</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">orientation</span><span class="o">=</span></code>
equal 1, gives the orientation of the triangulation, elements are in the reference orientation (counter clock wise)
equal -1 reverse the orientation of the triangles
it’s the global orientation of the surface 1 extern (-1 intern)</p></li>
</ul>
</div></blockquote>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="w">     </span><span class="kt">real</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="linenos"> 2</span><span class="w">     </span><span class="kt">real</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"> </span><span class="c1">//</span>
<span class="linenos"> 3</span><span class="w">     </span><span class="kt">int</span><span class="w"> </span><span class="n">nx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">/</span><span class="n">h</span><span class="p">;</span>
<span class="linenos"> 4</span><span class="w">     </span><span class="kt">int</span><span class="w"> </span><span class="n">ny</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">/</span><span class="n">h</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="w">     </span><span class="kt">func</span><span class="w"> </span><span class="n">torex</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">R</span><span class="o">+</span><span class="n">r</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos"> 6</span><span class="w">     </span><span class="kt">func</span><span class="w"> </span><span class="n">torey</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">R</span><span class="o">+</span><span class="n">r</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos"> 7</span><span class="w">     </span><span class="kt">func</span><span class="w"> </span><span class="n">torez</span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="w">     </span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThS</span><span class="o">=</span><span class="nf">square3</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">,[</span><span class="n">torex</span><span class="p">,</span><span class="n">torey</span><span class="p">,</span><span class="n">torez</span><span class="p">],</span><span class="kp">orientation</span><span class="o">=</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
<p>The following code generates a <span class="math notranslate nohighlight">\(3\times 4 \times 5\)</span> grid in the unit cube <span class="math notranslate nohighlight">\([0, 1]^3\)</span> with a clock wise triangulation.</p>
</section>
<section id="surface-mesh-builders">
<h4>surface mesh builders<a class="headerlink" href="#surface-mesh-builders" title="Link to this heading"></a></h4>
<p>Adding at the top of a <em>FreeFEM</em> script <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">include</span><span class="w"> </span><span class="s">&quot;MeshSurface.idp&quot;</span></code>, constructors of sphere, ellipsoid, surface mesh of a 3d box are available.</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">SurfaceHex</span><span class="p">(</span><span class="kr">N</span><span class="p">,</span><span class="w"> </span><span class="kp">B</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">orient</span><span class="p">)</span></code></p>
<ul>
<li><p>this operator allows to build the surface mesh of a 3d box</p></li>
<li><p>int[int]  N=[nx,ny,nz]; //  the number of seg in the 3 direction</p></li>
<li><p>real [int,int]  B=[[xmin,xmax],[ymin,ymax],[zmin,zmax]]; // bounding bax</p></li>
<li><p>int [int,int]  L=[[1,2],[3,4],[5,6]]; // the label of the 6 face left,right, front, back, down, right</p></li>
<li><p>orient the global orientation of the surface 1 extern (-1 intern),</p></li>
<li><p>returns a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code> type</p></li>
</ul>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Ellipsoide</span><span class="w"> </span><span class="p">(</span><span class="n">RX</span><span class="p">,</span><span class="w"> </span><span class="n">RY</span><span class="p">,</span><span class="w"> </span><span class="n">RZ</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">OX</span><span class="p">,</span><span class="w"> </span><span class="n">OY</span><span class="p">,</span><span class="w"> </span><span class="n">OZ</span><span class="p">,</span><span class="w"> </span><span class="n">orient</span><span class="p">)</span></code></p>
<ul>
<li><p>h is the mesh size</p></li>
<li><p>L is the label</p></li>
<li><p>orient the global orientation of the surface 1 extern (-1 intern)</p></li>
<li><p>OX, OY, OZ are real numbers to give the Ellipsoide center ( optinal, by default is (0,0,0) )</p></li>
<li><p>where RX, RY, RZ are real numbers such as the parametric equations of the ellipsoid is:</p></li>
<li><p>returns a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code> type</p></li>
</ul>
</li>
</ul>
<div class="math notranslate nohighlight">
\[\forall u \in [- \frac{\pi}{2},\frac{\pi}{2}  [ \text{ and } v \in [0, 2 \pi], \vectthree{x=\text{Rx } cos(u)cos(v) + \text{Ox }}{y=\text{Ry } cos(u)sin(v) + \text{Oy }}{z = \text{Rz } sin(v)  + \text{Oz }    }\]</div>
<ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Sphere</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">OX</span><span class="p">,</span><span class="w"> </span><span class="n">OY</span><span class="p">,</span><span class="w"> </span><span class="n">OZ</span><span class="p">,</span><span class="w"> </span><span class="n">orient</span><span class="p">)</span></code></p>
<ul>
<li><p>where R is the raduis of the sphere,</p></li>
<li><p>OX, OY, OZ are real numbers to give the Ellipsoide center ( optinal, by default is (0,0,0) )</p></li>
<li><p>h is the mesh size  of  the shpere</p></li>
<li><p>L is the label the the sphere</p></li>
<li><p>orient the global orientation of the surface 1 extern (-1 intern)</p></li>
<li><p>returns a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code> type</p></li>
</ul>
</li>
</ul>
</div></blockquote>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">func</span><span class="w"> </span><span class="kt">meshS</span><span class="w"> </span><span class="n">SurfaceHex</span><span class="p">(</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="kr">N</span><span class="p">,</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="kp">B</span><span class="w"> </span><span class="p">,</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="kp">orientation</span><span class="p">){</span>
<span class="linenos"> 2</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">x0</span><span class="o">=</span><span class="kp">B</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">x1</span><span class="o">=</span><span class="kp">B</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos"> 3</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="nf">y0</span><span class="o">=</span><span class="kp">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="nf">y1</span><span class="o">=</span><span class="kp">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">z0</span><span class="o">=</span><span class="kp">B</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">z1</span><span class="o">=</span><span class="kp">B</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nx</span><span class="o">=</span><span class="kr">N</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ny</span><span class="o">=</span><span class="kr">N</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">nz</span><span class="o">=</span><span class="kr">N</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="w">    </span><span class="kt">mesh</span><span class="w"> </span><span class="n">Thx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span><span class="n">nz</span><span class="p">,[</span><span class="nf">y0</span><span class="o">+</span><span class="p">(</span><span class="nf">y1</span><span class="o">-</span><span class="nf">y0</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="n">z0</span><span class="o">+</span><span class="p">(</span><span class="n">z1</span><span class="o">-</span><span class="n">z0</span><span class="p">)</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>
<span class="linenos"> 9</span><span class="w">    </span><span class="kt">mesh</span><span class="w"> </span><span class="n">Thy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span><span class="n">nz</span><span class="p">,[</span><span class="n">x0</span><span class="o">+</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="n">z0</span><span class="o">+</span><span class="p">(</span><span class="n">z1</span><span class="o">-</span><span class="n">z0</span><span class="p">)</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>
<span class="linenos">10</span><span class="w">    </span><span class="kt">mesh</span><span class="w"> </span><span class="n">Thz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">,[</span><span class="n">x0</span><span class="o">+</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="nf">y0</span><span class="o">+</span><span class="p">(</span><span class="nf">y1</span><span class="o">-</span><span class="nf">y0</span><span class="p">)</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="w">    </span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">refx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span><span class="n">refX</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)];</span><span class="w">   </span><span class="c1">//  Xmin, Ymax faces labels renumbering</span>
<span class="linenos">13</span><span class="w">    </span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">refy</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span><span class="n">refY</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)];</span><span class="w">   </span><span class="c1">//  Ymin, Ymax faces labesl renumbering</span>
<span class="linenos">14</span><span class="w">    </span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">refz</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span><span class="n">refZ</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)];</span><span class="w">   </span><span class="c1">//  Zmin, Zmax faces labels renumbering</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="w">    </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Thx0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thx</span><span class="p">,</span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">x0</span><span class="p">,</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">],</span><span class="kp">orientation</span><span class="o">=-</span><span class="kp">orientation</span><span class="p">,</span><span class="kr">label</span><span class="o">=</span><span class="n">refx</span><span class="p">);</span>
<span class="linenos">17</span><span class="w">    </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Thx1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thx</span><span class="p">,</span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">x1</span><span class="p">,</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">],</span><span class="kp">orientation</span><span class="o">=+</span><span class="kp">orientation</span><span class="p">,</span><span class="kr">label</span><span class="o">=</span><span class="n">refX</span><span class="p">);</span>
<span class="linenos">18</span><span class="w">    </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Thy0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thy</span><span class="p">,</span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="kr">x</span><span class="p">,</span><span class="nf">y0</span><span class="p">,</span><span class="kr">y</span><span class="p">],</span><span class="kp">orientation</span><span class="o">=+</span><span class="kp">orientation</span><span class="p">,</span><span class="kr">label</span><span class="o">=</span><span class="n">refy</span><span class="p">);</span>
<span class="linenos">19</span><span class="w">    </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Thy1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thy</span><span class="p">,</span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="kr">x</span><span class="p">,</span><span class="nf">y1</span><span class="p">,</span><span class="kr">y</span><span class="p">],</span><span class="kp">orientation</span><span class="o">=-</span><span class="kp">orientation</span><span class="p">,</span><span class="kr">label</span><span class="o">=</span><span class="n">refY</span><span class="p">);</span>
<span class="linenos">20</span><span class="w">    </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Thz0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thz</span><span class="p">,</span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">,</span><span class="n">z0</span><span class="p">],</span><span class="kp">orientation</span><span class="o">=-</span><span class="kp">orientation</span><span class="p">,</span><span class="kr">label</span><span class="o">=</span><span class="n">refz</span><span class="p">);</span>
<span class="linenos">21</span><span class="w">    </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Thz1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thz</span><span class="p">,</span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">,</span><span class="n">z1</span><span class="p">],</span><span class="kp">orientation</span><span class="o">=+</span><span class="kp">orientation</span><span class="p">,</span><span class="kr">label</span><span class="o">=</span><span class="n">refZ</span><span class="p">);</span>
<span class="linenos">22</span><span class="w">    </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th</span><span class="o">=</span><span class="w"> </span><span class="n">Thx0</span><span class="o">+</span><span class="n">Thx1</span><span class="o">+</span><span class="n">Thy0</span><span class="o">+</span><span class="n">Thy1</span><span class="o">+</span><span class="n">Thz0</span><span class="o">+</span><span class="n">Thz1</span><span class="p">;</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Th</span><span class="p">;</span>
<span class="linenos">25</span><span class="w"> </span><span class="p">}</span>
<span class="linenos">26</span>
<span class="linenos">27</span><span class="w"> </span><span class="kt">func</span><span class="w"> </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Ellipsoide</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="w"> </span><span class="n">RX</span><span class="p">,</span><span class="kt">real</span><span class="w"> </span><span class="n">RY</span><span class="p">,</span><span class="kt">real</span><span class="w"> </span><span class="n">RZ</span><span class="p">,</span><span class="kt">real</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="kt">real</span><span class="w"> </span><span class="n">Ox</span><span class="p">,</span><span class="kt">real</span><span class="w"> </span><span class="n">Oy</span><span class="p">,</span><span class="kt">real</span><span class="w"> </span><span class="n">Oz</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="kp">orientation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">28</span><span class="w">    </span><span class="kt">mesh</span><span class="w">  </span><span class="n">Th</span><span class="o">=</span><span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,[</span><span class="kr">x</span><span class="o">*</span><span class="kr">pi</span><span class="o">-</span><span class="kr">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="kr">y</span><span class="o">*</span><span class="kr">pi</span><span class="p">]);</span><span class="w">  </span><span class="c1">//  $]\frac{-pi}{2},frac{-pi}{2}[\times]0,2\pi[ $</span>
<span class="linenos">29</span><span class="w">    </span><span class="c1">//  a parametrization of a sphere</span>
<span class="linenos">30</span><span class="w">    </span><span class="kt">func</span><span class="w"> </span><span class="n">f1</span><span class="w"> </span><span class="o">=</span><span class="n">RX</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">31</span><span class="w">    </span><span class="kt">func</span><span class="w"> </span><span class="n">f2</span><span class="w"> </span><span class="o">=</span><span class="n">RY</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">32</span><span class="w">    </span><span class="kt">func</span><span class="w"> </span><span class="n">f3</span><span class="w"> </span><span class="o">=</span><span class="n">RZ</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">);</span>
<span class="linenos">33</span><span class="w">        </span><span class="c1">//    partiel derivative</span>
<span class="linenos">34</span><span class="w">    </span><span class="kt">func</span><span class="w"> </span><span class="n">f1x</span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">RX</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">35</span><span class="w">    </span><span class="kt">func</span><span class="w"> </span><span class="n">f1y</span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">RX</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">36</span><span class="w">    </span><span class="kt">func</span><span class="w"> </span><span class="n">f2x</span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">RY</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">37</span><span class="w">    </span><span class="kt">func</span><span class="w"> </span><span class="n">f2y</span><span class="o">=</span><span class="w"> </span><span class="o">+</span><span class="n">RY</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">38</span><span class="w">    </span><span class="kt">func</span><span class="w"> </span><span class="n">f3x</span><span class="o">=-</span><span class="n">RZ</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">);</span>
<span class="linenos">39</span><span class="w">    </span><span class="kt">func</span><span class="w"> </span><span class="n">f3y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">40</span><span class="w">    </span><span class="c1">// the metric on the sphere  $  M = DF^t DF $</span>
<span class="linenos">41</span><span class="w">    </span><span class="kt">func</span><span class="w"> </span><span class="n">m11</span><span class="o">=</span><span class="n">f1x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">f2x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">f3x</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
<span class="linenos">42</span><span class="w">    </span><span class="kt">func</span><span class="w"> </span><span class="n">m21</span><span class="o">=</span><span class="n">f1x</span><span class="o">*</span><span class="n">f1y</span><span class="o">+</span><span class="n">f2x</span><span class="o">*</span><span class="n">f2y</span><span class="o">+</span><span class="n">f3x</span><span class="o">*</span><span class="n">f3y</span><span class="p">;</span>
<span class="linenos">43</span><span class="w">    </span><span class="kt">func</span><span class="w"> </span><span class="n">m22</span><span class="o">=</span><span class="n">f1y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">f2y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">f3y</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
<span class="linenos">44</span><span class="w">    </span><span class="kt">func</span><span class="w"> </span><span class="n">perio</span><span class="o">=</span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span><span class="kr">y</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="kr">y</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="kr">x</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="kr">x</span><span class="p">]];</span><span class="w">  </span><span class="c1">// to store the periodic condition</span>
<span class="linenos">45</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">hh</span><span class="o">=</span><span class="n">h</span><span class="p">;</span><span class="c1">// hh  mesh size on unite sphere</span>
<span class="linenos">46</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="n">vv</span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="nf">square</span><span class="p">(</span><span class="n">hh</span><span class="p">);</span>
<span class="linenos">47</span><span class="w">    </span><span class="n">Th</span><span class="o">=</span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">m11</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="n">m21</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="n">m22</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kp">periodic</span><span class="o">=</span><span class="n">perio</span><span class="p">);</span>
<span class="linenos">48</span><span class="w">    </span><span class="n">Th</span><span class="o">=</span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">m11</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="n">m21</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="n">m22</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kp">periodic</span><span class="o">=</span><span class="n">perio</span><span class="p">);</span>
<span class="linenos">49</span><span class="w">    </span><span class="n">Th</span><span class="o">=</span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">m11</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="n">m21</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="n">m22</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kp">periodic</span><span class="o">=</span><span class="n">perio</span><span class="p">);</span>
<span class="linenos">50</span><span class="w">    </span><span class="n">Th</span><span class="o">=</span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">m11</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="n">m21</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="n">m22</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kp">periodic</span><span class="o">=</span><span class="n">perio</span><span class="p">);</span>
<span class="linenos">51</span><span class="w">    </span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">ref</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">];</span>
<span class="linenos">52</span><span class="w">    </span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThS</span><span class="o">=</span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="n">f3</span><span class="p">],</span><span class="kp">orientation</span><span class="o">=</span><span class="kp">orientation</span><span class="p">,</span><span class="n">refface</span><span class="o">=</span><span class="n">ref</span><span class="p">);</span>
<span class="linenos">53</span><span class="w">    </span><span class="n">ThS</span><span class="o">=</span><span class="n">mmgs</span><span class="p">(</span><span class="n">ThS</span><span class="p">,</span><span class="kp">hmin</span><span class="o">=</span><span class="n">h</span><span class="p">,</span><span class="kp">hmax</span><span class="o">=</span><span class="n">h</span><span class="p">,</span><span class="n">hgrad</span><span class="o">=</span><span class="mf">2.</span><span class="p">);</span>
<span class="linenos">54</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">ThS</span><span class="p">;</span>
<span class="linenos">55</span><span class="w"> </span><span class="p">}</span>
<span class="linenos">56</span>
<span class="linenos">57</span><span class="w"> </span><span class="kt">func</span><span class="w"> </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Ellipsoide</span><span class="w"> </span><span class="p">(</span><span class="kt">real</span><span class="w"> </span><span class="n">RX</span><span class="p">,</span><span class="kt">real</span><span class="w"> </span><span class="n">RY</span><span class="p">,</span><span class="kt">real</span><span class="w"> </span><span class="n">RZ</span><span class="p">,</span><span class="kt">real</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="kp">orientation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">58</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">Ellipsoide</span><span class="w"> </span><span class="p">(</span><span class="n">RX</span><span class="p">,</span><span class="n">RY</span><span class="p">,</span><span class="n">RZ</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="kp">orientation</span><span class="p">);</span>
<span class="linenos">59</span><span class="w"> </span><span class="p">}</span>
<span class="linenos">60</span><span class="w"> </span><span class="kt">func</span><span class="w"> </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Sphere</span><span class="p">(</span><span class="kt">real</span><span class="w"> </span><span class="n">R</span><span class="p">,</span><span class="kt">real</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="kp">orientation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">61</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">Ellipsoide</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="kp">orientation</span><span class="p">);</span>
<span class="linenos">62</span><span class="w"> </span><span class="p">}</span>
<span class="linenos">63</span><span class="w"> </span><span class="kt">func</span><span class="w"> </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Sphere</span><span class="p">(</span><span class="kt">real</span><span class="w"> </span><span class="n">R</span><span class="p">,</span><span class="kt">real</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="kt">real</span><span class="w"> </span><span class="n">Ox</span><span class="p">,</span><span class="kt">real</span><span class="w"> </span><span class="n">Oy</span><span class="p">,</span><span class="kt">real</span><span class="w"> </span><span class="n">Oz</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="kp">orientation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">64</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">Ellipsoide</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">Ox</span><span class="p">,</span><span class="n">Oy</span><span class="p">,</span><span class="n">Oz</span><span class="p">,</span><span class="kp">orientation</span><span class="p">);</span>
<span class="linenos">65</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="d-mesh-generators-combined-with-movemesh23">
<h4>2D mesh generators combined with  <em>movemesh23</em><a class="headerlink" href="#d-mesh-generators-combined-with-movemesh23" title="Link to this heading"></a></h4>
<p><strong>FreeFEM</strong> ‘s meshes can be built by the composition of the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">movemesh23</span></code> command from a 2d mesh generation.
The operation is a projection of a 2d plane in <span class="math notranslate nohighlight">\(\mathbb{R^3}\)</span> following the geometric transformation  [ <span class="math notranslate nohighlight">\(\Phi 1\)</span>, <span class="math notranslate nohighlight">\(\Phi 2\)</span>, <span class="math notranslate nohighlight">\(\Phi 3\)</span> ].</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos"> 2</span><span class="kt">real</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="linenos"> 3</span><span class="kt">border</span><span class="w"> </span><span class="nf">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=-</span><span class="n">l</span><span class="p">,</span><span class="n">l</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=-</span><span class="n">l</span><span class="p">;</span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="linenos"> 4</span><span class="kt">border</span><span class="w"> </span><span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=-</span><span class="n">l</span><span class="p">,</span><span class="n">l</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">l</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="linenos"> 5</span><span class="kt">border</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="n">l</span><span class="p">,</span><span class="o">-</span><span class="n">l</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="n">l</span><span class="p">;</span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="linenos"> 6</span><span class="kt">border</span><span class="w"> </span><span class="nf">d</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="n">l</span><span class="p">,</span><span class="o">-</span><span class="n">l</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="n">l</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="linenos"> 7</span><span class="kt">int</span><span class="w"> </span><span class="kr">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="kt">border</span><span class="w"> </span><span class="nf">i</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">1.1</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="kr">y</span><span class="o">=</span><span class="mf">1.1</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="kr">label</span><span class="o">=</span><span class="mi">5</span><span class="p">;};</span>
<span class="linenos"> 9</span><span class="kt">mesh</span><span class="w"> </span><span class="n">th</span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="o">+</span><span class="n">b</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="o">+</span><span class="n">c</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="o">+</span><span class="nf">d</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="o">+</span><span class="n">i</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">));</span>
<span class="linenos">10</span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th</span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">,</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">]);</span>
</pre></div>
</div>
</section>
</section>
<section id="id7">
<h3>Remeshing<a class="headerlink" href="#id7" title="Link to this heading"></a></h3>
<section id="id8">
<h4>The command <em>trunc</em><a class="headerlink" href="#id8" title="Link to this heading"></a></h4>
<p>This operator allows to define a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code> by truncating another one, i.e. by removing triangles, and/or by splitting each triangle by a given positive integer s.
In a FreeFEM script, this function must be called as follows:</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code> TS2= <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">trunc</span></code> (TS1, boolean function to keep or remove elements, split = s, label = …)</p>
<p>The command has the following arguments:</p>
<ul class="simple">
<li><p>boolean function to keep or remove elements</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">split</span><span class="o">=</span></code> sets the level n of triangle splitting. each triangle is splitted in n × n ( one by default)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span><span class="o">=</span></code>   sets the label number of new boundary item (1 by default)</p></li>
</ul>
<p>An example of how to call the function</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">real</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="linenos"> 2</span><span class="kt">real</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"> </span><span class="c1">//</span>
<span class="linenos"> 3</span><span class="kt">int</span><span class="w"> </span><span class="n">nx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">/</span><span class="n">h</span><span class="p">;</span>
<span class="linenos"> 4</span><span class="kt">int</span><span class="w"> </span><span class="n">ny</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">/</span><span class="n">h</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="kt">func</span><span class="w"> </span><span class="n">torex</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">R</span><span class="o">+</span><span class="n">r</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos"> 6</span><span class="kt">func</span><span class="w"> </span><span class="n">torey</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">R</span><span class="o">+</span><span class="n">r</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos"> 7</span><span class="kt">func</span><span class="w"> </span><span class="n">torez</span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos"> 8</span><span class="c1">// build a tore</span>
<span class="linenos"> 9</span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThS</span><span class="o">=</span><span class="nf">square3</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">,[</span><span class="n">torex</span><span class="p">,</span><span class="n">torey</span><span class="p">,</span><span class="n">torez</span><span class="p">])</span><span class="w"> </span><span class="p">;</span>
<span class="linenos">10</span><span class="n">ThS</span><span class="o">=</span><span class="nf">trunc</span><span class="p">(</span><span class="n">ThS</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kr">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="kr">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="kr">z</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">1.</span><span class="p">),</span><span class="w"> </span><span class="kp">split</span><span class="o">=</span><span class="mi">4</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="id9">
<h4>The command <em>movemesh</em><a class="headerlink" href="#id9" title="Link to this heading"></a></h4>
<p>Like 2d and 3d type meshes in <strong>FreeFEM</strong>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code> can be translated, rotated or deformated by an application [<span class="math notranslate nohighlight">\(\Phi 1\)</span>, <span class="math notranslate nohighlight">\(\Phi 2\)</span>, <span class="math notranslate nohighlight">\(\Phi 3\)</span>].
The image <span class="math notranslate nohighlight">\(T_{h}(\Omega)\)</span> is obtained by the command <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">movemeshS</span></code>.</p>
<p>The parameters of movemeshS are:</p>
<ul>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">transfo</span><span class="o">=</span></code> sets the geometric transformation <span class="math notranslate nohighlight">\(\Phi(x,y)=(\Phi1(x,y,z), \Phi2(x,y,z), \Phi3(x,y,z))\)</span></p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">region</span><span class="o">=</span></code> sets the integer labels of the triangles.</dt><dd><p>0 by default.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span><span class="o">=</span></code> sets the labels of the border edges.</dt><dd><p>This parameter is initialized as the label for the keyword <a class="reference internal" href="#meshgenerationchangelabel"><span class="std std-ref">change</span></a>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">edgemerge</span><span class="o">=</span></code> An integer expression.</dt><dd><p>When you transform a mesh, some triangles can be merged and fix the parameter to 1, else 0
By default, this parameter is equal to 1.</p>
</dd>
</dl>
</li>
<li><dl>
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ptmerge</span><span class="w"> </span><span class="o">=</span></code> A real expression.</dt><dd><p>When you transform a mesh, some points can be merged.
This parameter is the criteria to define two merging points.
By default, we use</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[ptmerge \: = \: 1e-7 \: \:Vol( B ),\]</div>
<p>where <span class="math notranslate nohighlight">\(B\)</span> is the smallest axis parallel boxes containing the discretion domain of <span class="math notranslate nohighlight">\(\Omega\)</span> and <span class="math notranslate nohighlight">\(Vol(B)\)</span> is the volume of this box.</p>
</div></blockquote>
</dd>
</dl>
</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">orientation</span><span class="w"> </span><span class="o">=</span></code> An integer expression</dt><dd><p>equal 1, give the oientation of the triangulation, elements must be in the reference orientation (counter clock wise)
equal -1 reverse the orientation of the triangles. It’s the global orientation of the normals at the surface 1 extern (-1 intern)</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>Example of using</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square3</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span><span class="kr">n</span><span class="p">,[</span><span class="mi">2</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="kp">orientation</span><span class="o">=</span><span class="mi">-1</span><span class="p">);</span>
<span class="linenos">2</span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th2</span><span class="o">=</span><span class="nf">movemeshS</span><span class="p">(</span><span class="n">Th1</span><span class="p">,</span><span class="w"> </span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">,</span><span class="kr">z</span><span class="p">]);</span>
<span class="linenos">3</span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th3</span><span class="o">=</span><span class="nf">movemesh</span><span class="p">(</span><span class="n">Th1</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">,</span><span class="kr">z</span><span class="p">]);</span>
</pre></div>
</div>
</section>
<section id="id10">
<h4>The command <em>change</em><a class="headerlink" href="#id10" title="Link to this heading"></a></h4>
<p>Equivalent for a 2d or 3d mesh, the command <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">change</span></code> changes the label of elements and border elements of a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code>.</p>
<p>The parameters for this command line are:</p>
<ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">reftri</span><span class="o">=</span></code> is a vector of integer that contains successive pairs of the old label number to the new label number for elements.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">refedge</span><span class="o">=</span></code> is a vector of integer that contains successive pairs of the old region number to new region number for boundary elements.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">flabel</span><span class="o">=</span></code> is an integer function given the new value of the label.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">fregion</span><span class="o">=</span></code> is an integer function given the new value of the region.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">rmledges</span><span class="o">=</span></code> is a vector of integer, where edge’s label given are remove of the mesh</p></li>
</ul>
<p>These vectors are composed of <span class="math notranslate nohighlight">\(n_{l}\)</span> successive pairs of numbers <span class="math notranslate nohighlight">\(O,N\)</span> where <span class="math notranslate nohighlight">\(n_{l}\)</span> is the number (label or region) that we want to change.
For example, we have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathtt{label} &amp;= [ O_{1}, N_{1}, ..., O_{n_{l}},N_{n_{l}} ] \\
\mathtt{region} &amp;= [ O_{1}, N_{1}, ..., O_{n_{l}},N_{n_{l}} ]\end{split}\]</div>
</section>
</section>
<section id="link-with-a-mesh3">
<h3>Link with a mesh3<a class="headerlink" href="#link-with-a-mesh3" title="Link to this heading"></a></h3>
<p>In topology and mathematics, the boundary of a subset S of a topological space X is the set of points which can be approached both from S and from the outside of S.
The general definitions to the boundary of a subset S of a topological space X are:</p>
<blockquote>
<div><ul class="simple">
<li><p>the closure of S without the interior of S <span class="math notranslate nohighlight">\(\partial S = S  \backslash \mathring S\)</span>.</p></li>
<li><p>the intersection of the closure of S with the closure of its complement <span class="math notranslate nohighlight">\(\partial S = S  \cap (X  \backslash S)\)</span>.</p></li>
<li><p>the set of points p of X such that every neighborhood of p contains at least one point of S and at least one point not of S.</p></li>
</ul>
</div></blockquote>
<p>More concretely in FreeFEM, the gestion of a 3D mesh is as follows. Let be <span class="math notranslate nohighlight">\(\Omega\)</span> a subset of <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> and <span class="math notranslate nohighlight">\(\partial \Omega\)</span> is boundary, the finite element discretization <span class="math notranslate nohighlight">\(\Omega_h\)</span> of this domain gives:</p>
<blockquote>
<div><ul class="simple">
<li><p>a mesh3 type, denotes Th3, meshing the volume domain. It contains all the nodes, the tetrahedrons   <span class="math notranslate nohighlight">\(\Omega_i\)</span> such as  <span class="math notranslate nohighlight">\(\Omega_h = \cup_i \Omega_i\)</span> and the list of triangles describing the boundary domain</p></li>
<li><p>a meshS type, denotes ThS, meshing the boundary of the volume domain. Typically, containing the nodes belonging to the boundary of Th3 and, if it exists the boundary triangles and the edges.</p></li>
</ul>
</div></blockquote>
<p>Remark: Condition of meshS existence
| In FreeFEM, a meshS can be defined in 2 cases such as:</p>
<blockquote>
<div><ul class="simple">
<li><p>Th3 <span class="math notranslate nohighlight">\(\subset\)</span> ThS where it exactly describes the bounder of Th3.</p></li>
<li><p>a mehS is an explicite surface mesh given by a list of vertices, triangle finite elements and boundary edge elements (can be optional follows the geometry domain)</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Hence, if an input mesh (.msh freefem or .mesh format) contains a list of vertices, tetrahedra, triangles and edges, <strong>FreeFEM</strong> builds a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code> whitch contains explicitly a surface mesh type <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code>.</p>
</div>
<section id="the-command-gamma">
<h4>The command <em>Gamma</em><a class="headerlink" href="#the-command-gamma" title="Link to this heading"></a></h4>
<p>The command <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">Gamma</span></code> allows to build and manipulate the border mesh independly of a volume mesh such as the surface is described by triangle elements and edges border elements in 3d. Use this function, suppose that the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code> object even contains the geometric description of its surface. That means, the input mesh explicitly contains the list of vertices, tetrahedra, triangles and edges. In case where the surface mesh doesn’t exist, before calling <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">Gamma</span></code>, must build it by calling the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">buildSurface</span></code> function (see the next function description).</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos">2</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="kr">n</span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="linenos">3</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">nvb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kr">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="kr">n</span><span class="mi">-1</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="p">;</span><span class="c1">// Nb boundary vertices</span>
<span class="linenos">4</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">ntb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">n</span><span class="o">*</span><span class="kr">n</span><span class="o">*</span><span class="mi">12</span><span class="p">;</span><span class="w"> </span><span class="c1">// Nb of Boundary triangle</span>
<span class="linenos">5</span><span class="w"> </span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th</span><span class="o">=</span><span class="nf">cube</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span><span class="kr">n</span><span class="p">,</span><span class="kr">n</span><span class="p">);</span>
<span class="linenos">6</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildBdMesh</span><span class="p">(</span><span class="n">Th</span><span class="p">);</span><span class="w"> </span><span class="c1">// build the surface mesh</span>
<span class="linenos">7</span><span class="w"> </span><span class="c1">// build Th1, the surface of Th, defined by triangles elements and edges border elements list</span>
<span class="linenos">8</span><span class="w"> </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="nf">Gamma</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="the-command-buildbdmesh">
<h4>The command <em>buildBdMesh</em><a class="headerlink" href="#the-command-buildbdmesh" title="Link to this heading"></a></h4>
<p>Let Th3 a volume mesh (mesh3 type) ; such as the geometry description is a list of vertices, tetrahedra elements and triangle border elements.
<strong>FreeFEM</strong> can generate the surface mesh associated to Th3. The intern mechanism of <strong>FreeFEM</strong> created directly the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code> associated to Th3 and accessible by the command <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th3</span><span class="p">.</span><span class="nf">Gamma</span><span class="p">;</span></code>.</p>
</section>
<section id="the-command-savesurfacemesh">
<h4>The command <em>savesurfacemesh</em><a class="headerlink" href="#the-command-savesurfacemesh" title="Link to this heading"></a></h4>
<p>Available for 3d meshes, the command <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">savesurfacemesh</span></code> saves the entire surface of a 3d volume <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code> at the format .mesh.
Two possibilies about the mesh3 surface:</p>
<blockquote>
<div><ul class="simple">
<li><p>the geometric surface isn’t explicite, that means the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code> doesn’t contain surface elements (triangles) and border surface elements (edge). The surface is defined by the border of the volume. Hence, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">savesurfacemesh</span></code> returns the list of vertices and faces of the volume mesh, according to a local numbring at the border mesh.</p></li>
<li><p>the geometric surface is explicite and known by the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code> type. This may be due to the nature of the data mesh (list of vertices, tetrahedra, triangles, edges) or a surface building by <strong>FreeFEM</strong> with the calling of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">buildSurface</span></code> operator. In this case, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">savesurfacemesh</span></code> allows to save the real geometry of the surface 3d mesh (list of vertices, triangles, edges)</p></li>
</ul>
</div></blockquote>
<p>Example of use</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos">2</span><span class="w"> </span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th3</span><span class="o">=</span><span class="nf">cube</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
<span class="linenos">3</span><span class="w"> </span><span class="nf">savemesh</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;surf.mesh&quot;</span><span class="p">);</span>
<span class="linenos">4</span><span class="w"> </span><span class="n">savesurfacemesh</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;surfreal.mesh&quot;</span><span class="p">);</span>
<span class="linenos">5</span><span class="w"> </span><span class="kt">mesh3</span><span class="w"> </span><span class="n">ThS3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">trunc</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">split</span><span class="o">=</span><span class="mi">3</span><span class="p">);</span>
<span class="linenos">6</span><span class="w"> </span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThSS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ThS3</span><span class="p">.</span><span class="nf">Gamma</span><span class="p">;</span>
<span class="linenos">7</span><span class="w"> </span><span class="n">savesurfacemesh</span><span class="p">(</span><span class="n">ThS3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;surfacesplit.mesh&quot;</span><span class="p">);</span>
<span class="linenos">8</span><span class="w"> </span><span class="nf">savemesh</span><span class="p">(</span><span class="n">ThSS</span><span class="p">,</span><span class="s">&quot;GammaSplit.mesh&quot;</span><span class="w"> </span><span class="p">);</span>
</pre></div>
</div>
<p>volume mesh and meshS=NULL</p>
<p>savesurfmesh(Th,filename_mesh)
write in the file the vertices list and the triangle list (face of the volum mesh) according to a numbering in local surface</p>
<p>savesurfmesh(Th,filename_points,filename_faces)
The operation does the same thing that the first exept to</p>
</section>
<section id="glue-of-meshs-meshes">
<h4>Glue of meshS meshes<a class="headerlink" href="#glue-of-meshs-meshes" title="Link to this heading"></a></h4>
<p>A surface 3d mesh can be the result of the generation of several assembled meshes, with caution of the right orientation at the merged interfaces.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square3</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span><span class="kr">n</span><span class="p">,[</span><span class="mi">2</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="kp">orientation</span><span class="o">=</span><span class="mi">-1</span><span class="p">);</span>
<span class="linenos">2</span><span class="w">     </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square3</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span><span class="kr">n</span><span class="p">,[</span><span class="mi">2</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="kp">orientation</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">3</span><span class="w">     </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square3</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span><span class="kr">n</span><span class="p">,[</span><span class="mi">2</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="kr">y</span><span class="p">],</span><span class="kp">orientation</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">4</span><span class="w">     </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square3</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span><span class="kr">n</span><span class="p">,[</span><span class="mi">2</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="kr">y</span><span class="p">],</span><span class="kp">orientation</span><span class="o">=</span><span class="mi">-1</span><span class="p">);</span>
<span class="linenos">5</span><span class="w">     </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square3</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span><span class="kr">n</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="kr">y</span><span class="p">,</span><span class="kr">x</span><span class="p">]);</span>
<span class="linenos">6</span><span class="w">     </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square3</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span><span class="kr">n</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="kr">y</span><span class="p">,</span><span class="kr">x</span><span class="p">],</span><span class="kp">orientation</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">7</span><span class="w">     </span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th1</span><span class="o">+</span><span class="n">Th2</span><span class="o">+</span><span class="n">Th11</span><span class="o">+</span><span class="n">Th22</span><span class="o">+</span><span class="n">Th5</span><span class="o">+</span><span class="n">Th6</span><span class="p">;</span>
<span class="linenos">8</span><span class="w">     </span><span class="nf">assert</span><span class="p">(</span><span class="n">Th</span><span class="p">.</span><span class="kr">nbnomanifold</span><span class="o">==</span><span class="mi">40</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For the moment, the case of no manifold mesh are not considered in FreeFEM. To check if the meshS contains no manifold elements, the command <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">nbnomanifold</span></code>.</p>
</div>
</section>
</section>
</section>
<section id="the-type-meshl-in-3-dimension">
<span id="meshltype"></span><h2><strong>The type meshL in 3 dimension</strong><a class="headerlink" href="#the-type-meshl-in-3-dimension" title="Link to this heading"></a></h2>
<section id="commands-for-3d-curve-mesh-generation">
<h3>Commands for 3d curve mesh generation<a class="headerlink" href="#commands-for-3d-curve-mesh-generation" title="Link to this heading"></a></h3>
<section id="the-command-segment">
<h4>The command <em>segment</em><a class="headerlink" href="#the-command-segment" title="Link to this heading"></a></h4>
<p>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">segment</span></code> is a basic command to define a curve in 3D space.</p>
<p>The parameters of this command line are:</p>
<blockquote>
<div><ul class="simple">
<li><p>n generates a n subsegments from the unit line</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[.,.,.]</span></code> is  [ <span class="math notranslate nohighlight">\(\Phi 1\)</span>, <span class="math notranslate nohighlight">\(\Phi 2\)</span>, <span class="math notranslate nohighlight">\(\Phi 3\)</span> ] is the geometric transformation from <span class="math notranslate nohighlight">\(\mathbb{R^1}\)</span> to <span class="math notranslate nohighlight">\(\mathbb{R^3}\)</span>. By default, [ <span class="math notranslate nohighlight">\(\Phi 1\)</span>, <span class="math notranslate nohighlight">\(\Phi 2\)</span>, <span class="math notranslate nohighlight">\(\Phi 3\)</span> ] = [x,0,0]</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">orientation</span><span class="o">=</span></code>
equal 1, gives the orientation of the triangulation, elements are in the reference orientation (counter clock wise)
equal -1 reverse the orientation of the triangles
it’s the global orientation of the surface 1 extern (-1 intern)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">cleanmesh</span><span class="o">=</span></code> is a boolean, allowing remove the duplicated nodes</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">removeduplicate</span><span class="o">=</span></code> is a boolean, allowing remove the duplicated elements and border elements</p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">precismesh</span></code> this parameter is the criteria to define two merging points.</dt><dd><p>By default, it value is 1e-7 and define the smallest axis parallel boxes containing the discretion domain of <span class="math notranslate nohighlight">\(\Omega\)</span></p>
</dd>
</dl>
</li>
</ul>
<p>By defaut, the border points are marked by label 1 and 2.</p>
</div></blockquote>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w">     </span><span class="kt">real</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="linenos">2</span><span class="w">     </span><span class="kt">real</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="c1">//</span>
<span class="linenos">3</span><span class="w">     </span><span class="kt">int</span><span class="w"> </span><span class="n">nx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">/</span><span class="n">h</span><span class="p">;</span>
<span class="linenos">4</span><span class="w">     </span><span class="kt">func</span><span class="w"> </span><span class="n">torex</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">R</span><span class="o">+</span><span class="n">r</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos">5</span><span class="w">     </span><span class="kt">func</span><span class="w"> </span><span class="n">torey</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">R</span><span class="o">+</span><span class="n">r</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos">6</span><span class="w">     </span><span class="kt">func</span><span class="w"> </span><span class="n">torez</span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos">7</span><span class="w">     </span><span class="kt">meshL</span><span class="w"> </span><span class="n">Th</span><span class="o">=</span><span class="nf">segment</span><span class="p">(</span><span class="n">nx</span><span class="p">,[</span><span class="n">torex</span><span class="p">,</span><span class="n">torey</span><span class="p">,</span><span class="n">torez</span><span class="p">],</span><span class="kp">removeduplicate</span><span class="o">=</span><span class="kr">true</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
<p>The following code generates a 10 subsegments from the unit line with a clock wise triangulation, according to the geometric transformation [torex,torey,torez] and removing the duplicated points/elements</p>
</section>
<section id="id11">
<h4>The command <em>buildmesh</em><a class="headerlink" href="#id11" title="Link to this heading"></a></h4>
<p>This operator allows to define a curve mesh from multi-borders.
The domain can be defined by a parametrized curve (keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">border</span></code>), such as Th1 in the following example
or piecewise by parametrized curves, such as the construction of the mesh Th2.</p>
<p>The pieces can only intersect at their endpoints, but it is possible to join more than two endpoints.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="c1">// conical helix</span>
<span class="linenos"> 4</span><span class="kt">border</span><span class="w"> </span><span class="n">E1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">10.</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="kp">t</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">y</span><span class="o">=-</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="kp">t</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">z</span><span class="o">=</span><span class="kp">t</span><span class="p">;}</span>
<span class="linenos"> 5</span><span class="kt">meshL</span><span class="w"> </span><span class="n">Th1</span><span class="o">=</span><span class="nf">buildmeshL</span><span class="p">(</span><span class="n">E1</span><span class="p">(</span><span class="mi">1000</span><span class="p">));</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kt">int</span><span class="w"> </span><span class="n">upper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">others</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kr">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="kt">border</span><span class="w"> </span><span class="nf">D01</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">-1</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos"> 9</span><span class="kt">border</span><span class="w"> </span><span class="nf">D02</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">1.5-1.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">-1</span><span class="p">;</span><span class="w"> </span><span class="kr">z</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span><span class="kr">label</span><span class="o">=</span><span class="n">upper</span><span class="p">;}</span>
<span class="linenos">10</span><span class="kt">border</span><span class="w"> </span><span class="nf">D03</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">1.5</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">z</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span><span class="kr">label</span><span class="o">=</span><span class="n">upper</span><span class="p">;}</span>
<span class="linenos">11</span><span class="kt">border</span><span class="w"> </span><span class="nf">D04</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">z</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span><span class="kr">label</span><span class="o">=</span><span class="n">others</span><span class="p">;}</span>
<span class="linenos">12</span><span class="kt">border</span><span class="w"> </span><span class="nf">D05</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">z</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span><span class="kr">label</span><span class="o">=</span><span class="n">others</span><span class="p">;}</span>
<span class="linenos">13</span><span class="kt">border</span><span class="w"> </span><span class="nf">D06</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">z</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span><span class="kr">label</span><span class="o">=</span><span class="n">others</span><span class="p">;}</span>
<span class="linenos">14</span><span class="kt">border</span><span class="w"> </span><span class="nf">D11</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">-0.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">z</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span><span class="kr">label</span><span class="o">=</span><span class="n">inner</span><span class="p">;}</span>
<span class="linenos">15</span><span class="kt">border</span><span class="w"> </span><span class="nf">D12</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">-0.5</span><span class="p">;</span><span class="w"> </span><span class="kr">z</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span><span class="kr">label</span><span class="o">=</span><span class="n">inner</span><span class="p">;}</span>
<span class="linenos">16</span><span class="kt">border</span><span class="w"> </span><span class="nf">D13</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">-0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">z</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span><span class="kr">label</span><span class="o">=</span><span class="n">inner</span><span class="p">;}</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="kt">meshL</span><span class="w"> </span><span class="n">Th2</span><span class="o">=</span><span class="nf">buildmeshL</span><span class="p">(</span><span class="n">D01</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">D02</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">D03</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">D04</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">D05</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span>
<span class="linenos">19</span><span class="w">   </span><span class="o">+</span><span class="w"> </span><span class="n">D06</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">D11</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">D12</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">D13</span><span class="p">(</span><span class="kr">n</span><span class="p">));</span>
</pre></div>
</div>
</section>
</section>
<section id="id12">
<h3>Remeshing<a class="headerlink" href="#id12" title="Link to this heading"></a></h3>
<section id="id13">
<h4>The command <em>trunc</em><a class="headerlink" href="#id13" title="Link to this heading"></a></h4>
<p>This operator allows to define a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshL</span></code> by truncating another one, i.e. by removing segments, and/or by splitting each element by a given positive integer s.
Here, an example to use this function:</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshL</span></code> ThL2= <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">trunc</span></code> (ThL1, boolean function to keep or remove elements, split = s, label = …)</p>
<p>The command has the following arguments:</p>
<ul class="simple">
<li><p>boolean function to keep or remove elements</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">split</span><span class="o">=</span></code> sets the level n of edge splitting, each edge is splitted in n subpart( one by default)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span><span class="o">=</span></code>   sets the label number of new boundary item (1 by default)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">new2old</span></code></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">old2new</span></code></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">renum</span></code></p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">orientation</span><span class="o">=</span></code></dt><dd><p>equal 1, gives the orientation of the triangulation, elements are in the reference orientation (counter clock wise)
equal -1 reverse the orientation of the triangles
it’s the global orientation of the surface 1 extern (-1 intern)</p>
</dd>
</dl>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">cleanmesh</span><span class="o">=</span></code> is a boolean, allowing remove the duplicated nodes</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">removeduplicate</span><span class="o">=</span></code> is a boolean, allowing remove the duplicated elements and border elements</p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">precismesh</span></code> this parameter is the criteria to define two merging points.</dt><dd><p>By default, it value is 1e-7 and define the smallest axis parallel boxes containing the discretion domain of <span class="math notranslate nohighlight">\(\Omega\)</span></p>
</dd>
</dl>
</li>
</ul>
<p>An example of how to call this function</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">int</span><span class="w"> </span><span class="n">nx</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>
<span class="linenos">2</span><span class="kt">meshL</span><span class="w"> </span><span class="n">Th</span><span class="o">=</span><span class="nf">segment</span><span class="p">(</span><span class="n">nx</span><span class="p">,[</span><span class="mf">5.</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="nf">cos</span><span class="p">(</span><span class="kr">pi</span><span class="o">*</span><span class="kr">x</span><span class="p">),</span><span class="nf">sin</span><span class="p">(</span><span class="kr">pi</span><span class="o">*</span><span class="kr">x</span><span class="p">)]);</span>
<span class="linenos">3</span><span class="n">Th</span><span class="o">=</span><span class="nf">trunc</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kr">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="kr">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="kr">z</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">1.</span><span class="p">),</span><span class="w"> </span><span class="kp">split</span><span class="o">=</span><span class="mi">4</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="id14">
<h4>The command <em>movemesh</em><a class="headerlink" href="#id14" title="Link to this heading"></a></h4>
<p>This is the classical mesh transformation <strong>FreeFEM</strong> function, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshL</span></code> can be deformed by an application [ <span class="math notranslate nohighlight">\(\Phi 1\)</span>, <span class="math notranslate nohighlight">\(\Phi 2\)</span>, <span class="math notranslate nohighlight">\(\Phi 3\)</span> ].
The image <span class="math notranslate nohighlight">\(T_{h}(\Omega)\)</span> is obtained by the command <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">movemeshL</span></code>.</p>
<p>The parameters of movemesh are:</p>
<ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">transfo</span><span class="o">=</span></code> sets the geometric transformation <span class="math notranslate nohighlight">\(\Phi(x,y)=(\Phi1(x,y,z), \Phi2(x,y,z), \Phi3(x,y,z))\)</span></p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">refedge</span><span class="o">=</span></code> sets the integer labels of the triangles.</dt><dd><p>0 by default.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">refpoint</span><span class="o">=</span></code> sets the labels of the border points.</dt><dd><p>This parameter is initialized as the label for the keyword <a class="reference internal" href="#meshgenerationchangelabel"><span class="std std-ref">change</span></a>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">precismesh</span></code> this parameter is the criteria to define two merging points.</dt><dd><p>By default, it value is 1e-7 and define the smallest axis parallel boxes containing the discretion domain of <span class="math notranslate nohighlight">\(\Omega\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">orientation</span><span class="w"> </span><span class="o">=</span></code> An integer expression</dt><dd><p>equal 1, give the oientation of the triangulation, elements must be in the reference orientation (counter clock wise)
equal -1 reverse the orientation of the triangles. It’s the global orientation of the normals at the surface 1 extern (-1 intern)</p>
</dd>
</dl>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">cleanmesh</span><span class="o">=</span></code> is a boolean, allowing remove the duplicated nodes</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">removeduplicate</span><span class="o">=</span></code> is a boolean, allowing remove the duplicated elements and border elements</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The definition of the geometric transformation depends on the space dimension of the studied problem. It means that, with curve FEM, it’s possible to treat a real 1D problem (space coordinate is x) then the transformation is given by x: -&gt;F(x), that means [F_x] and F_y=F_z=0 in FreeFEM function.</p>
</div>
<p>Example of using</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">int</span><span class="w"> </span><span class="n">nx</span><span class="o">=</span><span class="mi">100</span><span class="p">;</span>
<span class="linenos">2</span><span class="kt">meshL</span><span class="w"> </span><span class="n">Th</span><span class="o">=</span><span class="n">Sline</span><span class="p">(</span><span class="n">nx</span><span class="p">);</span>
<span class="linenos">3</span><span class="kt">meshL</span><span class="w"> </span><span class="n">Th31</span><span class="o">=</span><span class="nf">movemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kr">x</span><span class="p">]);</span>
<span class="linenos">4</span><span class="kt">meshL</span><span class="w"> </span><span class="n">Th32</span><span class="o">=</span><span class="nf">movemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kr">x</span><span class="p">,</span><span class="o">-</span><span class="kr">x</span><span class="o">*</span><span class="p">(</span><span class="kr">x</span><span class="mi">-1</span><span class="p">)]);</span>
<span class="linenos">5</span><span class="kt">meshL</span><span class="w"> </span><span class="n">Th3</span><span class="o">=</span><span class="n">Th31</span><span class="o">+</span><span class="n">Th32</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="id15">
<h4>The command <em>change</em><a class="headerlink" href="#id15" title="Link to this heading"></a></h4>
<p>The command <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">change</span></code> changes the label of elements and border elements of a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshL</span></code>.</p>
<p>The parameters for this command line are:</p>
<ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">refedge</span><span class="o">=</span></code> is a vector of integer that contains successive pairs of the old label number to the new label number for elements.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">refpoint</span><span class="o">=</span></code> is a vector of integer that contains successive pairs of the old region number to new region number for boundary elements.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">flabel</span><span class="o">=</span></code> is an integer function given the new value of the label.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">fregion</span><span class="o">=</span></code> is an integer function given the new value of the region.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">rmlpoint</span><span class="o">=</span></code> is a vector of integer, where edge’s label given are remove of the mesh</p></li>
</ul>
<p>These vectors are composed of <span class="math notranslate nohighlight">\(n_{l}\)</span> successive pairs of numbers <span class="math notranslate nohighlight">\(O,N\)</span> where <span class="math notranslate nohighlight">\(n_{l}\)</span> is the number (label or region) that we want to change.
For example, we have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathtt{label} &amp;= [ O_{1}, N_{1}, ..., O_{n_{l}},N_{n_{l}} ] \\
\mathtt{region} &amp;= [ O_{1}, N_{1}, ..., O_{n_{l}},N_{n_{l}} ]\end{split}\]</div>
</section>
<section id="the-commands-buildbdmesh-and-gamma">
<h4>The commands <em>buildBdMesh</em> and <em>Gamma</em><a class="headerlink" href="#the-commands-buildbdmesh-and-gamma" title="Link to this heading"></a></h4>
<p>The command <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">Gamma</span></code> allows to extract the border mesh independly of a surface mesh.
With this function, the constructed border mesh contains the full geometric description of th eboundary surface. In case where the border mesh doesn’t exist, before calling <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">Gamma</span></code>, must build it by calling the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">buildBdMesh</span></code> function (see the next function description).</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos">2</span><span class="kt">int</span><span class="w"> </span><span class="kr">n</span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="linenos">3</span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th</span><span class="o">=</span><span class="nf">square3</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span><span class="kr">n</span><span class="p">);</span>
<span class="linenos">4</span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildBdMesh</span><span class="p">(</span><span class="n">Th</span><span class="p">);</span><span class="w"> </span><span class="c1">// build the border mesh</span>
<span class="linenos">5</span><span class="c1">// build Th1, the border of Th, defined by edges elements and point border elements</span>
<span class="linenos">6</span><span class="kt">meshL</span><span class="w"> </span><span class="n">Th1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="nf">Gamma</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="glue-of-meshl-meshes">
<h4>Glue of meshL meshes<a class="headerlink" href="#glue-of-meshl-meshes" title="Link to this heading"></a></h4>
<p>An assembling of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshL</span></code> is possible thanks to the operator <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="o">+</span></code>. The result returns a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshL</span></code>, with caution of the right orientation at the merged interfaces. Here, the function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">checkmesh</span></code> can be called.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="kr">n</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>
<span class="linenos">2</span><span class="w"> </span><span class="kt">meshL</span><span class="w"> </span><span class="n">Th1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">segment</span><span class="p">(</span><span class="kr">n</span><span class="p">);</span>
<span class="linenos">3</span><span class="w"> </span><span class="kt">meshL</span><span class="w"> </span><span class="n">Th2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">segment</span><span class="p">(</span><span class="kr">n</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="kr">x</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="kp">orientation</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">4</span><span class="w"> </span><span class="kt">meshL</span><span class="w"> </span><span class="n">Th3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">segment</span><span class="p">(</span><span class="kr">n</span><span class="p">,[</span><span class="kr">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="kp">orientation</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">5</span><span class="w"> </span><span class="kt">meshL</span><span class="w"> </span><span class="n">Th4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">segment</span><span class="p">(</span><span class="kr">n</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="kr">x</span><span class="p">],</span><span class="kp">orientation</span><span class="o">=</span><span class="mi">-1</span><span class="p">);</span>
<span class="linenos">6</span>
<span class="linenos">7</span><span class="w"> </span><span class="kt">meshL</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Th1</span><span class="o">+</span><span class="n">Th2</span><span class="o">+</span><span class="n">Th3</span><span class="o">+</span><span class="n">Th4</span><span class="p">;</span>
<span class="linenos">8</span><span class="w"> </span><span class="n">Th</span><span class="o">=</span><span class="n">rebuildBorder</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">ridgeangledetection</span><span class="o">=</span><span class="kr">pi</span><span class="o">/</span><span class="mf">2.</span><span class="o">+</span><span class="mf">0.0001</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For the moment, the case of no manifold mesh are not considered in FreeFEM. To check if the meshL contains no manifold elements, the command <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">nbnomanifold</span></code>.</p>
</div>
</section>
<section id="id16">
<h4>The command extract<a class="headerlink" href="#id16" title="Link to this heading"></a></h4>
<p>This operator allows to extract a labeled piece or the entire border of a 2D mesh and project it in 3D. Optionally, a geometic transformation can be applied.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w">     </span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="o">=</span><span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
<span class="linenos">2</span><span class="w">     </span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">ll</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="linenos">3</span><span class="w">     </span><span class="kt">meshL</span><span class="w"> </span><span class="n">ThL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">extract</span><span class="p">(</span><span class="n">Th</span><span class="p">,[</span><span class="kr">x</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="kr">y</span><span class="o">*</span><span class="mi">5</span><span class="p">],</span><span class="n">refedge</span><span class="o">=</span><span class="n">ll</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="the-commands-rebuildborder">
<h4>The commands <em>rebuildBorder</em><a class="headerlink" href="#the-commands-rebuildborder" title="Link to this heading"></a></h4>
<p>This operator, used in the last example, allows to reconstruted the border elements following a special criteria <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ridgeangledetection</span></code>. By default, it value is <span class="math notranslate nohighlight">\(\frac{8}{9}*arctan(1)\approx40°\)</span>, the diedral angle for a decahedron.</p>
</section>
</section>
<section id="the-commands-checkmesh">
<h3>The commands <em>checkmesh</em><a class="headerlink" href="#the-commands-checkmesh" title="Link to this heading"></a></h3>
<p>This function is avalaible for all 3D meshes. It checkes and validates the a given mesh, allows to remove duplicate vertices and/or elements and border elements. The possible arguments are</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">precismesh</span><span class="o">=</span></code> this parameter is the criteria to define two merging points.</dt><dd><p>By default, it value is 1e-7 and define the smallest axis parallel boxes containing the discretion domain of <span class="math notranslate nohighlight">\(\Omega\)</span></p>
</dd>
</dl>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">removeduplicate</span><span class="o">=</span></code> is a boolean, allowing remove the duplicated elements and border elements</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">rebuildboundary</span><span class="o">=</span></code> is a boolean, allowing rebuild the border elements (in case of incomplete list given by the mesh)</p></li>
</ul>
<p>Example:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">checkmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="tetgen-a-tetrahedral-mesh-generator">
<h3>TetGen: A tetrahedral mesh generator<a class="headerlink" href="#tetgen-a-tetrahedral-mesh-generator" title="Link to this heading"></a></h3>
<p>TetGen is a software developed by Dr. Hang Si of Weierstrass Institute for Applied Analysis and Stochastics in Berlin, Germany <a class="reference internal" href="../bibliography.html#hang2006" id="id17"><span>[HANG2006]</span></a>.
TetGen is free for research and non-commercial use.
For any commercial license utilization, a commercial license is available upon request to Hang Si.</p>
<p>This software is a tetrahedral mesh generator of a three dimensional domain defined by its boundary (a surface).
The input domain takes into account a polyhedral or a piecewise linear complex.
This tetrahedralization is a constrained Delaunay tetrahedralization.</p>
<p>The method used in TetGen to control the quality of the mesh is a Delaunay refinement due to Shewchuk <a class="reference internal" href="../bibliography.html#shewchuk1998" id="id18"><span>[SHEWCHUK1998]</span></a>.
The quality measure of this algorithm is the Radius-Edge Ratio (see Section 1.3.1 <a class="reference internal" href="../bibliography.html#hang2006" id="id19"><span>[HANG2006]</span></a> for more details).
A theoretical bound of this ratio of the Shewchuk algorithm is obtained for a given complex of vertices, constrained segments and facets of surface mesh, with no input angle less than 90 degrees.
This theoretical bound is 2.0.</p>
<p>The launch of TetGen is done with the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">tetg</span></code>.
The parameters of this command line is:</p>
<ul>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">reftet</span><span class="o">=</span></code> sets the label of tetrahedra.</p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span><span class="o">=</span></code> is a vector of integers that contains the old labels number at index <span class="math notranslate nohighlight">\(2i\)</span> and the new labels number at index <span class="math notranslate nohighlight">\(2i+1\)</span> of Triangles.</dt><dd><p>This parameter is initialized as a label for the keyword <a class="reference internal" href="#meshgenerationchangelabel"><span class="std std-ref">change</span></a>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">switch</span><span class="o">=</span></code> A string expression.</dt><dd><p>This string corresponds to the command line switch of TetGen see Section 3.2 of <a class="reference internal" href="../bibliography.html#hang2006" id="id20"><span>[HANG2006]</span></a>.</p>
</dd>
</dl>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbofholes</span><span class="o">=</span></code> Number of holes (default value: “size of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">holelist</span></code> / 3”).</p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">holelist</span><span class="o">=</span></code> This array corresponds to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">holelist</span></code> of TetGenio data structure <a class="reference internal" href="../bibliography.html#hang2006" id="id21"><span>[HANG2006]</span></a>.</dt><dd><p>A real vector of size <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kp">nbofholes</span></code>.
In TetGen, each hole is associated with a point inside this domain.
This vector is <span class="math notranslate nohighlight">\(x_{1}^{h}, y_{1}^{h}, z_{1}^{h}, x_{2}^{h}, y_{2}^{h}, z_{2}^{h}, \cdots,\)</span> where <span class="math notranslate nohighlight">\(x_{i}^{h},y_{i}^{h},z_{i}^{h}\)</span> is the associated point with the <span class="math notranslate nohighlight">\(i^{\mathrm{th}}\)</span> hole.</p>
</dd>
</dl>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbofregions</span><span class="o">=</span></code> Number of regions (default value: “size of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code> / 5”).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span><span class="o">=</span></code> This array corresponds to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code> of TetGenio data structure <a class="reference internal" href="../bibliography.html#hang2006" id="id22"><span>[HANG2006]</span></a>.</p>
<p>The attribute and the volume constraint of region are given in this real vector of size <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kp">nbofregions</span></code>.
The <span class="math notranslate nohighlight">\(i^{\mathrm{th}}\)</span> region is described by five elements: <span class="math notranslate nohighlight">\(x-\)</span>coordinate, <span class="math notranslate nohighlight">\(y-\)</span>coordinate and <span class="math notranslate nohighlight">\(z-\)</span>coordinate of a point inside this domain (<span class="math notranslate nohighlight">\(x_{i},y_{i},z_{i}\)</span>); the attribute (<span class="math notranslate nohighlight">\(at_{i}\)</span>) and the maximum volume for tetrahedra (<span class="math notranslate nohighlight">\(mvol_{i}\)</span>) for this region.</p>
<p>The <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code> vector is: <span class="math notranslate nohighlight">\(x_{1}, y_{1}, z_{1}, at_{1}, mvol_{1}, x_{2}, y_{2}, z_{2}, at_{2}, mvol_{2}, \cdots\)</span>.</p>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nboffacetcl</span><span class="o">=</span></code> Number of facets constraints “size of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">facetcl</span></code> / 2”).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">facetcl</span><span class="o">=</span></code> This array corresponds to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">facetconstraintlist</span></code> of TetGenio data structure <a class="reference internal" href="../bibliography.html#hang2006" id="id23"><span>[HANG2006]</span></a>.</p>
<p>The <span class="math notranslate nohighlight">\(i^{th}\)</span> facet constraint is defined by the facet marker <span class="math notranslate nohighlight">\(Ref_{i}^{fc}\)</span> and the maximum area for faces <span class="math notranslate nohighlight">\(marea_{i}^{fc}\)</span>.
The <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">facetcl</span></code> array is: <span class="math notranslate nohighlight">\(Ref_{1}^{fc}, marea_{1}^{fc}, Ref_{2}^{fc}, marea_{2}^{fc}, \cdots\)</span>.</p>
<p>This parameters has no effect if switch <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">q</span></code> is not selected.</p>
</li>
</ul>
<p>Principal switch parameters in TetGen:</p>
<ul>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">p</span></code> Tetrahedralization of boundary.</p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">q</span></code> Quality mesh generation.</dt><dd><p>The bound of Radius-Edge Ratio will be given after the option <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">q</span></code>.
By default, this value is 2.0.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">a</span></code> Constructs with the volume constraints on tetrahedra.</dt><dd><p>These volumes constraints are defined with the bound of the previous switch <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">q</span></code> or in the parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">A</span></code> Attributes reference to region given in the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code>.</dt><dd><p>The other regions have label 0.</p>
</dd>
</dl>
<p>The option <code class="docutils literal highlight highlight-python"><span></span><span class="n">AA</span></code> gives a different label at each region.
This switch works with the option <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">p</span></code>.
If option <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">r</span></code> is used, this switch has no effect.</p>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">r</span></code> Reconstructs and Refines a previously generated mesh.</dt><dd><p>This character is only used with the command line <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">tetgreconstruction</span></code>.</p>
</dd>
</dl>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Y</span></code> This switch preserves the mesh on the exterior boundary.</p>
<p>This switch must be used to ensure a conformal mesh between two adjacent meshes.</p>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">YY</span></code> This switch preserves the mesh on the exterior and interior boundary.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">C</span></code> The consistency of the result’s mesh is testing by TetGen.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">CC</span></code> The consistency of the result’s mesh is testing by TetGen and also constrained checks of Delaunay mesh (if <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">p</span></code> switch is selected) or the consistency of Conformal Delaunay (if <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">q</span></code> switch is selected).</p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">V</span></code> Give information of the work of TetGen.</dt><dd><p>More information can be obtained in specified <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">VV</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">VVV</span></code>.</p>
</dd>
</dl>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Q</span></code> Quiet: No terminal output except errors</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">M</span></code> The coplanar facets are not merging.</p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">T</span></code> Sets a tolerance for coplanar test.</dt><dd><p>The default value is <span class="math notranslate nohighlight">\(1e-8\)</span>.</p>
</dd>
</dl>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">d</span></code> Intersections of facets are detected.</p></li>
</ul>
<p>To obtain a tetrahedral mesh with TetGen, we need the surface mesh of a three dimensional domain.
We now give the command line in <strong>FreeFEM</strong> to construct these meshes.</p>
<p><strong>The keyword tetgtransfo</strong></p>
<p>This keyword corresponds to a composition of command line <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">tetg</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">movemesh23</span></code>.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nf">tetgtransfo</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span><span class="w"> </span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">Phi</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">Phi</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">Phi</span><span class="p">(</span><span class="mi">3</span><span class="p">)]),</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">tetg</span><span class="p">(</span><span class="n">Th3surf</span><span class="p">,</span><span class="w"> </span><span class="p">...),</span>
</pre></div>
</div>
<p>where <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th3surf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span><span class="w"> </span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">Phi</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">Phi</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">Phi</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th2</span></code> is the input two dimensional mesh of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">tetgtransfo</span></code>.</p>
<p>The parameters of this command line are, on one hand, the parameters <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">switch</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nboffacetcl</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">facetcl</span></code> of keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">tetg</span></code> and on the other hand, the parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ptmerge</span></code> of keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">movemesh23</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To use <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">tetgtransfo</span></code>, the result’s mesh of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">movemesh23</span></code> must be a closed surface and define one region only. Therefore, the parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code> is defined for one region.</p>
<p>An example of this keyword can be found in line 61 of the <a class="reference internal" href="../examples/mesh-generation.html#examplebuildlayermesh"><span class="std std-ref">Build layer mesh example</span></a>.</p>
</div>
<p><strong>The keyword tetgconvexhull</strong></p>
<p><strong>FreeFEM</strong>, using TetGen, is able to build a tetrahedralization from a set of points.
This tetrahedralization is a Delaunay mesh of the convex hull of the set of points.</p>
<p>The coordinates of the points can be initialized in two ways.
The first is a file that contains the coordinate of points <span class="math notranslate nohighlight">\(X_{i}=(x_{i}, y_{i}, z_{i})\)</span>.
This file is organized as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ccc}
n_{v} &amp; &amp; \\
x_{1} &amp; y_{1} &amp; z_{1} \\
x_{2} &amp; y_{2} &amp; z_{2} \\
\vdots &amp;\vdots &amp; \vdots \\
x_{n_v} &amp; y_{n_v} &amp; z_{n_v}
\end{array}\end{split}\]</div>
<p>The second way is to give three arrays that correspond respectively to the <span class="math notranslate nohighlight">\(x-\)</span>coordinates, <span class="math notranslate nohighlight">\(y-\)</span>coordinates and <span class="math notranslate nohighlight">\(z-\)</span>coordinates.</p>
<p>The parameters of this command line are :</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">switch</span><span class="o">=</span></code> A string expression.</dt><dd><p>This string corresponds to the command line <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">switch</span></code> of TetGen see Section 3.2 of <a class="reference internal" href="../bibliography.html#hang2006" id="id24"><span>[HANG2006]</span></a>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">reftet</span><span class="o">=</span></code> An integer expression.</dt><dd><p>Set the label of tetrahedra.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span><span class="o">=</span></code> An integer expression.</dt><dd><p>Set the label of triangles.</p>
</dd>
</dl>
</li>
</ul>
<p>In the string <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">switch</span></code>, we can’t used the option <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">p</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">q</span></code> of TetGen.</p>
</section>
<section id="reconstruct-refine-a-3d-mesh-with-tetgen">
<h3>Reconstruct/Refine a 3d mesh with TetGen<a class="headerlink" href="#reconstruct-refine-a-3d-mesh-with-tetgen" title="Link to this heading"></a></h3>
<p>Meshes in three dimension can be refined using TetGen with the command line <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">tetgreconstruction</span></code>.</p>
<p>The parameter of this keyword are</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">region</span><span class="o">=</span></code> an integer array that changes the region number of tetrahedra.</dt><dd><p>This array is defined as the parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">reftet</span></code> in the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">change</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span><span class="o">=</span></code> an integer array that changes the label of boundary triangles.</dt><dd><p>This array is defined as the parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span></code> in the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">change</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">sizeofvolume</span><span class="o">=</span></code> a reel function.</dt><dd><p>This function constraints the volume size of the tetrahedra in the domain (see <a class="reference internal" href="#meshfirstisotropemeshadaptation"><span class="std std-ref">Isotrope mesh adaption section</span></a> to build a 3d adapted mesh).</p>
</dd>
</dl>
</li>
</ul>
<p>The parameters <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">switch</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbofregions</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nboffacetcl</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">facetcl</span></code> of the command line which call TetGen (<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">tetg</span></code>) is used for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">tetgrefine</span></code>.</p>
<p>In the parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">switch</span><span class="o">=</span></code>, the character <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">r</span></code> should be used without the character <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">p</span></code>.</p>
<p>For instance, see the manual of TetGen <a class="reference internal" href="../bibliography.html#hang2006" id="id25"><span>[HANG2006]</span></a> for effect of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">r</span></code> to other character.</p>
<p>The parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code> defines a new volume constraint in the region.
The label in the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code> will be the previous label of region.</p>
<p>This parameter and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbofregions</span></code> can’t be used with the parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">sizeofvolume</span></code>.</p>
<p><a class="reference external" href="https://github.com/FreeFem/FreeFem-sources/blob/develop/examples/3d/refinesphere.edp">**Example refinesphere.edp**</a></p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos"> 2</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;tetgen&quot;</span>
<span class="linenos"> 3</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="o">=</span><span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,[</span><span class="kr">x</span><span class="o">*</span><span class="kr">pi</span><span class="o">-</span><span class="kr">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="kr">y</span><span class="o">*</span><span class="kr">pi</span><span class="p">]);</span><span class="w">  </span><span class="c1">//  $]\frac{-pi}{2},frac{-pi}{2}[\times]0,2\pi[ $</span>
<span class="linenos"> 6</span><span class="c1">//  a parametrization of a sphere</span>
<span class="linenos"> 7</span><span class="kt">func</span><span class="w"> </span><span class="n">f1</span><span class="w"> </span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos"> 8</span><span class="kt">func</span><span class="w"> </span><span class="n">f2</span><span class="w"> </span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos"> 9</span><span class="kt">func</span><span class="w"> </span><span class="n">f3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">);</span>
<span class="linenos">10</span><span class="c1">//  partiel derivative of the parametrization DF</span>
<span class="linenos">11</span><span class="kt">func</span><span class="w"> </span><span class="n">f1x</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">12</span><span class="kt">func</span><span class="w"> </span><span class="n">f1y</span><span class="o">=-</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">13</span><span class="kt">func</span><span class="w"> </span><span class="n">f2x</span><span class="o">=-</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">14</span><span class="kt">func</span><span class="w"> </span><span class="n">f2y</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">15</span><span class="kt">func</span><span class="w"> </span><span class="n">f3x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">);</span>
<span class="linenos">16</span><span class="kt">func</span><span class="w"> </span><span class="n">f3y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">17</span><span class="c1">// $  M = DF^t DF $</span>
<span class="linenos">18</span><span class="kt">func</span><span class="w"> </span><span class="n">m11</span><span class="o">=</span><span class="n">f1x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">f2x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">f3x</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
<span class="linenos">19</span><span class="kt">func</span><span class="w"> </span><span class="n">m21</span><span class="o">=</span><span class="n">f1x</span><span class="o">*</span><span class="n">f1y</span><span class="o">+</span><span class="n">f2x</span><span class="o">*</span><span class="n">f2y</span><span class="o">+</span><span class="n">f3x</span><span class="o">*</span><span class="n">f3y</span><span class="p">;</span>
<span class="linenos">20</span><span class="kt">func</span><span class="w"> </span><span class="n">m22</span><span class="o">=</span><span class="n">f1y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">f2y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">f3y</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="kt">func</span><span class="w"> </span><span class="n">perio</span><span class="o">=</span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span><span class="kr">y</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="kr">y</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="kr">x</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="kr">x</span><span class="p">]];</span>
<span class="linenos">23</span><span class="kt">real</span><span class="w"> </span><span class="n">hh</span><span class="o">=</span><span class="mf">0.1</span><span class="p">;</span>
<span class="linenos">24</span><span class="kt">real</span><span class="w"> </span><span class="n">vv</span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="nf">square</span><span class="p">(</span><span class="n">hh</span><span class="p">);</span>
<span class="linenos">25</span><span class="kr">verbosity</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
<span class="linenos">26</span><span class="n">Th</span><span class="o">=</span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">m11</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="n">m21</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="n">m22</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kp">periodic</span><span class="o">=</span><span class="n">perio</span><span class="p">);</span>
<span class="linenos">27</span><span class="n">Th</span><span class="o">=</span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">m11</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="n">m21</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="n">m22</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span><span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kp">periodic</span><span class="o">=</span><span class="n">perio</span><span class="p">);</span>
<span class="linenos">28</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">29</span>
<span class="linenos">30</span><span class="kr">verbosity</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
<span class="linenos">31</span>
<span class="linenos">32</span><span class="c1">// construction of the surface of spheres</span>
<span class="linenos">33</span><span class="kt">real</span><span class="w"> </span><span class="n">Rmin</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span>
<span class="linenos">34</span><span class="kt">func</span><span class="w"> </span><span class="n">f1min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rmin</span><span class="o">*</span><span class="n">f1</span><span class="p">;</span>
<span class="linenos">35</span><span class="kt">func</span><span class="w"> </span><span class="n">f2min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rmin</span><span class="o">*</span><span class="n">f2</span><span class="p">;</span>
<span class="linenos">36</span><span class="kt">func</span><span class="w"> </span><span class="n">f3min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rmin</span><span class="o">*</span><span class="n">f3</span><span class="p">;</span>
<span class="linenos">37</span>
<span class="linenos">38</span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThS</span><span class="o">=</span><span class="nf">movemesh23</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">f1min</span><span class="p">,</span><span class="n">f2min</span><span class="p">,</span><span class="n">f3min</span><span class="p">]);</span>
<span class="linenos">39</span>
<span class="linenos">40</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mi">145</span><span class="p">,</span><span class="mf">0.01</span><span class="p">];</span>
<span class="linenos">41</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th3sph</span><span class="o">=</span><span class="nf">tetg</span><span class="p">(</span><span class="n">ThS</span><span class="p">,</span><span class="kp">switch</span><span class="o">=</span><span class="s">&quot;paAAQYY&quot;</span><span class="p">,</span><span class="kp">nbofregions</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kp">regionlist</span><span class="o">=</span><span class="n">domain</span><span class="p">);</span>
<span class="linenos">42</span>
<span class="linenos">43</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">newlabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">145</span><span class="p">,</span><span class="mi">18</span><span class="p">];</span>
<span class="linenos">44</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">domainrefine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mi">145</span><span class="p">,</span><span class="mf">0.0001</span><span class="p">];</span>
<span class="linenos">45</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th3sphrefine</span><span class="o">=</span><span class="nf">tetgreconstruction</span><span class="p">(</span><span class="n">Th3sph</span><span class="p">,</span><span class="kp">switch</span><span class="o">=</span><span class="s">&quot;raAQ&quot;</span><span class="p">,</span><span class="kr">region</span><span class="o">=</span><span class="n">newlabel</span><span class="p">,</span><span class="kp">nbofregions</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kp">regionlist</span><span class="o">=</span><span class="n">domainrefine</span><span class="p">,</span><span class="kp">sizeofvolume</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">);</span>
<span class="linenos">46</span>
<span class="linenos">47</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">newlabel2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">145</span><span class="p">,</span><span class="mi">53</span><span class="p">];</span>
<span class="linenos">48</span><span class="kt">func</span><span class="w"> </span><span class="n">fsize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="o">/</span><span class="p">((</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="o">*</span><span class="nf">sqrt</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="kr">x</span><span class="mf">-0.5</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="kr">y</span><span class="mf">-0.5</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="kr">z</span><span class="mf">-0.5</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="p">);</span>
<span class="linenos">49</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th3sphrefine2</span><span class="o">=</span><span class="nf">tetgreconstruction</span><span class="p">(</span><span class="n">Th3sph</span><span class="p">,</span><span class="kp">switch</span><span class="o">=</span><span class="s">&quot;raAQ&quot;</span><span class="p">,</span><span class="kr">region</span><span class="o">=</span><span class="n">newlabel2</span><span class="p">,</span><span class="kp">sizeofvolume</span><span class="o">=</span><span class="n">fsize</span><span class="p">);</span>
<span class="linenos">50</span>
<span class="linenos">51</span><span class="w"> </span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;sphere&quot;</span><span class="p">,</span><span class="n">Th3sph</span><span class="p">,</span><span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">52</span><span class="w"> </span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;sphererefinedomain&quot;</span><span class="p">,</span><span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Th3sphrefine</span><span class="p">);</span>
<span class="linenos">53</span><span class="w"> </span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;sphererefinelocal&quot;</span><span class="p">,</span><span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Th3sphrefine2</span><span class="p">);</span>
<span class="linenos">54</span>
<span class="linenos">55</span><span class="c1">// FFCS: testing 3d plots</span>
<span class="linenos">56</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th3sph</span><span class="p">);</span>
<span class="linenos">57</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th3sphrefine</span><span class="p">);</span>
<span class="linenos">58</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th3sphrefine2</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
<section id="read-write-statements-for-meshes">
<span id="meshdatastructurereadwrite"></span><h2>Read/Write Statements for meshes<a class="headerlink" href="#read-write-statements-for-meshes" title="Link to this heading"></a></h2>
<section id="d-case">
<h3>2d case<a class="headerlink" href="#d-case" title="Link to this heading"></a></h3>
<section id="format-of-mesh-data">
<h4>format of  mesh data<a class="headerlink" href="#format-of-mesh-data" title="Link to this heading"></a></h4>
<p>Users who want to read a triangulation made elsewhere should see the structure of the file generated below:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">border</span><span class="w"> </span><span class="nf">C</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);}</span>
<span class="linenos">2</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span>
<span class="linenos">3</span><span class="nf">savemesh</span><span class="p">(</span><span class="n">Th1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;mesh.msh&quot;</span><span class="p">);</span>
<span class="linenos">4</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th2</span><span class="o">=</span><span class="nf">readmesh</span><span class="p">(</span><span class="s">&quot;mesh.msh&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>The mesh is shown on <a class="reference internal" href="#figbuildmesh"><span class="std std-numref">Fig. 95</span></a>.</p>
<p>The information about <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code> are saved in the file <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh</span><span class="p">.</span><span class="n">msh</span></code> whose structure is shown on <a class="reference internal" href="#tabmeshstructure"><span class="std std-numref">Table 1</span></a>.
An external file contains a mesh at format .mesh can be read by the ommand <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">readmesh</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span></code>.</p>
<p>There, <span class="math notranslate nohighlight">\(n_v\)</span> denotes the number of vertices, <span class="math notranslate nohighlight">\(n_t\)</span> the number of triangles and <span class="math notranslate nohighlight">\(n_s\)</span> the number of edges on boundary.</p>
<p>For each vertex <span class="math notranslate nohighlight">\(q^i,\, i=1,\cdots,n_v\)</span>, denoted by <span class="math notranslate nohighlight">\((q^i_x,q^i_y)\)</span> the <span class="math notranslate nohighlight">\(x\)</span>-coordinate and <span class="math notranslate nohighlight">\(y\)</span>-coordinate.</p>
<p>Each triangle <span class="math notranslate nohighlight">\(T_k, k=1,\cdots,n_t\)</span> has three vertices <span class="math notranslate nohighlight">\(q^{k_1},\, q^{k_2},\,q^{k_3}\)</span> that are oriented counter-clockwise.</p>
<p>The boundary consists of 10 lines <span class="math notranslate nohighlight">\(L_i,\, i=1,\cdots,10\)</span> whose end points are <span class="math notranslate nohighlight">\(q^{i_1},\, q^{i_2}\)</span>.</p>
<figure class="align-default" id="figbuildmesh">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Data.png"><img alt="../_images/MeshGeneration_Data.png" src="../_images/MeshGeneration_Data.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 95 </span><span class="caption-text">Mesh by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span></code></span><a class="headerlink" href="#figbuildmesh" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>In the <a class="reference internal" href="#figbuildmesh"><span class="std std-numref">Fig. 95</span></a>, we have the following.</p>
<p><span class="math notranslate nohighlight">\(n_v=14, n_t=16, n_s=10\)</span></p>
<p><span class="math notranslate nohighlight">\(q^1=(-0.309016994375, 0.951056516295)\)</span></p>
<p><span class="math notranslate nohighlight">\(\dots\)</span></p>
<p><span class="math notranslate nohighlight">\(q^{14}=(-0.309016994375, -0.951056516295)\)</span></p>
<p>The vertices of <span class="math notranslate nohighlight">\(T_1\)</span> are <span class="math notranslate nohighlight">\(q^9, q^{12},\, q^{10}\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\dots\)</span></p>
<p>The vertices of <span class="math notranslate nohighlight">\(T_{16}\)</span> are <span class="math notranslate nohighlight">\(q^9, q^{10}, q^{6}\)</span>.</p>
<p>The edge of the 1st side <span class="math notranslate nohighlight">\(L_1\)</span> are <span class="math notranslate nohighlight">\(q^6, q^5\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\dots\)</span></p>
<p>The edge of the 10th side <span class="math notranslate nohighlight">\(L_{10}\)</span> are <span class="math notranslate nohighlight">\(q^{10}, q^6\)</span>.</p>
<table class="docutils align-default" id="tabmeshstructure">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">The structure of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">mesh_sample</span><span class="p">.</span><span class="n">msh</span></code></span><a class="headerlink" href="#tabmeshstructure" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Content of the file</p></th>
<th class="head"><p>Explanation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>14 16 10</p></td>
<td><p><span class="math notranslate nohighlight">\(n_v\quad n_t\quad n_e\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>-0.309016994375 0.951056516295 1</p>
<p>0.309016994375 0.951056516295 1</p>
<p>…</p>
<p>-0.309016994375 -0.951056516295 1</p>
</td>
<td><p><span class="math notranslate nohighlight">\(q^1_x\quad q^1_y\quad\)</span> boundary label <span class="math notranslate nohighlight">\(=1\)</span></p>
<p><span class="math notranslate nohighlight">\(q^2_x\quad q^2_y\quad\)</span> boundary label <span class="math notranslate nohighlight">\(=1\)</span></p>
<p>…</p>
<p><span class="math notranslate nohighlight">\(q^{14}_x\quad q^{14}_y\quad\)</span> boundary label <span class="math notranslate nohighlight">\(=1\)</span></p>
</td>
</tr>
<tr class="row-even"><td><p>9 12 10 0</p>
<p>5 9 6 0</p>
<p>…</p>
<p>9 10 6 0</p>
</td>
<td><p><span class="math notranslate nohighlight">\(1_1\quad 1_2\quad 1_3\quad\)</span> region label <span class="math notranslate nohighlight">\(=0\)</span></p>
<p><span class="math notranslate nohighlight">\(2_1\quad 2_2\quad 2_3\quad\)</span> region label <span class="math notranslate nohighlight">\(=0\)</span></p>
<p>…</p>
<p><span class="math notranslate nohighlight">\(16_1\quad 16_2\quad 16_3\quad\)</span> region label <span class="math notranslate nohighlight">\(=0\)</span></p>
</td>
</tr>
<tr class="row-odd"><td><p>6 5 1</p>
<p>5 2 1</p>
<p>…</p>
<p>10 6 1</p>
</td>
<td><p><span class="math notranslate nohighlight">\(1_1\quad 1_2\quad\)</span> boundary label <span class="math notranslate nohighlight">\(=1\)</span></p>
<p><span class="math notranslate nohighlight">\(2_1\quad 2_2\quad\)</span> boundary label <span class="math notranslate nohighlight">\(=1\)</span></p>
<p>…</p>
<p><span class="math notranslate nohighlight">\(10_1\quad 10_2\quad\)</span> boundary label <span class="math notranslate nohighlight">\(=1\)</span></p>
</td>
</tr>
</tbody>
</table>
<p>In <strong>FreeFEM</strong> there are many mesh file formats available for communication with other tools such as <code class="docutils literal highlight highlight-python"><span></span><span class="n">emc2</span></code>, <code class="docutils literal highlight highlight-python"><span></span><span class="n">modulef</span></code>, … (see <a class="reference internal" href="developers.html#meshfiledatastructure"><span class="std std-ref">Mesh format chapter</span></a> ).</p>
<p>The extension of a file implies its format.
More details can be found on the file format .msh in the article by F. Hecht “bamg : a bidimensional anisotropic mesh generator” <a class="reference internal" href="../bibliography.html#hecht1998-2" id="id26"><span>[HECHT1998_2]</span></a>.</p>
<p>A mesh file can be read into <strong>FreeFEM</strong> except that the names of the borders are lost and only their reference numbers are kept.
So these borders have to be referenced by the number which corresponds to their order of appearance in the program, unless this number is overwritten by the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span></code>. Here are some examples:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Parameters</span>
<span class="linenos"> 2</span><span class="kt">int</span><span class="w"> </span><span class="kr">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1">// Mesh</span>
<span class="linenos"> 5</span><span class="kt">border</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="linenos"> 6</span><span class="kt">border</span><span class="w"> </span><span class="nf">right</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">5</span><span class="p">;};</span>
<span class="linenos"> 7</span><span class="kt">border</span><span class="w"> </span><span class="nf">ceiling</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">5</span><span class="p">;};</span>
<span class="linenos"> 8</span><span class="kt">border</span><span class="w"> </span><span class="nf">left</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">5</span><span class="p">;};</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="kt">mesh</span><span class="w"> </span><span class="n">th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="nf">floor</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">right</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ceiling</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">left</span><span class="p">(</span><span class="kr">n</span><span class="p">));</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="c1">//save mesh in different formats</span>
<span class="linenos">13</span><span class="nf">savemesh</span><span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;toto.am_fmt&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// format &quot;formated Marrocco&quot;</span>
<span class="linenos">14</span><span class="nf">savemesh</span><span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;toto.Th&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// format database db mesh &quot;bamg&quot;</span>
<span class="linenos">15</span><span class="nf">savemesh</span><span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;toto.msh&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// format freefem</span>
<span class="linenos">16</span><span class="nf">savemesh</span><span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;toto.nopo&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// modulef format</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="c1">// Fespace</span>
<span class="linenos">19</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">femp1</span><span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos">20</span><span class="n">femp1</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">21</span><span class="n">femp1</span><span class="w"> </span><span class="n">g</span><span class="p">;</span>
<span class="linenos">22</span>
<span class="linenos">23</span><span class="c1">//save the fespace function in a file</span>
<span class="linenos">24</span><span class="p">{</span>
<span class="linenos">25</span><span class="w">  </span><span class="kt">ofstream</span><span class="w"> </span><span class="kp">file</span><span class="p">(</span><span class="s">&quot;f.txt&quot;</span><span class="p">);</span>
<span class="linenos">26</span><span class="w">  </span><span class="kp">file</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">f</span><span class="p">[]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">27</span><span class="p">}</span><span class="w"> </span><span class="c1">//the file is automatically closed at the end of the block</span>
<span class="linenos">28</span><span class="c1">//read a file and put it in a fespace function</span>
<span class="linenos">29</span><span class="p">{</span>
<span class="linenos">30</span><span class="w">  </span><span class="kt">ifstream</span><span class="w"> </span><span class="kp">file</span><span class="p">(</span><span class="s">&quot;f.txt&quot;</span><span class="p">);</span>
<span class="linenos">31</span><span class="w">  </span><span class="kp">file</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">g</span><span class="p">[]</span><span class="w"> </span><span class="p">;</span>
<span class="linenos">32</span><span class="p">}</span><span class="c1">//the file is equally automatically closed</span>
<span class="linenos">33</span>
<span class="linenos">34</span><span class="c1">// Plot</span>
<span class="linenos">35</span><span class="nf">plot</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>
<span class="linenos">36</span>
<span class="linenos">37</span><span class="c1">// Mesh 2</span>
<span class="linenos">38</span><span class="c1">//read the mesh for freefem format saved mesh</span>
<span class="linenos">39</span><span class="kt">mesh</span><span class="w"> </span><span class="n">th2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">readmesh</span><span class="p">(</span><span class="s">&quot;toto.msh&quot;</span><span class="p">);</span>
<span class="linenos">40</span>
<span class="linenos">41</span><span class="c1">// Fespace 2</span>
<span class="linenos">42</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh2</span><span class="p">(</span><span class="n">th2</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos">43</span><span class="n">Vh2</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="linenos">44</span>
<span class="linenos">45</span><span class="c1">// Problem</span>
<span class="linenos">46</span><span class="c1">//solve:</span>
<span class="linenos">47</span><span class="c1">//  $u + \Delta u = g$ in $\Omega $</span>
<span class="linenos">48</span><span class="c1">//  $u=0$ on $\Gamma_1$</span>
<span class="linenos">49</span><span class="c1">//  $\frac{\partial u }{\partial n} = g$ on $\Gamma_2$</span>
<span class="linenos">50</span><span class="kt">solve</span><span class="w"> </span><span class="nf">Problem</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="linenos">51</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">th2</span><span class="p">)(</span>
<span class="linenos">52</span><span class="w">      </span><span class="n">u</span><span class="o">*</span><span class="n">v</span>
<span class="linenos">53</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos">54</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos">55</span><span class="w">  </span><span class="p">)</span>
<span class="linenos">56</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">th2</span><span class="p">)(</span>
<span class="linenos">57</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">g</span><span class="o">*</span><span class="n">v</span>
<span class="linenos">58</span><span class="w">  </span><span class="p">)</span>
<span class="linenos">59</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="nf">int1d</span><span class="p">(</span><span class="n">th2</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)(</span>
<span class="linenos">60</span><span class="w">      </span><span class="n">g</span><span class="o">*</span><span class="n">v</span>
<span class="linenos">61</span><span class="w">  </span><span class="p">)</span>
<span class="linenos">62</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">63</span><span class="w">  </span><span class="p">;</span>
<span class="linenos">64</span>
<span class="linenos">65</span><span class="c1">// Plot</span>
<span class="linenos">66</span><span class="nf">plot</span><span class="p">(</span><span class="n">th2</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="input-output-for-a-mesh">
<h4>Input/output for a mesh<a class="headerlink" href="#input-output-for-a-mesh" title="Link to this heading"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p>the command <em>readmesh</em></p></li>
</ul>
</div></blockquote>
<dl>
<dt>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">readmesh</span></code> allows to build a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh</span></code> from a data file</dt><dd><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="o">=</span><span class="n">readmeshS</span><span class="p">(</span><span class="s">&quot;Th.mesh&quot;</span><span class="p">);</span>
<span class="linenos">2</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Thff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">readmesh</span><span class="p">(</span><span class="s">&quot;Thff.msh&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// FreeFEM format</span>
</pre></div>
</div>
<ul class="simple">
<li><p>the command <em>savemesh</em></p></li>
</ul>
</dd>
<dt>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">savemesh</span></code> allows to export a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh</span></code></dt><dd><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nf">savemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="s">&quot;Th.mesh&quot;</span><span class="p">)</span>
<span class="linenos">2</span><span class="nf">savemesh</span><span class="p">(</span><span class="n">Thff</span><span class="p">,</span><span class="s">&quot;Thff.msh&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// FreeFEM format</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="nf">savemesh</span><span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;toto.msh&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// format freefem  savemesh(th, &quot;toto.am_fmt&quot;); // format &quot;formated Marrocco&quot;</span>
<span class="linenos">5</span><span class="nf">savemesh</span><span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;toto.Th&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// format database db mesh &quot;bamg&quot;</span>
<span class="linenos">6</span><span class="nf">savemesh</span><span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;toto.nopo&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// modulef format</span>
<span class="linenos">7</span><span class="c1">// allows to save the 2d mesh with the 3rd space coordinate as a scalar solution for visualise</span>
<span class="linenos">8</span><span class="nf">savemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="s">&quot;mm&quot;</span><span class="p">,[</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">,</span><span class="n">u</span><span class="p">]);</span><span class="w"> </span><span class="c1">//  save surface mesh for medit, see for example minimal-surf.edp</span>
<span class="linenos">9</span><span class="nf">exec</span><span class="p">(</span><span class="s">&quot;medit mm;rm mm.bb mm.faces mm.points&quot;</span><span class="p">);</span>
</pre></div>
</div>
<ul class="simple">
<li><p>the command <em>vtkloadS</em></p></li>
</ul>
</dd>
</dl>
<p>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">vtkload</span></code> allows to build a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh</span></code> from a data mesh at vtk format mesh</p>
<blockquote>
<div><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;iovtk&quot;</span>
<span class="linenos">2</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="o">=</span><span class="n">vtkloadS</span><span class="p">(</span><span class="s">&quot;mymesh.vtk&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p>the command <em>savevtk</em></p></li>
</ul>
<dl>
<dt>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">savevtk</span></code> allows to export a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh</span></code> to a data mesh at vtk format mesh</dt><dd><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;iovtk&quot;</span>
<span class="linenos">2</span><span class="w"> </span><span class="nf">savevtk</span><span class="p">(</span><span class="s">&quot;Th.vtk&quot;</span><span class="p">,</span><span class="n">Th</span><span class="p">);</span>
</pre></div>
</div>
<ul class="simple">
<li><p>the command <em>gmshload</em></p></li>
</ul>
</dd>
<dt>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">gmshloadS</span></code> allows to build a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh</span></code> from a data mesh file at formatmsh (GMSH)</dt><dd><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;gmsh&quot;</span>
<span class="linenos">2</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="o">=</span><span class="nf">gmshload</span><span class="p">(</span><span class="s">&quot;mymesh.msh&quot;</span><span class="p">);</span>
</pre></div>
</div>
<ul class="simple">
<li><p>the command <em>savegmsh</em></p></li>
</ul>
</dd>
<dt>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">savegmsh</span></code> allows to export a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh</span></code> to a data mesh msh (GMSH)</dt><dd><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w">    </span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;gmsh&quot;</span>
<span class="linenos">2</span><span class="n">savegmsh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Th&quot;</span><span class="p">);</span>
</pre></div>
</div>
</dd>
</dl>
</section>
</section>
<section id="id27">
<h3>3d case<a class="headerlink" href="#id27" title="Link to this heading"></a></h3>
<section id="id28">
<h4>format of  mesh data<a class="headerlink" href="#id28" title="Link to this heading"></a></h4>
<p>In three dimensions, the file mesh format supported for input and output files by <strong>FreeFEM</strong> are the extension .msh and .mesh.
These formats are described in the <a class="reference internal" href="developers.html#meshfiledatastructure"><span class="std std-ref">Mesh Format section</span></a>.</p>
<p><strong>Extension file .msh</strong> The structure of the files with extension .msh in 3D is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{cccccc}
    n_v &amp; n_{tet} &amp; n_{tri} &amp; &amp; \\
    q^1_x &amp; q^1_y &amp; q^1_z &amp; Vertex label &amp; \\
    q^2_x &amp; q^2_y &amp; q^2_z &amp; Vertex label &amp; \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \\
    q^{n_v}_x &amp; q^{n_v}_y &amp; q^{n_v}_z &amp; Vertex label &amp; \\
    1_1 &amp; 1_2 &amp; 1_3 &amp; 1_4 &amp; region label \\
    2_1 &amp; 2_2 &amp; 2_3 &amp; 2_4 &amp; region label \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
    (n_{tet})_1 &amp; (n_{tet})_2 &amp; (n_{tet})_3 &amp; (n_{tet})_4 &amp; region label \\
    1_1 &amp; 1_2 &amp; 1_3 &amp; boundary label &amp; \\
    2_1 &amp; 2_2 &amp; 2_3 &amp; boundary label &amp; \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \\
    (n_tri)_{1} &amp; (n_{tri})_2 &amp; (n_{tri})_3 &amp; boundary label &amp; \\
\end{array}\end{split}\]</div>
<p>In this structure, <span class="math notranslate nohighlight">\(n_v\)</span> denotes the number of vertices, <span class="math notranslate nohighlight">\(n_{tet}\)</span> the number of tetrahedra and <span class="math notranslate nohighlight">\(n_{tri}\)</span> the number of triangles.</p>
<p>For each vertex <span class="math notranslate nohighlight">\(q^i,\, i=1,\cdots,n_v\)</span>, we denote by <span class="math notranslate nohighlight">\((q^i_x,q^i_y,q^i_z)\)</span> the <span class="math notranslate nohighlight">\(x\)</span>-coordinate, the <span class="math notranslate nohighlight">\(y\)</span>-coordinate and the <span class="math notranslate nohighlight">\(z\)</span>-coordinate.</p>
<p>Each tetrahedra <span class="math notranslate nohighlight">\(T_k, k=1,\cdots,n_{tet}\)</span> has four vertices <span class="math notranslate nohighlight">\(q^{k_1},\, q^{k_2},\,q^{k_3}, \,q^{k_4}\)</span>.</p>
<p>The boundary consists of a union of triangles.
Each triangle <span class="math notranslate nohighlight">\(tri_j, j=1,\cdots,n_{tri}\)</span> has three vertices <span class="math notranslate nohighlight">\(q^{j_1},\, q^{j_2},\,q^{j_3}\)</span>.</p>
<p><strong>extension file .mesh</strong> The data structure for a three dimensional mesh is composed of the data structure presented in <a class="reference internal" href="developers.html#meshfiledatastructure"><span class="std std-ref">Mesh Format section</span></a> and a data structure for the tetrahedra. The tetrahedra of a three dimensional mesh are referred using the following field:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>Tetrahedra
<span class="linenos"> 2</span>NbTetrahedra
<span class="linenos"> 3</span>Vertex1<span class="w"> </span>Vertex2<span class="w"> </span>Vertex3<span class="w"> </span>Vertex4<span class="w"> </span>Label
<span class="linenos"> 4</span>...
<span class="linenos"> 5</span>Vertex1<span class="w"> </span>Vertex2<span class="w"> </span>Vertex3<span class="w"> </span>Vertex4<span class="w"> </span>Label
<span class="linenos"> 6</span>Triangles
<span class="linenos"> 7</span>NbTriangles
<span class="linenos"> 8</span>Vertex1<span class="w"> </span>Vertex2<span class="w"> </span>Vertex3<span class="w"> </span>Label
<span class="linenos"> 9</span>...
<span class="linenos">10</span>Vertex1<span class="w"> </span>Vertex2<span class="w"> </span>Vertex3<span class="w"> </span>Label
</pre></div>
</div>
<p>This field is express with the notation of <a class="reference internal" href="developers.html#meshfiledatastructure"><span class="std std-ref">Mesh Format section</span></a>.</p>
</section>
<section id="input-output-for-a-mesh3">
<h4>Input/output for a mesh3<a class="headerlink" href="#input-output-for-a-mesh3" title="Link to this heading"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p>the command <em>readmesh3</em></p></li>
</ul>
</div></blockquote>
<dl>
<dt>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">readmesh3</span></code> allows to build a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code> from a data file</dt><dd><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th3</span><span class="o">=</span><span class="nf">readmesh3</span><span class="p">(</span><span class="s">&quot;Th3.mesh&quot;</span><span class="p">);</span>
<span class="linenos">2</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th3ff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">readmesh3</span><span class="p">(</span><span class="s">&quot;Th3ff.msh&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// FreeFEM format</span>
</pre></div>
</div>
<ul class="simple">
<li><p>the command <em>savemesh</em></p></li>
</ul>
</dd>
<dt>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">savemesh</span></code> allows to export a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code></dt><dd><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nf">savemesh</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span><span class="s">&quot;Th3.mesh&quot;</span><span class="p">)</span>
<span class="linenos">2</span><span class="nf">savemesh</span><span class="p">(</span><span class="n">Th3ff</span><span class="p">,</span><span class="s">&quot;Th3ff.msh&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// FreeFEM format</span>
</pre></div>
</div>
<ul class="simple">
<li><p>the command <em>vtkload3</em></p></li>
</ul>
</dd>
</dl>
<p>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">vtkload3</span></code> allows to build a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code> from a data mesh at vtk format mesh</p>
<blockquote>
<div><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;iovtk&quot;</span>
<span class="linenos">2</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th3</span><span class="o">=</span><span class="n">vtkloadS</span><span class="p">(</span><span class="s">&quot;mymesh.vtk&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p>the command <em>savevtk</em></p></li>
</ul>
<dl>
<dt>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">savevtk</span></code> allows to export a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code> to a data mesh at vtk format mesh</dt><dd><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;iovtk&quot;</span>
<span class="linenos">2</span><span class="w"> </span><span class="nf">savevtk</span><span class="p">(</span><span class="s">&quot;Th3.vtk&quot;</span><span class="p">,</span><span class="n">Th3</span><span class="p">);</span>
</pre></div>
</div>
<ul class="simple">
<li><p>the command <em>gmshload3</em></p></li>
</ul>
</dd>
<dt>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">gmshload3</span></code> allows to build a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code> from a data mesh file at formatmsh (GMSH)</dt><dd><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;gmsh&quot;</span>
<span class="linenos">2</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th3</span><span class="o">=</span><span class="nf">gmshload3</span><span class="p">(</span><span class="s">&quot;mymesh.msh&quot;</span><span class="p">);</span>
</pre></div>
</div>
<ul class="simple">
<li><p>the command <em>savegmsh</em></p></li>
</ul>
</dd>
<dt>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">savegmsh</span></code> allows to export a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code> to a data mesh msh (GMSH)</dt><dd><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w">    </span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;gmsh&quot;</span>
<span class="linenos">2</span><span class="n">savegmsh</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Th3&quot;</span><span class="p">);</span>
</pre></div>
</div>
</dd>
</dl>
</section>
</section>
<section id="surface-3d-case">
<h3>Surface 3d case<a class="headerlink" href="#surface-3d-case" title="Link to this heading"></a></h3>
<section id="id29">
<h4>format of  mesh data<a class="headerlink" href="#id29" title="Link to this heading"></a></h4>
<p>Like 2d and 3d, the input and output format files supported by <strong>FreeFEM</strong> are the extension .msh and .mesh.
These formats are described in the <a class="reference internal" href="developers.html#meshfiledatastructure"><span class="std std-ref">Mesh Format section</span></a>.</p>
<p><strong>Extension file .msh</strong> The structure of the files with extension .msh in surface 3D is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{cccccc}
    n_v &amp; n_{tri} &amp; n_{edges} &amp; &amp; \\
    q^1_x &amp; q^1_y &amp; q^1_z &amp; Vertex label &amp; \\
    q^2_x &amp; q^2_y &amp; q^2_z &amp; Vertex label &amp; \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \\
    q^{n_v}_x &amp; q^{n_v}_y &amp; q^{n_v}_z &amp; Vertex label &amp; \\
    1_1 &amp; 1_2 &amp; 1_3  &amp; region label \\
    2_1 &amp; 2_2 &amp; 2_3  &amp; region label \\
    \vdots &amp; \vdots &amp; \vdots  &amp; \vdots \\
    (n_{tri})_1 &amp; (n_{tri})_2 &amp; (n_{tri})_3 &amp; region label \\
    1_1 &amp; 1_2 &amp; boundary label &amp; \\
    2_1 &amp; 2_2 &amp; boundary label &amp; \\
    \vdots &amp;  \vdots &amp; \vdots &amp; \\
    (n_edge)_{1} &amp; (n_{edge})_2 &amp; boundary label &amp; \\
\end{array}\end{split}\]</div>
<p>In this structure, <span class="math notranslate nohighlight">\(n_v\)</span> denotes the number of vertices, <span class="math notranslate nohighlight">\(n_{tet}\)</span> the number of tetrahedra and <span class="math notranslate nohighlight">\(n_{tri}\)</span> the number of triangles.</p>
<p>For each vertex <span class="math notranslate nohighlight">\(q^i,\, i=1,\cdots,n_v\)</span>, we denote by <span class="math notranslate nohighlight">\((q^i_x,q^i_y,q^i_z)\)</span> the <span class="math notranslate nohighlight">\(x\)</span>-coordinate, the <span class="math notranslate nohighlight">\(y\)</span>-coordinate and the <span class="math notranslate nohighlight">\(z\)</span>-coordinate.</p>
<p>Each tetrahedra <span class="math notranslate nohighlight">\(T_k, k=1,\cdots,n_{tet}\)</span> has four vertices <span class="math notranslate nohighlight">\(q^{k_1},\, q^{k_2},\,q^{k_3}, \,q^{k_4}\)</span>.</p>
<p>The boundary consists of a union of triangles.
Each triangle <span class="math notranslate nohighlight">\(be_j, j=1,\cdots,n_{tri}\)</span> has three vertices <span class="math notranslate nohighlight">\(q^{j_1},\, q^{j_2},\,q^{j_3}\)</span>.</p>
<p><strong>extension file .mesh</strong> The data structure for a three dimensional mesh is composed of the data structure presented in <a class="reference internal" href="developers.html#meshfiledatastructure"><span class="std std-ref">Mesh Format section</span></a> and a data structure for the tetrahedra. The tetrahedra of a three dimensional mesh are referred using the following field:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>MeshVersionFormatted<span class="w"> </span><span class="m">2</span>
<span class="linenos"> 2</span>Dimension<span class="w"> </span><span class="m">3</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span>Vertices
<span class="linenos"> 5</span>NbVertices
<span class="linenos"> 6</span><span class="o">(</span>v0<span class="o">)</span>x<span class="w"> </span><span class="o">(</span>v0<span class="o">)</span>y<span class="w"> </span><span class="o">(</span>v0<span class="o">)</span>z
<span class="linenos"> 7</span>...
<span class="linenos"> 8</span><span class="o">(</span>vn<span class="o">)</span>x<span class="w"> </span><span class="o">(</span>vn<span class="o">)</span>y<span class="w"> </span><span class="o">(</span>vn<span class="o">)</span>z
<span class="linenos"> 9</span>
<span class="linenos">10</span>Triangles
<span class="linenos">11</span>NbTriangles
<span class="linenos">12</span>Vertex1<span class="w"> </span>Vertex2<span class="w"> </span>Vertex3<span class="w"> </span>Label
<span class="linenos">13</span>...
<span class="linenos">14</span>Vertex1<span class="w"> </span>Vertex2<span class="w"> </span>Vertex3<span class="w"> </span>Label
<span class="linenos">15</span>
<span class="linenos">16</span>Edges
<span class="linenos">17</span>NbEdges
<span class="linenos">18</span>Vertex1<span class="w"> </span>Vertex2<span class="w"> </span>Label
<span class="linenos">19</span>...
<span class="linenos">20</span>Vertex1<span class="w"> </span>Vertex2<span class="w"> </span>Label
<span class="linenos">21</span>
<span class="linenos">22</span>End
</pre></div>
</div>
<p>This field is express with the notation of <a class="reference internal" href="developers.html#meshfiledatastructure"><span class="std std-ref">Mesh Format section</span></a>.</p>
</section>
<section id="input-output-for-a-meshs">
<h4>Input/output for a meshS<a class="headerlink" href="#input-output-for-a-meshs" title="Link to this heading"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p>the command <em>readmesh3</em></p></li>
</ul>
</div></blockquote>
<dl>
<dt>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">readmeshS</span></code> allows to build a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code> from a data file</dt><dd><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThS</span><span class="o">=</span><span class="n">readmeshS</span><span class="p">(</span><span class="s">&quot;ThS.mesh&quot;</span><span class="p">);</span>
<span class="linenos">2</span><span class="kt">meshS</span><span class="w"> </span><span class="n">Th3ff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">readmeshS</span><span class="p">(</span><span class="s">&quot;ThSff.msh&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// FreeFEM format</span>
</pre></div>
</div>
<ul class="simple">
<li><p>the command <em>savemesh</em></p></li>
</ul>
</dd>
<dt>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">savemesh</span></code> allows to export a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code></dt><dd><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nf">savemesh</span><span class="p">(</span><span class="n">ThS</span><span class="p">,</span><span class="s">&quot;ThS.mesh&quot;</span><span class="p">)</span>
<span class="linenos">2</span><span class="nf">savemesh</span><span class="p">(</span><span class="n">ThSff</span><span class="p">,</span><span class="s">&quot;ThSff.msh&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// FreeFEM format</span>
</pre></div>
</div>
<ul class="simple">
<li><p>the command <em>vtkloadS</em></p></li>
</ul>
</dd>
</dl>
<p>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">vtkloadS</span></code> allows to build a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code> from a data mesh at vtk format mesh</p>
<blockquote>
<div><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;iovtk&quot;</span>
<span class="linenos">2</span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThS</span><span class="o">=</span><span class="n">vtkloadS</span><span class="p">(</span><span class="s">&quot;mymesh.vtk&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p>the command <em>savevtk</em></p></li>
</ul>
<dl>
<dt>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">savevtk</span></code> allows to export a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code> to a data mesh at vtk format mesh</dt><dd><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;iovtk&quot;</span>
<span class="linenos">2</span><span class="w"> </span><span class="nf">savevtk</span><span class="p">(</span><span class="s">&quot;ThS.vtk&quot;</span><span class="p">,</span><span class="n">ThS</span><span class="p">);</span>
</pre></div>
</div>
<ul class="simple">
<li><p>the command <em>gmshloadS</em></p></li>
</ul>
</dd>
<dt>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">gmshloadS</span></code> allows to build a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code> from a data mesh file at formatmsh (GMSH)</dt><dd><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;gmsh&quot;</span>
<span class="linenos">2</span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThS</span><span class="o">=</span><span class="n">gmshloadS</span><span class="p">(</span><span class="s">&quot;mymesh.msh&quot;</span><span class="p">);</span>
</pre></div>
</div>
<ul class="simple">
<li><p>the command <em>savegmsh</em></p></li>
</ul>
</dd>
<dt>The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">savegmsh</span></code> allows to export a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">meshS</span></code> to a data mesh msh (GMSH)</dt><dd><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w">    </span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;gmsh&quot;</span>
<span class="linenos">2</span><span class="n">savegmsh</span><span class="p">(</span><span class="n">ThS</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ThS&quot;</span><span class="p">);</span>
</pre></div>
</div>
</dd>
</dl>
</section>
</section>
</section>
<section id="medit">
<h2>Medit<a class="headerlink" href="#medit" title="Link to this heading"></a></h2>
<p>The keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">medit</span></code> allows to display a mesh alone or a mesh and one or several functions defined on the mesh using the Pascal Frey’s freeware <code class="docutils literal highlight highlight-python"><span></span><span class="n">medit</span></code>.
<code class="docutils literal highlight highlight-python"><span></span><span class="n">medit</span></code> opens its own window and uses OpenGL extensively.
Naturally to use this command <code class="docutils literal highlight highlight-python"><span></span><span class="n">medit</span></code> must be installed.</p>
<p>A vizualisation with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">medit</span></code> of scalar solutions <span class="math notranslate nohighlight">\(f1\)</span> and <span class="math notranslate nohighlight">\(f2\)</span> continuous, piecewise linear and known at the vertices of the mesh Th is obtained using:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;sol1 sol2&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">f1</span><span class="p">,</span><span class="w"> </span><span class="n">f2</span><span class="p">,</span><span class="w"> </span><span class="kp">order</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<p>The first plot named <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">sol1</span></code> display f1.
The second plot names <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">sol2</span></code> display f2.</p>
<p>The arguments of the function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">medit</span></code> are the name of the differents scenes (separated by a space) of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">medit</span></code>, a mesh and solutions.</p>
<p>Each solution is associated with one scene.
The scalar, vector and symmetric tensor solutions are specified in the format described in the section dealing with the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">savesol</span></code>.</p>
<p>The parameters of this command line are :</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">order</span><span class="o">=</span></code> 0 if the solution is given at the center of gravity of elements.</dt><dd><p>1 is the solution is given at the vertices of elements.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">meditff</span><span class="o">=</span></code> set the name of execute command of medit.</dt><dd><p>By default, this string is medit.</p>
</dd>
</dl>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">save</span><span class="o">=</span></code> set the name of a file <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">.</span><span class="n">sol</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">.</span><span class="n">solb</span></code> to save solutions.</p></li>
</ul>
<p>This command line allows also to represent two differents meshes and solutions on them in the same windows.
The nature of solutions must be the same.
Hence, we can vizualize in the same window the different domains in a domain decomposition method for instance.
A vizualisation with medit of scalar solutions <span class="math notranslate nohighlight">\(h1\)</span> and <span class="math notranslate nohighlight">\(h2\)</span> at vertices of the mesh Th1 and Th2 respectively are obtained using:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;sol2domain&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Th1</span><span class="p">,</span><span class="w"> </span><span class="n">h1</span><span class="p">,</span><span class="w"> </span><span class="n">Th2</span><span class="p">,</span><span class="w"> </span><span class="n">h2</span><span class="p">,</span><span class="w"> </span><span class="kp">order</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Medit</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="c1">// Initial Problem:</span>
<span class="linenos"> 4</span><span class="c1">// Resolution of the following EDP:</span>
<span class="linenos"> 5</span><span class="c1">// -Delta u_s = f on \Omega = { (x,y) | 1 &lt;= sqrt(x^2+y^2) &lt;= 2 }</span>
<span class="linenos"> 6</span><span class="c1">// -Delta u_1 = f1 on \Omega_1 = { (x,y) | 0.5 &lt;= sqrt(x^2+y^2) &lt;= 1. }</span>
<span class="linenos"> 7</span><span class="c1">// u = 1 on Gamma</span>
<span class="linenos"> 8</span><span class="c1">// Null Neumman condition on Gamma_1 and on Gamma_2</span>
<span class="linenos"> 9</span><span class="c1">// We find the solution u by solving two EDP defined on domain Omega and Omega_1</span>
<span class="linenos">10</span><span class="c1">// This solution is visualize with medit</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="kr">verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="c1">// Mesh</span>
<span class="linenos">15</span><span class="kt">border</span><span class="w"> </span><span class="nf">Gamma</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="linenos">16</span><span class="kt">border</span><span class="w"> </span><span class="nf">Gamma1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">2</span><span class="p">;};</span>
<span class="linenos">17</span><span class="kt">border</span><span class="w"> </span><span class="nf">Gamma2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">3</span><span class="p">;};</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">Gamma</span><span class="p">(</span><span class="mi">-40</span><span class="p">));</span><span class="w"> </span><span class="c1">//Omega</span>
<span class="linenos">20</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="nf">Gamma</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Gamma2</span><span class="p">(</span><span class="mi">-40</span><span class="p">));</span><span class="w"> </span><span class="c1">//Omega_1</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="c1">// Fespace</span>
<span class="linenos">23</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P2</span><span class="p">);</span>
<span class="linenos">24</span><span class="kt">func</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="kr">x</span><span class="o">*</span><span class="kr">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="kr">y</span><span class="o">*</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">25</span><span class="n">Vh</span><span class="w"> </span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="linenos">26</span>
<span class="linenos">27</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh1</span><span class="p">(</span><span class="n">Th1</span><span class="p">,</span><span class="w"> </span><span class="nc">P2</span><span class="p">);</span>
<span class="linenos">28</span><span class="kt">func</span><span class="w"> </span><span class="n">f1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="o">*</span><span class="nf">sqrt</span><span class="p">(</span><span class="kr">x</span><span class="o">*</span><span class="kr">x</span><span class="o">+</span><span class="kr">y</span><span class="o">*</span><span class="kr">y</span><span class="p">);</span>
<span class="linenos">29</span><span class="n">Vh1</span><span class="w"> </span><span class="n">u1</span><span class="p">,</span><span class="w"> </span><span class="n">v1</span><span class="p">;</span>
<span class="linenos">30</span>
<span class="linenos">31</span><span class="c1">// Macro</span>
<span class="linenos">32</span><span class="kt">macro</span><span class="w"> </span><span class="n">Grad2</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">us</span><span class="p">)]</span><span class="w"> </span><span class="c1">// EOM</span>
<span class="linenos">33</span>
<span class="linenos">34</span><span class="c1">// Problem</span>
<span class="linenos">35</span><span class="kt">problem</span><span class="w"> </span><span class="n">Lap2dOmega</span><span class="w"> </span><span class="p">(</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="kp">init</span><span class="o">=</span><span class="kr">false</span><span class="p">)</span>
<span class="linenos">36</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos">37</span><span class="w">        </span><span class="n">Grad2</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Grad2</span><span class="p">(</span><span class="n">us</span><span class="p">)</span>
<span class="linenos">38</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">39</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos">40</span><span class="w">        </span><span class="n">f</span><span class="o">*</span><span class="n">v</span>
<span class="linenos">41</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">42</span><span class="w">    </span><span class="o">+</span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">us</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">43</span><span class="w">    </span><span class="p">;</span>
<span class="linenos">44</span>
<span class="linenos">45</span><span class="kt">problem</span><span class="w"> </span><span class="n">Lap2dOmega1</span><span class="w"> </span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="w"> </span><span class="n">v1</span><span class="p">,</span><span class="w"> </span><span class="kp">init</span><span class="o">=</span><span class="kr">false</span><span class="p">)</span>
<span class="linenos">46</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th1</span><span class="p">)(</span>
<span class="linenos">47</span><span class="w">        </span><span class="n">Grad2</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Grad2</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span>
<span class="linenos">48</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">49</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th1</span><span class="p">)(</span>
<span class="linenos">50</span><span class="w">        </span><span class="n">f1</span><span class="o">*</span><span class="n">v1</span>
<span class="linenos">51</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">52</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">u1</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">53</span><span class="w">    </span><span class="p">;</span>
<span class="linenos">54</span>
<span class="linenos">55</span><span class="c1">// Solve</span>
<span class="linenos">56</span><span class="n">Lap2dOmega</span><span class="p">;</span>
<span class="linenos">57</span><span class="n">Lap2dOmega1</span><span class="p">;</span>
<span class="linenos">58</span>
<span class="linenos">59</span><span class="c1">// Plot with medit</span>
<span class="linenos">60</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;solution&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">Th1</span><span class="p">,</span><span class="w"> </span><span class="n">u1</span><span class="p">,</span><span class="w"> </span><span class="kp">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">save</span><span class="o">=</span><span class="s">&quot;testsavemedit.solb&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</section>
<section id="mshmet">
<span id="meshgenerationmshmet"></span><h2>Mshmet<a class="headerlink" href="#mshmet" title="Link to this heading"></a></h2>
<p>Mshmet is a software developed by P. Frey that allows to compute an anisotropic metric based on solutions (i.e. Hessian-based).
This software can return also an isotropic metric.
Moreover, <code class="docutils literal highlight highlight-python"><span></span><span class="n">mshmet</span></code> can also construct a metric suitable for levelset interface capturing.
The solution can be defined on 2D or 3D structured/unstructured meshes.
For example, the solution can be an error estimate of a FE solution.</p>
<p>Solutions for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mshmet</span></code> are given as an argument.
The solution can be a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">func</span></code>, a vector <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">func</span></code>, a symmetric tensor, a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">fespace</span></code> function, a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">fespace</span></code> vector function and a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">fespace</span></code> symmetric tensor.
The symmetric tensor argument is defined as this type of data for datasol argument.
This software accepts more than one solution.</p>
<p>For example, the metric <span class="math notranslate nohighlight">\(M\)</span> computed with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mshmet</span></code> for the solution <span class="math notranslate nohighlight">\(u\)</span> defined on the mesh <span class="math notranslate nohighlight">\(Th\)</span> is obtained by writing:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos">2</span><span class="n">Vh</span><span class="w"> </span><span class="n">u</span><span class="p">;</span><span class="w"> </span><span class="c1">//a scalar fespace function</span>
<span class="linenos">3</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mshmet</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">);</span>
</pre></div>
</div>
<p>The parameters of the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mshmet</span></code> are :</p>
<ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">normalization</span><span class="w"> </span><span class="o">=</span></code> (b) do a normalization of all solution in <span class="math notranslate nohighlight">\([0,1]\)</span>.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">aniso</span><span class="w"> </span><span class="o">=</span></code> (b) build anisotropic metric if 1 (default 0: isotropic)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">levelset</span><span class="w"> </span><span class="o">=</span></code> (b) build metric for levelset method (default: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">false</span></code>)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">verbosity</span><span class="w"> </span><span class="o">=</span></code> (l) level of verbosity</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbregul</span><span class="w"> </span><span class="o">=</span></code> (l) number of regularization’s iteration of solutions given (default 0).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">hmin</span><span class="w"> </span><span class="o">=</span></code> (d)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">hmax</span><span class="w"> </span><span class="o">=</span></code> (d)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">err</span><span class="w"> </span><span class="o">=</span></code> (d) level of error.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">width</span><span class="w"> </span><span class="o">=</span></code> (d) the width</p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">metric</span><span class="w"> </span><span class="o">=</span></code> a vector of double.</dt><dd><p>This vector contains an initial metric given to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mshmet</span></code>.
The structure of the metric vector is described in the next paragraph.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">loptions</span><span class="w"> </span><span class="o">=</span></code> a vector of integer of size 7.</dt><dd><p>This vector contains the integer parameters of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mshmet</span></code> (for expert only).</p>
<ul>
<li><p>loptions(0): normalization (default 1).</p></li>
<li><dl class="simple">
<dt>loptions(1): isotropic parameters (default 0).</dt><dd><p>1 for isotropic metric results otherwise 0.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>loptions(2): level set parameters (default 0).</dt><dd><p>1 for building level set metric otherwise 0.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>loptions(3): debug parameters (default 0).</dt><dd><p>1 for turning on debug mode otherwise 0.</p>
</dd>
</dl>
</li>
<li><p>loptions(4): level of verbosity (default 10).</p></li>
<li><p>loptions(5): number of regularization’s iteration of solutions given (default 0).</p></li>
<li><dl class="simple">
<dt>loptions(6): previously metric parameter (default 0).</dt><dd><p>1 for using previous metric otherwise 0.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">doptions</span><span class="o">=</span></code> a vector of double of size 4.</dt><dd><p>This vector contains the real parameters of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mshmet</span></code> (for expert only).</p>
<ul>
<li><p>doptions(0): hmin : min size parameters (default 0.01).</p></li>
<li><p>doptions(1): hmax : max size parameters (default 1.0).</p></li>
<li><p>doptions(2): eps : tolerance parameters (default 0.01).</p></li>
<li><p>doptions(2): width : relative width for Level Set (<span class="math notranslate nohighlight">\(0&lt;w&lt;1\)</span>) (default 0.05).</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>The result of the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mshmet</span></code> is a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> which contains the metric computed by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mshmet</span></code> at the different vertices <span class="math notranslate nohighlight">\(V_{i}\)</span> of the mesh.</p>
<p>With <span class="math notranslate nohighlight">\(nv\)</span> is the number of vertices, the structure of this vector is:</p>
<div class="math notranslate nohighlight">
\[M_{iso}= (m(V_0), m(V_1), \ldots, m(V_{nv}))^t\]</div>
<p>for a isotropic metric <span class="math notranslate nohighlight">\(m\)</span>.
For a symmetric tensor metric <span class="math notranslate nohighlight">\(h=\left(\begin{array}{ccc} m_{1 1} &amp; m_{1 2} &amp; m_{1 3}\\ m_{2 1} &amp; m_{2 2} &amp; m_{2 3} \\ m_{3 1} &amp; m_{3 2} &amp; m_{3 3} \end{array}\right)\)</span> , the parameters <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">metric</span></code> is:</p>
<div class="math notranslate nohighlight">
\[M_{aniso}= (H(V_{0}), \ldots, H(V_{nv}) )^t\]</div>
<p>where <span class="math notranslate nohighlight">\(H(V_{i})\)</span> is the vector of size 6 defined by <span class="math notranslate nohighlight">\([m11,m21,m22,m31,m32,m33]\)</span></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>mshmet</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">mshmet</span><span class="s">&quot;</span>
<span class="linenos"> 2</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="linenos"> 3</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="c1">// Parameters</span>
<span class="linenos"> 6</span><span class="kt">real</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="p">;</span>
<span class="linenos"> 7</span><span class="kt">func</span><span class="w"> </span><span class="n">zmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="kt">func</span><span class="w"> </span><span class="n">zmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos"> 9</span><span class="kt">int</span><span class="w"> </span><span class="n">MaxLayer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="c1">// Mesh</span>
<span class="linenos">12</span><span class="kt">border</span><span class="w"> </span><span class="nf">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="linenos">13</span><span class="kt">border</span><span class="w"> </span><span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">2</span><span class="p">;};</span>
<span class="linenos">14</span><span class="kt">border</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">3</span><span class="p">;};</span>
<span class="linenos">15</span><span class="kt">border</span><span class="w"> </span><span class="nf">d</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">4</span><span class="p">;};</span>
<span class="linenos">16</span><span class="kt">border</span><span class="w"> </span><span class="nf">e</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">5</span><span class="p">;};</span>
<span class="linenos">17</span><span class="kt">border</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">6</span><span class="p">;};</span>
<span class="linenos">18</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">d</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">6</span><span class="p">));</span>
<span class="linenos">19</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildlayers</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">MaxLayer</span><span class="p">,</span><span class="w"> </span><span class="kp">zbound</span><span class="o">=</span><span class="p">[</span><span class="n">zmin</span><span class="p">,</span><span class="w"> </span><span class="n">zmax</span><span class="p">]);</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="c1">// Fespace</span>
<span class="linenos">22</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh3</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span><span class="w"> </span><span class="nc">P2</span><span class="p">);</span>
<span class="linenos">23</span><span class="n">Vh3</span><span class="w"> </span><span class="n">u3</span><span class="p">,</span><span class="w"> </span><span class="n">v3</span><span class="p">;</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh3P1</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos">26</span><span class="n">Vh3P1</span><span class="w"> </span><span class="n">usol</span><span class="p">;</span>
<span class="linenos">27</span>
<span class="linenos">28</span><span class="c1">// Problem</span>
<span class="linenos">29</span><span class="kt">problem</span><span class="w"> </span><span class="nf">Problem2</span><span class="p">(</span><span class="n">u3</span><span class="p">,</span><span class="w"> </span><span class="n">v3</span><span class="p">,</span><span class="w"> </span><span class="kp">solver</span><span class="o">=</span><span class="kr">sparsesolver</span><span class="p">)</span>
<span class="linenos">30</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th3</span><span class="p">)(</span>
<span class="linenos">31</span><span class="w">        </span><span class="n">u3</span><span class="o">*</span><span class="n">v3</span><span class="o">*</span><span class="mf">1.0e-10</span>
<span class="linenos">32</span><span class="w">        </span><span class="o">+</span><span class="w"> </span><span class="nf">dx</span><span class="p">(</span><span class="n">u3</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v3</span><span class="p">)</span>
<span class="linenos">33</span><span class="w">        </span><span class="o">+</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">u3</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v3</span><span class="p">)</span>
<span class="linenos">34</span><span class="w">        </span><span class="o">+</span><span class="w"> </span><span class="nf">dz</span><span class="p">(</span><span class="n">u3</span><span class="p">)</span><span class="o">*</span><span class="nf">dz</span><span class="p">(</span><span class="n">v3</span><span class="p">)</span>
<span class="linenos">35</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">36</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th3</span><span class="p">)(</span>
<span class="linenos">37</span><span class="w">        </span><span class="n">v3</span>
<span class="linenos">38</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">39</span><span class="w">    </span><span class="o">+</span><span class="nf">on</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="n">u3</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">40</span><span class="w">    </span><span class="p">;</span>
<span class="linenos">41</span>
<span class="linenos">42</span><span class="c1">// Solve</span>
<span class="linenos">43</span><span class="n">Problem2</span><span class="p">;</span>
<span class="linenos">44</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">u3</span><span class="p">[].</span><span class="kr">min</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">u3</span><span class="p">[].</span><span class="kr">max</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">45</span>
<span class="linenos">46</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Sol&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Th3</span><span class="p">,</span><span class="w"> </span><span class="n">u3</span><span class="p">);</span>
<span class="linenos">47</span>
<span class="linenos">48</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="kp">bb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mshmet</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span><span class="n">u3</span><span class="p">);</span>
<span class="linenos">49</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Metric:&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kp">bb</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">50</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">Th3</span><span class="p">.</span><span class="kr">nv</span><span class="p">;</span><span class="w"> </span><span class="n">ii</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">51</span><span class="w">    </span><span class="n">usol</span><span class="p">[][</span><span class="n">ii</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">bb</span><span class="p">[</span><span class="n">ii</span><span class="p">];</span>
<span class="linenos">52</span>
<span class="linenos">53</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Metric&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Th3</span><span class="p">,</span><span class="w"> </span><span class="n">usol</span><span class="p">);</span>
</pre></div>
</div>
</div>
</section>
<section id="freeyams">
<h2>FreeYams<a class="headerlink" href="#freeyams" title="Link to this heading"></a></h2>
<p>FreeYams is a surface mesh adaptation software which is developed by P. Frey.
This software is a new version of yams.
The adapted surface mesh is constructed with a geometric metric tensor field.
This field is based on the intrinsic properties of the discrete surface.</p>
<p>Also, this software allows to construct a simplification of a mesh.
This decimation is based on the Hausdorff distance between the initial and the current triangulation.
Compared to the software yams, FreeYams can be used also to produce anisotropic triangulations adapted to levelset simulations.
A technical report on freeYams documentation is available <a class="reference external" href="https://www.ljll.math.upmc.fr/frey/publications/RT-0252.pdf">here</a>.</p>
<p>To call FreeYams in <strong>FreeFEM</strong>, we used the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">freeyams</span></code>.
The arguments of this function are the initial mesh and/or metric.
The metric with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">freeyams</span></code> are a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">func</span></code>, a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">fespace</span></code> function, a symmetric tensor function, a symmetric tensor <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">fespace</span></code> function or a vector of double (<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>).
If the metric is a vector of double, this data must be given in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">metric</span></code> parameter.
Otherwise, the metric is given in the argument.</p>
<p>For example, the adapted mesh of <code class="docutils literal highlight highlight-python"><span></span><span class="n">Thinit</span></code> defined by the metric <span class="math notranslate nohighlight">\(u\)</span> defined as <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">fespace</span></code> function is obtained by writing:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Thinit</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos">2</span><span class="n">Vh</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="linenos">3</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">freeyams</span><span class="p">(</span><span class="n">Thinit</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">);</span>
</pre></div>
</div>
<p>The symmetric tensor argument for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">freeyams</span></code> keyword is defined as this type of data for datasol argument.</p>
<ul>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">aniso</span><span class="o">=</span></code> (b) aniso or iso metric (default 0, iso)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">mem</span><span class="o">=</span></code> (l) memory of for freeyams in Mb (default -1,
freeyams choose)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">hmin</span><span class="o">=</span></code> (d)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">hmax</span><span class="o">=</span></code> (d)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">gradation</span><span class="o">=</span></code> (d)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">option</span><span class="o">=</span></code> (l)</p>
<ul class="simple">
<li><p>0 : mesh optimization (smoothing+swapping)</p></li>
<li><p>1 : decimation+enrichment adaptated to a metric map. (default)</p></li>
<li><p>-1 : decimation adaptated to a metric map.</p></li>
<li><p>2 : decimation+enrichment with a Hausdorff-like method</p></li>
<li><p>-2 : decimation with a Hausdorff-like method</p></li>
<li><p>4 : split triangles recursively.</p></li>
<li><p>9 : No-Shrinkage Vertex Smoothing</p></li>
</ul>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ridgeangle</span><span class="o">=</span></code> (d)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">absolute</span><span class="o">=</span></code> (b)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">verbosity</span><span class="o">=</span></code> (i)</p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">metric</span><span class="o">=</span></code> vector expression.</dt><dd><p>This parameters contains the metric at the different vertices on the initial mesh.
With <span class="math notranslate nohighlight">\(nv\)</span> is the number of vertices, this vector is:</p>
</dd>
</dl>
<div class="math notranslate nohighlight">
\[M_{iso}= ( m(V_0), m(V_1), \ldots, m(V_{nv}) )^t\]</div>
<p>for a scalar metric <span class="math notranslate nohighlight">\(m\)</span>.
For a symmetric tensor metric
<span class="math notranslate nohighlight">\(h=\left(\begin{array}{ccc} m_{1 1} &amp; m_{1 2} &amp; m_{1 3}\\ m_{2 1} &amp; m_{2 2} &amp; m_{2 3} \\ m_{3 1} &amp; m_{3 2} &amp; m_{3 3} \end{array}\right)\)</span>, the parameters <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">metric</span></code> is:</p>
<div class="math notranslate nohighlight">
\[M_{aniso}= ( H(V_{0}), \ldots, H(V_{nv}) )^t\]</div>
<p>where <span class="math notranslate nohighlight">\(H(V_{i})\)</span> is the vector of size 6 defined by <span class="math notranslate nohighlight">\([m11,m21,m22,m31,m32,m33]\)</span></p>
</li>
<li><dl>
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">loptions</span><span class="o">=</span></code> a vector of integer of size 13.</dt><dd><p>This vectors contains the integer options of FreeYams. (just for the expert)</p>
<ul class="simple">
<li><dl class="simple">
<dt>loptions(0): anisotropic parameter (default 0).</dt><dd><p>If you give an anisotropic metric 1 otherwise 0.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>loptions(1): Finite Element correction parameter (default 0).</dt><dd><p>1 for <em>no</em> Finite Element correction otherwise 0.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>loptions(2): Split multiple connected points parameter (default 1).</dt><dd><p>1 for splitting multiple connected points otherwise 0.</p>
</dd>
</dl>
</li>
<li><p>loptions(3): maximum value of memory size in Mbytes (default -1: the size is given by freeyams).</p></li>
<li><dl class="simple">
<dt>loptions(4): set the value of the connected component which we want to obtain.</dt><dd><p>(Remark: freeyams give an automatic value at each connected component).</p>
</dd>
</dl>
</li>
<li><p>loptions(5): level of verbosity</p></li>
<li><dl class="simple">
<dt>loptions(6): Create point on straight edge (no mapping) parameter (default 0).</dt><dd><p>1 for creating point on straight edge otherwise 0.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>loptions(7): validity check during smoothing parameter.</dt><dd><p>This parameter is only used with No-Shrinkage Vertex Smoothing optimization (optimization option parameter 9).
1 for No validity checking during smoothing otherwise 0.</p>
</dd>
</dl>
</li>
<li><p>loptions(8): number of desired’s vertices (default -1).</p></li>
<li><p>loptions(9): number of iteration of optimizations (default 30).</p></li>
<li><dl class="simple">
<dt>loptions(10): no detection parameter (default 0).</dt><dd><p>1 for detecting the ridge on the mesh otherwise 0.
The ridge definition is given in the parameter doptions(12).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>loptions(11): no vertex smoothing parameter (default 0).</dt><dd><p>1 for smoothing the vertices otherwise 0.</p>
</dd>
</dl>
</li>
<li><p>loptions(12): Optimization level parameter (default 0).</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>0 : mesh optimization (smoothing+swapping)</p></li>
<li><p>1 : decimation+enrichment adaptated to a metric map.</p></li>
<li><p>-1: decimation adaptated to a metric map.</p></li>
<li><p>2 : decimation+enrichment with a Hausdorff-like method</p></li>
<li><p>-2: decimation with a Hausdorff-like method</p></li>
<li><p>4 : split triangles recursively.</p></li>
<li><p>9 : No-Shrinkage Vertex Smoothing</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">doptions</span><span class="o">=</span></code> a vector of double of size 11.</dt><dd><p>This vectors contains the real options of freeyams.</p>
</dd>
</dl>
<ul class="simple">
<li><p>doptions(0): Set the geometric approximation (Tangent plane deviation) (default 0.01).</p></li>
<li><p>doptions(1): Set the lamda parameter (default -1).</p></li>
<li><p>doptions(2): Set the mu parmeter (default -1).</p></li>
<li><p>doptions(3): Set the gradation value (Mesh density control) (default 1.3).</p></li>
<li><p>doptions(4): Set the minimal size(hmin) (default -2.0: the size is automatically computed).</p></li>
<li><p>doptions(5): Set the maximal size(hmax) (default -2.0: the size is automatically computed).</p></li>
<li><p>doptions(6): Set the tolerance of the control of Chordal deviation (default -2.0).</p></li>
<li><p>doptions(7): Set the quality of degradation (default 0.599).</p></li>
<li><p>doptions(8): Set the declic parameter (default 2.0).</p></li>
<li><p>doptions(9): Set the angular walton limitation parameter (default 45 degree).</p></li>
<li><p>doptions(10): Set the angular ridge detection (default 45 degree).</p></li>
</ul>
</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>freeyams</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos"> 2</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="linenos"> 3</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">freeyams</span><span class="s">&quot;</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="c1">// Parameters</span>
<span class="linenos"> 6</span><span class="kt">int</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
<span class="linenos"> 7</span><span class="kt">real</span><span class="w"> </span><span class="n">zmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="kt">real</span><span class="w"> </span><span class="n">zmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1">// Mesh</span>
<span class="linenos">11</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="n">nn</span><span class="p">);</span>
<span class="linenos">12</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">rup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">rdown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="linenos">13</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">rmid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="linenos">14</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildlayers</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span><span class="w"> </span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="kp">zbound</span><span class="o">=</span><span class="p">[</span><span class="n">zmin</span><span class="p">,</span><span class="w"> </span><span class="n">zmax</span><span class="p">],</span><span class="w"> </span><span class="kp">reffacemid</span><span class="o">=</span><span class="n">rmid</span><span class="p">,</span><span class="w"> </span><span class="kp">reffaceup</span><span class="o">=</span><span class="n">rup</span><span class="p">,</span><span class="w"> </span><span class="kp">reffacelow</span><span class="o">=</span><span class="n">rdown</span><span class="p">);</span>
<span class="linenos">15</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">freeyams</span><span class="p">(</span><span class="n">Th</span><span class="p">);</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;SurfaceMesh&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Th3</span><span class="p">);</span>
</pre></div>
</div>
</div>
</section>
<section id="mmg3d">
<h2>mmg3d<a class="headerlink" href="#mmg3d" title="Link to this heading"></a></h2>
<div class="admonition-todo admonition" id="id30">
<p class="admonition-title">Todo</p>
<p>mmg3d-v4.0</p>
</div>
<p><a class="reference external" href="http://www.mmgtools.org">Mmg3d</a> is a 3D remeshing software developed by C. Dobrzynski and P. Frey.</p>
<p>This software allows to remesh an initial mesh made of tetrahedra.
This initial mesh is adapted to a geometric metric tensor field or to a displacement vector (moving rigid body).
The metric can be obtained with <a class="reference internal" href="#meshgenerationmshmet"><span class="std std-ref">mshmet</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>If no metric is given, an isotropic metric is computed by analyzing the size of the edges in the initial mesh.</p></li>
<li><p>If a displacement is given, the vertices of the surface triangles are moved without verifying the geometrical structure of the new surface mesh.</p></li>
</ul>
</div>
<p>The parameters of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mmg3d</span></code> are :</p>
<ul>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">options</span><span class="o">=</span></code> vector expression.</dt><dd><p>This vector contains the option parameters of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mmg3d</span></code>.
It is a vector of 6 values, with the following meaning:</p>
</dd>
</dl>
<ul>
<li><p>Optimization parameters : (default 1)</p>
<p>0 : mesh optimization.</p>
<p>1 : adaptation with metric (deletion and insertion vertices) and optimization.</p>
<p>-1 : adaptation with metric (deletion and insertion vertices) without optimization.</p>
<p>4 : split tetrahedra (be careful modify the surface).</p>
<p>9 : moving mesh with optimization.</p>
<p>-9 : moving mesh without optimization.</p>
</li>
<li><p>Debug mode : (default 0)</p>
<p>1 : turn on debug mode.</p>
<p>0 : otherwise.</p>
</li>
<li><p>Specify the size of bucket per dimension (default 64)</p></li>
<li><p>Swapping mode : (default 0)</p>
<p>1 : no edge or face flipping.</p>
<p>0 : otherwise.</p>
</li>
<li><p>Insert points mode : (default 0)</p>
<p>1 : no edge splitting or collapsing and no insert points.</p>
<p>0 : otherwise.</p>
</li>
</ul>
<ol class="arabic simple" start="5">
<li><p>Verbosity level (default 3)</p></li>
</ol>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">memory</span><span class="o">=</span></code> integer expression.</dt><dd><p>Set the maximum memory size of new mesh in Mbytes.
By default the number of maximum vertices, tetrahedra and triangles are respectively 500 000, 3000 000, 100000 which represent approximately a memory of 100 Mo.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">metric</span><span class="o">=</span></code> vector expression.</dt><dd><p>This vector contains the metric given at <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mmg3d</span></code>.
It is a vector of size <span class="math notranslate nohighlight">\(nv\)</span> or 6 <span class="math notranslate nohighlight">\(nv\)</span> respectively for an isotropic and anisotropic metric where <span class="math notranslate nohighlight">\(nv\)</span> is the number of vertices in the initial mesh.
The structure of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">metric</span></code> vector is described in the <a class="reference internal" href="#meshgenerationmshmet"><span class="std std-ref">mshmet</span></a>.</p>
</dd>
</dl>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">displacement</span><span class="o">=</span></code> <span class="math notranslate nohighlight">\([\Phi1, \Phi2, \Phi3]\)</span> set the displacement vector of the initial mesh <span class="math notranslate nohighlight">\(\mathbf{\Phi(x,y)} = [\Phi1(x,y), \Phi2(x,y), \Phi3(x,y)]\)</span>.</p></li>
<li><dl class="simple">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">displVect</span><span class="o">=</span></code> sets the vector displacement in a vector expression.</dt><dd><p>This vector contains the displacement at each point of the initial mesh.
It is a vector of size 3 <span class="math notranslate nohighlight">\(nv\)</span>.</p>
</dd>
</dl>
</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>mmg3d</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos"> 2</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="linenos"> 3</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">mmg3d</span><span class="s">&quot;</span>
<span class="linenos"> 4</span><span class="cp">include</span><span class="w"> </span><span class="s">&quot;Cube.idp&quot;</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="c1">// Parameters</span>
<span class="linenos"> 7</span><span class="kt">int</span><span class="w"> </span><span class="kr">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">Nxyz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">];</span>
<span class="linenos"> 9</span><span class="kt">real</span><span class="w"> </span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">Bxyz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">1.</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">1.</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">1.</span><span class="p">]];</span>
<span class="linenos">10</span><span class="kt">int</span><span class="w"> </span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">Lxyz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]];</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="c1">// Mesh</span>
<span class="linenos">13</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cube</span><span class="p">(</span><span class="n">Nxyz</span><span class="p">,</span><span class="w"> </span><span class="n">Bxyz</span><span class="p">,</span><span class="w"> </span><span class="n">Lxyz</span><span class="p">);</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">isometric</span><span class="p">(</span><span class="n">Th</span><span class="p">.</span><span class="kr">nv</span><span class="p">);</span>
<span class="linenos">16</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">nv</span><span class="p">;</span><span class="w"> </span><span class="n">ii</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">17</span><span class="w">    </span><span class="n">isometric</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.17</span><span class="p">;</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mmg3d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">memory</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="kp">metric</span><span class="o">=</span><span class="n">isometric</span><span class="p">);</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="c1">// Plot</span>
<span class="linenos">22</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Initial&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Th</span><span class="p">);</span>
<span class="linenos">23</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Isometric&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Th3</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Falling spheres</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos"> 2</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;TetGen&quot;</span>
<span class="linenos"> 3</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="linenos"> 4</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">mmg3d</span><span class="s">&quot;</span>
<span class="linenos"> 5</span><span class="cp">include</span><span class="w"> </span><span class="s">&quot;MeshSurface.idp&quot;</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1">// Parameters</span>
<span class="linenos"> 8</span><span class="kt">real</span><span class="w"> </span><span class="n">hs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.8</span><span class="p">;</span>
<span class="linenos"> 9</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="kr">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">4</span><span class="o">/</span><span class="n">hs</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="o">/</span><span class="n">hs</span><span class="p">,</span><span class="w"> </span><span class="mf">11.5</span><span class="o">/</span><span class="n">hs</span><span class="p">];</span>
<span class="linenos">10</span><span class="kt">real</span><span class="w"> </span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="kp">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">-10</span><span class="p">,</span><span class="w"> </span><span class="mf">1.5</span><span class="p">]];</span>
<span class="linenos">11</span><span class="kt">int</span><span class="w"> </span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="mi">311</span><span class="p">,</span><span class="w"> </span><span class="mi">311</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">311</span><span class="p">,</span><span class="w"> </span><span class="mi">311</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">311</span><span class="p">,</span><span class="w"> </span><span class="mi">311</span><span class="p">]];</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">];</span>
<span class="linenos">14</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">vit</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.3</span><span class="p">];</span>
<span class="linenos">15</span><span class="kt">func</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span>
<span class="linenos">16</span><span class="kt">func</span><span class="w"> </span><span class="n">dep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vit</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="c1">// Meshes</span>
<span class="linenos">19</span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SurfaceHex</span><span class="p">(</span><span class="kr">N</span><span class="p">,</span><span class="w"> </span><span class="kp">B</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">20</span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThSg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sphere</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">hs</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
<span class="linenos">21</span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThSd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sphere</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">hs</span><span class="p">,</span><span class="w"> </span><span class="mi">310</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
<span class="linenos">22</span><span class="n">ThSd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh</span><span class="p">(</span><span class="n">ThSd</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="o">+</span><span class="kr">y</span><span class="p">,</span><span class="w"> </span><span class="kr">z</span><span class="p">]);</span>
<span class="linenos">23</span><span class="kt">meshS</span><span class="w"> </span><span class="n">ThHS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ThH</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ThSg</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ThSd</span><span class="p">;</span>
<span class="linenos">24</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;ThHS&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ThHS</span><span class="p">);</span>
<span class="linenos">25</span>
<span class="linenos">26</span><span class="kt">real</span><span class="w"> </span><span class="n">voltet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">hs</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">6.</span><span class="p">;</span>
<span class="linenos">27</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">-4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">voltet</span><span class="p">];</span>
<span class="linenos">28</span><span class="kt">real</span><span class="w"> </span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">holes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span>
<span class="linenos">29</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">tetg</span><span class="p">(</span><span class="n">ThHS</span><span class="p">,</span><span class="w"> </span><span class="kp">switch</span><span class="o">=</span><span class="s">&quot;pqaAAYYQ&quot;</span><span class="p">,</span><span class="w"> </span><span class="kp">nbofregions</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">regionlist</span><span class="o">=</span><span class="n">domaine</span><span class="p">,</span><span class="w"> </span><span class="kp">nbofholes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="kp">holelist</span><span class="o">=</span><span class="n">holes</span><span class="p">);</span>
<span class="linenos">30</span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Box-With-two-Ball&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Th</span><span class="p">);</span>
<span class="linenos">31</span>
<span class="linenos">32</span><span class="c1">// Fespace</span>
<span class="linenos">33</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos">34</span><span class="n">Vh</span><span class="w"> </span><span class="n">uh</span><span class="p">,</span><span class="n">vh</span><span class="p">;</span>
<span class="linenos">35</span>
<span class="linenos">36</span><span class="c1">// Macro</span>
<span class="linenos">37</span><span class="kt">macro</span><span class="w"> </span><span class="n">Grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">),</span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">),</span><span class="nf">dz</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span>
<span class="linenos">38</span>
<span class="linenos">39</span><span class="c1">// Problem</span>
<span class="linenos">40</span><span class="kt">problem</span><span class="w"> </span><span class="n">Lap</span><span class="w"> </span><span class="p">(</span><span class="n">uh</span><span class="p">,</span><span class="w"> </span><span class="n">vh</span><span class="p">,</span><span class="w"> </span><span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">)</span>
<span class="linenos">41</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos">42</span><span class="w">        </span><span class="n">Grad</span><span class="p">(</span><span class="n">uh</span><span class="p">)</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Grad</span><span class="p">(</span><span class="n">vh</span><span class="p">)</span>
<span class="linenos">43</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">44</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">310</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="n">uh</span><span class="o">=</span><span class="n">dep</span><span class="p">)</span>
<span class="linenos">45</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">311</span><span class="p">,</span><span class="w"> </span><span class="n">uh</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
<span class="linenos">46</span><span class="w">    </span><span class="p">;</span>
<span class="linenos">47</span>
<span class="linenos">48</span><span class="c1">// Falling loop</span>
<span class="linenos">49</span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">29</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="o">++</span><span class="p">){</span>
<span class="linenos">50</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; ITERATION &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">51</span>
<span class="linenos">52</span><span class="w">    </span><span class="c1">// Solve</span>
<span class="linenos">53</span><span class="w">    </span><span class="n">Lap</span><span class="p">;</span>
<span class="linenos">54</span>
<span class="linenos">55</span><span class="w">    </span><span class="c1">// Plot</span>
<span class="linenos">56</span><span class="w">    </span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">uh</span><span class="p">);</span>
<span class="linenos">57</span>
<span class="linenos">58</span><span class="w">    </span><span class="c1">// Sphere falling</span>
<span class="linenos">59</span><span class="w">    </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mmg3d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">options</span><span class="o">=</span><span class="n">opt</span><span class="p">,</span><span class="w"> </span><span class="kp">displacement</span><span class="o">=</span><span class="p">[</span><span class="n">zero</span><span class="p">,</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="w"> </span><span class="n">uh</span><span class="p">],</span><span class="w"> </span><span class="kp">memory</span><span class="o">=</span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos">60</span><span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="a-first-3d-isotrope-mesh-adaptation-process">
<span id="meshfirstisotropemeshadaptation"></span><h2>A first 3d isotrope mesh adaptation process<a class="headerlink" href="#a-first-3d-isotrope-mesh-adaptation-process" title="Link to this heading"></a></h2>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Adaptation 3D</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;msh3&quot;</span>
<span class="linenos"> 2</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;TetGen&quot;</span>
<span class="linenos"> 3</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">mshmet</span><span class="s">&quot;</span>
<span class="linenos"> 4</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="c1">// Parameters</span>
<span class="linenos"> 7</span><span class="kt">int</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">l1111</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="c1">//labels</span>
<span class="linenos"> 9</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">l01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="linenos">10</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">l11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="kt">real</span><span class="w"> </span><span class="n">errm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-2</span><span class="p">;</span><span class="w"> </span><span class="c1">//level of error</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="c1">// Mesh</span>
<span class="linenos">15</span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildlayers</span><span class="p">(</span><span class="nf">square</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="kr">region</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">l1111</span><span class="p">),</span>
<span class="linenos">16</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="kp">zbound</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="kp">labelmid</span><span class="o">=</span><span class="n">l11</span><span class="p">,</span><span class="w"> </span><span class="kp">labelup</span><span class="o">=</span><span class="n">l01</span><span class="p">,</span><span class="w"> </span><span class="kp">labeldown</span><span class="o">=</span><span class="n">l01</span><span class="p">);</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="n">Th3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">trunc</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kr">x</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="kr">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="kr">z</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.5</span><span class="p">),</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">//remove the ]0.5,1[^3 cube</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="c1">// Fespace</span>
<span class="linenos">21</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos">22</span><span class="n">Vh</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">usol</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">;</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="c1">// Macro</span>
<span class="linenos">25</span><span class="kt">macro</span><span class="w"> </span><span class="n">Grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">),</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">),</span><span class="w"> </span><span class="nf">dz</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span><span class="w"> </span><span class="c1">// EOM</span>
<span class="linenos">26</span>
<span class="linenos">27</span><span class="c1">// Problem</span>
<span class="linenos">28</span><span class="kt">problem</span><span class="w"> </span><span class="n">Poisson</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">)</span>
<span class="linenos">29</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th3</span><span class="p">)(</span>
<span class="linenos">30</span><span class="w">        </span><span class="n">Grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Grad</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos">31</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">32</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th3</span><span class="p">)(</span>
<span class="linenos">33</span><span class="w">        </span><span class="mi">1</span><span class="o">*</span><span class="n">v</span>
<span class="linenos">34</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">35</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">36</span><span class="w">    </span><span class="p">;</span>
<span class="linenos">37</span>
<span class="linenos">38</span><span class="c1">// Loop</span>
<span class="linenos">39</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="n">ii</span><span class="o">++</span><span class="p">){</span>
<span class="linenos">40</span><span class="w">    </span><span class="c1">// Solve</span>
<span class="linenos">41</span><span class="w">    </span><span class="n">Poisson</span><span class="p">;</span>
<span class="linenos">42</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;u min, max = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">u</span><span class="p">[].</span><span class="kr">min</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">u</span><span class="p">[].</span><span class="kr">max</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">43</span>
<span class="linenos">44</span><span class="w">    </span><span class="n">h</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="c1">//for resizing h[] because the mesh change</span>
<span class="linenos">45</span><span class="w">    </span><span class="n">h</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mshmet</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kp">normalization</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">aniso</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="kp">nbregul</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">hmin</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span><span class="w"> </span><span class="kp">hmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="kp">err</span><span class="o">=</span><span class="n">errm</span><span class="p">);</span>
<span class="linenos">46</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;h min, max = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">h</span><span class="p">[].</span><span class="kr">min</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">h</span><span class="p">[].</span><span class="kr">max</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">h</span><span class="p">[].</span><span class="kr">n</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th3</span><span class="p">.</span><span class="kr">nv</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">47</span><span class="w">    </span><span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos">48</span>
<span class="linenos">49</span><span class="w">    </span><span class="n">errm</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="mf">0.8</span><span class="p">;</span><span class="w"> </span><span class="c1">//change the level of error</span>
<span class="linenos">50</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Th3 &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th3</span><span class="p">.</span><span class="kr">nv</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th3</span><span class="p">.</span><span class="kr">nt</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">51</span><span class="w">    </span><span class="n">Th3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">tetgreconstruction</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span><span class="w"> </span><span class="kp">switch</span><span class="o">=</span><span class="s">&quot;raAQ&quot;</span><span class="p">,</span><span class="w"> </span><span class="kp">sizeofvolume</span><span class="o">=</span><span class="n">h</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mf">6.</span><span class="p">);</span><span class="w"> </span><span class="c1">//rebuild mesh</span>
<span class="linenos">52</span><span class="w">    </span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;U-adap-iso-&quot;</span><span class="o">+</span><span class="n">ii</span><span class="p">,</span><span class="w"> </span><span class="n">Th3</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos">53</span><span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="build-a-2d-mesh-from-an-isoline">
<h2>Build a 2d mesh from an isoline<a class="headerlink" href="#build-a-2d-mesh-from-an-isoline" title="Link to this heading"></a></h2>
<p>The idea is to get the discretization of an isoline of fluid meshes, this tool can be useful to construct meshes from image.
First, we give an example of the isovalue meshes <span class="math notranslate nohighlight">\(0.2\)</span> of analytical function <span class="math notranslate nohighlight">\(\sqrt{(x-1/2)^2 +(y-1/2)^2}\)</span>, on unit square.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">isoline</span><span class="s">&quot;</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">xy</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">//to store the isoline points</span>
<span class="linenos"> 4</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="kr">be</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">//to store the begin, end couple of lines</span>
<span class="linenos"> 5</span><span class="p">{</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="linenos"> 7</span><span class="w">    </span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos"> 8</span><span class="w">    </span><span class="n">Vh</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">square</span><span class="p">(</span><span class="kr">x</span><span class="mf">-0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="kr">y</span><span class="mf">-0.5</span><span class="p">));</span>
<span class="linenos"> 9</span><span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="kp">iso</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.2</span><span class="w"> </span><span class="p">;</span>
<span class="linenos">10</span><span class="w">    </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="kp">viso</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="kp">iso</span><span class="p">];</span>
<span class="linenos">11</span><span class="w">    </span><span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kp">viso</span><span class="o">=</span><span class="kp">viso</span><span class="p">,</span><span class="n">Th</span><span class="p">);</span><span class="c1">//to see the iso line</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nbc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">isoline</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">xy</span><span class="p">,</span><span class="w"> </span><span class="kp">close</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">iso</span><span class="o">=</span><span class="kp">iso</span><span class="p">,</span><span class="w"> </span><span class="kp">beginend</span><span class="o">=</span><span class="kr">be</span><span class="p">,</span><span class="w"> </span><span class="kp">smoothing</span><span class="o">=</span><span class="mf">0.1</span><span class="p">);</span>
</pre></div>
</div>
<p>The <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">isoline</span></code> parameters are <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code> the mesh, the expression <span class="math notranslate nohighlight">\(u\)</span>, the bidimentionnal array <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">xy</span></code> to store the list coordinate of the points.
The list of named parameter are :</p>
<ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">iso</span><span class="o">=</span></code> value of the isoline to compute (0 is the default value)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">close</span><span class="o">=</span></code> close the isoline with the border (default <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">true</span></code>), we add the part of the mesh border such the value is less than the isovalue</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">smoothing</span><span class="o">=</span></code> number of smoothing process is the <span class="math notranslate nohighlight">\({l} ^{r} {s}\)</span> where <span class="math notranslate nohighlight">\(l\)</span> is the length of the current line component, <span class="math notranslate nohighlight">\(r\)</span> the ratio, <span class="math notranslate nohighlight">\(s\)</span> is smoothing value. The smoothing default value is 0.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ratio</span><span class="o">=</span></code> the ratio (1 by default).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">eps</span><span class="o">=</span></code> relative <span class="math notranslate nohighlight">\(\varepsilon\)</span> (default 1e-10)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">beginend</span><span class="o">=</span></code> array to get begin, end couple of each of sub line (resize automatically)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">file</span><span class="o">=</span></code> to save the data curve in data file for gnuplot</p></li>
</ul>
<p>In the array <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">xy</span></code> you get the list of vertices of the isoline, each connex line go from <span class="math notranslate nohighlight">\(i= i_0^c ,\dots, i_1^c-1\)</span> with <span class="math notranslate nohighlight">\(i_0^c =be(2*c)\)</span> <span class="math notranslate nohighlight">\(i_1^c =be(2*c+1)\)</span>, and where <span class="math notranslate nohighlight">\(x_i= xy(0,i), y_i=yx( 1,i), l_i=xy(2,i)\)</span>.</p>
<p>Here <span class="math notranslate nohighlight">\(l_i\)</span> is the length of the line (the origin of the line is point <span class="math notranslate nohighlight">\(i_0^c\)</span>).</p>
<p>The sense of the isoline is such that the upper part is at the left size of the isoline.
So here : the minimum is a point <span class="math notranslate nohighlight">\(0.5,05\)</span> so the curve 1 turn in the clockwise sense, the order of each component are sort such that the number of point by component is decreasing.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="w">      </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Number of the line component = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">nbc</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 2</span><span class="w">      </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Number of points = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">xy</span><span class="p">.</span><span class="kr">m</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 3</span><span class="w">      </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;be = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">be</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="w">      </span><span class="c1">// shows the lines component</span>
<span class="linenos"> 6</span><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nbc</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">c</span><span class="p">){</span>
<span class="linenos"> 7</span><span class="w">         </span><span class="kt">int</span><span class="w"> </span><span class="n">i0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">be</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">],</span><span class="w"> </span><span class="n">i1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">be</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="mi">-1</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="w">         </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Curve &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 9</span><span class="w">         </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">i1</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="linenos">10</span><span class="w">            </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;x= &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">xy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; y= &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">xy</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; s= &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">xy</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">11</span><span class="w">         </span><span class="nf">plot</span><span class="p">([</span><span class="n">xy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">i0</span><span class="o">:</span><span class="n">i1</span><span class="p">),</span><span class="w"> </span><span class="n">xy</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i0</span><span class="o">:</span><span class="n">i1</span><span class="p">)],</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="kp">viso</span><span class="o">=</span><span class="kp">viso</span><span class="p">,</span><span class="w"> </span><span class="kp">cmm</span><span class="o">=</span><span class="s">&quot; curve &quot;</span><span class="o">+</span><span class="n">c</span><span class="p">);</span>
<span class="linenos">12</span><span class="w">   </span><span class="p">}</span>
<span class="linenos">13</span><span class="p">}</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;length of last curve = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">xy</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">xy</span><span class="p">.</span><span class="kr">m</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>We also have a new function to easily parametrize a discrete curve defined by the couple <span class="math notranslate nohighlight">\(be, xy\)</span>.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">border</span><span class="w"> </span><span class="nf">Curve0</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span>
<span class="linenos"> 2</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">//component 0</span>
<span class="linenos"> 3</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i0</span><span class="o">=</span><span class="kr">be</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">],</span><span class="w"> </span><span class="n">i1</span><span class="o">=</span><span class="kr">be</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="mi">-1</span><span class="p">;</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="kr">P</span><span class="o">=</span><span class="n">Curve</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span><span class="w"> </span><span class="n">i0</span><span class="p">,</span><span class="w"> </span><span class="n">i1</span><span class="p">,</span><span class="w"> </span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="c1">//Curve 0</span>
<span class="linenos"> 5</span><span class="w">    </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="linenos"> 6</span><span class="p">}</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="kt">border</span><span class="w"> </span><span class="nf">Curve1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span>
<span class="linenos"> 9</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">//component 1</span>
<span class="linenos">10</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i0</span><span class="o">=</span><span class="kr">be</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">],</span><span class="w"> </span><span class="n">i1</span><span class="o">=</span><span class="kr">be</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="mi">-1</span><span class="p">;</span>
<span class="linenos">11</span><span class="w">    </span><span class="kr">P</span><span class="o">=</span><span class="n">Curve</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span><span class="w"> </span><span class="n">i0</span><span class="p">,</span><span class="w"> </span><span class="n">i1</span><span class="p">,</span><span class="w"> </span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="c1">//Curve 1</span>
<span class="linenos">12</span><span class="w">    </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="linenos">13</span><span class="p">}</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="nf">plot</span><span class="p">(</span><span class="n">Curve1</span><span class="p">(</span><span class="mi">100</span><span class="p">));</span><span class="w"> </span><span class="c1">//show curve</span>
<span class="linenos">16</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">Curve1</span><span class="p">(</span><span class="mi">-100</span><span class="p">));</span>
<span class="linenos">17</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</div>
<p>Secondly, we use this idea to build meshes from an image, we use the plugins <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ppm2rnm</span></code> to read <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">pgm</span></code> a gray scale image and then we extract the gray contour at level 0.25.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Leman lake</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;ppm2rnm&quot;</span>
<span class="linenos"> 2</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;</span><span class="nf">isoline</span><span class="s">&quot;</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1">// Parameters</span>
<span class="linenos"> 5</span><span class="kt">string</span><span class="w"> </span><span class="n">leman</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;LemanLake.pgm&quot;</span><span class="p">;</span>
<span class="linenos"> 6</span><span class="kt">real</span><span class="w"> </span><span class="n">AreaLac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">580.03</span><span class="p">;</span><span class="w"> </span><span class="c1">//in km^2</span>
<span class="linenos"> 7</span><span class="kt">real</span><span class="w"> </span><span class="n">hsize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">Curves</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="linenos"> 9</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="kr">be</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">10</span><span class="kt">int</span><span class="w"> </span><span class="n">nc</span><span class="p">;</span><span class="w"> </span><span class="c1">//nb of curve</span>
<span class="linenos">11</span><span class="p">{</span>
<span class="linenos">12</span><span class="w">    </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">ff1</span><span class="p">(</span><span class="n">leman</span><span class="p">);</span><span class="w"> </span><span class="c1">//read image</span>
<span class="linenos">13</span><span class="w">    </span><span class="c1">//and set it in a rect. array</span>
<span class="linenos">14</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ff1</span><span class="p">.</span><span class="kr">n</span><span class="p">,</span><span class="w"> </span><span class="n">ny</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ff1</span><span class="p">.</span><span class="kr">m</span><span class="p">;</span>
<span class="linenos">15</span><span class="w">    </span><span class="c1">//build a Cartesian mesh such that the origin is in the right place.</span>
<span class="linenos">16</span><span class="w">    </span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">nx</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="n">ny</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="p">[(</span><span class="n">nx</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="kr">x</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="n">ny</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kr">y</span><span class="p">)]);</span>
<span class="linenos">17</span><span class="w">    </span><span class="c1">//warning the numbering of the vertices (x,y) is</span>
<span class="linenos">18</span><span class="w">    </span><span class="c1">//given by $i = x/nx + nx* y/ny $</span>
<span class="linenos">19</span><span class="w">    </span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos">20</span><span class="w">    </span><span class="n">Vh</span><span class="w"> </span><span class="n">f1</span><span class="p">;</span>
<span class="linenos">21</span><span class="w">    </span><span class="n">f1</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ff1</span><span class="p">;</span><span class="w"> </span><span class="c1">//transform array in finite element functions.</span>
<span class="linenos">22</span><span class="w">    </span><span class="n">nc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">isoline</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">f1</span><span class="p">,</span><span class="w"> </span><span class="kp">iso</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span><span class="w"> </span><span class="kp">close</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Curves</span><span class="p">,</span><span class="w"> </span><span class="kp">beginend</span><span class="o">=</span><span class="kr">be</span><span class="p">,</span><span class="w"> </span><span class="kp">smoothing</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span><span class="w"> </span><span class="kp">ratio</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span>
<span class="linenos">23</span><span class="p">}</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="c1">//The longest isoline: the lake</span>
<span class="linenos">26</span><span class="kt">int</span><span class="w"> </span><span class="n">ic0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">be</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">ic1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">be</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="mi">-1</span><span class="p">;</span>
<span class="linenos">27</span><span class="nf">plot</span><span class="p">([</span><span class="n">Curves</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">ic0</span><span class="o">:</span><span class="n">ic1</span><span class="p">),</span><span class="w"> </span><span class="n">Curves</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ic0</span><span class="o">:</span><span class="n">ic1</span><span class="p">)],</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos">28</span>
<span class="linenos">29</span><span class="kt">int</span><span class="w"> </span><span class="n">NC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Curves</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">ic1</span><span class="p">)</span><span class="o">/</span><span class="n">hsize</span><span class="p">;</span>
<span class="linenos">30</span><span class="kt">real</span><span class="w"> </span><span class="n">xl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Curves</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">ic0</span><span class="o">:</span><span class="n">ic1</span><span class="p">).</span><span class="kr">max</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="linenos">31</span><span class="kt">real</span><span class="w"> </span><span class="n">yl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Curves</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ic0</span><span class="o">:</span><span class="n">ic1</span><span class="p">).</span><span class="kr">min</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="linenos">32</span><span class="kt">border</span><span class="w"> </span><span class="nf">G</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">P</span><span class="o">=</span><span class="n">Curve</span><span class="p">(</span><span class="n">Curves</span><span class="p">,</span><span class="w"> </span><span class="n">ic0</span><span class="p">,</span><span class="w"> </span><span class="n">ic1</span><span class="p">,</span><span class="w"> </span><span class="kp">t</span><span class="p">);</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="kr">x</span><span class="o">&gt;</span><span class="n">xl</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="kr">y</span><span class="o">&lt;</span><span class="n">yl</span><span class="p">);}</span>
<span class="linenos">33</span><span class="nf">plot</span><span class="p">(</span><span class="n">G</span><span class="p">(</span><span class="o">-</span><span class="n">NC</span><span class="p">),</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos">34</span>
<span class="linenos">35</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">G</span><span class="p">(</span><span class="o">-</span><span class="n">NC</span><span class="p">));</span>
<span class="linenos">36</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos">37</span>
<span class="linenos">38</span><span class="kt">real</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">AreaLac</span><span class="o">/</span><span class="n">Th</span><span class="p">.</span><span class="kr">area</span><span class="p">);</span>
<span class="linenos">39</span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">movemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kr">x</span><span class="o">*</span><span class="n">scale</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="o">*</span><span class="n">scale</span><span class="p">]);</span>
<span class="linenos">40</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Th.area = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Th</span><span class="p">.</span><span class="kr">area</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; Km^2 &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; == &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">AreaLac</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; Km^2 &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">41</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;leman.eps&quot;</span><span class="p">);</span>
</pre></div>
</div>
<div class="figure compound align-center" id="Isoline">
<figure class="align-default" id="id52">
<span id="meshgenerationisoline1"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Isoline1.jpg"><img alt="MeshGeneration_Isoline1" src="../_images/MeshGeneration_Isoline1.jpg" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 96 </span><span class="caption-text">The image of the Leman lake meshes</span><a class="headerlink" href="#id52" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id53">
<span id="meshgenerationisoline2"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Isoline2.png"><img alt="MeshGeneration_Isoline2" src="../_images/MeshGeneration_Isoline2.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 97 </span><span class="caption-text">The mesh of the lake</span><a class="headerlink" href="#id53" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><span class="caption-text">Isoline</span></p>
<span class="target" id="Isoline"></span></div></div>
</section>
</section>


			<div class="content-nav-buttons" role="navigation">
				<a href="notations.html" class="btn-neutral" title="previous topic" rel="previous"><span class="fa fa-arrow-circle-left"></span> Previous topic: Notations</a>
				<a href="finite-element.html" class="btn-neutral" title="next topic" rel="next">Next topic: Finite element <span class="fa fa-arrow-circle-right"></span></a>
			</div>
		</div>
	</div>
	
	<div id="toc">
	<div id="toc-doc">
		<b>Table of content</b>
		<ul>
<li><a class="reference internal" href="#">Mesh Generation</a><ul>
<li><a class="reference internal" href="#the-type-mesh-in-2-dimension"><strong>The type mesh in 2 dimension</strong></a><ul>
<li><a class="reference internal" href="#commands-for-2d-mesh-generation">Commands for 2d mesh Generation</a><ul>
<li><a class="reference internal" href="#the-command-square">The command <em>square</em></a></li>
<li><a class="reference internal" href="#the-command-buildmesh">The command <em>buildmesh</em></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mesh-connectivity-and-data">Mesh Connectivity and data</a></li>
<li><a class="reference internal" href="#the-keyword-triangulate">The keyword “triangulate”</a></li>
<li><a class="reference internal" href="#d-finite-element-space-on-a-boundary">2d Finite Element space on a boundary</a></li>
<li><a class="reference internal" href="#remeshing">Remeshing</a><ul>
<li><a class="reference internal" href="#the-command-movemesh">The command <em>movemesh</em></a></li>
<li><a class="reference internal" href="#the-command-htriangle">The command <em>hTriangle</em></a></li>
<li><a class="reference internal" href="#the-command-adaptmesh">The command <em>adaptmesh</em></a></li>
<li><a class="reference internal" href="#the-command-trunc">The command <em>trunc</em></a></li>
<li><a class="reference internal" href="#the-command-change">The command <em>change</em></a></li>
<li><a class="reference internal" href="#the-command-splitmesh">The command <em>splitmesh</em></a></li>
</ul>
</li>
<li><a class="reference internal" href="#meshing-examples">Meshing Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-type-mesh3-in-3-dimension"><strong>The type mesh3 in 3 dimension</strong></a><ul>
<li><a class="reference internal" href="#d-mesh-generation">3d mesh generation</a><ul>
<li><a class="reference internal" href="#the-command-cube">The command <em>cube</em></a></li>
<li><a class="reference internal" href="#the-command-buildlayers">The command <em>buildlayers</em></a></li>
</ul>
</li>
<li><a class="reference internal" href="#id3">Remeshing</a><ul>
<li><a class="reference internal" href="#id4">The command <em>change</em></a></li>
<li><a class="reference internal" href="#meshgenerationtrunc">The command <em>trunc</em></a></li>
<li><a class="reference internal" href="#id6">The command <em>movemesh</em></a></li>
<li><a class="reference internal" href="#the-command-extract">The command <em>extract</em></a></li>
<li><a class="reference internal" href="#the-command-buildsurface">The command <em>buildSurface</em></a></li>
<li><a class="reference internal" href="#the-command-movemesh23">The command <em>movemesh23</em></a></li>
</ul>
</li>
<li><a class="reference internal" href="#d-meshing-examples">3d Meshing examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-type-meshs-in-3-dimension"><strong>The type meshS in 3 dimension</strong></a><ul>
<li><a class="reference internal" href="#commands-for-3d-surface-mesh-generation">Commands for 3d surface mesh generation</a><ul>
<li><a class="reference internal" href="#the-command-square3">The command <em>square3</em></a></li>
<li><a class="reference internal" href="#surface-mesh-builders">surface mesh builders</a></li>
<li><a class="reference internal" href="#d-mesh-generators-combined-with-movemesh23">2D mesh generators combined with  <em>movemesh23</em></a></li>
</ul>
</li>
<li><a class="reference internal" href="#id7">Remeshing</a><ul>
<li><a class="reference internal" href="#id8">The command <em>trunc</em></a></li>
<li><a class="reference internal" href="#id9">The command <em>movemesh</em></a></li>
<li><a class="reference internal" href="#id10">The command <em>change</em></a></li>
</ul>
</li>
<li><a class="reference internal" href="#link-with-a-mesh3">Link with a mesh3</a><ul>
<li><a class="reference internal" href="#the-command-gamma">The command <em>Gamma</em></a></li>
<li><a class="reference internal" href="#the-command-buildbdmesh">The command <em>buildBdMesh</em></a></li>
<li><a class="reference internal" href="#the-command-savesurfacemesh">The command <em>savesurfacemesh</em></a></li>
<li><a class="reference internal" href="#glue-of-meshs-meshes">Glue of meshS meshes</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#the-type-meshl-in-3-dimension"><strong>The type meshL in 3 dimension</strong></a><ul>
<li><a class="reference internal" href="#commands-for-3d-curve-mesh-generation">Commands for 3d curve mesh generation</a><ul>
<li><a class="reference internal" href="#the-command-segment">The command <em>segment</em></a></li>
<li><a class="reference internal" href="#id11">The command <em>buildmesh</em></a></li>
</ul>
</li>
<li><a class="reference internal" href="#id12">Remeshing</a><ul>
<li><a class="reference internal" href="#id13">The command <em>trunc</em></a></li>
<li><a class="reference internal" href="#id14">The command <em>movemesh</em></a></li>
<li><a class="reference internal" href="#id15">The command <em>change</em></a></li>
<li><a class="reference internal" href="#the-commands-buildbdmesh-and-gamma">The commands <em>buildBdMesh</em> and <em>Gamma</em></a></li>
<li><a class="reference internal" href="#glue-of-meshl-meshes">Glue of meshL meshes</a></li>
<li><a class="reference internal" href="#id16">The command extract</a></li>
<li><a class="reference internal" href="#the-commands-rebuildborder">The commands <em>rebuildBorder</em></a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-commands-checkmesh">The commands <em>checkmesh</em></a></li>
<li><a class="reference internal" href="#tetgen-a-tetrahedral-mesh-generator">TetGen: A tetrahedral mesh generator</a></li>
<li><a class="reference internal" href="#reconstruct-refine-a-3d-mesh-with-tetgen">Reconstruct/Refine a 3d mesh with TetGen</a></li>
</ul>
</li>
<li><a class="reference internal" href="#read-write-statements-for-meshes">Read/Write Statements for meshes</a><ul>
<li><a class="reference internal" href="#d-case">2d case</a><ul>
<li><a class="reference internal" href="#format-of-mesh-data">format of  mesh data</a></li>
<li><a class="reference internal" href="#input-output-for-a-mesh">Input/output for a mesh</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id27">3d case</a><ul>
<li><a class="reference internal" href="#id28">format of  mesh data</a></li>
<li><a class="reference internal" href="#input-output-for-a-mesh3">Input/output for a mesh3</a></li>
</ul>
</li>
<li><a class="reference internal" href="#surface-3d-case">Surface 3d case</a><ul>
<li><a class="reference internal" href="#id29">format of  mesh data</a></li>
<li><a class="reference internal" href="#input-output-for-a-meshs">Input/output for a meshS</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#medit">Medit</a></li>
<li><a class="reference internal" href="#mshmet">Mshmet</a></li>
<li><a class="reference internal" href="#freeyams">FreeYams</a></li>
<li><a class="reference internal" href="#mmg3d">mmg3d</a></li>
<li><a class="reference internal" href="#a-first-3d-isotrope-mesh-adaptation-process">A first 3d isotrope mesh adaptation process</a></li>
<li><a class="reference internal" href="#build-a-2d-mesh-from-an-isoline">Build a 2d mesh from an isoline</a></li>
</ul>
</li>
</ul>

	</div>
	<div id="exampleLinks" style="display: none">
		<div id="linksContainer">
		</div>
	</div>
</div>
	<footer>
	<p>
		Coded with <i class="fas fa-heart"></i> since 1987
	</p>
	<a href="https://freefem.org" target="_blank"><img src='../_static/img/Symbole.svg' alt="FreeFEM logo"/></a>
	<div>
		<a id="lgpl" href="https://www.gnu.org/licenses/lgpl-3.0.txt" target="_blank">LGPL 3.0</a>
		<a href="http://doc.freefem.org/introduction/citation.html" target="_blank">BibTeX</a>
	</div>
</footer>
	

	<!-- Common -->
	<script async src="../_static/js/common.js"></script>
	<!-- Nav -->
	<script async src="../_static/js/nav.js"></script>
	<!-- Subnav -->
	<script async src="../_static/js/subnav.js"></script>
	<!-- MathJax -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
	<!-- Treejs -->
	<script src="../_static/js/tree.min.js"></script>
	<!-- CodeMirror -->
	<script src="../_static/js/codemirror.js"></script>
	<script src="../_static/js/runmode.js"></script>
	<script src="../_static/js/searchcursor.js"></script>
	<script src="../_static/js/mode/freefem/freefem.js"></script>
	<!-- Github -->
	<script async src="../_static/js/github.js"></script>
	<!-- Search -->
	<script src="../_static/js/examples.js"></script>
	<script src="../_static/js/mathjax-config.js"></script>
	<script src="../_static/js/lunr.js"></script>
	<script src="../_static/lunr/lunr_index.js"></script>
	<script src="../_static/lunr/lunr_index_edps.js"></script>
	<script src="../_static/js/search.js"></script>
	<script>
		initSearch('../')
	</script>
</body>

</html>