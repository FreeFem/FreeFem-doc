<!DOCTYPE html>

<html lang="en">

<head>
	  <meta charset="UTF-8">
  <title>Finite element</title>
  <link rel="icon" href="../_static/img/Symbol.png" />

  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />

  <!-- Google font -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700,900" rel="stylesheet">

  <!-- FreeFEM theme specific -->
  <link rel="stylesheet" type="text/css" href="../_static/css/freefemtheme.css" />

  <!-- css -->
  <link rel="stylesheet" href="../_static/css/pygments_custom.css" type="text/css" />

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
</head>

<body>
	<header>
   <a class="header-logo" href="../introduction/index.html">
      <img alt="logo" title="FreeFEM documentation" src="../_static/img/FreeFem_Documentation_Logo_bleu.svg" />
   </a>

   <a class="header-github" href="https://github.com/FreeFem/FreeFem-doc" target="_blank">
      <i class="fab fa-github"></i>
      <p class="header-github-title" >
         FreeFEM Documentation on GitHub
      </p>

      <p class="header-github-stars" id="headerGithubStarsForks">
         <span id="headerGithubStars"></span> stars - <span id="headerGithubForks"></span> forks
      </p>
   </a>
</header>
	
	<nav id="nav">
	<div style="display: none;">
		<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html"><strong>Introduction</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/new-features.html">Version 4.5: new features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#release-binaries-packages">Release, binaries packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#new-meshes-and-fem-border">New meshes and FEM border</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/new-features.html#boundary-element-method">Boundary Element Method</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/new-features.html#version-4-6-new-features">Version 4.6: new features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/new-features.html#version-4-7-new-features">Version 4.7: new features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/new-features.html#version-4-7-1-new-features">Version 4.7-1: new features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/new-features.html#version-4-8-new-features">Version 4.8: new features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/new-features.html#version-4-9-new-features">Version 4.9: new features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/new-features.html#version-4-10-new-features">Version 4.10: new features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/new-features.html#version-4-11-new-features-4-apr-2022">Version 4.11: new features (4 apr 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/installation.html">Installation guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#using-binary-package">Using binary package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#windows-installation">Windows installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#macos-x-installation">macOS X installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#ubuntu-installation">Ubuntu installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#arch-aur-package">Arch AUR package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#fedora-installation">Fedora installation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#compiling-source-code">Compiling source code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-osx-10-13">Compilation on OSX (&gt;=10.13)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-ubuntu">Compilation on Ubuntu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-arch-linux">Compilation on Arch Linux</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-fedora">Compilation on Fedora</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-linux-with-intel-software-tools">Compilation on Linux with Intel software tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-windows">Compilation on Windows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#freefem-continuous-integration"><strong>FreeFEM</strong> continuous integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#environment-variables-and-init-file">Environment variables and init file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#coloring-syntax-freefem">Coloring Syntax FreeFem++</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#atom">Atom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#gedit">Gedit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#textmate-2-an-editor-under-macos">Textmate 2, an editor under macOS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#notepad-an-editor-under-windows">Notepad++,an editor under windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#emacs-editor">Emacs editor</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/download.html">Download</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/download.html#latest-binary-packages">Latest binary packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/download.html#syntax-highlighters">Syntax highlighters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/history.html">History</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/citation.html">Citation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/citation.html#if-you-use-freefem-please-cite-the-following-reference-in-your-work">If you use <strong>FreeFEM</strong>, please cite the following reference in your work:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#bibtex">BibTeX</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#apa">APA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#iso690">ISO690</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#mla">MLA</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/authors.html">Authors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/contributing.html">Contributing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/contributing.html#bug-report">Bug report</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/contributing.html#concerning-the-freefem-documentation">Concerning the <strong>FreeFEM</strong> documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/contributing.html#concerning-the-freefem-compilation-or-usage">Concerning the <strong>FreeFEM</strong> compilation or usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/contributing.html#improve-content">Improve content</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/git-github.html">Git &amp; Github usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/git-github.html#contribution-timeline">Contribution timeline</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Learning by Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/poisson.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/equationsClassification.html">Classification of partial differential equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/membrane.html">Membrane</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/heatExchanger.html">Heat Exchanger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/acoustics.html">Acoustics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/thermalConduction.html">Thermal Conduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/thermalConduction.html#axisymmetry-3d-rod-with-circular-section">Axisymmetry: 3D Rod with circular section</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/thermalConduction.html#a-nonlinear-problem-radiation">A Nonlinear Problem : Radiation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/fanBlade.html">Irrotational Fan Blade Flow and Thermal effects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/fanBlade.html#heat-convection-around-the-airfoil">Heat Convection around the airfoil</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/rotatingHill.html">Pure Convection : The Rotating Hill</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/rotatingHill.html#solution-by-a-characteristics-galerkin-method">Solution by a Characteristics-Galerkin Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/rotatingHill.html#solution-by-discontinuous-galerkin-fem">Solution by Discontinuous-Galerkin FEM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/elasticity.html">The System of elasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/stokes.html">The System of Stokes for Fluids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/navierStokesProjection.html">A projection algorithm for the Navier-Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/navierStokesNewton.html">Newton Method for the Steady Navier-Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/aLargeFluidProblem.html">A Large Fluid Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/complexNumbers.html">An Example with Complex Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/optimalControl.html">Optimal Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/flowWithShocks.html">A Flow with Shocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/heatEquationOptimization.html">Time dependent schema optimization for heat equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/timeDependentStokes.html">Tutorial to write a transient Stokes solver in matrix form</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/wifiPropagation.html">Wifi Propagation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/wifiPropagation.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/wifiPropagation.html#physics">Physics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/wifiPropagation.html#coding">Coding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/wifiPropagation.html#the-domain">The domain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/wifiPropagation.html#lets-create-a-mesh">Let’s create a mesh</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/matlabOctavePlot.html">Plotting in Matlab and Octave</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#d-problem">2D Problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#exporting-data">Exporting Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#importing-data">Importing Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#d-plot-examples">2D Plot Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#id1">3D Plot Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/matlabOctavePlot.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="notations.html">Notations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="notations.html#generalities">Generalities</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#sets-mappings-matrices-vectors">Sets, Mappings, Matrices, Vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#numbers">Numbers</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#differential-calculus">Differential Calculus</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#meshes">Meshes</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#functional-spaces">Functional Spaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#finite-element-spaces">Finite Element Spaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mesh-generation.html">Mesh Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#the-type-mesh-in-2-dimension"><strong>The type mesh in 2 dimension</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#commands-for-2d-mesh-generation">Commands for 2d mesh Generation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-square">The command <em>square</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-buildmesh">The command <em>buildmesh</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#mesh-connectivity-and-data">Mesh Connectivity and data</a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#the-keyword-triangulate">The keyword “triangulate”</a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#d-finite-element-space-on-a-boundary">2d Finite Element space on a boundary</a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#remeshing">Remeshing</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-movemesh">The command <em>movemesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-htriangle">The command <em>hTriangle</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-adaptmesh">The command <em>adaptmesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-trunc">The command <em>trunc</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-change">The command <em>change</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-splitmesh">The command <em>splitmesh</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#meshing-examples">Meshing Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#the-type-mesh3-in-3-dimension"><strong>The type mesh3 in 3 dimension</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#d-mesh-generation">3d mesh generation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-cube">The command <em>cube</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-buildlayers">The command <em>buildlayers</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#id3">Remeshing</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id4">The command <em>change</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#meshgenerationtrunc">The command <em>trunc</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id6">The command <em>movemesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-extract">The command <em>extract</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-buildsurface">The command <em>buildSurface</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-movemesh23">The command <em>movemesh23</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#d-meshing-examples">3d Meshing examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#the-type-meshs-in-3-dimension"><strong>The type meshS in 3 dimension</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#commands-for-3d-surface-mesh-generation">Commands for 3d surface mesh generation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-square3">The command <em>square3</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#surface-mesh-builders">surface mesh builders</a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#d-mesh-generators-combined-with-movemesh23">2D mesh generators combined with  <em>movemesh23</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#id7">Remeshing</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id8">The command <em>trunc</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id9">The command <em>movemesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id10">The command <em>change</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#link-with-a-mesh3">Link with a mesh3</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-gamma">The command <em>Gamma</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-buildbdmesh">The command <em>buildBdMesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-savesurfacemesh">The command <em>savesurfacemesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#glue-of-meshs-meshes">Glue of meshS meshes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#the-type-meshl-in-3-dimension"><strong>The type meshL in 3 dimension</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#commands-for-3d-curve-mesh-generation">Commands for 3d curve mesh generation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-command-segment">The command <em>segment</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id11">The command <em>buildmesh</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#id12">Remeshing</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id13">The command <em>trunc</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id14">The command <em>movemesh</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id15">The command <em>change</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-commands-buildbdmesh-and-gamma">The commands <em>buildBdMesh</em> and <em>Gamma</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#glue-of-meshl-meshes">Glue of meshL meshes</a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id16">The command extract</a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#the-commands-rebuildborder">The commands <em>rebuildBorder</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#the-commands-checkmesh">The commands <em>checkmesh</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#tetgen-a-tetrahedral-mesh-generator">TetGen: A tetrahedral mesh generator</a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#reconstruct-refine-a-3d-mesh-with-tetgen">Reconstruct/Refine a 3d mesh with TetGen</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#read-write-statements-for-meshes">Read/Write Statements for meshes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#d-case">2d case</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#format-of-mesh-data">format of  mesh data</a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#input-output-for-a-mesh">Input/output for a mesh</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#id27">3d case</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id28">format of  mesh data</a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#input-output-for-a-mesh3">Input/output for a mesh3</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="mesh-generation.html#surface-3d-case">Surface 3d case</a><ul>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#id29">format of  mesh data</a></li>
<li class="toctree-l5"><a class="reference internal" href="mesh-generation.html#input-output-for-a-meshs">Input/output for a meshS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#medit">Medit</a></li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#mshmet">Mshmet</a></li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#freeyams">FreeYams</a></li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#mmg3d">mmg3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#a-first-3d-isotrope-mesh-adaptation-process">A first 3d isotrope mesh adaptation process</a></li>
<li class="toctree-l3"><a class="reference internal" href="mesh-generation.html#build-a-2d-mesh-from-an-isoline">Build a 2d mesh from an isoline</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Finite element</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#list-of-the-types-of-finite-elements">List of the types of finite elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-of-fespace-in-2d">Use of fespace in 2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-of-fespace-in-3d">Use of fespace in 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-of-fespace-in-surface-3d">Use of fespace in surface 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="#finite-element-functions">Finite Element functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lagrangian-finite-elements">Lagrangian Finite Elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#p0-element">P0-element</a></li>
<li class="toctree-l4"><a class="reference internal" href="#p1-element">P1-element</a></li>
<li class="toctree-l4"><a class="reference internal" href="#p2-element">P2-element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#surface-lagrangian-finite-elements">Surface Lagrangian Finite Elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#definition-of-the-surface-p1-lagragian-element">Definition of the surface P1 Lagragian element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#p1-nonconforming-element">P1 Nonconforming Element</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-fe-space">Other FE-space</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vector-valued-fe-function">Vector Valued FE-function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#raviart-thomas-element">Raviart-Thomas Element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#a-fast-finite-element-interpolator">A Fast Finite Element Interpolator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#keywords-problem-and-solve">Keywords: Problem and Solve</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#weak-form-and-boundary-condition">Weak Form and Boundary Condition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#parameters-affecting-solve-and-problem">Parameters affecting solve and problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="#problem-definition">Problem definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#numerical-integration">Numerical Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#variational-form-sparse-matrix-pde-data-vector">Variational Form, Sparse Matrix, PDE Data Vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interpolation-matrix">Interpolation matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#finite-elements-connectivity">Finite elements connectivity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#plot">Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-gnuplot">Link with gnuplot</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-medit">Link with medit</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-paraview">Link with Paraview</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-matlab-and-octave">Link with Matlab© and Octave</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="algorithms-and-optimization.html">Algorithms &amp; Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="algorithms-and-optimization.html#conjugate-gradient-gmres">Conjugate Gradient/GMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithms-and-optimization.html#algorithms-for-unconstrained-optimization">Algorithms for Unconstrained Optimization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="algorithms-and-optimization.html#example-of-usage-for-bfgs-or-cmaes">Example of usage for BFGS or CMAES</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="algorithms-and-optimization.html#ipopt">IPOPT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="algorithms-and-optimization.html#short-description-of-the-algorithm">Short description of the algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="algorithms-and-optimization.html#ipopt-in-freefem">IPOPT in <strong>FreeFEM</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="algorithms-and-optimization.html#some-short-examples-using-ipopt">Some short examples using IPOPT</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithms-and-optimization.html#d-constrained-minimum-surface-with-ipopt">3D constrained minimum surface with IPOPT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="algorithms-and-optimization.html#area-and-volume-expressions">Area and volume expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="algorithms-and-optimization.html#derivatives">Derivatives</a></li>
<li class="toctree-l4"><a class="reference internal" href="algorithms-and-optimization.html#the-problem-and-its-script">The problem and its script</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="algorithms-and-optimization.html#the-nlopt-optimizers">The nlOpt optimizers</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithms-and-optimization.html#optimization-with-mpi">Optimization with MPI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parallelization.html">Parallelization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parallelization.html#mpi">MPI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-keywords">MPI Keywords</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-constants">MPI Constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-constructor">MPI Constructor</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-functions">MPI Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-communicator-operator">MPI Communicator operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#schwarz-example-in-parallel">Schwarz example in parallel</a><ul>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#true-parallel-schwarz-example">True parallel Schwarz example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="parallelization.html#parallel-sparse-solvers">Parallel sparse solvers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#using-parallel-sparse-solvers-in-freefem">Using parallel sparse solvers in <strong>FreeFEM</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#sparse-direct-solver">Sparse direct solver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#mumps-solver">MUMPS solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#superlu-distributed-solver">SuperLU distributed solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#pastix-solver">PaStiX solver</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#parallel-sparse-iterative-solver">Parallel sparse iterative solver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#parms-solver">pARMS solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#interfacing-with-hips">Interfacing with HIPS</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#interfacing-with-hypre">Interfacing with HYPRE</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#domain-decomposition">Domain decomposition</a><ul>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#communicators-and-groups">Communicators and groups</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#process">Process</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#points-to-points-communicators">Points to Points communicators</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#global-operations">Global operations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="petsc/index.html">PETSc and SLEPc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="petsc/examples.html">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="petsc/examples.html#linear-problems">Linear problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="petsc/examples.html#nonlinear-problems">Nonlinear problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="petsc/examples.html#time-steppers-and-optimizers">Time steppers and optimizers</a></li>
<li class="toctree-l4"><a class="reference internal" href="petsc/examples.html#eigenvalue-problems">Eigenvalue problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="petsc/examples.html#miscellaneous">Miscellaneous</a></li>
<li class="toctree-l4"><a class="reference internal" href="petsc/examples.html#reproducible-science">Reproducible science</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="BEM.html">The Boundary Element Method</a><ul>
<li class="toctree-l3"><a class="reference internal" href="BEM.html#introduction-to-the-boundary-element-method-bem">Introduction to the Boundary Element Method (BEM)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#model-problem">Model problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#boundary-integral-operators">Boundary Integral Operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#the-bemtool-library">the BEMTool library</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#hierarchical-matrices">Hierarchical matrices</a><ul>
<li class="toctree-l5"><a class="reference internal" href="BEM.html#low-rank-approximation">Low-rank approximation</a></li>
<li class="toctree-l5"><a class="reference internal" href="BEM.html#hierarchical-block-structure">Hierarchical block structure</a></li>
<li class="toctree-l5"><a class="reference internal" href="BEM.html#the-htool-library">The Htool library</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="BEM.html#solve-a-bem-problem-with-freefem">Solve a BEM problem with FreeFEM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#build-the-geometry">Build the geometry</a><ul>
<li class="toctree-l5"><a class="reference internal" href="BEM.html#d">2D</a></li>
<li class="toctree-l5"><a class="reference internal" href="BEM.html#id3">3D</a></li>
<li class="toctree-l5"><a class="reference internal" href="BEM.html#orientation-of-normal-vector">Orientation of normal vector</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#define-the-type-of-operator">Define the type of operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#define-the-variational-problem">Define the variational problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#assemble-the-h-matrix">Assemble the H-Matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#solve-the-linear-system">Solve the linear system</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#compute-the-solution">Compute the solution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="BEM.html#d-example-script">2D example script</a></li>
<li class="toctree-l3"><a class="reference internal" href="BEM.html#bem-for-maxwell-s-equations">BEM for Maxwell’s equations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#efie-for-the-scattering-problem">EFIE for the scattering problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="BEM.html#maxwell-bem-problem-in-freefem">Maxwell BEM problem in FreeFEM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html">Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#gsl">gsl</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#ffrandom">ffrandom</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#mmap-semaphore">mmap / semaphore</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="developers.html">Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="developers.html#file-formats">File formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="developers.html#mesh-file-data-structure">Mesh file data structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#bb-file-type-to-store-solutions">bb file type to Store Solutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#id1">BB file type to store solutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#metric-file">Metric file</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#list-of-am-fmt-amdba-meshes">List of AM_FMT, AMDBA Meshes</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#sol-and-solb-files">sol and solb files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="developers.html#adding-a-new-finite-element">Adding a new finite element</a><ul>
<li class="toctree-l4"><a class="reference internal" href="developers.html#some-notations">Some notations</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#which-class-to-add">Which class to add?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="developers.html#dynamical-link">Dynamical link</a><ul>
<li class="toctree-l4"><a class="reference internal" href="developers.html#a-first-example-myfunction-cpp">A first example myfunction.cpp</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#example-discrete-fast-fourier-transform">Example: Discrete Fast Fourier Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#load-module-for-dervieux-p0-p1-finite-volume-method">Load Module for Dervieux P0-P1 Finite Volume Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#more-on-adding-a-new-finite-element">More on Adding a new finite element</a><ul>
<li class="toctree-l5"><a class="reference internal" href="developers.html#the-bernardi-raugel-element">The Bernardi-Raugel Element</a></li>
<li class="toctree-l5"><a class="reference internal" href="developers.html#the-morley-element">The Morley Element</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ffddm/index.html">ffddm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html">Domain Decomposition (DD)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#mesh-decomposition">Mesh Decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#distributed-linear-algebra">Distributed Linear Algebra</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#partition-of-unity-matrices-poum">Partition of Unity Matrices (POUM)</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#distributed-scalar-product">Distributed scalar product</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#update">Update</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#distributed-matrix-and-vector-resulting-from-a-variational-formulation">Distributed Matrix and Vector resulting from a variational formulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#distributed-linear-solvers">Distributed Linear Solvers</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#distributed-direct-solvers">Distributed Direct Solvers</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#schwarz-methods">Schwarz methods</a><ul>
<li class="toctree-l6"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#restricted-additive-schwarz-ras">Restricted Additive Schwarz (RAS)</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#optimized-restricted-additive-schwarz-oras">Optimized Restricted Additive Schwarz (ORAS)</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#two-level-methods">Two level methods</a><ul>
<li class="toctree-l7"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#coarse-mesh">Coarse Mesh</a></li>
<li class="toctree-l7"><a class="reference internal" href="ffddm/introduction-to-the-domain-decomposition-method.html#geneo">GenEO</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/documentation.html">ffddm documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#minimal-example">Minimal example</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#overlapping-mesh-decomposition">Overlapping mesh decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#local-finite-element-spaces">Local finite element spaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#define-the-problem-to-solve">Define the problem to solve</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#one-level-preconditioners">One level preconditioners</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#two-level-preconditioners">Two level preconditioners</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#building-the-geneo-coarse-space">Building the GenEO coarse space</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#building-the-coarse-space-from-a-coarse-mesh">Building the coarse space from a coarse mesh</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#solving-the-linear-system">Solving the linear system</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#using-hpddm-within-ffddm">Using <em>HPDDM</em> within <em>ffddm</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#advanced-use">Advanced use</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#interpolation-between-two-distributed-finite-element-spaces">Interpolation between two distributed finite element spaces</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#local-finite-element-spaces-for-non-lagrange-finite-elements">Local finite element spaces for non Lagrange finite elements</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#inexact-coarse-solves-for-two-level-methods">Inexact coarse solves for two level methods</a><ul>
<li class="toctree-l6"><a class="reference internal" href="ffddm/documentation.html#coarse-mesh-and-inexact-coarse-solve">Coarse mesh and inexact coarse solve</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/parameters.html">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/parameters.html#command-line-arguments">Command-line arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/parameters.html#global-parameters">Global parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/tutorial.html">Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#what-is-ffddm">What is <strong>ffddm</strong> ?</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#why-domain-decomposition-methods">Why Domain Decomposition Methods ?</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-1-decompose-the-mesh">Step 1: Decompose the mesh</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-2-define-your-finite-element">Step 2: Define your finite element</a><ul>
<li class="toctree-l6"><a class="reference internal" href="ffddm/tutorial.html#distributed-vectors-and-restriction-operators">Distributed vectors and restriction operators</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/tutorial.html#partition-of-unity">Partition of unity</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/tutorial.html#data-exchange-between-neighbors">Data exchange between neighbors</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-3-define-your-problem">Step 3: Define your problem</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#summary-so-far-translating-your-sequential-freefem-script">Summary so far: translating your sequential <em>FreeFEM</em> script</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#id1">Step 1: Decompose the mesh</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#solve-the-linear-system">Solve the linear system</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#solve-the-linear-system-with-the-parallel-direct-solver-mumps">Solve the linear system with the parallel direct solver <em>MUMPS</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-4-define-the-one-level-dd-preconditioner">Step 4: Define the one level DD preconditioner</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-5-solve-the-linear-system-with-preconditioned-gmres">Step 5: Solve the linear system with preconditioned GMRES</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#define-a-two-level-dd-preconditioner">Define a two level DD preconditioner</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#build-the-geneo-coarse-space">Build the GenEO coarse space</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#build-the-coarse-space-from-a-coarse-mesh">Build the coarse space from a coarse mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#use-hpddm-within-ffddm">Use <strong>HPDDM</strong> within <strong>ffddm</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#some-results-heterogeneous-3d-elasticity-with-geneo">Some results: Heterogeneous 3D elasticity with GenEO</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#some-results-2-level-dd-for-maxwell-equations-scattering-from-the-cobra-cavity">Some results: 2-level DD for Maxwell equations, scattering from the COBRA cavity</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#id2">Some results: 2-level DD for Maxwell equations, scattering from the COBRA cavity</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/examples.html">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references/index.html">Language references</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../references/types.html">Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#standard-types">Standard types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#int">int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#bool">bool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#real">real</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#complex">complex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#string">string</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#mesh-design">Mesh design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#border">border</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#mesh">mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#mesh3">mesh3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#finite-element-space-design">Finite element space design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#fespace">fespace</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#macro-design">Macro design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#macro">macro</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#newmacro-endmacro">NewMacro / EndMacro</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#ifmacro">IFMACRO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#endifmacro">ENDIFMACRO</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#functions-design">Functions design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#func">func</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#elementary-functions">Elementary functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#random-functions">Random functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#fe-functions">FE-functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#problem-design">Problem design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#problem">problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#solve">solve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#varf">varf</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#array">Array</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#array-index">Array index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#array-size">Array size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#array-sort">Array sort</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#double-array">Double array</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#array-of-fe-functions">Array of FE functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#map-arrays">Map arrays</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/types.html#matrix">matrix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#matrix-size">Matrix size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#matrix-resize">Matrix resize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#matrix-diagonal">Matrix diagonal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#matrix-renumbering">Matrix renumbering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#complex-matrix">Complex matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#dot-product-outer-product">Dot product / Outer product</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/types.html#matrix-inversion">Matrix inversion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/global-variables.html">Global variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#area">area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#argv">ARGV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#boundaryedge">BoundaryEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#cg">CG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#cholesky">Cholesky</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#crout">Crout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#edgeorientation">edgeOrientation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#false">false</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#gmres">GMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#htriangle">hTriangle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#include">include</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#internaledge">InternalEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#label">label</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#lenedge">lenEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#load">load</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#lu">LU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#n">N</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#ntonedge">nTonEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#nuedge">nuEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#nutriangle">nuTriangle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#p">P</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#pi">pi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#region">region</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#sparsesolver">sparsesolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#true">true</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#verbosity">verbosity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#version">version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#volume">volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#x">x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#y">y</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/global-variables.html#z">z</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/quadrature-formulae.html">Quadrature formulae</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/quadrature-formulae.html#int1d">int1d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#notations">Notations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf1pe">qf1pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf2pe">qf2pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf3pe-default">qf3pE   <em>(default)</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf4pe">qf4pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf5pe">qf5pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf1pelump">qf1pElump</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/quadrature-formulae.html#int2d">int2d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf1pt">qf1pT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf2pt">qf2pT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf5pt-default">qf5pT   <em>(default)</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf1ptlump">qf1pTlump</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf2pt4p1">qf2pT4P1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf7pt">qf7pT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qf9pt">qf9pT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/quadrature-formulae.html#int3d">int3d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qfv1">qfV1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qfv2">qfV2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qfv5-default">qfV5   <em>(default)</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/quadrature-formulae.html#qfv1lump">qfV1lump</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/operators.html">Operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#addition-operator">Addition operator +</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#increment-operator">Increment operator ++</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#substraction-operator">Substraction operator -</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#decrement-operator">Decrement operator –</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#multiplication-operator">Multiplication operator *</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#equal-operator">Equal operator =</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#comparison-operator">Comparison operator ==</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#id1">Comparison operator !=</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#id2">Comparison operator &lt;, &lt;=</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#id3">Comparison operator &gt;, &gt;=</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#compound-operator">Compound operator <cite>+=</cite>, <cite>-=</cite>, <cite>*=</cite>, <cite>/=</cite></a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#term-by-term-multiplication">Term by term multiplication .*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#division-operator">Division operator /</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#term-by-term-division">Term by term division ./</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#remainder-from-the-division">Remainder from the division %</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#power-operator">Power operator ^</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#inverse-of-a-matrix-1">Inverse of a matrix ^-1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#transpose-operator">Transpose operator ‘</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#tensor-scalar-product">Tensor scalar product :</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/operators.html#c-arithmetical-if-expression">C++ arithmetical if expression ? :</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/loops.html">Loops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#for">for</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#if">if</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#else">else</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#while">while</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#continue">continue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#break">break</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#try">try</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#catch">catch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/loops.html#implicit-loop">Implicit loop</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/IO.html">I/O</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#cout">cout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#cin">cin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#endl">endl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#ifstream">ifstream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#ofstream">ofstream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#append">append</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#binary">binary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#seekg">seekg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#tellg">tellg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#flush">flush</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#getline">getline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/IO.html#output-format">Output format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#precision">precision</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#scientific">scientific</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#fixed">fixed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#showbase">showbase</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#noshowbase">noshowbase</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#showpos">showpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#noshowpos">noshowpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#default">default</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/IO.html#setw">setw</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/functions.html">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#abs">abs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#acos">acos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#acosh">acosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#adaptmesh">adaptmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#adj">adj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#affinecg">AffineCG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#affinegmres">AffineGMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#arg">arg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#asin">asin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#asinh">asinh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#assert">assert</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#atan">atan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#atan2">atan2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#atanh">atanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#atoi">atoi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#atof">atof</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#bfgs">BFGS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#buildmesh">buildmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#ceil">ceil</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#change">change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#checkmovemesh">checkmovemesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#chi">chi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#clock">clock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#complexeigenvalue">complexEigenValue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#conj">conj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#convect">convect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#copysign">copysign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#cos">cos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#cosh">cosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#diffnp">diffnp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#diffpos">diffpos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dist">dist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dumptable">dumptable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dx">dx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dxx">dxx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dxy">dxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dxz">dxz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dy">dy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dyx">dyx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dyy">dyy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dyz">dyz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dz">dz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dzx">dzx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dzy">dzy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#dzz">dzz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#eigenvalue">EigenValue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#emptymesh">emptymesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#erf">erf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#erfc">erfc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#exec">exec</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#exit">exit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#exp">exp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#fdim">fdim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#floor">floor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#fmax">fmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#fmin">fmin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#fmod">fmod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#imag">imag</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#int1d">int1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#int2d">int2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#int3d">int3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#intalledges">intalledges</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#intallfaces">intallfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#interpolate">interpolate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#invdiff">invdiff</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#invdiffnp">invdiffnp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#invdiffpos">invdiffpos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#isinf">isInf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#isnan">isNaN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#isnormal">isNormal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#j0">j0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#j1">j1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#jn">jn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#jump">jump</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#linearcg">LinearCG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#lineargmres">LinearGMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#lgamma">lgamma</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#log">log</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#log10">log10</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#lrint">lrint</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#lround">lround</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#ltime">ltime</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#max">max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#min">min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#movemesh">movemesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#nan">NaN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#nlcg">NLCG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#on">on</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#plot">plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#polar">polar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#pow">pow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#projection">projection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randinit">randinit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randint31">randint31</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randint32">randint32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randreal1">randreal1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randreal2">randreal2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randreal3">randreal3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#randres53">randres53</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#readmesh">readmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#readmesh3">readmesh3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#real">real</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#rint">rint</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#round">round</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#savemesh">savemesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#set">set</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#sign">sign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#signbit">signbit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#sin">sin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#sinh">sinh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#sort">sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#splitmesh">splitmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#sqrt">sqrt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#square">square</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#storagetotal">storagetotal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#storageused">storageused</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#strtod">strtod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#strtol">strtol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#swap">swap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#system">system</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#tan">tan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#tanh">tanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#tgamma">tgamma</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#time">time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#trace">trace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#trunc">trunc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#y0">y0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#y1">y1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references/functions.html#yn">yn</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/external-libraries.html">External libraries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#aniso">aniso</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#boundaniso">boundaniso</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#bec">BEC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#bectrap">BECtrap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gpvortex">GPvortex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dxgpvortex">dxGPVortex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dygpvortex">dyGPVortex</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#binary-i-o">Binary I/O</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#loadvec">LoadVec</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#loadflag">LoadFlag</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#savevec">SaveVec</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#flag">flag</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#buildlayer">buildlayer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#buildlayers">buildlayers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#closepoints">ClosePoints</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#radiussearch">radiusSearch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#voisinage">Voisinage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#neighborhood">neighborhood</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#closepoints2">ClosePoints2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#closepoint">ClosePoint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#closepoints1">ClosePoints1</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#curvature">Curvature</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#extractborder">extractborder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id17">curvature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#raxicurvature">raxicurvature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#curves">curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#setecurveabcisse">setecurveabcisse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#equiparameter">equiparameter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#tresca">Tresca</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#vonmises">VonMises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#dfft">dfft</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#plandfft">plandfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#execute">execute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#delete">delete</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id28">dfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#map">map</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#distance">distance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id31">distance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#checkdist">checkdist</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#dxwriter">DxWriter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dxaddmesh">Dxaddmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dxaddtimeseries">Dxaddtimeseries</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dxaddsol2ts">Dxaddsol2ts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#element-p1bl">Element_P1bl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#expert">expert</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#exactpartition">exactpartition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id38">exactpartition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ff-airybiry">ff-AiryBiry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#airy">airy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#biry">biry</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ff-cmaes">ff-cmaes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#cmaes">cmaes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ff-gsl-awk">ff_gsl_awk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfugaussianp">gslcdfugaussianP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfugaussianq">gslcdfugaussianQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfugaussianpinv">gslcdfugaussianPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfugaussianqinv">gslcdfugaussianQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgaussianp">gslcdfgaussianP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgaussianq">gslcdfgaussianQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgaussianpinv">gslcdfgaussianPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgaussianqinv">gslcdfgaussianQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgammap">gslcdfgammaP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgammaq">gslcdfgammaQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgammapinv">gslcdfgammaPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgammaqinv">gslcdfgammaQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfcauchyp">gslcdfcauchyP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfcauchyq">gslcdfcauchyQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfcauchypinv">gslcdfcauchyPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfcauchyqinv">gslcdfcauchyQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflaplacep">gslcdflaplaceP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflaplaceq">gslcdflaplaceQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflaplacepinv">gslcdflaplacePinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflaplaceqinv">gslcdflaplaceQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfrayleighp">gslcdfrayleighP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfrayleighq">gslcdfrayleighQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfrayleighpinv">gslcdfrayleighPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfrayleighqinv">gslcdfrayleighQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfchisqp">gslcdfchisqP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfchisqq">gslcdfchisqQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfchisqpinv">gslcdfchisqPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfchisqqinv">gslcdfchisqQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfexponentialp">gslcdfexponentialP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfexponentialq">gslcdfexponentialQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfexponentialpinv">gslcdfexponentialPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfexponentialqinv">gslcdfexponentialQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfexppowp">gslcdfexppowP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfexppowq">gslcdfexppowQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdftdistp">gslcdftdistP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdftdistq">gslcdftdistQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdftdistpinv">gslcdftdistPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdftdistqinv">gslcdftdistQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdffdistp">gslcdffdistP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdffdistq">gslcdffdistQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdffdistpinv">gslcdffdistPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdffdistqinv">gslcdffdistQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfbetap">gslcdfbetaP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfbetaq">gslcdfbetaQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfbetapinv">gslcdfbetaPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfbetaqinv">gslcdfbetaQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfflatp">gslcdfflatP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfflatq">gslcdfflatQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfflatpinv">gslcdfflatPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfflatqinv">gslcdfflatQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflognormalp">gslcdflognormalP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflognormalq">gslcdflognormalQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflognormalpinv">gslcdflognormalPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflognormalqinv">gslcdflognormalQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel1p">gslcdfgumbel1P</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel1q">gslcdfgumbel1Q</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel1pinv">gslcdfgumbel1Pinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel1qinv">gslcdfgumbel1Qinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel2p">gslcdfgumbel2P</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel2q">gslcdfgumbel2Q</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel2pinv">gslcdfgumbel2Pinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgumbel2qinv">gslcdfgumbel2Qinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfweibullp">gslcdfweibullP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfweibullq">gslcdfweibullQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfweibullpinv">gslcdfweibullPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfweibullqinv">gslcdfweibullQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfparetop">gslcdfparetoP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfparetoq">gslcdfparetoQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfparetopinv">gslcdfparetoPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfparetoqinv">gslcdfparetoQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflogisticp">gslcdflogisticP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflogisticq">gslcdflogisticQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflogisticpinv">gslcdflogisticPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdflogisticqinv">gslcdflogisticQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfbinomialp">gslcdfbinomialP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfbinomialq">gslcdfbinomialQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfpoissonp">gslcdfpoissonP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfpoissonq">gslcdfpoissonQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgeometricp">gslcdfgeometricP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfgeometricq">gslcdfgeometricQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfnegativebinomialp">gslcdfnegativebinomialP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfnegativebinomialq">gslcdfnegativebinomialQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfpascalp">gslcdfpascalP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslcdfpascalq">gslcdfpascalQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranbernoullipdf">gslranbernoullipdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranbeta">gslranbeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranbetapdf">gslranbetapdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranbinomialpdf">gslranbinomialpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranexponential">gslranexponential</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranexponentialpdf">gslranexponentialpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranexppow">gslranexppow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranexppowpdf">gslranexppowpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrancauchy">gslrancauchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrancauchypdf">gslrancauchypdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranchisq">gslranchisq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranchisqpdf">gslranchisqpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranerlang">gslranerlang</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranerlangpdf">gslranerlangpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranfdist">gslranfdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranfdistpdf">gslranfdistpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranflat">gslranflat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranflatpdf">gslranflatpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangamma">gslrangamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangammaint">gslrangammaint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangammapdf">gslrangammapdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangammamt">gslrangammamt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangammaknuth">gslrangammaknuth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangaussian">gslrangaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangaussianratiomethod">gslrangaussianratiomethod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangaussianziggurat">gslrangaussianziggurat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangaussianpdf">gslrangaussianpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranugaussian">gslranugaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranugaussianratiomethod">gslranugaussianratiomethod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranugaussianpdf">gslranugaussianpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangaussiantail">gslrangaussiantail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangaussiantailpdf">gslrangaussiantailpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranugaussiantail">gslranugaussiantail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranugaussiantailpdf">gslranugaussiantailpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlandau">gslranlandau</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlandaupdf">gslranlandaupdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangeometricpdf">gslrangeometricpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangumbel1">gslrangumbel1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangumbel1pdf">gslrangumbel1pdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangumbel2">gslrangumbel2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrangumbel2pdf">gslrangumbel2pdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlogistic">gslranlogistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlogisticpdf">gslranlogisticpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlognormal">gslranlognormal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlognormalpdf">gslranlognormalpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlogarithmicpdf">gslranlogarithmicpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrannegativebinomialpdf">gslrannegativebinomialpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranpascalpdf">gslranpascalpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranpareto">gslranpareto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranparetopdf">gslranparetopdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranpoissonpdf">gslranpoissonpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranrayleigh">gslranrayleigh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranrayleighpdf">gslranrayleighpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranrayleightail">gslranrayleightail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranrayleightailpdf">gslranrayleightailpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrantdist">gslrantdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrantdistpdf">gslrantdistpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlaplace">gslranlaplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlaplacepdf">gslranlaplacepdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranlevy">gslranlevy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranweibull">gslranweibull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslranweibullpdf">gslranweibullpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyai">gslsfairyAi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairybi">gslsfairyBi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyaiscaled">gslsfairyAiscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairybiscaled">gslsfairyBiscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyaideriv">gslsfairyAideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairybideriv">gslsfairyBideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyaiderivscaled">gslsfairyAiderivscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairybiderivscaled">gslsfairyBiderivscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyzeroai">gslsfairyzeroAi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyzerobi">gslsfairyzeroBi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyzeroaideriv">gslsfairyzeroAideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfairyzerobideriv">gslsfairyzeroBideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselj0">gslsfbesselJ0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselj1">gslsfbesselJ1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseljn">gslsfbesselJn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbessely0">gslsfbesselY0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbessely1">gslsfbesselY1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselyn">gslsfbesselYn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseli0">gslsfbesselI0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseli1">gslsfbesselI1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselin">gslsfbesselIn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseli0scaled">gslsfbesselI0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseli1scaled">gslsfbesselI1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselinscaled">gslsfbesselInscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselk0">gslsfbesselK0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselk1">gslsfbesselK1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselkn">gslsfbesselKn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselk0scaled">gslsfbesselK0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselk1scaled">gslsfbesselK1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselknscaled">gslsfbesselKnscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id43">gslsfbesselj0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id44">gslsfbesselj1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselj2">gslsfbesselj2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseljl">gslsfbesseljl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id45">gslsfbessely0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id46">gslsfbessely1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbessely2">gslsfbessely2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselyl">gslsfbesselyl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id47">gslsfbesseli0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id48">gslsfbesseli1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseli2scaled">gslsfbesseli2scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselilscaled">gslsfbesselilscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id49">gslsfbesselk0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id50">gslsfbesselk1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselk2scaled">gslsfbesselk2scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselklscaled">gslsfbesselklscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesseljnu">gslsfbesselJnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselynu">gslsfbesselYnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselinuscaled">gslsfbesselInuscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselinu">gslsfbesselInu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselknuscaled">gslsfbesselKnuscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselknu">gslsfbesselKnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbessellnknu">gslsfbessellnKnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselzeroj0">gslsfbesselzeroJ0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselzeroj1">gslsfbesselzeroJ1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbesselzerojnu">gslsfbesselzeroJnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfclausen">gslsfclausen</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhydrogenicr1">gslsfhydrogenicR1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdawson">gslsfdawson</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdebye1">gslsfdebye1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdebye2">gslsfdebye2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdebye3">gslsfdebye3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdebye4">gslsfdebye4</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdebye5">gslsfdebye5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdebye6">gslsfdebye6</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdilog">gslsfdilog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfmultiply">gslsfmultiply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellintkcomp">gslsfellintKcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellintecomp">gslsfellintEcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellintpcomp">gslsfellintPcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellintdcomp">gslsfellintDcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellintf">gslsfellintF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellinte">gslsfellintE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfellintrc">gslsfellintRC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsferfc">gslsferfc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflogerfc">gslsflogerfc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsferf">gslsferf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsferfz">gslsferfZ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsferfq">gslsferfQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhazard">gslsfhazard</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexp">gslsfexp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpmult">gslsfexpmult</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpm1">gslsfexpm1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexprel">gslsfexprel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexprel2">gslsfexprel2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpreln">gslsfexpreln</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpinte1">gslsfexpintE1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpinte2">gslsfexpintE2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpinten">gslsfexpintEn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpinte1scaled">gslsfexpintE1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpinte2scaled">gslsfexpintE2scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpintenscaled">gslsfexpintEnscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpintei">gslsfexpintEi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpinteiscaled">gslsfexpintEiscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfshi">gslsfShi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfchi">gslsfChi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfexpint3">gslsfexpint3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfsi">gslsfSi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfci">gslsfCi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfatanint">gslsfatanint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidiracm1">gslsffermidiracm1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidirac0">gslsffermidirac0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidirac1">gslsffermidirac1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidirac2">gslsffermidirac2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidiracint">gslsffermidiracint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidiracmhalf">gslsffermidiracmhalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidirachalf">gslsffermidirachalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidirac3half">gslsffermidirac3half</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffermidiracinc0">gslsffermidiracinc0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflngamma">gslsflngamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgamma">gslsfgamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgammastar">gslsfgammastar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgammainv">gslsfgammainv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsftaylorcoeff">gslsftaylorcoeff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsffact">gslsffact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfdoublefact">gslsfdoublefact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflnfact">gslsflnfact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflndoublefact">gslsflndoublefact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflnchoose">gslsflnchoose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfchoose">gslsfchoose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflnpoch">gslsflnpoch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpoch">gslsfpoch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpochrel">gslsfpochrel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgammaincq">gslsfgammaincQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgammaincp">gslsfgammaincP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgammainc">gslsfgammainc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflnbeta">gslsflnbeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbeta">gslsfbeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfbetainc">gslsfbetainc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgegenpoly1">gslsfgegenpoly1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgegenpoly2">gslsfgegenpoly2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgegenpoly3">gslsfgegenpoly3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfgegenpolyn">gslsfgegenpolyn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhyperg0f1">gslsfhyperg0F1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhyperg1f1int">gslsfhyperg1F1int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhyperg1f1">gslsfhyperg1F1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhyperguint">gslsfhypergUint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhypergu">gslsfhypergU</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhyperg2f0">gslsfhyperg2F0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflaguerre1">gslsflaguerre1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflaguerre2">gslsflaguerre2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflaguerre3">gslsflaguerre3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflaguerren">gslsflaguerren</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflambertw0">gslsflambertW0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflambertwm1">gslsflambertWm1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendrepl">gslsflegendrePl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendrep1">gslsflegendreP1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendrep2">gslsflegendreP2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendrep3">gslsflegendreP3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreq0">gslsflegendreQ0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreq1">gslsflegendreQ1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreql">gslsflegendreQl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreplm">gslsflegendrePlm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendresphplm">gslsflegendresphPlm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendrearraysize">gslsflegendrearraysize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfconicalphalf">gslsfconicalPhalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfconicalpmhalf">gslsfconicalPmhalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfconicalp0">gslsfconicalP0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfconicalp1">gslsfconicalP1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfconicalpsphreg">gslsfconicalPsphreg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfconicalpcylreg">gslsfconicalPcylreg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreh3d0">gslsflegendreH3d0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreh3d1">gslsflegendreH3d1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflegendreh3d">gslsflegendreH3d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflog">gslsflog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflogabs">gslsflogabs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflog1plusx">gslsflog1plusx</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflog1plusxmx">gslsflog1plusxmx</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpowint">gslsfpowint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpsiint">gslsfpsiint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpsi">gslsfpsi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpsi1piy">gslsfpsi1piy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpsi1int">gslsfpsi1int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpsi1">gslsfpsi1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfpsin">gslsfpsin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfsynchrotron1">gslsfsynchrotron1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfsynchrotron2">gslsfsynchrotron2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsftransport2">gslsftransport2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsftransport3">gslsftransport3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsftransport4">gslsftransport4</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsftransport5">gslsftransport5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfsin">gslsfsin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfcos">gslsfcos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhypot">gslsfhypot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfsinc">gslsfsinc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflnsinh">gslsflnsinh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsflncosh">gslsflncosh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfanglerestrictsymm">gslsfanglerestrictsymm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfanglerestrictpos">gslsfanglerestrictpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfzetaint">gslsfzetaint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfzeta">gslsfzeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfzetam1">gslsfzetam1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfzetam1int">gslsfzetam1int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfhzeta">gslsfhzeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfetaint">gslsfetaint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslsfeta">gslsfeta</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ff-ipopt">ff-Ipopt</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#ipopt">IPOPT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#fflapack">fflapack</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#inv">inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dgeev">dgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#zgeev">zgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#geev">geev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id56">geev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dggev">dggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#zggev">zggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dsygvd">dsygvd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dgesdd">dgesdd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#zhegv">zhegv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dsyev">dsyev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#zheev">zheev</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ff-mmap-semaphore">ff-mmap-semaphore</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#wait">Wait</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#trywait">trywait</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#post">Post</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#msync">msync</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#read">Read</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#write">Write</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ffnewuoa">ffnewuoa</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#newuoa">newuoa</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ff-nlopt">ff-NLopt</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirect">nloptDIRECT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirectl">nloptDIRECTL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirectlrand">nloptDIRECTLRand</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirectscal">nloptDIRECTScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirectnoscal">nloptDIRECTNoScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirectlnoscal">nloptDIRECTLNoScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptdirectlrandnoscal">nloptDIRECTLRandNoScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptorigdirect">nloptOrigDIRECT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptorigdirectl">nloptOrigDIRECTL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptstogo">nloptStoGO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptstogorand">nloptStoGORand</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptlbfgs">nloptLBFGS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptpraxis">nloptPRAXIS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptvar1">nloptVar1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptvar2">nloptVar2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nlopttnewton">nloptTNewton</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nlopttnewtonrestart">nloptTNewtonRestart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nlopttnewtonprecond">nloptTNewtonPrecond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nlopttnewtonprecondrestart">nloptTNewtonPrecondRestart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptcrs2">nloptCRS2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptmma">nloptMMA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptcobyla">nloptCOBYLA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptnewuoa">nloptNEWUOA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptnewuoabound">nloptNEWUOABound</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptneldermead">nloptNelderMead</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptsbplx">nloptSbplx</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptbobyqa">nloptBOBYQA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptisres">nloptISRES</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptslsqp">nloptSLSQP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptmlsl">nloptMLSL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptmlsllds">nloptMLSLLDS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptauglag">nloptAUGLAG</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#nloptauglageq">nloptAUGLAGEQ</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ffrandom">ffrandom</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#srandomdev">srandomdev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#srandom">srandom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#random">random</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#freefemqa">FreeFemQA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#meshgenqa">MeshGenQA</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#freeyams">freeyams</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id109">freeyams</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#gmsh">gmsh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gmshload">gmshload</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gmshload3">gmshload3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#savegmsh">savegmsh</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#gsl">gsl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslpolysolvequadratic">gslpolysolvequadratic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslpolysolvecubic">gslpolysolvecubic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslpolycomplexsolve">gslpolycomplexsolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrnguniform">gslrnguniform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrnguniformpos">gslrnguniformpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslname">gslname</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrngget">gslrngget</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrngmin">gslrngmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrngmax">gslrngmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrngset">gslrngset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gslrngtype">gslrngtype</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#ilut">ilut</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#applyilutprecond">applyIlutPrecond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#makeilutprecond">makeIlutPrecond</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#iohdf5">iohdf5</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#savehdf5sol">savehdf5sol</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#iovtk">iovtk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#savevtk">savevtk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#vtkload">vtkload</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#vtkload3">vtkload3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#isoline">isoline</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id128">isoline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#curve">Curve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#area">Area</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#findallocalmin">findallocalmin</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#lapack">lapack</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id133">inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id135">dgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id137">zgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id139">geev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id141">dggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id143">zggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id145">dsygvd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id147">dgesdd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id149">zhegv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id151">dsyev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id153">zheev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dgelsy">dgelsy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#lgbmo">lgbmo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#bmo">bmo</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mat-dervieux">mat_dervieux</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#matupwind1">MatUpWind1</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mat-psi">mat_psi</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#matupwind0">MatUpWind0</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#medit">medit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id159">medit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#savesol">savesol</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#readsol">readsol</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#metis">metis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#metisnodal">metisnodal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#metisdual">metisdual</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#metrickuate">MetricKuate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id165">MetricKuate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#metricpk">MetricPk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id167">MetricPk</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mmg3d">mmg3d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id169">mmg3d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mmg3d-v4-0">mmg3d-v4.0</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id171">mmg3d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#msh3">msh3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#change">change</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#movemesh23">movemesh23</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#movemesh2d3dsurf">movemesh2D3Dsurf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#movemesh3">movemesh3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#movemesh">movemesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#movemesh3d">movemesh3D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#deplacement">deplacement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#checkbemesh">checkbemesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id181">buildlayers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#bcube">bcube</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#cube">cube</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#trunc">trunc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#gluemesh">gluemesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#extract">extract</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#showborder">showborder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#getborder">getborder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#addlayers">AddLayers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mshmet">mshmet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id190">mshmet</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mumps">MUMPS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#defaulttomumpsseq">defaulttoMUMPSseq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#mumps-seq">MUMPS_seq</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id193">defaulttoMUMPSseq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#netgen">netgen</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#netg">netg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#netgstl">netgstl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#netgload">netgload</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#newsolver">NewSolver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#defaulttoumfpack">defaulttoUMFPACK</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#pardiso">PARDISO</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#defaulttopardiso">defaulttoPARDISO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#ompsetnumthreads">ompsetnumthreads</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#ompgetnumthreads">ompgetnumthreads</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#ompgetmaxthreads">ompgetmaxthreads</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#pcm2rnm">pcm2rnm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#readpcm">readpcm</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#pipe">pipe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#flush">flush</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#sleep">sleep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#usleep">usleep</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#qf11to25">qf11to25</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#qf1d">QF1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#qf2d">QF2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#qf3d">QF3d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#tripleqf">tripleQF</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#scotch">scotch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id210">scotch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#shell">shell</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#readdir">readdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#unlink">unlink</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#rmdir">rmdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#cddir">cddir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#chdir">chdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#basename">basename</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#dirname">dirname</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#mkdir">mkdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#chmod">chmod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#cpfile">cpfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#stat">stat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#isdir">isdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#getenv">getenv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#setenv">setenv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#unsetenv">unsetenv</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#splitedges">splitedges</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#splitedgemesh">SplitedgeMesh</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#splitmesh12">splitmesh12</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id228">splitmesh12</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#splitmesh3">splitmesh3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id230">splitmesh3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#splitmesh4">splitmesh4</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#splimesh4">splimesh4</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#splitmesh6">splitmesh6</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id233">splitmesh6</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#superlu">SuperLu</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#defaulttosuperlu">defaulttoSuperLu</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#symmetrizecsr">symmetrizeCSR</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id236">symmetrizeCSR</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#tetgen">tetgen</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#tetgconvexhull">tetgconvexhull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#tetgtransfo">tetgtransfo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#tetg">tetg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#tetgreconstruction">tetgreconstruction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#umfpack64">UMFPACK64</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#defaulttoumfpack64">defaulttoUMFPACK64</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#vtk-writer-3d">VTK_writer_3d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#vtkaddmesh">Vtkaddmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#vtkaddscalar">Vtkaddscalar</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../references/external-libraries.html#vtk-writer">VTK_writer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id245">Vtkaddmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../references/external-libraries.html#id247">Vtkaddscalar</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../models/index.html">Mathematical Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/static-problems.html">Static problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#soap-film">Soap Film</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#electrostatics">Electrostatics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#aerodynamics">Aerodynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#error-estimation">Error estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#periodic-boundary-conditions">Periodic Boundary Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#poisson-problems-with-mixed-boundary-condition">Poisson Problems with mixed boundary condition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#poisson-with-mixed-finite-element">Poisson with mixed finite element</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#metric-adaptation-and-residual-error-indicator">Metric Adaptation and residual error indicator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/static-problems.html#adaptation-using-residual-error-indicator">Adaptation using residual error indicator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/elasticity.html">Elasticity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/elasticity.html#fracture-mechanics">Fracture Mechanics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/non-linear-static-problems.html">Non-linear static problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/non-linear-static-problems.html#newton-raphson-algorithm">Newton-Raphson algorithm</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/eigen-value-problems.html">Eigen value problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/evolution-problems.html">Evolution problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/evolution-problems.html#mathematical-theory-on-time-difference-approximations">Mathematical Theory on Time Difference Approximations.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/evolution-problems.html#convection">Convection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/evolution-problems.html#d-black-scholes-equation-for-an-european-put-option">2D Black-Scholes equation for an European Put option</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/navier-stokes-equations.html">Navier-Stokes equations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/navier-stokes-equations.html#uzawa-algorithm-and-conjugate-gradients">Uzawa Algorithm and Conjugate Gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/navier-stokes-equations.html#nsuzawacahouetchabart-edp">NSUzawaCahouetChabart.edp</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/variational-inequality.html">Variational Inequality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/domain-decomposition.html">Domain decomposition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/domain-decomposition.html#schwarz-overlapping">Schwarz overlapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/domain-decomposition.html#schwarz-non-overlapping-scheme">Schwarz non overlapping Scheme</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/domain-decomposition.html#schwarz-conjuguate-gradient">Schwarz conjuguate gradient</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/fluid-structure-coupled-problem.html">Fluid-structure coupled problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/transmission-problem.html">Transmission problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/free-boundary-problems.html">Free boundary problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/non-linear-elasticity.html">Non-linear elasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/compressible-neo-hookean-materials.html">Compressible Neo-Hookean materials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/compressible-neo-hookean-materials.html#notation">Notation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/compressible-neo-hookean-materials.html#recommended-references">Recommended References</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/compressible-neo-hookean-materials.html#a-neo-hookean-compressible-material">A Neo-Hookean Compressible Material</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/compressible-neo-hookean-materials.html#an-approach-to-implementation-in-freefem">An Approach to Implementation in FreeFEM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/whispering-gallery-modes.html">Whispering gallery modes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/whispering-gallery-modes.html#wave-equation-for-the-wgms">Wave equation for the WGMs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/whispering-gallery-modes.html#weak-formulation">Weak formulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/whispering-gallery-modes.html#a-dielectric-sphere-example-with-freefem">A dielectric sphere example with FreeFEM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/misc.html">Misc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/misc.html#poisson-s-equation">Poisson’s Equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/misc.html#poisson-s-equation-3d">Poisson’s equation 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/misc.html#stokes-equation-on-a-cube">Stokes Equation on a cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/misc.html#cavity">Cavity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/mesh-generation.html">Mesh Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#square-mesh">Square mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#mesh-adaptation">Mesh adaptation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#mesh-adaptation-for-the-poisson-s-problem">Mesh adaptation for the Poisson’s problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#uniform-mesh-adaptation">Uniform mesh adaptation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#borders">Borders</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#change">Change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#cube">Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#empty-mesh">Empty mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#points">3 points</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#bezier">Bezier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#build-layer-mesh">Build layer mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/mesh-generation.html#sphere">Sphere</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/finite-element.html">Finite Element</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/finite-element.html#periodic-3d">Periodic 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/finite-element.html#lagrange-multipliers">Lagrange multipliers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/visualization.html">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/visualization.html#plot">Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/visualization.html#hsv">HSV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/visualization.html#medit">Medit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/visualization.html#paraview">Paraview</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/algorithms-and-optimizations.html">Algorithms &amp; Optimizations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/algorithms-and-optimizations.html#algorithms">Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/algorithms-and-optimizations.html#cmaes-variational-inequality">CMAES variational inequality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/algorithms-and-optimizations.html#ipopt-minimal-surface-volume">IPOPT minimal surface &amp; volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/algorithms-and-optimizations.html#cmaes-mpi-variational-inequality">CMAES MPI variational inequality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/parallelization.html">Parallelization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/parallelization.html#mpi-gmres-2d">MPI-GMRES 2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/parallelization.html#mpi-gmres-3d">MPI-GMRES 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/parallelization.html#direct-solvers">Direct solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/parallelization.html#solver-mumps">Solver MUMPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/parallelization.html#solver-superlu-dist">Solver superLU_DIST</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/parallelization.html#solver-pastix">Solver PaStiX</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/developers.html">Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#fft">FFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#complex">Complex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#string">String</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#elementary-function">Elementary function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#array">Array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#block-matrix">Block matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#matrix-operations">Matrix operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#matrix-inversion">Matrix inversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#fe-array">FE array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#loop">Loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#implicit-loop">Implicit loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#i-o">I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#file-stream">File stream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#command-line-arguments">Command line arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#macro">Macro</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#basic-error-handling">Basic error handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/developers.html#error-handling">Error handling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

	</div>

	<div class="nav-links" id="staticNav">
	</div>

	<button class="nav-btn" onclick="openNav()"><i class="fa fa-bars"></i></button>

	<div id="sideNav" class="sidenav">
		<div class="sideNavHeader">
			<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   id="Calque_1"
   data-name="Calque 1"
   viewBox="0 0 380.98 113.39"
   version="1.1"
   sodipodi:docname="Logo.svg"
   inkscape:version="0.92.4 5da689c313, 2019-01-14">
  <metadata
     id="metadata30">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <sodipodi:namedview
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1"
     objecttolerance="10"
     gridtolerance="10"
     guidetolerance="10"
     inkscape:pageopacity="0"
     inkscape:pageshadow="2"
     inkscape:window-width="1920"
     inkscape:window-height="1016"
     id="namedview28"
     showgrid="false"
     inkscape:zoom="1.1312929"
     inkscape:cx="194.02578"
     inkscape:cy="53.159222"
     inkscape:window-x="0"
     inkscape:window-y="27"
     inkscape:window-maximized="1"
     inkscape:current-layer="Calque_1" />
  <defs
     id="defs4">
    <style
       id="style2">.cls-1{fill:blue;}.cls-2{fill:#00007f;}</style>
  </defs>
  <title
     id="title6">Logo</title>
  <path
     class="cls-2"
     d="M397.36,291H381.81v14.22h-11V267.42h27.75v8.44H381.74v6.67H397.3V291Z"
     transform="translate(-230.46 -229.51)"
     id="path13" />
  <path
     class="cls-2"
     d="M417.29,292.68H413v12.51H402V267.42h16.7c4.89,0,8.76,1,11.49,3a9.55,9.55,0,0,1,4.13,8.32,12.59,12.59,0,0,1-1.59,6.73,11.85,11.85,0,0,1-5.33,4.38l8.19,15v.44H423.77ZM413,284.24h5.71c3.18,0,4.76-1.4,4.76-4.25s-1.71-4.13-5.08-4.13H413Z"
     transform="translate(-230.46 -229.51)"
     id="path15" />
  <path
     class="cls-2"
     d="M465.8,289.89H450.94v6.86h17.59v8.44H440V267.42h28.76v8.44H450.94v5.59H465.8Z"
     transform="translate(-230.46 -229.51)"
     id="path17" />
  <path
     class="cls-2"
     d="M497.6,289.89H482.75v6.86h17.58v8.44H471.77V267.42h28.75v8.44H482.75v5.59H497.6Z"
     transform="translate(-230.46 -229.51)"
     id="path19" />
  <path
     class="cls-2"
     d="M530.11,291H514.55v14.22h-11V267.42h27.75v8.44H514.49v6.67h15.56V291Z"
     transform="translate(-230.46 -229.51)"
     id="path21" />
  <path
     class="cls-2"
     d="M560.58,289.89H545.73v6.86h17.58v8.44H534.74V267.42H563.5v8.44H545.73v5.59h14.85Z"
     transform="translate(-230.46 -229.51)"
     id="path23" />
  <path
     class="cls-2"
     d="M581.09,267.42,589,291.54l7.87-24.12h14.6v37.77h-11v-5.84l1.08-20.19-9,26h-7l-9-26,1.14,20.19v5.84h-11V267.42Z"
     transform="translate(-230.46 -229.51)"
     id="path25" />
  <g
     id="g833"
     transform="matrix(0.69996616,0,0,0.69996616,24.36493,-106.39712)">
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="181.58182"
       x="49.328617"
       height="86.368324"
       width="21.264048"
       id="rect1411"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="181.58182"
       x="64.966545"
       height="21.592081"
       width="53.160122"
       id="rect1413"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="218.71571"
       x="72.469795"
       height="16.194061"
       width="21.264048"
       id="rect1415"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="205.23866"
       x="95.834"
       height="86.368324"
       width="21.264048"
       id="rect1411-6"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="205.23866"
       x="111.47193"
       height="21.592081"
       width="53.160122"
       id="rect1413-7"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="242.37254"
       x="118.97518"
       height="16.194061"
       width="21.264048"
       id="rect1415-5"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
  </g>
</svg>
			<a class="closebtn" href="#" onclick="closeNav()"><i class="fas fa-times"></i></a>
		</div>
		<div id="dynamicSideNav">
		</div>
	</div>
	<div class="search-container">
	<label id="search-icon" for="searchInput"><i class="fas fa-search"></i></label>
	<input type="search" placeholder="Type to start searching" id="searchInput">
	<label id="search-overlay" onclick="removeOverlay()"></label>
	<div id="searchResults"></div>
</div>

	
</nav>
	

	<div id="subnav">
	<div style="display: none">
		<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html"><strong>Introduction</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Learning by Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="notations.html">Notations</a></li>
<li class="toctree-l2"><a class="reference internal" href="mesh-generation.html">Mesh Generation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Finite element</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#list-of-the-types-of-finite-elements">List of the types of finite elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-of-fespace-in-2d">Use of fespace in 2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-of-fespace-in-3d">Use of fespace in 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-of-fespace-in-surface-3d">Use of fespace in surface 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="#finite-element-functions">Finite Element functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lagrangian-finite-elements">Lagrangian Finite Elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#surface-lagrangian-finite-elements">Surface Lagrangian Finite Elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#p1-nonconforming-element">P1 Nonconforming Element</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-fe-space">Other FE-space</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vector-valued-fe-function">Vector Valued FE-function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-fast-finite-element-interpolator">A Fast Finite Element Interpolator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#keywords-problem-and-solve">Keywords: Problem and Solve</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameters-affecting-solve-and-problem">Parameters affecting solve and problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="#problem-definition">Problem definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#numerical-integration">Numerical Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#variational-form-sparse-matrix-pde-data-vector">Variational Form, Sparse Matrix, PDE Data Vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interpolation-matrix">Interpolation matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#finite-elements-connectivity">Finite elements connectivity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="algorithms-and-optimization.html">Algorithms &amp; Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallelization.html">Parallelization</a></li>
<li class="toctree-l2"><a class="reference internal" href="petsc/index.html">PETSc and SLEPc</a></li>
<li class="toctree-l2"><a class="reference internal" href="BEM.html">The Boundary Element Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="developers.html">Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="ffddm/index.html">ffddm</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references/index.html">Language references</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models/index.html">Mathematical Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

	</div>
</div>
	
	<div id="content">
		
   <section id="finite-element">
<span id="finiteelement"></span><h1>Finite element<a class="headerlink" href="#finite-element" title="Link to this heading"></a></h1>
<p>As stated in <a class="reference internal" href="../tutorials/index.html#tutorial"><span class="std std-ref">tutorials</span></a>, FEM approximates all functions <span class="math notranslate nohighlight">\(w\)</span> as:</p>
<div class="math notranslate nohighlight">
\[w(x,y)\simeq w_0\phi_0(x,y)+w_1\phi_1(x,y)+\cdots+w_{M-1}\phi_{M-1}(x,y)\]</div>
<p>with finite element basis functions <span class="math notranslate nohighlight">\(\phi_k(x,y)\)</span> and numbers <span class="math notranslate nohighlight">\(w_k\)</span> (<span class="math notranslate nohighlight">\(k=0,\cdots,M-1\)</span>).
The functions <span class="math notranslate nohighlight">\(\phi_k(x,y)\)</span> are constructed from the triangle <span class="math notranslate nohighlight">\(T_{i_k}\)</span>, and called <em>shape functions</em>.</p>
<p>In <strong>FreeFEM</strong>, the finite element space:</p>
<div class="math notranslate nohighlight">
\[V_h=\left\{w\left|\; w_0\phi_0+w_1\phi_1+\cdots+w_{M-1}\phi_{M-1},\, w_i\in \R\right.\right\}\]</div>
<p>is easily created by</p>
<blockquote>
<div><ul class="simple">
<li><p>in 2d</p></li>
</ul>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">IDspace</span><span class="p">(</span><span class="n">IDmesh</span><span class="p">,</span><span class="o">&lt;</span><span class="n">IDFE</span><span class="o">&gt;</span><span class="p">);</span>
</pre></div>
</div>
<p>or with <span class="math notranslate nohighlight">\(\ell\)</span> pairs of periodic boundary conditions in 2D:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">IDspace</span><span class="p">(</span><span class="n">IDmesh</span><span class="p">,</span><span class="o">&lt;</span><span class="n">IDFE</span><span class="o">&gt;</span><span class="p">,</span>
<span class="linenos">2</span><span class="w">    </span><span class="kp">periodic</span><span class="o">=</span><span class="p">[[</span><span class="n">la1</span><span class="p">,</span><span class="w"> </span><span class="n">sa1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">lb1</span><span class="p">,</span><span class="w"> </span><span class="n">sb1</span><span class="p">],</span>
<span class="linenos">3</span><span class="w">              </span><span class="p">...</span>
<span class="linenos">4</span><span class="w">              </span><span class="p">[</span><span class="n">lak</span><span class="p">,</span><span class="w"> </span><span class="n">sak</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">lbk</span><span class="p">,</span><span class="w"> </span><span class="n">sbl</span><span class="p">]]);</span>
</pre></div>
</div>
<ul class="simple">
<li><p>in 3D:</p></li>
</ul>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">IDspace</span><span class="p">(</span><span class="n">IDmesh3</span><span class="p">,</span><span class="o">&lt;</span><span class="n">IDFE</span><span class="o">&gt;</span><span class="p">,</span>
<span class="linenos">2</span><span class="w">    </span><span class="kp">periodic</span><span class="o">=</span><span class="p">[[</span><span class="n">la1</span><span class="p">,</span><span class="w"> </span><span class="n">sa1</span><span class="p">,</span><span class="w"> </span><span class="n">ta1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">lb1</span><span class="p">,</span><span class="w"> </span><span class="n">sb1</span><span class="p">,</span><span class="w"> </span><span class="n">tb1</span><span class="p">],</span>
<span class="linenos">3</span><span class="w">              </span><span class="p">...</span>
<span class="linenos">4</span><span class="w">              </span><span class="p">[</span><span class="n">lak</span><span class="p">,</span><span class="w"> </span><span class="n">sak</span><span class="p">,</span><span class="w"> </span><span class="n">tak</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">lbk</span><span class="p">,</span><span class="w"> </span><span class="n">sbl</span><span class="p">,</span><span class="w"> </span><span class="n">tbl</span><span class="p">]]);</span>
</pre></div>
</div>
<ul class="simple">
<li><p>in surface 3D:</p></li>
</ul>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">IDspace</span><span class="p">(</span><span class="n">IDmeshS</span><span class="p">,</span><span class="o">&lt;</span><span class="n">IDFE</span><span class="o">&gt;</span><span class="p">,</span>
<span class="linenos">2</span><span class="w">    </span><span class="kp">periodic</span><span class="o">=</span><span class="p">[[</span><span class="n">la1</span><span class="p">,</span><span class="w"> </span><span class="n">sa1</span><span class="p">,</span><span class="w"> </span><span class="n">ta1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">lb1</span><span class="p">,</span><span class="w"> </span><span class="n">sb1</span><span class="p">,</span><span class="w"> </span><span class="n">tb1</span><span class="p">],</span>
<span class="linenos">3</span><span class="w">              </span><span class="p">...</span>
<span class="linenos">4</span><span class="w">              </span><span class="p">[</span><span class="n">lak</span><span class="p">,</span><span class="w"> </span><span class="n">sak</span><span class="p">,</span><span class="w"> </span><span class="n">tak</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">lbk</span><span class="p">,</span><span class="w"> </span><span class="n">sbl</span><span class="p">,</span><span class="w"> </span><span class="n">tbl</span><span class="p">]]);</span>
</pre></div>
</div>
</div></blockquote>
<p>where <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">IDspace</span></code> is the name of the space (e.g. <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Vh</span></code>), <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">IDmesh</span></code> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">IDmesh3</span></code> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">IDmeshS</span><span class="w"> </span><span class="err">`</span><span class="n">is</span><span class="w"> </span><span class="n">respectly</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="o">:</span><span class="n">freefem</span><span class="o">:</span><span class="err">`</span><span class="kt">mesh</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">meshS</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="o">&lt;</span><span class="n">IDFE</span><span class="o">&gt;</span></code> is an identifier of finite element type.</p>
<p>In 2D we have a pair of periodic boundary conditions, if <span class="math notranslate nohighlight">\([la_i, sa_i]\)</span>, <span class="math notranslate nohighlight">\([lb_i, sb_i]\)</span> is a pair of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span></code>, and the 2 labels <span class="math notranslate nohighlight">\(la_i\)</span> and <span class="math notranslate nohighlight">\(lb_i\)</span> refer to 2 pieces of boundary to be in equivalence.</p>
<p>If <span class="math notranslate nohighlight">\([la_i, sa_i]\)</span>, <span class="math notranslate nohighlight">\([lb_i, sb_i]\)</span> is a pair of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code>, then <span class="math notranslate nohighlight">\(sa_i\)</span> and <span class="math notranslate nohighlight">\(sb_i\)</span> give two common abscissa on the two boundary curves, and two points are identified as one if the two abscissa are equal.</p>
<p>In 2D, we have a pair of periodic boundary conditions, if <span class="math notranslate nohighlight">\([la_i, sa_i, ta_i]\)</span>, <span class="math notranslate nohighlight">\([lb_i, sb_i, tb_i]\)</span> is a pair of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span></code>, the 2 labels <span class="math notranslate nohighlight">\(la_i\)</span> and <span class="math notranslate nohighlight">\(lb_i\)</span> define the 2 pieces of boundary to be in equivalence.</p>
<p>If <span class="math notranslate nohighlight">\([la_i, sa_i, ta_i]\)</span>, <span class="math notranslate nohighlight">\([lb_i, sb_i, tb_i]\)</span> is a pair of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code>, then <span class="math notranslate nohighlight">\(sa_i\)</span>, <span class="math notranslate nohighlight">\(ta_i\)</span> and <span class="math notranslate nohighlight">\(sb_i\)</span>, <span class="math notranslate nohighlight">\(tb_i\)</span> give two common parameters on the two boundary surfaces, and two points are identified as one if the two parameters are equal.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The 2D mesh of the two identified borders must be the same, so to be sure, use the parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">fixedborder</span><span class="o">=</span><span class="kr">true</span></code> in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">buildmesh</span></code> command (see <a class="reference internal" href="mesh-generation.html#meshborder"><span class="std std-ref">fixedborder</span></a>).</p>
</div>
<section id="list-of-the-types-of-finite-elements">
<h2>List of the types of finite elements<a class="headerlink" href="#list-of-the-types-of-finite-elements" title="Link to this heading"></a></h2>
<p>As of today, the known types of finite elements are:</p>
<ul>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P0</span><span class="p">]</span></code> piecewise constant discontinuous finite element (2d, 3d, surface 3d), the degrees of freedom are the barycenter element value.</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-p0">
<span class="eqno">(9)<a class="headerlink" href="#equation-eq-p0" title="Link to this equation"></a></span>\[\P^0_{h} = \left\{ v \in L^2(\Omega) \left|\; \textrm{for all }K \in \mathcal{T}_{h}\;\;\textrm{there is }\alpha_{K}\in \R : \;\; v_{|K} = \alpha_{K } \right.\right\}\]</div>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P1</span><span class="p">]</span></code> piecewise linear continuous finite element (2d, 3d, surface 3d), the degrees of freedom are the vertices values.</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-p1">
<span class="eqno">(10)<a class="headerlink" href="#equation-eq-p1" title="Link to this equation"></a></span>\[\P^1_{h} = \left\{ v \in H^{1}(\Omega) \left|\; \forall K \in \mathcal{T}_{h},\ v_{|K} \in P_{1} \right.\right\}\]</div>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P1dc</span><span class="p">]</span></code> piecewise linear discontinuous finite element (2d, 3d with load”Element_P1dc1”)</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-p1dc">
<span class="eqno">(11)<a class="headerlink" href="#equation-eq-p1dc" title="Link to this equation"></a></span>\[\P^1_{dc|h} = \left\{ v \in L^{2}(\Omega) \left|\; \forall K \in \mathcal{T}_{h}, \ v_{|K} \in P_{1} \right.\right\}\]</div>
</div></blockquote>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Due to an interpolation problem, the degree of freedom is not the vertices but three vertices which move inside <span class="math notranslate nohighlight">\(T(X)= G + .99 (X-G)\)</span> where <span class="math notranslate nohighlight">\(G\)</span> is the barycenter.</p>
</div>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P1b</span><span class="p">]</span></code> piecewise linear continuous finite element plus bubble (2d, 3d)</p>
<p><strong>The 2D Case:</strong></p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-p1b">
<span class="eqno">(12)<a class="headerlink" href="#equation-eq-p1b" title="Link to this equation"></a></span>\[\P^1_{b|h} = \left\{ v \in H^{1}(\Omega) \left|\; \forall K \in \mathcal{T}_{h}, \ v_{|K} \in P_{1} \oplus \mathrm{Span}\{ \lambda^{K}_{0} \lambda^{K}_{1} \lambda^{K}_{2} \} \right.\right\}\]</div>
</div></blockquote>
<p><strong>The 3D Case:</strong></p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-p1b-3d">
<span class="eqno">(13)<a class="headerlink" href="#equation-eq-p1b-3d" title="Link to this equation"></a></span>\[\P^1_{b|h} = \left\{ v \in H^{1}(\Omega) \left|\; \forall K \in \mathcal{T}_{h}, \ v_{|K} \in P_{1} \oplus \mathrm{Span}\{ \lambda^{K}_{0} \lambda^{K}_{1} \lambda^{K}_{2} \lambda^{K}_{3} \} \right.\right\}\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda^{K}_{i}, i=0,..,d\)</span> are the <span class="math notranslate nohighlight">\(d+1\)</span> barycentric coordinate functions of the element <span class="math notranslate nohighlight">\(K\)</span> (triangle or tetrahedron).</p>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1bl</span><span class="p">,</span><span class="nc">P1bl3d</span></code> piecewise linear continuous finite element plus linear bubble (with load”Element_P1bl” 2d, 3d).</p>
<p>The bubble is built by splitting the <span class="math notranslate nohighlight">\(K\)</span>, a barycenter in <span class="math notranslate nohighlight">\(d+1\)</span> sub element. (need <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_P1bl&quot;</span></code>)</p>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P2</span><span class="p">,</span><span class="w"> </span><span class="nc">P2</span><span class="p">]</span></code> piecewise <span class="math notranslate nohighlight">\(P_{2}\)</span> continuous finite element (2d, 3d, surface 3d)</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\P^2_{h} = \left\{ v \in H^{1}(\Omega) \left|\; \forall K \in \mathcal{T}_{h}, \ v_{|K} \in P_{2} \right.\right\}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_{2}\)</span> is the set of polynomials of <span class="math notranslate nohighlight">\(\R^{2}\)</span> of degrees <span class="math notranslate nohighlight">\(\le 2\)</span>.</p>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P2b</span><span class="p">,</span><span class="w"> </span><span class="n">P2b3d</span><span class="p">]</span></code> piecewise <span class="math notranslate nohighlight">\(P_{2}\)</span> continuous finite element plus bubble (2d, 3d with load”Element_P2bulle3”)</p>
<p><strong>The 2D Case:</strong></p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\P^2_{h} = \left\{ v \in H^{1}(\Omega) \left|\; \forall K \in \mathcal{T}_{h}, \ v_{|K} \in P_{2} \oplus \mathrm{Span}\{ \lambda^{K}_{0} \lambda^{K}_{1} \lambda^{K}_{2} \} \right.\right\}\]</div>
<p><strong>The 3D Case:</strong></p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\P^2_{h} = \left\{ v \in H^{1}(\Omega) \left|\; \forall K \in \mathcal{T}_{h}, \ v_{|K} \in P_{2} \oplus \mathrm{Span}\{ \lambda^{K}_{0} \lambda^{K}_{1} \lambda^{K}_{2} \lambda^{K}_{3} \} \right.\right\}\]</div>
</div></blockquote>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P2dc</span><span class="p">]</span></code> piecewise <span class="math notranslate nohighlight">\(P_{2}\)</span> discontinuous finite element (2d)</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\P^2_{dc|h} = \left\{ v \in L^{2}(\Omega) \left|\; \forall K \in \mathcal{T}_{h}, \ v_{|K} \in P_{2} \right.\right\}\]</div>
</div></blockquote>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Due to an interpolation problem, the degree of freedom is not the six P2 nodes but six nodes which move inside <span class="math notranslate nohighlight">\(T(X)= G + .99 (X-G)\)</span> where <span class="math notranslate nohighlight">\(G\)</span> is the barycenter.</p>
</div>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P2h</span><span class="p">]</span></code> quadratic homogeneous continuous (without <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1</span></code>).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P3</span><span class="p">]</span></code> piecewise <span class="math notranslate nohighlight">\(P_{3}\)</span> continuous finite element (2d) (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_P3&quot;</span></code>)</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\P^3_{h} = \left\{ v \in H^{1}(\Omega) \left|\; \forall K \in \mathcal{T}_{h}, \ v_{|K} \in P_{3} \right.\right\}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_{3}\)</span> is the set of polynomials of <span class="math notranslate nohighlight">\(\R^{2}\)</span> of degrees <span class="math notranslate nohighlight">\(\le 3\)</span>.</p>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P3dc</span><span class="p">]</span></code> piecewise <span class="math notranslate nohighlight">\(P_{3}\)</span> discontinuous finite element (2d) (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_P3dc&quot;</span></code>)</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\P^3_{dc|h} = \left\{ v \in L^2(\Omega) \left|\; \forall K \in \mathcal{T}_{h}, \ v_{|K} \in P_{3} \right.\right\}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_{3}\)</span> is the set of polynomials of <span class="math notranslate nohighlight">\(\R^{2}\)</span> of degrees <span class="math notranslate nohighlight">\(\le 3\)</span>.</p>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P4</span><span class="p">]</span></code> piecewise <span class="math notranslate nohighlight">\(P_{4}\)</span> continuous finite element (2d) (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_P4&quot;</span></code>)</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\P^4_{h} = \left\{ v \in H^{1}(\Omega) \left|\; \forall K \in \mathcal{T}_{h},\ v_{|K} \in P_{4} \right.\right\}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_{4}\)</span> is the set of polynomials of <span class="math notranslate nohighlight">\(\R^{2}\)</span> of degrees <span class="math notranslate nohighlight">\(\le 4\)</span>.</p>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P4dc</span><span class="p">]</span></code> piecewise <span class="math notranslate nohighlight">\(P_{4}\)</span> discontinuous finite element (2d) (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_P4dc&quot;</span></code>)</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\P^4_{dc|h} = \left\{ v \in L^2(\Omega) \left|\; \forall K \in \mathcal{T}_{h}, \ v_{|K} \in P_{3} \right.\right\}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_{4}\)</span> is the set of polynomials of <span class="math notranslate nohighlight">\(\R^{2}\)</span> of degrees <span class="math notranslate nohighlight">\(\le 3\)</span>.</p>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P0Edge</span><span class="p">]</span></code> piecewise <span class="math notranslate nohighlight">\(P_{0}\)</span> discontinuous finite element (2d) contained on each edge of the mesh.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P1Edge</span><span class="p">]</span></code> piecewise <span class="math notranslate nohighlight">\(P_{1}\)</span> discontinuous finite element (2d) (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_PkEdge&quot;</span></code>) <span class="math notranslate nohighlight">\(P_1\)</span> on each edge of the mesh.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P2Edge</span><span class="p">]</span></code> piecewise <span class="math notranslate nohighlight">\(P_{2}\)</span> discontinuous finite element (2d) (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_PkEdge&quot;</span></code>) <span class="math notranslate nohighlight">\(P_2\)</span> on each edge of the mesh.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P3Edge</span><span class="p">]</span></code> piecewise <span class="math notranslate nohighlight">\(P_{3}\)</span> discontinuous finite element (2d) (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_PkEdge&quot;</span></code>) <span class="math notranslate nohighlight">\(P_3\)</span> on each edge of the mesh.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P4Edge</span><span class="p">]</span></code> piecewise <span class="math notranslate nohighlight">\(P_{4}\)</span> discontinuous finite element (2d) (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_PkEdge&quot;</span></code>) <span class="math notranslate nohighlight">\(P_4\)</span> on each edge of the mesh.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P5Edge</span><span class="p">]</span></code> piecewise <span class="math notranslate nohighlight">\(P_{5}\)</span> discontinuous finite element (2d) (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_PkEdge&quot;</span></code>) <span class="math notranslate nohighlight">\(P_5\)</span> on each edge of the mesh.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P2Morley</span><span class="p">]</span></code> piecewise <span class="math notranslate nohighlight">\(P_{2}\)</span> non conform finite element (2d) (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Morley&quot;</span></code>)</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\P^2_{h} = \left\{ v \in L^2(\Omega) \left|\; \forall K \in \mathcal{T}_{h}, \ v_{|K} \in P_{3},
\left\{\begin{array}{c}
    v \mbox{ continuous at vertices,}\\
    \p_n{v} \mbox{ continuous at middle of edge,}
\end{array}\right.
\right.\right\}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_{2}\)</span> is the set of polynomials of <span class="math notranslate nohighlight">\(\R^{2}\)</span> of degrees <span class="math notranslate nohighlight">\(\le 2\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>To build the interplant of a function <span class="math notranslate nohighlight">\(u\)</span> (scalar) for this finite element, we need the function and 2 partial derivatives <span class="math notranslate nohighlight">\((u,u_x, u_y)\)</span>, creating this vectorial finite element with 3 components <span class="math notranslate nohighlight">\((u,u_x,u_y)\)</span>.</p>
</div>
<p>See our example for solving the BiLaplacien problem:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Morley&quot;</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="c1">// Parameters</span>
<span class="linenos"> 4</span><span class="kt">int</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="kt">real</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="p">;</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kt">real</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="c1">// Mesh</span>
<span class="linenos">10</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span><span class="w"> </span><span class="n">nn</span><span class="p">);</span>
<span class="linenos">11</span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="c1">// Fespace</span>
<span class="linenos">14</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P2Morley</span><span class="p">);</span><span class="w"> </span><span class="c1">//The Morley finite element space</span>
<span class="linenos">15</span><span class="n">Vh</span><span class="w"> </span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ux</span><span class="p">,</span><span class="w"> </span><span class="n">uy</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">vx</span><span class="p">,</span><span class="w"> </span><span class="n">vy</span><span class="p">];</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="c1">// Macro</span>
<span class="linenos">18</span><span class="kt">macro</span><span class="w"> </span><span class="n">bilaplacien</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">dxx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dxx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">dyy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dyy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.</span><span class="o">*</span><span class="nf">dxy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dxy</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="w"> </span><span class="c1">//</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="c1">// Problem</span>
<span class="linenos">21</span><span class="kt">solve</span><span class="w"> </span><span class="n">bilap</span><span class="w"> </span><span class="p">([</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ux</span><span class="p">,</span><span class="w"> </span><span class="n">uy</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">vx</span><span class="p">,</span><span class="w"> </span><span class="n">vy</span><span class="p">])</span>
<span class="linenos">22</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos">23</span><span class="w">        </span><span class="n">bilaplacien</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="linenos">24</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">25</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos">26</span><span class="w">        </span><span class="n">f</span><span class="o">*</span><span class="n">v</span>
<span class="linenos">27</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">28</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">ux</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">uy</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">29</span><span class="w">    </span><span class="p">;</span>
<span class="linenos">30</span>
<span class="linenos">31</span><span class="c1">// Plot</span>
<span class="linenos">32</span><span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;u&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">HCT</span><span class="p">]</span></code> <span class="math notranslate nohighlight">\(P_3\)</span> <span class="math notranslate nohighlight">\(C^1\)</span> conforms finite element (2d) (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_HCT&quot;</span></code>) one 3 sub triangles.</p>
<blockquote>
<div><p>Lets call <span class="math notranslate nohighlight">\(\mathcal{T}^\triangle_{h}\)</span> the sub mesh of <span class="math notranslate nohighlight">\(\mathcal{T}_{h}\)</span> where all triangles are split in 3 at the barycenter.</p>
<div class="math notranslate nohighlight">
\[\P^{HCT}_{h} = \left\{ v \in C^1(\Omega) \left|\; \forall K \in \mathcal{T}^\triangle_{h}, \ v_{|K} \in P_{3} \right.\right\}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_{3}\)</span> is the set of polynomials of <span class="math notranslate nohighlight">\(\R^{2}\)</span> of degrees <span class="math notranslate nohighlight">\(\le 3\)</span>.</p>
<p>The degrees of freedom are the values of the normal derivative at the mid-point of each edge <a class="reference internal" href="../bibliography.html#bernadou1980" id="id1"><span>[BERNADOU1980]</span></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>To build the interplant of a function <span class="math notranslate nohighlight">\(u\)</span> (scalar) for this finite element, we need the function and 2 partial derivatives <span class="math notranslate nohighlight">\((u,u_x, u_y)\)</span>, creating this vectorial finite element with 3 components <span class="math notranslate nohighlight">\((u,u_x,u_y)\)</span> like in previous finite element.</p>
</div>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P2BR</span><span class="p">]</span></code> (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;BernadiRaugel&quot;</span></code>) the Bernadi Raugel Finite Element is a Vectorial element (2d) with 2 components, see <a class="reference internal" href="../bibliography.html#bernardi1985" id="id2"><span>[BERNARDI1985]</span></a>.</p>
<blockquote>
<div><p>It is a 2D coupled Finite Element, where the Polynomial space is <span class="math notranslate nohighlight">\(P_1^2\)</span> with 3 normal bubble edge functions <span class="math notranslate nohighlight">\((P_2)\)</span>.
There are 9 degrees of freedom:</p>
<ul class="simple">
<li><p>2 components at each of the 3 vertices and</p></li>
<li><p>the 3 flux on the 3 edges.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">RT0</span><span class="p">,</span><span class="w"> </span><span class="nc">RT03d</span><span class="p">]</span></code> Raviart-Thomas finite element of degree <span class="math notranslate nohighlight">\(0\)</span>.</p>
<blockquote>
<div><p><strong>The 2D Case:</strong></p>
<div class="math notranslate nohighlight" id="equation-eq-rt0">
<span class="eqno">(14)<a class="headerlink" href="#equation-eq-rt0" title="Link to this equation"></a></span>\[RT0_{h} = \left\{ \mathbf{v} \in H(\textrm{div}) \left|\; \forall K \in \mathcal{T}_{h} ,\ \mathbf{v}_{|K}(x,y) =
\vecttwo{\alpha^1_{K}}{\alpha^2_{K}} + \beta_{K}\vecttwo{x}{y} \right.\right\}\]</div>
<p><strong>The 3D Case:</strong></p>
<div class="math notranslate nohighlight" id="equation-eq-rt03d">
<span class="eqno">(15)<a class="headerlink" href="#equation-eq-rt03d" title="Link to this equation"></a></span>\[RT0_{h} = \left\{ \mathbf{v} \in H(\textrm{div}) \left|\; \forall K \in \mathcal{T}_{h},\ \mathbf{v}_{|K}(x,y,z) =
\vectthree{\alpha^1_{K}}{\alpha^2_{K}}{\alpha^3_{K}} + \beta_{K}\vectthree{x}{y}{z} \right.\right\}\]</div>
<p>where by writing <span class="math notranslate nohighlight">\(\textrm{div }\mathbf{w}=\sum_{i=1}^d\p w_i/\p x_i\)</span> with <span class="math notranslate nohighlight">\(\mathbf{w}=(w_i)_{i=1}^d\)</span>:</p>
<div class="math notranslate nohighlight">
\[H(\textrm{div})=\left\{\mathbf{w}\in L^{2}(\Omega)^d\left|\textrm{div } \mathbf{w}\in L^{2}(\Omega)\right.\right\}\]</div>
<p>and where <span class="math notranslate nohighlight">\(\alpha^1_{K}\)</span>, <span class="math notranslate nohighlight">\(\alpha^2_{K}\)</span>, <span class="math notranslate nohighlight">\(\alpha^3_{K}\)</span>, <span class="math notranslate nohighlight">\(\beta_{K}\)</span> are real numbers.</p>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">RT0Ortho</span><span class="p">]</span></code> Raviart-Thomas Orthogonal, or Nedelec finite element type I of degree <span class="math notranslate nohighlight">\(0\)</span> in dimension 2</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-rt0ortho">
<span class="eqno">(16)<a class="headerlink" href="#equation-rt0ortho" title="Link to this equation"></a></span>\[RT0Ortho{h} = \left\{ \mathbf{v} \in H(\textrm{curl}) \left|\; \forall K \in \mathcal{T}_{h},\ \mathbf{v}_{|K}(x,y) =
\vecttwo{\alpha^1_{K}}{\alpha^2_{K}} + \beta_{K}\vecttwo{-y}{x} \right.\right\}\]</div>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">Edge03d</span><span class="p">]</span></code> 3d Nedelec finite element or Edge Element of degree <span class="math notranslate nohighlight">\(0\)</span>.</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[Edge0_{h} = \left\{ \mathbf{v} \in H(\textrm{Curl}) \left|\; \forall K \in\mathcal{T}_{h}, \ \mathbf{v}_{|K}(x,y,z) =
    \vectthree{\alpha^1_{K}}{\alpha^2_{K}}{\alpha^3_{K}} + \vectthree{\beta^1_{K}}{\beta^2_{K}}{\beta^3_{K}}\times\vectthree{x}{y}{z} \right.\right\}
:label:eq:Edge03d\]</div>
<p>where by writing <span class="math notranslate nohighlight">\(\textrm{curl}\mathbf{w}=\vectthree{\p w_2/\p x_3-\p w_3/\p x_2}{\p w_3/\p x_1-\p w_1/\p x_3}{\p w_1/\p x_2-\p w_2/\p x_1}\)</span> with <span class="math notranslate nohighlight">\(\mathbf{w}=(w_i)_{i=1}^d\)</span>:</p>
<div class="math notranslate nohighlight">
\[H(\textrm{curl})=\left\{\mathbf{w}\in L^{2}(\Omega)^d\left|\textrm{curl } \mathbf{w}\in L^{2}(\Omega)^d\right.\right\}\]</div>
<p>and <span class="math notranslate nohighlight">\(\alpha^1_{K},\alpha^2_{K},\alpha^3_{K},\beta^1_{K},\beta^2_{K},\beta^3_{K}\)</span> are real numbers.</p>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">Edge13d</span><span class="p">]</span></code> (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_Mixte3d&quot;</span></code>) 3d Nedelec finite element or Edge Element of degree <span class="math notranslate nohighlight">\(1\)</span>.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">Edge23d</span><span class="p">]</span></code> (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_Mixte3d&quot;</span></code>) 3d Nedelec finite element or Edge Element of degree <span class="math notranslate nohighlight">\(2\)</span>.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P1nc</span><span class="p">]</span></code> piecewise linear element continuous at the mid-point of the edge only in 2D (Crouzeix-Raviart Finite Element 2D).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P2pnc</span><span class="p">]</span></code> piecewise quadratic plus a P3 bubble element with the continuity of the 2 moments on each edge (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_P2pnc&quot;</span></code>)</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">RT1</span><span class="p">]</span></code> (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_Mixte&quot;</span></code>)</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-rt1">
<span class="eqno">(17)<a class="headerlink" href="#equation-eq-rt1" title="Link to this equation"></a></span>\[RT1_{h} = \left\{ \mathbf{v} \in H(\textrm{div}) \left|\; \forall K \in\mathcal{T}_{h}, \ \alpha^1_{K}, \alpha^2_{K}, \beta_{K} \in P_1^2,P_0, \mathbf{v}_{|K}(x,y) =
    \vecttwo{\alpha^1_{K}}{\alpha^2_{K}} + \beta_{K}\vecttwo{x}{y} \right.\right\}\]</div>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">RT1Ortho</span><span class="p">]</span></code> (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_Mixte&quot;</span></code>)</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-rt1ortho">
<span class="eqno">(18)<a class="headerlink" href="#equation-eq-rt1ortho" title="Link to this equation"></a></span>\[RT1_{h} = \left\{ \mathbf{v} \in H(\textrm{curl}) \left|\; \forall K \in\mathcal{T}_{h},\ \alpha^1_{K}, \alpha^2_{K}, \beta_{K} \in P_1^2,P_0, \mathbf{v}_{|K}(x,y) =
    \vecttwo{\alpha^1_{K}}{\alpha^2_{K}} + \beta_{K}\vecttwo{-y}{x} \right.\right\}\]</div>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">RT2</span><span class="p">]</span></code> (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_Mixte&quot;</span></code>)</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-rt2">
<span class="eqno">(19)<a class="headerlink" href="#equation-eq-rt2" title="Link to this equation"></a></span>\[RT2_{h} = \left\{ \mathbf{v} \in H(\textrm{div}) \left|\; \forall K \in\mathcal{T}_{h},\ \alpha^1_{K}, \alpha^2_{K}, \beta_{K} \in P_2^2, P_1, \mathbf{v}_{|K}(x,y) =
    \vecttwo{\alpha^1_{K}}{\alpha^2_{K}} + \beta_{K}\vecttwo{x}{y} \right.\right\}\]</div>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">RT2Ortho</span><span class="p">]</span></code> (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_Mixte&quot;</span></code>)</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-rt2ortho">
<span class="eqno">(20)<a class="headerlink" href="#equation-eq-rt2ortho" title="Link to this equation"></a></span>\[RT2_{h} = \left\{ \mathbf{v} \in H(\textrm{curl}) \left|\; \forall K \in\mathcal{T}_{h} ,\ \alpha^1_{K}, \alpha^2_{K}, \beta_{K} \in P_2^2, P_1,\ \mathbf{v}_{|K}(x,y) =
    \vecttwo{\alpha^1_{K}}{\alpha^2_{K}} + \beta_{K}\vecttwo{-y}{x} \right.\right\}\]</div>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">BDM1</span><span class="p">]</span></code> (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_Mixte&quot;</span></code>) the Brezzi-Douglas-Marini finite element:</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-bdm1">
<span class="eqno">(21)<a class="headerlink" href="#equation-eq-bdm1" title="Link to this equation"></a></span>\[BDM1_{h} = \left\{ \mathbf{v} \in H(\textrm{div}) \left|\; \forall K \in\mathcal{T}_{h},\ \mathbf{v}_{|K} \in P_1^2\right.\right\}\]</div>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">BDM1Ortho</span><span class="p">]</span></code> (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_Mixte&quot;</span></code>) the Brezzi-Douglas-Marini Orthogonal also call Nedelec of type II , finite element</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-bdm1ortho">
<span class="eqno">(22)<a class="headerlink" href="#equation-eq-bdm1ortho" title="Link to this equation"></a></span>\[BDM1Ortho_{h} = \left\{ \mathbf{v} \in H(\textrm{curl}) \left|\; \forall K \in\mathcal{T}_{h},\ \mathbf{v}_{|K} \in P_1^2\right.\right\}\]</div>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">FEQF</span><span class="p">]</span></code> (needs <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;Element_QF&quot;</span></code>) the finite element to store functions at default quadrature points (so the quadrature is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf5pT</span></code> in 2D and is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qfV5</span></code> in 3d).</p>
<blockquote>
<div><p>For over quadrature you have the following corresponding finite element’s quadrature formula.</p>
<ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">FEQF1</span></code> <span class="math notranslate nohighlight">\(\mapsto\)</span> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf1pT</span></code>,</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">FEQF2</span></code> <span class="math notranslate nohighlight">\(\mapsto\)</span> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf2pT</span></code>,</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">FEQF5</span></code> <span class="math notranslate nohighlight">\(\mapsto\)</span> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf5pT</span></code>,</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">FEQF7</span></code> <span class="math notranslate nohighlight">\(\mapsto\)</span> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf7pT</span></code>,</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">FEQF9</span></code> <span class="math notranslate nohighlight">\(\mapsto\)</span> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf9pT</span></code>,</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">FEQF13d</span></code> <span class="math notranslate nohighlight">\(\mapsto\)</span> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qfV1</span></code>,</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">FEQF23d</span></code> <span class="math notranslate nohighlight">\(\mapsto\)</span> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qfV2</span></code>,</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">FEQF53d</span></code> <span class="math notranslate nohighlight">\(\mapsto\)</span> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qfV5</span></code></p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>You can use this element to optimize the storage and reuse of functions with a long formula inside an integral for non linear processes.</p>
</section>
<section id="use-of-fespace-in-2d">
<h2>Use of fespace in 2D<a class="headerlink" href="#use-of-fespace-in-2d" title="Link to this heading"></a></h2>
<p>With the 2D finite element spaces</p>
<div class="math notranslate nohighlight">
\[X_{h} = \left\{ v \in H^{1}(]0,1[^2) |\; \forall K \in \mathcal{T}_{h}\quad v_{|K} \in P_{1} \right\}\]</div>
<div class="math notranslate nohighlight">
\[X_{ph} = \left\{ v \in X_{h} |\; v\left(\vecttwo{0}{.}\right) = v\left(\vecttwo{1}{.}\right) , v\left(\vecttwo{.}{0}\right) = v\left(\vecttwo{.}{1}\right) \right\}\]</div>
<div class="math notranslate nohighlight">
\[M_{h} = \left\{ v \in H^{1}(]0,1[^2) |\; \forall K \in \mathcal{T}_{h}\quad v_{|K} \in P_{2} \right\}\]</div>
<div class="math notranslate nohighlight">
\[R_{h} = \left\{ \mathbf{v} \in H^{1}(]0,1[^2)^{2} |\; \forall K \in \mathcal{T}_{h}\quad \mathbf{v}_{|K}(x,y) = \vecttwo{\alpha_{K}}{\beta_{K}} + \gamma_{K}\vecttwo{x}{y} \right\}\]</div>
<p>when <span class="math notranslate nohighlight">\(\mathcal{T}_h\)</span> is a mesh <span class="math notranslate nohighlight">\(10\times 10\)</span> of the unit square <span class="math notranslate nohighlight">\(]0,1[^2\)</span>, we only write in <strong>FreeFEM</strong>:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="linenos">2</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Xh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span><span class="w"> </span><span class="c1">//scalar FE</span>
<span class="linenos">3</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Xph</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="nc">P1</span><span class="p">,</span>
<span class="linenos">4</span><span class="w">    </span><span class="kp">periodic</span><span class="o">=</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kr">x</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kr">x</span><span class="p">]]);</span><span class="w"> </span><span class="c1">//bi-periodic FE</span>
<span class="linenos">5</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Mh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P2</span><span class="p">);</span><span class="w"> </span><span class="c1">//scalar FE</span>
<span class="linenos">6</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Rh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">RT0</span><span class="p">);</span><span class="w"> </span><span class="c1">//vectorial FE</span>
</pre></div>
</div>
<p>where <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Xh</span><span class="p">,</span><span class="w"> </span><span class="n">Mh</span><span class="p">,</span><span class="w"> </span><span class="n">Rh</span></code> expresses finite element spaces (called FE spaces) <span class="math notranslate nohighlight">\(X_h,\, M_h,\, R_h\)</span>, respectively.</p>
<p>To use FE-functions <span class="math notranslate nohighlight">\(u_{h},v_{h} \in X_{h}\)</span>, <span class="math notranslate nohighlight">\(p_{h},q_{h} \in M_{h}\)</span> and <span class="math notranslate nohighlight">\(U_{h},V_{h} \in R_{h}\)</span>, we write:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">Xh</span><span class="w"> </span><span class="n">uh</span><span class="p">,</span><span class="w"> </span><span class="n">vh</span><span class="p">;</span>
<span class="linenos">2</span><span class="n">Xph</span><span class="w"> </span><span class="n">uph</span><span class="p">,</span><span class="w"> </span><span class="n">vph</span><span class="p">;</span>
<span class="linenos">3</span><span class="n">Mh</span><span class="w"> </span><span class="n">ph</span><span class="p">,</span><span class="w"> </span><span class="n">qh</span><span class="p">;</span>
<span class="linenos">4</span><span class="n">Rh</span><span class="w"> </span><span class="p">[</span><span class="n">Uxh</span><span class="p">,</span><span class="w"> </span><span class="n">Uyh</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">Vxh</span><span class="p">,</span><span class="w"> </span><span class="n">Vyh</span><span class="p">];</span>
<span class="linenos">5</span><span class="n">Xh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">Uh</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w">         </span><span class="c1">//array of 10 functions in Xh</span>
<span class="linenos">6</span><span class="n">Rh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">Wxh</span><span class="p">,</span><span class="w"> </span><span class="n">Wyh</span><span class="p">](</span><span class="mi">10</span><span class="p">);</span><span class="w"> </span><span class="c1">//array of 10 functions in Rh</span>
<span class="linenos">7</span><span class="n">Wxh</span><span class="p">[</span><span class="mi">5</span><span class="p">](</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">);</span><span class="w">        </span><span class="c1">//the 6th function at point (0.5, 0.5)</span>
<span class="linenos">8</span><span class="n">Wxh</span><span class="p">[</span><span class="mi">5</span><span class="p">][];</span><span class="w">               </span><span class="c1">//the array of the degree of freedom of the 6th function</span>
</pre></div>
</div>
<p>The functions <span class="math notranslate nohighlight">\(U_{h}, V_{h}\)</span> have two components so we have</p>
<div class="math notranslate nohighlight">
\[U_{h}=\vecttwo{Uxh}{Uyh} \quad \mbox{and}\quad V_{h}=\vecttwo{Vxh}{Vyh}\]</div>
</section>
<section id="use-of-fespace-in-3d">
<h2>Use of fespace in 3D<a class="headerlink" href="#use-of-fespace-in-3d" title="Link to this heading"></a></h2>
<p>With the 3D finite element spaces</p>
<div class="math notranslate nohighlight">
\[X_{h} = \{ v \in H^{1}(]0,1[^3) |\; \forall K \in \mathcal{T}_{h}\quad v_{|K} \in P_{1} \}\]</div>
<div class="math notranslate nohighlight">
\[X_{ph} = \left\{ v \in X_{h} |\; v\left(\vectthree{0}{.}{.}\right) = v\left(\vectthree{1}{.}{.}\right) , v\left(\vectthree{.}{0}{.}\right) = v\left(\vectthree{.}{1}{.}\right) , v\left(\vectthree{.}{.}{0}\right) = v\left(\vectthree{.}{.}{1}\right) \right\}\]</div>
<div class="math notranslate nohighlight">
\[M_{h} = \{ v \in H^{1}(]0,1[^3) |\; \forall K \in \mathcal{T}_{h}\quad v_{|K} \in P_{2} \}\]</div>
<div class="math notranslate nohighlight">
\[R_{h} = \left\{ \mathbf{v} \in H^{1}(]0,1[^3)^{2} |\; \forall K \in \mathcal{T}_{h}\quad \mathbf{v}_{|K}(x,y,z) = \vectthree{\alpha_{K}}{\beta_{K}}{\gamma_{K}} + \delta_{K}\vectthree{x}{y}{z} \right\}\]</div>
<p>when <span class="math notranslate nohighlight">\(\mathcal{T}_h\)</span> is a mesh <span class="math notranslate nohighlight">\(10\times 10\times 10\)</span> of the unit cubic <span class="math notranslate nohighlight">\(]0,1[^2\)</span>, we write in <strong>FreeFEM</strong>:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">//label: 0 up, 1 down, 2 front, 3 left, 4 back, 5 right</span>
<span class="linenos"> 2</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nn</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>
<span class="linenos"> 3</span><span class="w">    </span><span class="kt">mesh3</span><span class="w"> </span><span class="n">Th</span><span class="o">=</span><span class="nf">buildlayers</span><span class="p">(</span><span class="nf">square</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span><span class="n">nn</span><span class="p">,</span><span class="kr">region</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">nn</span><span class="p">,</span>
<span class="linenos"> 4</span><span class="w">      </span><span class="kp">zbound</span><span class="o">=</span><span class="p">[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span><span class="w"> </span><span class="kp">labelmid</span><span class="o">=</span><span class="n">rmid</span><span class="p">,</span><span class="w"> </span><span class="kp">reffaceup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rup</span><span class="p">,</span>
<span class="linenos"> 5</span><span class="w">      </span><span class="kp">reffacelow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rdown</span><span class="p">);</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Xh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span><span class="w"> </span><span class="c1">//scalar FE</span>
<span class="linenos"> 8</span><span class="w">    </span><span class="c1">// a FE space with full periodic condition in 3 axes</span>
<span class="linenos"> 9</span><span class="w">    </span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Xph</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="nc">P1</span><span class="p">,</span><span class="kp">periodic</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="kr">y</span><span class="p">,</span><span class="kr">z</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="kr">y</span><span class="p">,</span><span class="kr">z</span><span class="p">],</span>
<span class="linenos">10</span><span class="w">                     </span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="kr">x</span><span class="p">,</span><span class="kr">z</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="kr">x</span><span class="p">,</span><span class="kr">z</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">]]);</span>
<span class="linenos">11</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Mh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P2</span><span class="p">);</span><span class="w"> </span><span class="c1">//scalar FE</span>
<span class="linenos">12</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Rh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">RT03d</span><span class="p">);</span><span class="w"> </span><span class="c1">//vectorial FE</span>
</pre></div>
</div>
<p>where <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Xh</span><span class="p">,</span><span class="w"> </span><span class="n">Mh</span><span class="p">,</span><span class="w"> </span><span class="n">Rh</span></code> expresses finite element spaces (called FE spaces) <span class="math notranslate nohighlight">\(X_h,\, M_h,\, R_h\)</span>, respectively.</p>
<p>The functions <span class="math notranslate nohighlight">\(U_{h}, V_{h}\)</span> have two components so we have</p>
</section>
<section id="use-of-fespace-in-surface-3d">
<h2>Use of fespace in surface 3D<a class="headerlink" href="#use-of-fespace-in-surface-3d" title="Link to this heading"></a></h2>
<p>With the 3D finite element spaces</p>
<div class="math notranslate nohighlight">
\[X_{h} = \{ v \in H^{1}(]0,1[^3) |\; \forall K \in \mathcal{T}_{h}\quad v_{|K} \in P_{1} \}\]</div>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">meshS</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">square3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="linenos">2</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Xh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span><span class="w"> </span><span class="c1">//scalar FE</span>
</pre></div>
</div>
<p>where <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Xh</span></code> expresses finite element spaces (called FE spaces) <span class="math notranslate nohighlight">\(X_h\)</span>, respectively.</p>
<p>To use FE-functions <span class="math notranslate nohighlight">\(u_{h},v_{h} \in X_{h}\)</span>, <span class="math notranslate nohighlight">\(p_{h},q_{h} \in M_{h}\)</span> and <span class="math notranslate nohighlight">\(U_{h},V_{h} \in R_{h}\)</span>, we write:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">Xh</span><span class="w"> </span><span class="n">uh</span><span class="p">,</span><span class="w"> </span><span class="n">vh</span><span class="p">;</span>
<span class="linenos">2</span><span class="n">Xh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">Uh</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w">         </span><span class="c1">//array of 10 functions in Xh</span>
</pre></div>
</div>
</section>
<section id="finite-element-functions">
<h2>Finite Element functions<a class="headerlink" href="#finite-element-functions" title="Link to this heading"></a></h2>
<p>To define and use FE-functions <span class="math notranslate nohighlight">\(u_{h},v_{h} \in X_{h}\)</span>, <span class="math notranslate nohighlight">\(p_{h},q_{h} \in M_{h}\)</span> and <span class="math notranslate nohighlight">\(U_{h},V_{h} \in R_{h}\)</span>, we write:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">Xh</span><span class="w"> </span><span class="n">uh</span><span class="p">,</span><span class="w"> </span><span class="n">vh</span><span class="p">;</span>
<span class="linenos">2</span><span class="n">Xph</span><span class="w"> </span><span class="n">uph</span><span class="p">,</span><span class="w"> </span><span class="n">vph</span><span class="p">;</span>
<span class="linenos">3</span><span class="n">Mh</span><span class="w"> </span><span class="n">ph</span><span class="p">,</span><span class="w"> </span><span class="n">qh</span><span class="p">;</span>
<span class="linenos">4</span><span class="n">Rh</span><span class="w"> </span><span class="p">[</span><span class="n">Uxh</span><span class="p">,</span><span class="w"> </span><span class="n">Uyh</span><span class="p">,</span><span class="w"> </span><span class="n">Uyzh</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">Vxh</span><span class="p">,</span><span class="w"> </span><span class="n">Vyh</span><span class="p">,</span><span class="w"> </span><span class="n">Vyzh</span><span class="p">];</span>
<span class="linenos">5</span><span class="n">Xh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">Uh</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w">             </span><span class="c1">//array of 10 functions in Xh</span>
<span class="linenos">6</span><span class="n">Rh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">Wxh</span><span class="p">,</span><span class="n">Wyh</span><span class="p">,</span><span class="n">Wzh</span><span class="p">](</span><span class="mi">10</span><span class="p">);</span><span class="w">  </span><span class="c1">// array of 10 functions in Rh</span>
<span class="linenos">7</span><span class="n">Wxh</span><span class="p">[</span><span class="mi">5</span><span class="p">](</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">);</span><span class="w">        </span><span class="c1">//the 6th function at point (0.5, 0.5, 0.5)</span>
<span class="linenos">8</span><span class="n">Wxh</span><span class="p">[</span><span class="mi">5</span><span class="p">][];</span><span class="w">                   </span><span class="c1">//the array of the degree of freedom of the 6th function</span>
</pre></div>
</div>
<p>The functions <span class="math notranslate nohighlight">\(U_{h}, V_{h}\)</span> have three components, so we have:</p>
<div class="math notranslate nohighlight">
\[U_{h}=\vectthree{(U_h)_x}{(U_h)_y}{(U_h)_z} \quad \mbox{and}\quad V_{h}=\vectthree{(V_h)_x}{(V_h)_y}{(V_h)_z}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One challenge of the periodic boundary condition is that the mesh must have equivalent faces.</p>
<p>The <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">buildlayers</span></code> mesh generator splits each quadrilateral face with the diagonal passing through the vertex with maximum number, so to be sure to have the same mesh one both face periodic the 2D numbering in corresponding edges must be compatible (for example the same variation).</p>
<p>By Default, the numbering of square vertex is correct.</p>
<p>To change the mesh numbering you can use the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">change</span></code> function like:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="p">{</span>
<span class="linenos">2</span><span class="w">    </span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">old2new</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="n">Th</span><span class="p">.</span><span class="kr">nv</span><span class="mi">-1</span><span class="p">);</span><span class="w"> </span><span class="c1">//array set on 0, 1, .., nv-1</span>
<span class="linenos">3</span><span class="w">    </span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh2</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos">4</span><span class="w">    </span><span class="n">Vh2</span><span class="w"> </span><span class="n">sorder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">x</span><span class="o">+</span><span class="kr">y</span><span class="p">;</span><span class="w"> </span><span class="c1">//choose an order increasing on 4 square borders with x or y</span>
<span class="linenos">5</span><span class="w">    </span><span class="nf">sort</span><span class="p">(</span><span class="n">sorder</span><span class="p">[],</span><span class="w"> </span><span class="n">old2new</span><span class="p">);</span><span class="w"> </span><span class="c1">//build the inverse permutation</span>
<span class="linenos">6</span><span class="w">    </span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">new2old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">old2new</span><span class="o">^</span><span class="mi">-1</span><span class="p">;</span><span class="w"> </span><span class="c1">//inverse the permutation</span>
<span class="linenos">7</span><span class="w">    </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">change</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">renumv</span><span class="o">=</span><span class="n">new2old</span><span class="p">);</span>
<span class="linenos">8</span><span class="p">}</span>
</pre></div>
</div>
<p>The full example is in <a class="reference internal" href="../examples/finite-element.html#exampleperiodic3d"><span class="std std-ref">examples</span></a>.</p>
</div>
</section>
<section id="lagrangian-finite-elements">
<h2>Lagrangian Finite Elements<a class="headerlink" href="#lagrangian-finite-elements" title="Link to this heading"></a></h2>
<section id="p0-element">
<h3>P0-element<a class="headerlink" href="#p0-element" title="Link to this heading"></a></h3>
<p>For each triangle (d=2) or tetrahedron (d=3) <span class="math notranslate nohighlight">\(T_k\)</span>, the basis function <span class="math notranslate nohighlight">\(\phi_k\)</span> in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P0</span><span class="p">)</span></code> is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\phi_k(\mathbf{x})=
\left\{
\begin{array}{cl}
    1 &amp; \textrm{ if }(\mathbf{x})\in T_k\\
    0 &amp; \textrm{ if }(\mathbf{x})\not\in T_k
\end{array}
\right.\end{split}\]</div>
<p>If we write:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P0</span><span class="p">);</span>
<span class="linenos">2</span><span class="n">Vh</span><span class="w"> </span><span class="n">fh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">);</span>
</pre></div>
</div>
<p>then for vertices <span class="math notranslate nohighlight">\(q^{k_i},\, i=1,2,.. d+1\)</span> in <a class="reference internal" href="#finiteelementp1p2"><span class="std std-numref">Fig. 98</span></a>, <span class="math notranslate nohighlight">\(f_h\)</span> is built as <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">fh</span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle f_h(x,y)=\sum_k f(\frac{\sum_i q^{k_i}}{d+1}) \phi_k\)</span></p>
<p>See <a class="reference internal" href="#finiteelementprojp0"><span class="std std-numref">Fig. 100</span></a> for the projection of <span class="math notranslate nohighlight">\(f(x,y)=\sin(\pi x)\cos(\pi y)\)</span> on <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P0</span><span class="p">)</span></code> when the mesh <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code> is a <span class="math notranslate nohighlight">\(4\times 4\)</span>-grid of <span class="math notranslate nohighlight">\([-1,1]^2\)</span> as in <a class="reference internal" href="#finiteelementp0p1p2p1nc"><span class="std std-numref">Fig. 99</span></a>.</p>
</section>
<section id="p1-element">
<h3>P1-element<a class="headerlink" href="#p1-element" title="Link to this heading"></a></h3>
<figure class="align-default" id="finiteelementp1p2">
<a class="reference internal image-reference" href="../_images/FiniteElement_P1P2.png"><img alt="../_images/FiniteElement_P1P2.png" src="../_images/FiniteElement_P1P2.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 98 </span><span class="caption-text"><span class="math notranslate nohighlight">\(P_1\)</span> and <span class="math notranslate nohighlight">\(P_2\)</span> degrees of freedom on triangle <span class="math notranslate nohighlight">\(T_k\)</span></span><a class="headerlink" href="#finiteelementp1p2" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>For each vertex <span class="math notranslate nohighlight">\(q^i\)</span>, the basis function <span class="math notranslate nohighlight">\(\phi_i\)</span> in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">)</span></code> is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\phi_i(x,y)&amp;=a^k_i+b^k_ix+c^k_iy \textrm{ for }(x,y)\in T_k,\\
\phi_i(q^i)&amp;=1,\quad \phi_i(q^j)=0 \textrm{ if }i\neq j\end{split}\]</div>
<p>The basis function <span class="math notranslate nohighlight">\(\phi_{k_1}(x,y)\)</span> with the vertex <span class="math notranslate nohighlight">\(q^{k_1}\)</span> in <a class="reference internal" href="#finiteelementp1p2"><span class="std std-numref">Fig. 98</span></a> at point <span class="math notranslate nohighlight">\(p=(x,y)\)</span> in triangle <span class="math notranslate nohighlight">\(T_k\)</span> simply coincide with the <em>barycentric coordinates</em> <span class="math notranslate nohighlight">\(\lambda^k_1\)</span> <em>(area coordinates)</em>:</p>
<div class="math notranslate nohighlight">
\[\phi_{k_1}(x,y) = \lambda^k_{1}(x,y)=
\frac{\textrm{area of triangle} (p, q^{k_2},q^{k_3})}
{\textrm{area of triangle}(q^{k_1},q^{k_2},q^{k_3})}\]</div>
<p>If we write:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos">2</span><span class="n">Vh</span><span class="w"> </span><span class="n">fh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="kr">x</span><span class="p">.</span><span class="kr">y</span><span class="p">);</span>
</pre></div>
</div>
<p>then:</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">fh</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle f_h(x,y)=\sum_{i=1}^{n_v}f(q^i)\phi_i(x,y)\)</span></p>
<p>See <a class="reference internal" href="#finiteelementprojp1"><span class="std std-numref">Fig. 101</span></a> for the projection of <span class="math notranslate nohighlight">\(f(x,y)=\sin(\pi x)\cos(\pi y)\)</span> into <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">)</span></code>.</p>
<div class="figure compound align-center" id="FiniteElement">
<figure class="align-default" id="id8">
<span id="finiteelementp0p1p2p1nc"></span><a class="reference internal image-reference" href="../_images/FiniteElement_P0P1P2P1nc.png"><img alt="FiniteElement_P0P1P2P1nc" src="../_images/FiniteElement_P0P1P2P1nc.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 99 </span><span class="caption-text">Test mesh <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code> for projection</span><a class="headerlink" href="#id8" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id9">
<span id="finiteelementprojp0"></span><a class="reference internal image-reference" href="../_images/FiniteElement_projP0.png"><img alt="FiniteElement_projP0" src="../_images/FiniteElement_projP0.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 100 </span><span class="caption-text">Projection to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P0</span><span class="p">)</span></code></span><a class="headerlink" href="#id9" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><span class="caption-text">Finite element <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P0</span></code></span></p>
</div></section>
<section id="p2-element">
<span id="FiniteElement"></span><h3>P2-element<a class="headerlink" href="#p2-element" title="Link to this heading"></a></h3>
<p>For each vertex or mid-point <span class="math notranslate nohighlight">\(q^i\)</span>.
The basis function <span class="math notranslate nohighlight">\(\phi_i\)</span> in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P2</span><span class="p">)</span></code> is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{rcl}
    \phi_i(x,y)&amp;=&amp;a^k_i+b^k_ix+c^k_iy+d^k_ix^2+e^k_ixy+f^f_jy^2\textrm{ for }(x,y)\in T_k,\\
    \phi_i(q^i)&amp;=&amp;1,\quad \phi_i(q^j)=0\textrm{ if }i\neq j
\end{array}\end{split}\]</div>
<p>The basis function <span class="math notranslate nohighlight">\(\phi_{k_1}(x,y)\)</span> with the vertex <span class="math notranslate nohighlight">\(q^{k_1}\)</span> in <a class="reference internal" href="#finiteelementp1p2"><span class="std std-numref">Fig. 98</span></a> is defined by the <em>barycentric coordinates</em>:</p>
<div class="math notranslate nohighlight">
\[\phi_{k_1}(x,y) = \lambda^k_{1}(x,y)(2\lambda^k_1(x,y)-1)\]</div>
<p>and for the mid-point <span class="math notranslate nohighlight">\(q^{k_2}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\phi_{k_2}(x,y) = 4\lambda^k_1(x,y)\lambda^k_4(x,y)\]</div>
<p>If we write:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P2</span><span class="p">);</span>
<span class="linenos">2</span><span class="n">Vh</span><span class="w"> </span><span class="n">fh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="kr">x</span><span class="p">.</span><span class="kr">y</span><span class="p">);</span>
</pre></div>
</div>
<p>then:</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">fh</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle f_h(x,y)=\sum_{i=1}^{M}f(q^i)\phi_i(x,y)\quad (\textrm{summation over all vertex or mid-point})\)</span></p>
<p>See <a class="reference internal" href="#finiteelementprojp2"><span class="std std-ref">Projection to Vh(Th, P2)</span></a> for the projection of <span class="math notranslate nohighlight">\(f(x,y)=\sin(\pi x)\cos(\pi y)\)</span> into <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P2</span><span class="p">)</span></code>.</p>
<div class="figure compound align-center" id="FiniteElement">
<figure class="align-default" id="id10">
<span id="finiteelementprojp1"></span><a class="reference internal image-reference" href="../_images/FiniteElement_projP1.png"><img alt="FiniteElement_projP1" src="../_images/FiniteElement_projP1.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 101 </span><span class="caption-text">Projection to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">)</span></code></span><a class="headerlink" href="#id10" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id11">
<span id="finiteelementprojp2"></span><a class="reference internal image-reference" href="../_images/FiniteElement_projP2.png"><img alt="FiniteElement_projP2" src="../_images/FiniteElement_projP2.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 102 </span><span class="caption-text">Projection to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P2</span><span class="p">)</span></code></span><a class="headerlink" href="#id11" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><span class="caption-text">Finite elements <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1</span><span class="p">,</span><span class="w"> </span><span class="nc">P2</span></code></span></p>
</div></section>
</section>
<section id="surface-lagrangian-finite-elements">
<span id="surfacepklagrange"></span><span id="FiniteElement"></span><h2>Surface Lagrangian Finite Elements<a class="headerlink" href="#surface-lagrangian-finite-elements" title="Link to this heading"></a></h2>
<section id="definition-of-the-surface-p1-lagragian-element">
<h3>Definition of the surface P1 Lagragian element<a class="headerlink" href="#definition-of-the-surface-p1-lagragian-element" title="Link to this heading"></a></h3>
<p>To build the surface Pk-Lagrange, the main idea is to consider the usual 2d Lagrangian Finite Elements ; and its writing in barycentric coordinates ; apply a space transformation and barycentric properties.
The FreeFEM finite elements for surface problem are: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P0</span></code> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1</span></code> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P2</span></code> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1b</span></code>.</p>
<p><em>0) Notation</em></p>
<blockquote>
<div><ul class="simple">
<li><p>Let <span class="math notranslate nohighlight">\(\hat K\)</span> be the shape triangle in the space <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> of vertice <span class="math notranslate nohighlight">\((i_0,i_1,i_2)\)</span></p></li>
<li><p>Let <span class="math notranslate nohighlight">\(K\)</span> be a triangle of the space <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> of vertice <span class="math notranslate nohighlight">\((A_0,A_1,A_2)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x_q\)</span> a quadrature point on K</p></li>
<li><p><span class="math notranslate nohighlight">\(X_q\)</span> a quadrature point on A</p></li>
<li><p><span class="math notranslate nohighlight">\(P1_{2d}\)</span> designates 2d P1 Lagrangian Finite Elements</p></li>
<li><p><span class="math notranslate nohighlight">\(P1_{S}\)</span> designates surface 3d P1 Lagrangian Finite Elements</p></li>
<li><p><span class="math notranslate nohighlight">\((\lambda_i)_{i=0}^2\)</span> shape fonction of <span class="math notranslate nohighlight">\(\hat K\)</span> (<span class="math notranslate nohighlight">\(P1_{2d}\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\((\psi_i)_{i=0}^2\)</span> shape fonction of of <span class="math notranslate nohighlight">\(K\)</span> (<span class="math notranslate nohighlight">\(P1_S\)</span> )</p></li>
</ul>
</div></blockquote>
<p><em>1) Geometric transformation: from the current FE to the reference FE</em></p>
<p>Let be <span class="math notranslate nohighlight">\(\hat x= \begin{pmatrix}   \hat x \\ \hat y  \end{pmatrix}\)</span> a point of the triangle <span class="math notranslate nohighlight">\(\hat K \subset \mathbb{R}^2\)</span> and <span class="math notranslate nohighlight">\(X= \begin{pmatrix}   x \\  y  \\ z \end{pmatrix}\)</span> a point of the triangle <span class="math notranslate nohighlight">\(K \subset \mathbb{R}^3\)</span>, where <span class="math notranslate nohighlight">\(\hat x\)</span> and <span class="math notranslate nohighlight">\(\hat X\)</span> are expressed in baricentric coordinates.</p>
<p>The motivation here is to parameterize the 3d surface mesh to the reference 2d triangle, thus to be reduced to a finite element 2d P1.
Let’s define a geometric transformation F, such as <span class="math notranslate nohighlight">\(F: \mathbb{R}^2 \rightarrow \mathbb{R}^3\)</span></p>
<p>However, thus defines transformation F as not bijective.</p>
<p>So, consider the following approximation</p>
<div class="math notranslate nohighlight">
\[\begin{split}\tilde F: \mathbb{R}^2 &amp;\rightarrow \mathbb{R}^3  \\
\hat{x}   &amp;\rightarrow  X  \\
\begin{pmatrix} x \\ y \\ 0 \end{pmatrix} &amp;\rightarrow  \begin{pmatrix} \overrightarrow {A_0 A_1} \\ \overrightarrow {A_0A_2} \\ \overrightarrow {A_0A_1} \wedge  \overrightarrow     {A_0A_2} \end{pmatrix} ( \hat{x} -A_0)\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\wedge\)</span> denote the usual vector product.</p>
<figure class="align-default" id="id12">
<a class="reference internal image-reference" href="../_images/geotransfo_P1s.png"><img alt="" src="../_images/geotransfo_P1s.png" style="width: 60%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 103 </span><span class="caption-text">F, a parameterization from the reference 2d triangle to a 3d surface triangle</span><a class="headerlink" href="#id12" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><span class="math notranslate nohighlight">\(\overrightarrow {A0A1} \wedge  \overrightarrow {A_0A_2} = \begin{pmatrix} n_x \\ n_y \\ n_z \end{pmatrix}\)</span>  defines the normal to the tangent plane generated by <span class="math notranslate nohighlight">\(( A_0,\overrightarrow {A_0A_1}, \overrightarrow {A_0A_2} )\)</span></p>
</div>
<p>The affine transformation <span class="math notranslate nohighlight">\(\tilde F\)</span> allows you to pass from the 2d reference triangle, which we project in <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> to the 3d current triangle, discretizing the surface we note <span class="math notranslate nohighlight">\(\Gamma\)</span>.</p>
<p>Then <span class="math notranslate nohighlight">\(\tilde F^{-1}\)</span> is well defined and allows to return to the reference triangle <span class="math notranslate nohighlight">\(\hat K\)</span>, to the usual coordinates of <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> completed by the coordinate <span class="math notranslate nohighlight">\(z=0\)</span>.</p>
<p><em>2) Interpolation element fini</em></p>
<p>Remember that the reference geometric element for the finite element <span class="math notranslate nohighlight">\(P1s\)</span> that we are building is the reference triangle <span class="math notranslate nohighlight">\(\hat K\)</span> in the vertex plane <span class="math notranslate nohighlight">\((i_0, i_1, i_2\)</span>), which we project into space by posing <span class="math notranslate nohighlight">\(z=0\)</span> by the membrane hypothesis.</p>
<p>Hence <span class="math notranslate nohighlight">\(i_0 = \begin{pmatrix} 0 \\ 0 \\ 0 \end{pmatrix}\)</span>, <span class="math notranslate nohighlight">\(i_1 = \begin{pmatrix} 1 \\ 0 \\ 0  \end{pmatrix}\)</span>, <span class="math notranslate nohighlight">\(i_1 = \begin{pmatrix} 0 \\ 1 \\ 0 \end{pmatrix}\)</span>.</p>
<p>Let X be a point of the current triangle K, we have X= <span class="math notranslate nohighlight">\(\tilde F(\hat{x})\)</span>.
The barycentric coordinates of X in K are given by:
<span class="math notranslate nohighlight">\(X = \sum_{i=0} ^2  A_i \hat \lambda(\hat{x})\)</span> où</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A_i\)</span> the points of the current triangle K</p></li>
<li><p><span class="math notranslate nohighlight">\(\hat \lambda_i\)</span> basic functions <span class="math notranslate nohighlight">\(P1_{2d}\)</span></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\hat \lambda_0(x,y) = 1-x-y\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\hat \lambda_1(x,y) = x\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\hat \lambda_2(x,y) = y\)</span></p></li>
</ul>
</div></blockquote>
</div></blockquote>
<p>We need to define a quadrature formula for the finite element approximation. The usual formulation for a 2d triangle will be used by redefining the quadrature points
<span class="math notranslate nohighlight">\(X_q = x_q = \begin{pmatrix} \hat x_q \\ \hat y_q \\ 0 \end{pmatrix}\)</span>.</p>
<p><em>3) The Lagragian P1 functions and theirs 1st order derivatives</em></p>
<p>The finite element interpolation gives us the following relationship:
<span class="math notranslate nohighlight">\(\psi_i(X) = F^{-1} (\psi_i)( F^{-1} (X))\)</span>.
To find the expression of the basic functions <span class="math notranslate nohighlight">\(\psi\)</span> on the current triangle K, it is sufficient to use the inverse of the transformation <span class="math notranslate nohighlight">\(\tilde F\)</span> to get back to the reference triangle <span class="math notranslate nohighlight">\(\hat K\)</span>.
However in FreeFEM, the definition of the reference finite element, the current geometry is based on barycentric coordinates in order not to use geometric transformation. <span class="math notranslate nohighlight">\(\tilde F\)</span>.
The method used here is  geometric and based on the properties of the vector product and the area of the current triangle K.</p>
<p><em>i) The shape functions</em></p>
<p>Let be the triangle K of vertices <span class="math notranslate nohighlight">\(i_0, i_1, i_2 \subset  \mathbb{R}^3\)</span> and <span class="math notranslate nohighlight">\((\lambda_i)_{i=0} ^2\)</span> the local barycentric coordinates at K.
The normal is defined as the tangent plane generated by <span class="math notranslate nohighlight">\((A_0,  \overrightarrow {A_0A_1},  \overrightarrow {A_0A_2})\)</span>, \
<span class="math notranslate nohighlight">\(\vec n =  \overrightarrow {A_0A_1} \wedge  \overrightarrow {A_0A_2}\)</span> avec <span class="math notranslate nohighlight">\(\mid \mid \vec n \mid \mid  = 2 \text{ mes }(\hat K)\)</span>.</p>
<p>Le denotes the operator V, defines the usual vector product of  <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> such as <span class="math notranslate nohighlight">\(V(A,B,C) =  (B-A) \wedge (C-A)\)</span></p>
<p>The mixed product of three vectors u, v, w, noté <span class="math notranslate nohighlight">\([u, v, w]\)</span>, is the determinant of these three vectors in any direct orthonormal basis, thus
<span class="math notranslate nohighlight">\((A \wedge V,C)= \text{ det }(A,B,C)\)</span></p>
<p>with <span class="math notranslate nohighlight">\((.,.)\)</span> is the usual scalar product of <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>. \
Let Ph :math:` in mathbb{R}^3` and P his projected in the triangle K such as:</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/subtriangle_P1s.png"><img alt="" src="../_images/subtriangle_P1s.png" style="width: 40%;" /></a>
</figure>
<p>Let’s lay the sub-triangles as follows :</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(K_0 = (P,A1,A2)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(K_1 = (A0,P,A2)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(K_2 = (A0,A1,P)\)</span></p></li>
</ul>
</div></blockquote>
<p>with  <span class="math notranslate nohighlight">\(K = K_0 \cup K_1 \cup K_2\)</span>.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Properties in <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span></dt><dd><ul class="simple">
<li><p>Let <span class="math notranslate nohighlight">\(\vec n\)</span> be the normal to the tangent plane generated by <span class="math notranslate nohighlight">\((A_0, \overrightarrow {A_0A_1}, \overrightarrow {A_0A_2})\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\vec n =\overrightarrow {A_0 A_1} \wedge \overrightarrow {A_0 A_2}\)</span></p></li>
<li><p>By definition,  <span class="math notranslate nohighlight">\(\mathcal{A}= \frac{1}{2} \mid &lt; \vec n,\vec n&gt; \mid\)</span> and the vectorial area by <span class="math notranslate nohighlight">\(\mathcal{A^S}= \frac{1}{2} &lt; \vec n,\vec n&gt;\)</span> hence  <span class="math notranslate nohighlight">\(\mathcal{A^S} (PBC)= \frac{1}{2} &lt; \vec n_0,\vec n&gt;\)</span>, with <span class="math notranslate nohighlight">\(\vec n_0\)</span> the normal vector to the plane (PBC)</p></li>
</ul>
</dd>
</dl>
</div>
</div></blockquote>
<p>Let’s define the respective vector areas</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\vec N_0(P) =  V(P,A1,A2)\)</span> the vectorial area of K0</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec N_1(P) =  V(A0,P,A2)\)</span> the vectorial area of K1</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec N_2(P) =  V(A0,A1,P)\)</span> the vectorial area of K2</p></li>
</ul>
</div></blockquote>
<p>By definition, in 3d, the barycentric coordinates are given by algebraic area ratio: :math:` lambda_i(P) = frac {(vec N_i(P),vec N)}{(vec N,vec N)}label{basisfunc}`</p>
<p>Note that <span class="math notranslate nohighlight">\((\vec N_i(P) ,\vec N) = 2 \text{ sign } \text{ mes } (K_i) \mid \mid \vec N \mid \mid\)</span>
and <span class="math notranslate nohighlight">\((\vec N,\vec N) = 2 \text{ sign } \text{ mes } (K)  \mid \mid \vec N \mid \mid\)</span>, avec <span class="math notranslate nohighlight">\(sign\)</span> the orientation of the current triangle compared to the reference triangle.</p>
<p>We find the finite element interpolation,  <span class="math notranslate nohighlight">\(P = \sum_{i=0}^2  \lambda_i(P) A_i\)</span>.</p>
<p><em>ii) 1st order derivatives of Lagrangian P1 FE</em></p>
<p>Let <span class="math notranslate nohighlight">\(\vec Y\)</span> be any vector of <span class="math notranslate nohighlight">\(\in \mathbb{R}^3\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
(\vec N_2(P) ,\vec Y) &amp;= ( (A_1-A_0) \wedge (P-A_0),Y) \\
&amp;=\text{det}(A_1-A_0,P-A_0,Y)  \\
&amp;= \text{det}(A_1-A_0,P,Y)- \text{det}(A_1-A_0,A_0,Y)
\end{aligned}\end{split}\]</div>
<p>Let’s calculate the differential of <span class="math notranslate nohighlight">\((\vec N_2(P),Y), \forall Y\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}D_P (\vec N_2(P) ,\vec Y)  =  \text{det} (A_1-A_0,P',Y) dP \\
\begin{aligned}
\nabla_P (\vec N_2(P) ,\vec Y) &amp;= \text{ det } (A_1-A_0, P' ,\vec Y) \\
&amp;= - det (A_1-A_0, \vec Y, P') \\
&amp;= - (A_1-A_0) \wedge \vec Y . P' \\
&amp;=  \vec Y \wedge (A_1-A_0)
\end{aligned}\end{split}\]</div>
<p>Consider in particular <span class="math notranslate nohighlight">\(\vec Y = \vec N\)</span>, then</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\nabla_P (\vec N_2(P) ,\vec N) &amp;=  \vec N \wedge (A_1-A_0) \\
&amp;=  \vec N \wedge E_2
&amp;= - \text{det} (A_1-A_0, \vec Y, P')
\end{aligned}\end{split}\]</div>
<p>This leads to
:math:` nabla_P lambda_2(P) = frac {(vec N wedge E_2)}{(vec N,vec N)} `</p>
<p>By similar calculations for <span class="math notranslate nohighlight">\(\vec N_0(P)$ et $\vec N_1(P)\)</span></p>
<p><span class="math notranslate nohighlight">\(\nabla_P \lambda_i(P) = \frac {(\vec N \wedge E_i)}{(\vec N,\vec N)}\label{derivbasisfunc}\)</span></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>With the definition of the surface gradient and the 2d Pk-Lagrange FE used barycentric coordinates, surface Pk-Langrange FE are trivial.</p>
</div>
</section>
</section>
<section id="p1-nonconforming-element">
<h2>P1 Nonconforming Element<a class="headerlink" href="#p1-nonconforming-element" title="Link to this heading"></a></h2>
<p>Refer to <a class="reference internal" href="../bibliography.html#thomasset2012" id="id3"><span>[THOMASSET2012]</span></a> for details; briefly, we now consider non-continuous approximations so we will lose the property:</p>
<div class="math notranslate nohighlight">
\[w_h\in V_h\subset H^1(\Omega)\]</div>
<p>If we write:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1nc</span><span class="p">);</span>
<span class="linenos">2</span><span class="n">Vh</span><span class="w"> </span><span class="n">fh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="kr">x</span><span class="p">.</span><span class="kr">y</span><span class="p">);</span>
</pre></div>
</div>
<p>then:</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">fh</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle f_h(x,y)=\sum_{i=1}^{n_v}f(m^i)\phi_i(x,y)\quad (\textrm{summation over all midpoint})\)</span></p>
<p>Here the basis function <span class="math notranslate nohighlight">\(\phi_i\)</span> associated with the mid-point <span class="math notranslate nohighlight">\(m^i=(q^{k_i}+q^{k_{i+1}})/2\)</span> where <span class="math notranslate nohighlight">\(q^{k_i}\)</span> is the <span class="math notranslate nohighlight">\(i\)</span>-th point in <span class="math notranslate nohighlight">\(T_k\)</span>, and we assume that <span class="math notranslate nohighlight">\(j+1=0\)</span> if <span class="math notranslate nohighlight">\(j=3\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\phi_i(x,y) &amp;= a^k_i+b^k_ix+c^k_iy~\textrm{for }(x,y)\in T_k,\\
\phi_i(m^i) &amp;= 1,\quad \phi_i(m^j)=0\textrm{ if }i\neq j\end{split}\]</div>
<p>Strictly speaking <span class="math notranslate nohighlight">\(\p \phi_i/\p x,\, \p \phi_i/\p y\)</span> contain Dirac distribution <span class="math notranslate nohighlight">\(\rho \delta_{\p T_k}\)</span>.</p>
<p>The numerical calculations will automatically <em>ignore</em> them.
In <a class="reference internal" href="../bibliography.html#thomasset2012" id="id4"><span>[THOMASSET2012]</span></a>, there is a proof of the estimation</p>
<div class="math notranslate nohighlight">
\[\left(\sum_{k=1}^{n_v}\int_{T_k}|\nabla w-\nabla w_h|^2\d x\d y\right)^{1/2} =O(h)\]</div>
<p>The basis functions <span class="math notranslate nohighlight">\(\phi_k\)</span> have the following properties.</p>
<ol class="arabic">
<li><p>For the bilinear form <span class="math notranslate nohighlight">\(a\)</span> defined in <a class="reference internal" href="#finiteelementprojp1nc"><span class="std std-numref">Fig. 104</span></a> satisfy:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{rcl}
    a(\phi_i,\phi_i)&gt;0,\qquad a(\phi_i,\phi_j)&amp;\le&amp; 0\quad\textrm{if }i\neq j\\
    \sum_{k=1}^{n_v}a(\phi_i,\phi_k)&amp;\ge&amp; 0
\end{array}\end{split}\]</div>
</div></blockquote>
</li>
<li><p><span class="math notranslate nohighlight">\(f\ge 0 \Rightarrow u_h\ge 0\)</span></p></li>
<li><p>If <span class="math notranslate nohighlight">\(i\neq j\)</span>, the basis function <span class="math notranslate nohighlight">\(\phi_i\)</span> and <span class="math notranslate nohighlight">\(\phi_j\)</span> are <span class="math notranslate nohighlight">\(L^2\)</span>-orthogonal:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\int_{\Omega}\phi_i\phi_j\, \d x\d y=0\qquad \textrm{if }i\neq j\]</div>
<p>which is false for <span class="math notranslate nohighlight">\(P_1\)</span>-element.</p>
</div></blockquote>
</li>
</ol>
<p>See <a class="reference internal" href="#finiteelementprojp1nc"><span class="std std-numref">Fig. 104</span></a> for the projection of <span class="math notranslate nohighlight">\(f(x,y)=\sin(\pi x)\cos(\pi y)\)</span> into <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1nc</span><span class="p">)</span></code>.</p>
<div class="figure compound align-center" id="FiniteElement">
<figure class="align-default" id="id13">
<span id="finiteelementprojp1nc"></span><a class="reference internal image-reference" href="../_images/FiniteElement_projP1nc.png"><img alt="FiniteElement_projP1nc" src="../_images/FiniteElement_projP1nc.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 104 </span><span class="caption-text">Projection to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1nc</span><span class="p">)</span></code></span><a class="headerlink" href="#id13" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id14">
<span id="finiteelementprojp1b"></span><a class="reference internal image-reference" href="../_images/FiniteElement_projP1b.png"><img alt="FiniteElement_projP1b" src="../_images/FiniteElement_projP1b.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 105 </span><span class="caption-text">Projection to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1b</span><span class="p">)</span></code></span><a class="headerlink" href="#id14" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><span class="caption-text">Finite elements <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1nc</span><span class="p">,</span><span class="w"> </span><span class="nc">P1b</span></code></span></p>
</div></section>
<section id="other-fe-space">
<span id="FiniteElement"></span><h2>Other FE-space<a class="headerlink" href="#other-fe-space" title="Link to this heading"></a></h2>
<p>For each triangle <span class="math notranslate nohighlight">\(T_k\in \mathcal{T}_h\)</span>, let <span class="math notranslate nohighlight">\(\lambda_{k_1}(x,y),\, \lambda_{k_2}(x,y),\, \lambda_{k_3}(x,y)\)</span> be the area cordinate of the triangle (see <a class="reference internal" href="#finiteelementp1p2"><span class="std std-numref">Fig. 98</span></a>), and put:</p>
<div class="math notranslate nohighlight">
\[\beta_k(x,y)=27\lambda_{k_1}(x,y)\lambda_{k_2}(x,y)\lambda_{k_3}(x,y)\]</div>
<p>called <em>bubble</em> function on <span class="math notranslate nohighlight">\(T_k\)</span>.
The bubble function has the feature: 1. <span class="math notranslate nohighlight">\(\beta_k(x,y)=0\quad \textrm{if }(x,y)\in \p T_k\)</span>.</p>
<ol class="arabic simple" start="2">
<li><p><span class="math notranslate nohighlight">\(\beta_k(q^{k_b})=1\)</span> where <span class="math notranslate nohighlight">\(q^{k_b}\)</span> is the barycenter <span class="math notranslate nohighlight">\(\frac{q^{k_1}+q^{k_2}+q^{k_3}}{3}\)</span>.</p></li>
</ol>
<p>If we write:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1b</span><span class="p">);</span>
<span class="linenos">2</span><span class="n">Vh</span><span class="w"> </span><span class="n">fh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="kr">x</span><span class="p">.</span><span class="kr">y</span><span class="p">);</span>
</pre></div>
</div>
<p>then:</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">fh</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle f_h(x,y)=\sum_{i=1}^{n_v}f(q^i)\phi_i(x,y)+\sum_{k=1}^{n_t}f(q^{k_b})\beta_k(x,y)\)</span></p>
<p>See <a class="reference internal" href="#finiteelementprojp1b"><span class="std std-numref">Fig. 105</span></a> for the projection of <span class="math notranslate nohighlight">\(f(x,y)=\sin(\pi x)\cos(\pi y)\)</span> into <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1b</span><span class="p">)</span></code>.</p>
</section>
<section id="vector-valued-fe-function">
<h2>Vector Valued FE-function<a class="headerlink" href="#vector-valued-fe-function" title="Link to this heading"></a></h2>
<p>Functions from <span class="math notranslate nohighlight">\(\R^{2}\)</span> to <span class="math notranslate nohighlight">\(\R^{N}\)</span> with <span class="math notranslate nohighlight">\(N=1\)</span> are called scalar functions and called <em>vector valued</em> when <span class="math notranslate nohighlight">\(N&gt;1\)</span>.
When <span class="math notranslate nohighlight">\(N=2\)</span></p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nc">P0</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">])</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
<p>makes the space</p>
<div class="math notranslate nohighlight">
\[V_h=\{\mathbf{w}=(w_1,w_2)|\; w_1\in V_h(\mathcal{T}_h,P_0),\,
w_2\in V_h(\mathcal{T}_h,P_1)\}\]</div>
<section id="raviart-thomas-element">
<h3>Raviart-Thomas Element<a class="headerlink" href="#raviart-thomas-element" title="Link to this heading"></a></h3>
<p>In the Raviart-Thomas finite element <span class="math notranslate nohighlight">\(RT0_{h}\)</span>, the degrees of freedom are the fluxes across edges <span class="math notranslate nohighlight">\(e\)</span> of the mesh, where the flux of the function <span class="math notranslate nohighlight">\(\mathbf{f} : \R^2 \longrightarrow \R^2\)</span> is <span class="math notranslate nohighlight">\(\int_{e} \mathbf{f}.n_{e}\)</span>, <span class="math notranslate nohighlight">\(n_{e}\)</span> is the unit normal of edge <span class="math notranslate nohighlight">\(e\)</span>.</p>
<p>This implies an orientation of all the edges of the mesh, for example we can use the global numbering of the edge vertices and we just go from small to large numbers.</p>
<p>To compute the flux, we use a quadrature with one Gauss point, the mid-point of the edge.</p>
<p>Consider a triangle <span class="math notranslate nohighlight">\(T_k\)</span> with three vertices <span class="math notranslate nohighlight">\((\mathbf{a},\mathbf{b},\mathbf{c})\)</span>.</p>
<p>Lets denote the vertices numbers by <span class="math notranslate nohighlight">\(i_{a},i_{b},i_{c}\)</span>, and define the three edge vectors <span class="math notranslate nohighlight">\(\mathbf{e}^{1},\mathbf{e}^{2},\mathbf{e}^{3}\)</span> by <span class="math notranslate nohighlight">\(sgn(i_{b}-i_{c})(\mathbf{b}-\mathbf{c})\)</span>, <span class="math notranslate nohighlight">\(sgn(i_{c}-i_{a})(\mathbf{c}-\mathbf{a})\)</span>, <span class="math notranslate nohighlight">\(sgn(i_{a}-i_{b})(\mathbf{a}-\mathbf{b})\)</span>.</p>
<p>We get three basis functions:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\phi}^{k}_{1}= \frac{sgn(i_{b}-i_{c})}{2|T_k|}(\mathbf{x}-\mathbf{a}),\quad
\boldsymbol{\phi}^{k}_{2}= \frac{sgn(i_{c}-i_{a})}{2|T_k|}(\mathbf{x}-\mathbf{b}),\quad
\boldsymbol{\phi}^{k}_{3}= \frac{sgn(i_{a}-i_{b})}{2|T_k|}(\mathbf{x}-\mathbf{c}),\]</div>
<p>where <span class="math notranslate nohighlight">\(|T_k|\)</span> is the area of the triangle <span class="math notranslate nohighlight">\(T_k\)</span>.
If we write:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">RT0</span><span class="p">);</span>
<span class="linenos">2</span><span class="n">Vh</span><span class="w"> </span><span class="p">[</span><span class="n">f1h</span><span class="p">,</span><span class="w"> </span><span class="n">f2h</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">f1</span><span class="p">(</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="p">),</span><span class="w"> </span><span class="n">f2</span><span class="p">(</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="p">)];</span>
</pre></div>
</div>
<p>then:</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">fh</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle \mathbf{f}_h(x,y)=\sum_{k=1}^{n_t}\sum_{l=1}^6 n_{i_lj_l}|\mathbf{e^{i_l}}|f_{j_l}(m^{i_l})\phi_{i_lj_l}\)</span></p>
<p>where <span class="math notranslate nohighlight">\(n_{i_lj_l}\)</span> is the <span class="math notranslate nohighlight">\(j_l\)</span>-th component of the normal vector <span class="math notranslate nohighlight">\(\mathbf{n}_{i_l}\)</span>,</p>
<div class="math notranslate nohighlight">
\[\{m_1,m_2,m_3\} = \left\{\frac{\mathbf{b}+\mathbf{c}}{2},
\frac{\mathbf{a}+\mathbf{c}}{2},
\frac{\mathbf{b}+\mathbf{a}}{2} \right\}\]</div>
<p>and <span class="math notranslate nohighlight">\(i_l=\{1,1,2,2,3,3\},\, j_l=\{1,2,1,2,1,2\}\)</span> with the order of <span class="math notranslate nohighlight">\(l\)</span>.</p>
<figure class="align-default" id="finiteelementrt0">
<a class="reference internal image-reference" href="../_images/FiniteElement_RT0.png"><img alt="../_images/FiniteElement_RT0.png" src="../_images/FiniteElement_RT0.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 106 </span><span class="caption-text">Normal vectors of each edge</span><a class="headerlink" href="#finiteelementrt0" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Mesh</span>
<span class="linenos"> 2</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1">// Fespace</span>
<span class="linenos"> 5</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Xh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos"> 6</span><span class="n">Xh</span><span class="w"> </span><span class="n">uh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">x</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="kr">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">vh</span><span class="p">;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">RT0</span><span class="p">);</span>
<span class="linenos"> 9</span><span class="n">Vh</span><span class="w"> </span><span class="p">[</span><span class="n">Uxh</span><span class="p">,</span><span class="w"> </span><span class="n">Uyh</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">),</span><span class="w"> </span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">)];</span><span class="w"> </span><span class="c1">//vectorial FE function</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="c1">// Change the mesh</span>
<span class="linenos">12</span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="c1">//Xh is unchanged</span>
<span class="linenos">15</span><span class="c1">//Uxh = x; //error: impossible to set only 1 component</span>
<span class="linenos">16</span><span class="w">          </span><span class="c1">//of a vector FE function</span>
<span class="linenos">17</span><span class="n">vh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Uxh</span><span class="p">;</span><span class="c1">//ok</span>
<span class="linenos">18</span><span class="c1">//and now vh use the 5x5 mesh</span>
<span class="linenos">19</span><span class="c1">//but the fespace of vh is always the 2x2 mesh</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="c1">// Plot</span>
<span class="linenos">22</span><span class="nf">plot</span><span class="p">(</span><span class="n">uh</span><span class="p">);</span>
<span class="linenos">23</span><span class="n">uh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uh</span><span class="p">;</span><span class="w"> </span><span class="c1">//do a interpolation of uh (old) of 5x5 mesh</span>
<span class="linenos">24</span><span class="w">        </span><span class="c1">//to get the new uh on 10x10 mesh</span>
<span class="linenos">25</span><span class="nf">plot</span><span class="p">(</span><span class="n">uh</span><span class="p">);</span>
<span class="linenos">26</span>
<span class="linenos">27</span><span class="n">vh</span><span class="p">([</span><span class="kr">x</span><span class="mi">-1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="p">])</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">x</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="kr">y</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="c1">//interpolate vh = ((x-1/2)^2 + y^2)</span>
</pre></div>
</div>
<div class="figure compound align-center" id="FiniteElement">
<figure class="align-default" id="id15">
<span id="finiteelementonoldmesh"></span><a class="reference internal image-reference" href="../_images/FiniteElement_onoldmesh.png"><img alt="FiniteElement_onoldmesh" src="../_images/FiniteElement_onoldmesh.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 107 </span><span class="caption-text"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">vh</span></code> Iso on mesh <span class="math notranslate nohighlight">\(2\times 2\)</span></span><a class="headerlink" href="#id15" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id16">
<span id="finiteelementonnewmesh"></span><a class="reference internal image-reference" href="../_images/FiniteElement_onnewmesh.png"><img alt="FiniteElement_onnewmesh" src="../_images/FiniteElement_onnewmesh.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 108 </span><span class="caption-text"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">vh</span></code> Iso on  mesh <span class="math notranslate nohighlight">\(5\times 5\)</span></span><a class="headerlink" href="#id16" title="Link to this image"></a></p>
</figcaption>
</figure>
</div><p id="FiniteElement">To get the value at a point <span class="math notranslate nohighlight">\(x=1,y=2\)</span> of the FE function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">uh</span></code>, or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="n">Uxh</span><span class="p">,</span><span class="w"> </span><span class="n">Uyh</span><span class="p">]</span></code>, one writes:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">real</span><span class="w"> </span><span class="kp">value</span><span class="p">;</span>
<span class="linenos">2</span><span class="kp">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uh</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span><span class="w"> </span><span class="c1">//get value = uh(2, 4)</span>
<span class="linenos">3</span><span class="kp">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Uxh</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w"> </span><span class="c1">//get value = Uxh(2, 4)</span>
<span class="linenos">4</span><span class="c1">//OR</span>
<span class="linenos">5</span><span class="kr">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="linenos">6</span><span class="kp">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uh</span><span class="p">;</span><span class="w"> </span><span class="c1">//get value = uh(1, 2)</span>
<span class="linenos">7</span><span class="kp">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Uxh</span><span class="p">;</span><span class="w"> </span><span class="c1">//get value = Uxh(1, 2)</span>
<span class="linenos">8</span><span class="kp">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Uyh</span><span class="p">;</span><span class="w"> </span><span class="c1">//get value = Uyh(1, 2)</span>
</pre></div>
</div>
<p>To get the value of the array associated to the FE function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">uh</span></code>, one writes</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">real</span><span class="w"> </span><span class="kp">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uh</span><span class="p">[][</span><span class="mi">0</span><span class="p">];</span><span class="w"> </span><span class="c1">//get the value of degree of freedom 0</span>
<span class="linenos">2</span><span class="kt">real</span><span class="w"> </span><span class="n">maxdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uh</span><span class="p">[].</span><span class="kr">max</span><span class="p">;</span><span class="w"> </span><span class="c1">//maximum value of degree of freedom</span>
<span class="linenos">3</span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uh</span><span class="p">.</span><span class="kr">n</span><span class="p">;</span><span class="w"> </span><span class="c1">//the number of degree of freedom</span>
<span class="linenos">4</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">array</span><span class="p">(</span><span class="n">uh</span><span class="p">.</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uh</span><span class="p">[];</span><span class="w"> </span><span class="c1">//copy the array of the function uh</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For a non-scalar finite element function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="n">Uxh</span><span class="p">,</span><span class="w"> </span><span class="n">Uyh</span><span class="p">]</span></code> the two arrays <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Uxh</span><span class="p">[]</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Uyh</span><span class="p">[]</span></code> are the same array, because the degree of freedom can touch more than one component.</p>
</div>
</section>
</section>
<section id="a-fast-finite-element-interpolator">
<h2>A Fast Finite Element Interpolator<a class="headerlink" href="#a-fast-finite-element-interpolator" title="Link to this heading"></a></h2>
<p>In practice, one may discretize the variational equations by the Finite Element method.
Then there will be one mesh for <span class="math notranslate nohighlight">\(\Omega_1\)</span> and another one for <span class="math notranslate nohighlight">\(\Omega_2\)</span>.
The computation of integrals of products of functions defined on different meshes is difficult.</p>
<p>Quadrature formula and interpolations from one mesh to another at quadrature points are needed.
We present below the interpolation operator which we have used and which is new, to the best of our knowledge.</p>
<p>Let <span class="math notranslate nohighlight">\({\cal T}_{h}^0=\cup_k T^0_k,{\cal T}_{h}^1=\cup_k T^1_k\)</span> be two triangulations of a domain <span class="math notranslate nohighlight">\(\Omega\)</span>.
Let:</p>
<div class="math notranslate nohighlight">
\[V({\hbox{{\cal T}}_{h}^i}) =\{ C^0(\Omega_h^i)~:~f|_{T^i_k}\in P_0\},~~~i=0,1\]</div>
<p>be the spaces of continuous piecewise affine functions on each triangulation.</p>
<p>Let <span class="math notranslate nohighlight">\(f\in V({\cal T}_{h}^0)\)</span>.
The problem is to find <span class="math notranslate nohighlight">\(g\in V({\cal T}_{h}^1)\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[g(q) = f(q) \quad \forall q\hbox{~vertex of ~} {\cal T}_{h}^1\]</div>
<p>Although this is a seemingly simple problem, it is difficult to find an efficient algorithm in practice.</p>
<p>We propose an algorithm which is of complexity <span class="math notranslate nohighlight">\(N^1\log N^0\)</span>, where <span class="math notranslate nohighlight">\(N^i\)</span> is the number of vertices of <span class="math notranslate nohighlight">\(\cal T_{h}^i\)</span>, and which is very fast for most practical 2D applications.</p>
<p><strong>Algorithm</strong></p>
<p>The method has 5 steps.</p>
<p>First a quadtree is built containing all the vertices of the mesh <span class="math notranslate nohighlight">\({\cal T}_{h}^0\)</span> such that in each terminal cell there are at least one, and at most 4, vertices of <span class="math notranslate nohighlight">\({\cal T}_{h}^0\)</span>.</p>
<p>For each <span class="math notranslate nohighlight">\(q^1\)</span>, vertex of <span class="math notranslate nohighlight">\({\cal T}_{h}^1\)</span> do:</p>
<ol class="arabic">
<li><p>Find the terminal cell of the quadtree containing <span class="math notranslate nohighlight">\(q^1\)</span>.</p></li>
<li><p>Find the the nearest vertex <span class="math notranslate nohighlight">\(q^0_j\)</span> to <span class="math notranslate nohighlight">\(q^1\)</span> in that cell.</p></li>
<li><p>Choose one triangle <span class="math notranslate nohighlight">\(T_k^0\in{\cal T}_{h}^0\)</span> which has <span class="math notranslate nohighlight">\(q^0_j\)</span> for vertex.</p></li>
<li><p>Compute the barycentric coordinates <span class="math notranslate nohighlight">\(\{\lambda_j\}_{j=1,2,3}\)</span> of <span class="math notranslate nohighlight">\(q^1\)</span> in <span class="math notranslate nohighlight">\(T^0_k\)</span>.</p>
<blockquote>
<div><ul class="simple">
<li><p>if all barycentric coordinates are positive, go to Step 5</p></li>
<li><p>otherwise, if one barycentric coordinate <span class="math notranslate nohighlight">\(\lambda_i\)</span> is negative, replace <span class="math notranslate nohighlight">\(T^0_k\)</span> by the adjacent triangle opposite <span class="math notranslate nohighlight">\(q^0_i\)</span> and go to Step 4.</p></li>
<li><p>otherwise, if two barycentric coordinates are negative, take one of the two randomly and replace <span class="math notranslate nohighlight">\(T^0_k\)</span> by the adjacent triangle as above.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Calculate <span class="math notranslate nohighlight">\(g(q^1)\)</span> on <span class="math notranslate nohighlight">\(T^0_k\)</span> by linear interpolation of <span class="math notranslate nohighlight">\(f\)</span>:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[g(q^1) = \sum_{j=1,2,3} \lambda_j f(q^0_j)\]</div>
</div></blockquote>
</li>
</ol>
<figure class="align-default" id="finiteelementfastinterpolate">
<a class="reference internal image-reference" href="../_images/FiniteElement_fastInterpolate.png"><img alt="../_images/FiniteElement_fastInterpolate.png" src="../_images/FiniteElement_fastInterpolate.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 109 </span><span class="caption-text">To interpolate a function at <span class="math notranslate nohighlight">\(q^0\)</span>, the knowledge of the triangle which contains <span class="math notranslate nohighlight">\(q^0\)</span> is needed. The algorithm may start at <span class="math notranslate nohighlight">\(q^1\in T_k^0\)</span> and stall on the boundary (thick line) because the line <span class="math notranslate nohighlight">\(q^0q^1\)</span> is not inside <span class="math notranslate nohighlight">\(\Omega\)</span>.
But if the holes are triangulated too (doted line) then the problem does not arise.</span><a class="headerlink" href="#finiteelementfastinterpolate" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Two problems need to be solved:</p>
<ul>
<li><p><em>What if :math:`q^1` is not in</em> <span class="math notranslate nohighlight">\(\Omega^0_h\)</span> <em>?</em> Then Step 5 will stop with a boundary triangle.</p>
<blockquote>
<div><p>So we add a step which tests the distance of <span class="math notranslate nohighlight">\(q^1\)</span> with the two adjacent boundary edges and selects the nearest, and so on till the distance grows.</p>
</div></blockquote>
</li>
<li><p><em>What if</em> <span class="math notranslate nohighlight">\(\Omega^0_h\)</span> <em>is not convex and the marching process of Step 4 locks on a boundary?</em> By construction Delaunay-Voronoï’s mesh generators always triangulate the convex hull of the vertices of the domain.</p>
<blockquote>
<div><p>Therefore, we make sure that this information is not lost when <span class="math notranslate nohighlight">\({\cal T}_{h}^0,{\cal T}_{h}^1\)</span> are constructed and we keep the triangles which are outside the domain on a special list.</p>
<p>That way, in step 5 we can use that list to step over holes if needed.</p>
</div></blockquote>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sometimes, in rare cases, the interpolation process misses some points, we can change the search algorithm through a global variable <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">searchMethod</span></code></p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kr">searchMethod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// default value for fast search algorithm</span>
<span class="linenos">2</span><span class="kr">searchMethod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// safe search algorithm, uses brute force in case of missing point</span>
<span class="linenos">3</span><span class="c1">// (warning: can be very expensive in cases where a lot of points are outside of the domain)</span>
<span class="linenos">4</span><span class="kr">searchMethod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="c1">// always uses brute force. It is very computationally expensive.</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Step 3 requires an array of pointers such that each vertex points to one triangle of the triangulation.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The operator <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="o">=</span></code> is the interpolation operator of <strong>FreeFEM</strong>, the continuous finite functions are extended by continuity to the outside of the domain.</p>
<p>Try the following example :</p>
<blockquote>
<div><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Mesh</span>
<span class="linenos"> 2</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Ths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="linenos"> 3</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Thg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kr">x</span><span class="o">*</span><span class="mi">3-1</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="o">*</span><span class="mi">3-1</span><span class="p">]);</span>
<span class="linenos"> 4</span><span class="nf">plot</span><span class="p">(</span><span class="n">Ths</span><span class="p">,</span><span class="w"> </span><span class="n">Thg</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="c1">// Fespace</span>
<span class="linenos"> 7</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Ch</span><span class="p">(</span><span class="n">Ths</span><span class="p">,</span><span class="w"> </span><span class="nc">P2</span><span class="p">);</span>
<span class="linenos"> 8</span><span class="n">Ch</span><span class="w"> </span><span class="n">us</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kr">x</span><span class="mf">-0.5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="kr">y</span><span class="mf">-0.5</span><span class="p">);</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Dh</span><span class="p">(</span><span class="n">Ths</span><span class="p">,</span><span class="w"> </span><span class="nc">P2dc</span><span class="p">);</span>
<span class="linenos">11</span><span class="n">Dh</span><span class="w"> </span><span class="n">vs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kr">x</span><span class="mf">-0.5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="kr">y</span><span class="mf">-0.5</span><span class="p">);</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Fh</span><span class="p">(</span><span class="n">Thg</span><span class="p">,</span><span class="w"> </span><span class="nc">P2dc</span><span class="p">);</span>
<span class="linenos">14</span><span class="n">Fh</span><span class="w"> </span><span class="n">ug</span><span class="o">=</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">vg</span><span class="o">=</span><span class="n">vs</span><span class="p">;</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="c1">// Plot</span>
<span class="linenos">17</span><span class="nf">plot</span><span class="p">(</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">ug</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos">18</span><span class="nf">plot</span><span class="p">(</span><span class="n">vs</span><span class="p">,</span><span class="w"> </span><span class="n">vg</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</div>
<div class="figure compound align-center" id="Extension">
<figure class="align-default" id="id17">
<span id="finiteelementusug"></span><a class="reference internal image-reference" href="../_images/FiniteElement_UsUg.png"><img alt="FiniteElement_UsUg" src="../_images/FiniteElement_UsUg.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 110 </span><span class="caption-text">Extension of a continuous FE-function</span><a class="headerlink" href="#id17" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id18">
<span id="finiteelementvsvg"></span><a class="reference internal image-reference" href="../_images/FiniteElement_VsVg.png"><img alt="FiniteElement_VsVg" src="../_images/FiniteElement_VsVg.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 111 </span><span class="caption-text">Extension of discontinuous FE-function</span><a class="headerlink" href="#id18" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><span class="caption-text">Extension of FE-function</span></p>
</div></div></blockquote>
</div>
</section>
<section id="keywords-problem-and-solve">
<span id="Extension"></span><h2>Keywords: Problem and Solve<a class="headerlink" href="#keywords-problem-and-solve" title="Link to this heading"></a></h2>
<p>For <strong>FreeFEM</strong>, a problem must be given in variational form, so we need a bilinear form <span class="math notranslate nohighlight">\(a(u,v)\)</span>, a linear form <span class="math notranslate nohighlight">\(\ell(f,v)\)</span>, and possibly a boundary condition form must be added.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">problem</span><span class="w"> </span><span class="kr">P</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="linenos">2</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">l</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="linenos">3</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="kp">boundary</span><span class="w"> </span><span class="n">condition</span><span class="p">)</span>
<span class="linenos">4</span><span class="w">    </span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When you want to formulate the problem and solve it in the same time, you can use the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">solve</span></code>.</p>
</div>
<section id="weak-form-and-boundary-condition">
<h3>Weak Form and Boundary Condition<a class="headerlink" href="#weak-form-and-boundary-condition" title="Link to this heading"></a></h3>
<p>To present the principles of Variational Formulations, also called weak form, for the Partial Differential Equations, let’s take a model problem: a Poisson equation with Dirichlet and Robin Boundary condition.</p>
<p>The problem: Find <span class="math notranslate nohighlight">\(u\)</span> a real function defined on a domain <span class="math notranslate nohighlight">\(\Omega\)</span> of <span class="math notranslate nohighlight">\(\R^d\)</span> <span class="math notranslate nohighlight">\((d=2,3)\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{rcll}
    -\nabla\cdot(\kappa \nabla u) &amp;=&amp; f &amp; \mbox{ in }\Omega\\
    a u + \kappa \frac{\p u}{\p n} &amp;=&amp; b &amp; \mbox{ on }\Gamma_r\\
    u &amp;=&amp; g &amp; \mbox{ on }\Gamma_d
\end{array}\end{split}\]</div>
<p>where:</p>
<ul class="simple">
<li><p>if <span class="math notranslate nohighlight">\(d=2\)</span> then <span class="math notranslate nohighlight">\(\nabla.(\kappa \nabla u) = \p_x(\kappa \p_x u ) + \p_y(\kappa \p_y u )\)</span> with <span class="math notranslate nohighlight">\(\p_x u = \frac{\p u}{\p x}\)</span> and <span class="math notranslate nohighlight">\(\p_y u = \frac{\p u}{\p y}\)</span></p></li>
<li><p>if <span class="math notranslate nohighlight">\(d=3\)</span> then <span class="math notranslate nohighlight">\(\nabla.(\kappa \nabla u) = \p_x(\kappa \p_x u) + \p_y(\kappa \p_y u) + \p_z(\kappa \p_z u)\)</span> with <span class="math notranslate nohighlight">\(\p_x u = \frac{\p u}{\p x}\)</span>, <span class="math notranslate nohighlight">\(\p_y u = \frac{\p u}{\p y}\)</span> and , <span class="math notranslate nohighlight">\(\p_z u = \frac{\p u}{\p z}\)</span></p></li>
<li><p>The border <span class="math notranslate nohighlight">\(\Gamma=\p \Omega\)</span> is split in <span class="math notranslate nohighlight">\(\Gamma_d\)</span> and <span class="math notranslate nohighlight">\(\Gamma_n\)</span> such that <span class="math notranslate nohighlight">\(\Gamma_d \cap \Gamma_n = \emptyset\)</span> and <span class="math notranslate nohighlight">\(\Gamma_d \cup \Gamma_n = \p \Omega\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\kappa\)</span> is a given positive function, such that <span class="math notranslate nohighlight">\(\exists \kappa_0 \in \R ,\quad 0 &lt; \kappa_0 \leq \kappa\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(a\)</span> a given non negative function,</p></li>
<li><p><span class="math notranslate nohighlight">\(b\)</span> a given function.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the well known Neumann boundary condition if <span class="math notranslate nohighlight">\(a=0\)</span>, and if <span class="math notranslate nohighlight">\(\Gamma_d\)</span> is empty.</p>
<p>In this case the function appears in the problem just by its derivatives, so it is defined only up to a constant (if <span class="math notranslate nohighlight">\(u\)</span> is a solution then <span class="math notranslate nohighlight">\(u+c\)</span> is also a solution).</p>
</div>
<p>Let <span class="math notranslate nohighlight">\({v}\)</span>, a regular test function, null on <span class="math notranslate nohighlight">\(\Gamma_d\)</span>, by integration by parts we get:</p>
<div class="math notranslate nohighlight">
\[- \int_{\Omega} \nabla\cdot(\kappa \nabla u) \, {v} \,d\omega
= \int_{\Omega} \kappa \nabla{ v} \cdot \nabla u \,d\omega
- \int_{\Gamma} {v}\kappa \frac{ \p u}{\p \mathbf{n}} \,d\gamma,= \int_{\Omega} f {v} \,d\omega\]</div>
<p>where if <span class="math notranslate nohighlight">\(d=2\)</span> the <span class="math notranslate nohighlight">\(\nabla{ v} . \nabla u = (\frac{\p u}{\p x}\frac{\p { v}}{\p x}+\frac{\p u}{\p y}\frac{\p { v}}{\p y})\)</span>,</p>
<p>where if <span class="math notranslate nohighlight">\(d=3\)</span> the <span class="math notranslate nohighlight">\(\nabla{ v} . \nabla u = (\frac{\p u}{\p x}\frac{\p { v}}{\p x}+\frac{\p u}{\p y}\frac{\p { v}}{\p y} + \frac{\p u}{\p z}\frac{\p { v}}{\p z})\)</span>,</p>
<p>and where <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> is the unitary outer-pointing normal of the <span class="math notranslate nohighlight">\(\Gamma\)</span>.</p>
<p>Now we note that <span class="math notranslate nohighlight">\(\kappa \frac{ \p u}{\p n} = - a u + b\)</span> on <span class="math notranslate nohighlight">\(\Gamma_r\)</span> and <span class="math notranslate nohighlight">\(v=0\)</span> on <span class="math notranslate nohighlight">\(\Gamma_d\)</span> and <span class="math notranslate nohighlight">\(\Gamma = \Gamma_d \cup \Gamma_n\)</span> thus:</p>
<div class="math notranslate nohighlight">
\[- \int_{\Gamma} {v}
\kappa \frac{ \p u}{\p n} = \int_{\Gamma_r} a u v - \int_{\Gamma_r} b v\]</div>
<p>The problem becomes:</p>
<p>Find <span class="math notranslate nohighlight">\(u \in V_g = \{w \in H^1(\Omega) / w = g \mbox{ on } \Gamma_d \}\)</span> such that:</p>
<div class="math notranslate nohighlight" id="equation-eqn-v-poisson">
<span class="eqno">(23)<a class="headerlink" href="#equation-eqn-v-poisson" title="Link to this equation"></a></span>\[{\int_{\Omega} \kappa \nabla{ v} . \nabla u \,d\omega + \int_{\Gamma_r} a u v \,d\gamma = \int_{\Omega} f {v}} \,d\omega
+ \int_{\Gamma_r} b v \,d\gamma , \quad \forall v \in V_0\]</div>
<p>where <span class="math notranslate nohighlight">\(V_0 = \{v \in H^1(\Omega) / v = 0 \mbox{ on } \Gamma_d \}\)</span></p>
<p>Except in the case of Neumann conditions everywhere, the problem <a class="reference internal" href="#equation-eqn-v-poisson">(23)</a> is well posed when <span class="math notranslate nohighlight">\(\kappa\geq \kappa_0&gt;0\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If we have only the Neumann boundary condition, linear algebra tells us that the right hand side must be orthogonal to the kernel of the operator for the solution to exist.</p>
<blockquote>
<div><p>One way of writing the compatibility condition is:</p>
<div class="math notranslate nohighlight">
\[\int_{\Omega} f \,d\omega + \int_{\Gamma} b \,d\gamma=0\]</div>
<p>and a way to fix the constant is to solve for <span class="math notranslate nohighlight">\(u \in H^1(\Omega)\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[{\int_{\Omega} (\varepsilon u v \; + \; \kappa \nabla{ v} . \nabla u) \,d\omega
= \int_{\Omega} f {v}} \,d\omega + \int_{\Gamma_r} b v \,d\gamma , \quad \forall v \in H^1(\Omega)\]</div>
<p>where <span class="math notranslate nohighlight">\(\varepsilon\)</span> is a small parameter (<span class="math notranslate nohighlight">\(\sim \kappa\; 10^{-10} |\Omega|^{\frac2d}\)</span>).</p>
</div></blockquote>
<p>Remark that if the solution is of order <span class="math notranslate nohighlight">\(\frac{1}{\varepsilon}\)</span> then the compatibility condition is unsatisfied, otherwise we get the solution such that <span class="math notranslate nohighlight">\(\int_\Omega u = 0\)</span>, you can also add a Lagrange multiplier to solve the real mathematical problem like in the <a class="reference internal" href="../examples/finite-element.html#examplelagrangemultipliers"><span class="std std-ref">Lagrange multipliers example</span></a>.</p>
</div>
<p>In <strong>FreeFEM</strong>, the bidimensional problem <a class="reference internal" href="#equation-eqn-v-poisson">(23)</a> becomes:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">problem</span><span class="w"> </span><span class="n">Pw</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="linenos"> 2</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="w"> </span><span class="c1">//int_{Omega} kappa nabla v . nabla u</span>
<span class="linenos"> 3</span><span class="w">        </span><span class="n">kappa</span><span class="o">*</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="p">)</span>
<span class="linenos"> 5</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">gn</span><span class="p">)(</span><span class="w"> </span><span class="c1">//int_{Gamma_r} a u v</span>
<span class="linenos"> 6</span><span class="w">        </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u</span><span class="o">*</span><span class="n">v</span>
<span class="linenos"> 7</span><span class="w">    </span><span class="p">)</span>
<span class="linenos"> 8</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="w"> </span><span class="c1">//int_{Omega} f v</span>
<span class="linenos"> 9</span><span class="w">        </span><span class="n">f</span><span class="o">*</span><span class="n">v</span>
<span class="linenos">10</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">11</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">gn</span><span class="p">)(</span><span class="w"> </span><span class="c1">//int_{Gamma_r} b v</span>
<span class="linenos">12</span><span class="w">        </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v</span>
<span class="linenos">13</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">14</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="n">gd</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="n">g</span><span class="p">)</span><span class="w"> </span><span class="c1">//u = g on Gamma_d</span>
<span class="linenos">15</span><span class="w">    </span><span class="p">;</span>
</pre></div>
</div>
<p>where <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code> is a mesh of the bi-dimensional domain <span class="math notranslate nohighlight">\(\Omega\)</span>, and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">gd</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">gn</span></code> are respectively the boundary labels of boundary <span class="math notranslate nohighlight">\(\Gamma_d\)</span> and <span class="math notranslate nohighlight">\(\Gamma_n\)</span>.</p>
<p>And the three dimensional problem <a class="reference internal" href="#equation-eqn-v-poisson">(23)</a> becomes</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">macro</span><span class="w"> </span><span class="n">Grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">),</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">),</span><span class="w"> </span><span class="nf">dz</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="p">]</span><span class="c1">//</span>
<span class="linenos"> 2</span><span class="kt">problem</span><span class="w"> </span><span class="n">Pw</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="linenos"> 3</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="w"> </span><span class="c1">//int_{Omega} kappa nabla v . nabla u</span>
<span class="linenos"> 4</span><span class="w">        </span><span class="n">kappa</span><span class="o">*</span><span class="p">(</span><span class="n">Grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">&#39;*</span><span class="n">Grad</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="linenos"> 5</span><span class="w">    </span><span class="p">)</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">gn</span><span class="p">)(</span><span class="w"> </span><span class="c1">//int_{Gamma_r} a u v</span>
<span class="linenos"> 7</span><span class="w">        </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u</span><span class="o">*</span><span class="n">v</span>
<span class="linenos"> 8</span><span class="w">    </span><span class="p">)</span>
<span class="linenos"> 9</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="w"> </span><span class="c1">//int_{Omega} f v</span>
<span class="linenos">10</span><span class="w">        </span><span class="n">f</span><span class="o">*</span><span class="n">v</span>
<span class="linenos">11</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">12</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">gn</span><span class="p">)(</span><span class="w"> </span><span class="c1">//int_{Gamma_r} b v</span>
<span class="linenos">13</span><span class="w">        </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v</span>
<span class="linenos">14</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">15</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="n">gd</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="n">g</span><span class="p">)</span><span class="w"> </span><span class="c1">//u = g on Gamma_d</span>
<span class="linenos">16</span><span class="w">    </span><span class="p">;</span>
</pre></div>
</div>
<p>where <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code> is a mesh of the three dimensional domain <span class="math notranslate nohighlight">\(\Omega\)</span>, and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">gd</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">gn</span></code> are respectively the boundary labels of boundary <span class="math notranslate nohighlight">\(\Gamma_d\)</span> and <span class="math notranslate nohighlight">\(\Gamma_n\)</span>.</p>
</section>
</section>
<section id="parameters-affecting-solve-and-problem">
<h2>Parameters affecting solve and problem<a class="headerlink" href="#parameters-affecting-solve-and-problem" title="Link to this heading"></a></h2>
<p>The parameters are FE functions real or complex, the number <span class="math notranslate nohighlight">\(n\)</span> of parameters is even (<span class="math notranslate nohighlight">\(n=2*k\)</span>), the <span class="math notranslate nohighlight">\(k\)</span> first function parameters are unknown, and the <span class="math notranslate nohighlight">\(k\)</span> last are test functions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the functions are a part of vectorial FE then you must give all the functions of the vectorial FE in the same order (see <a class="reference internal" href="../models/static-problems.html#modelstaticpoissonwithmixedboundarycondition"><span class="std std-ref">Poisson problem with mixed finite element</span></a> for example).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Don’t mix complex and real parameters FE function.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Bug:</strong></p>
<p>The mixing of multiple <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">fespace</span></code> with different periodic boundary conditions are not implemented.</p>
<p>So all the finite element spaces used for tests or unknown functions in a problem, must have the same type of periodic boundary conditions or no periodic boundary conditions.</p>
<p>No clean message is given and the result is unpredictable.</p>
</div>
<p>The parameters are:</p>
<ul>
<li><p><strong>solver=</strong> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">LU</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">CG</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Crout</span></code>,  <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Cholesky</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">GMRES</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">sparsesolver</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code> …</p>
<blockquote>
<div><p>The default solver is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">sparsesolver</span></code> (it is equal to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code> if no other sparse solver is defined) or is set to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">LU</span></code> if no direct sparse solver is available.</p>
<p>The storage mode of the matrix of the underlying linear system depends on the type of solver chosen; for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">LU</span></code> the matrix is sky-line non symmetric, for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Crout</span></code> the matrix is sky-line symmetric, for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Cholesky</span></code> the matrix is sky-line symmetric positive definite, for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">CG</span></code> the matrix is sparse symmetric positive, and for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">GMRES</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">sparsesolver</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code> the matrix is just sparse.</p>
</div></blockquote>
</li>
<li><p><strong>eps=</strong> a real expression.</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\varepsilon\)</span> sets the stopping test for the iterative methods like <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">CG</span></code>.</p>
<p>Note that if <span class="math notranslate nohighlight">\(\varepsilon\)</span> is negative then the stopping test is:</p>
<div class="math notranslate nohighlight">
\[|| A x - b || &lt; |\varepsilon|\]</div>
<p>if it is positive, then the stopping test is:</p>
<div class="math notranslate nohighlight">
\[|| A x - b || &lt; \frac{|\varepsilon|}{|| A x_{0} - b ||}\]</div>
</div></blockquote>
</li>
<li><p><strong>init=</strong> boolean expression, if it is false or 0 the matrix is reconstructed.</p>
<blockquote>
<div><p>Note that if the mesh changes the matrix is reconstructed too.</p>
</div></blockquote>
</li>
<li><p><strong>precon=</strong> name of a function (for example <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">P</span></code>) to set the preconditioner.</p>
<blockquote>
<div><p>The prototype for the function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">P</span></code> must be:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="kr">P</span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">xx</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p><strong>tgv=</strong> Huge value (<span class="math notranslate nohighlight">\(10^{30}\)</span>) used to implement Dirichlet boundary conditions.</p></li>
<li><p><strong>tolpivot=</strong> sets the tolerance of the pivot in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code> (<span class="math notranslate nohighlight">\(10^{-1}\)</span>) and, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">LU</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Crout</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Cholesky</span></code> factorisation (<span class="math notranslate nohighlight">\(10^{-20}\)</span>).</p></li>
<li><p><strong>tolpivotsym=</strong> sets the tolerance of the pivot sym in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code></p></li>
<li><p><strong>strategy=</strong> sets the integer <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code> strategy (<span class="math notranslate nohighlight">\(0\)</span> by default).</p></li>
</ul>
</section>
<section id="problem-definition">
<span id="problemdefinition"></span><h2>Problem definition<a class="headerlink" href="#problem-definition" title="Link to this heading"></a></h2>
<p>Below <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">v</span></code> is the unknown function and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">w</span></code> is the test function.</p>
<p>After the “=” sign, one may find sums of:</p>
<ul>
<li><p>Identifier(s); this is the name given earlier to the variational form(s) (type <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">varf</span></code> ) for possible reuse.</p>
<blockquote>
<div><p>Remark, that the name in the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">varf</span></code> of the unknown test function is forgotten, we use the order in the argument list to recall names as in a <code class="docutils literal highlight highlight-python"><span></span><span class="n">C</span><span class="o">++</span></code> function,</p>
</div></blockquote>
</li>
<li><p>The terms of the bilinear form itself: if <span class="math notranslate nohighlight">\(K\)</span> is a given function,</p></li>
<li><p>Bilinear part for 3D meshes <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{T } K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th},T\subset \Omega_{1}}\int_{T} K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">levelset</span><span class="o">=</span><span class="n">phi</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{T,\phi&lt;0} K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kp">levelset</span><span class="o">=</span><span class="n">phi</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th},T\subset \Omega_{l}}\int_{T,\phi&lt;0} K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{(\p T\cup\Gamma) \cap ( \Gamma_2 \cup \Gamma_{5})} K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th},T\subset \Omega_{1}}\int_{T} K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{(\p T\cup\Gamma) \cap (\Gamma_2 \cup \Gamma_{5})} K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">levelset</span><span class="o">=</span><span class="n">phi</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{T,\phi=0} K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kp">levelset</span><span class="o">=</span><span class="n">phi</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th},T\subset \Omega_{l}}\int_{T,\phi=0} K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">intallfaces</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{\p T } K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">intallfaces</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{{T\in\mathtt{Th},T\subset \Omega_{1}}}\int_{\p T } K\,v\,w\)</span></p></li>
<li><p>They contribute to the sparse matrix of type <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">matrix</span></code> which, whether declared explicitly or not, is constructed by <strong>FreeFEM</strong>.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Bilinear part for 2D meshes <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{T } K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th},T\subset \Omega_{1}}\int_{T} K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">levelset</span><span class="o">=</span><span class="n">phi</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{T,\phi&lt;0} K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kp">levelset</span><span class="o">=</span><span class="n">phi</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th},T\subset \Omega_{l}}\int_{T,\phi&lt;0} K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{(\p T\cup\Gamma) \cap ( \Gamma_2 \cup \Gamma_{5})} K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th},T\subset \Omega_{1}}\int_{T} K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{(\p T\cup\Gamma) \cap ( \Gamma_2 \cup \Gamma_{5})} K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">levelset</span><span class="o">=</span><span class="n">phi</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{T,\phi=0} K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kp">levelset</span><span class="o">=</span><span class="n">phi</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th},T\subset \Omega_{l}}\int_{T,\phi=0} K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">intalledges</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{\p T } K\,v\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">intalledges</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{{T\in\mathtt{Th},T\subset \Omega_{1}}}\int_{\p T } K\,v\,w\)</span></p></li>
<li><p>They contribute to the sparse matrix of type <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">matrix</span></code> which, whether declared explicitly or not, is constructed by <strong>FreeFEM</strong>.</p></li>
<li><p>The right hand-side of the Partial Differential Equation in 3D, the terms of the linear form: for given functions <span class="math notranslate nohighlight">\(K,\, f\)</span>:</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{T} K\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th},T\in\Omega_l}\int_{T} K\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">levelset</span><span class="o">=</span><span class="n">phi</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{T,\phi&lt;0} K\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kp">levelset</span><span class="o">=</span><span class="n">phi</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th},T\subset\Omega_{l}}\int_{T,\phi&lt;0} K\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{(\p T\cup\Gamma) \cap ( \Gamma_2 \cup \Gamma_{5}) } K \,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">levelset</span><span class="o">=</span><span class="n">phi</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{T,\phi=0} K\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kp">levelset</span><span class="o">=</span><span class="n">phi</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th},T\subset \Omega_{l}}\int_{T,\phi=0} K\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">intallfaces</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">f</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{\p T } f\,w\)</span></p></li>
<li><p>A vector of type <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code></p></li>
</ul>
</div></blockquote>
</li>
<li><p>The right hand-side of the Partial Differential Equation in 2D, the terms of the linear form: for given functions <span class="math notranslate nohighlight">\(K,\, f\)</span>:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{T} K\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th},T\in\Omega_l}\int_{T} K\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">levelset</span><span class="o">=</span><span class="n">phi</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{T,\phi&lt;0} K\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kp">levelset</span><span class="o">=</span><span class="n">phi</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th},T\subset\Omega_{l}}\int_{T,\phi&lt;0} K\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{(\p T\cup\Gamma) \cap ( \Gamma_2 \cup \Gamma_{5}) } K \,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">levelset</span><span class="o">=</span><span class="n">phi</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{T,\phi=0} K\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kp">levelset</span><span class="o">=</span><span class="n">phi</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th},T\subset\Omega_{l}}\int_{T,\phi=0} K\,w\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">intalledges</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">f</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(\displaystyle\sum_{T\in\mathtt{Th}}\int_{\p T } f\,w\)</span></p></li>
<li><p>a vector of type <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code></p></li>
</ul>
</div></blockquote>
</li>
<li><p>The boundary condition terms:</p>
<blockquote>
<div><ul>
<li><p>An “on” scalar form (for Dirichlet) : <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="n">g</span><span class="p">)</span></code></p>
<blockquote>
<div><p>Used for all degrees of freedom <span class="math notranslate nohighlight">\(i\)</span> of the boundary referred by “1”, the diagonal term of the matrix <span class="math notranslate nohighlight">\(a_{ii}= tgv\)</span> with the <em>terrible giant value</em> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">tgv</span></code> (= <span class="math notranslate nohighlight">\(10^{30}\)</span> by default), and the right hand side <span class="math notranslate nohighlight">\(b[i] = &quot;(\Pi_h g)[i]&quot; \times tgv\)</span>, where the <span class="math notranslate nohighlight">\(&quot;(\Pi_h g)g[i]&quot;\)</span> is the boundary node value given by the interpolation of <span class="math notranslate nohighlight">\(g\)</span>.</p>
</div></blockquote>
</li>
<li><p>A linear form on <span class="math notranslate nohighlight">\(\Gamma\)</span> (for Neumann in 2d) <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="o">-</span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">f</span><span class="o">*</span><span class="n">w</span><span class="p">)</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="o">-</span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)(</span><span class="n">f</span><span class="o">*</span><span class="n">w</span><span class="p">)</span></code></p></li>
<li><p>A bilinear form on <span class="math notranslate nohighlight">\(\Gamma\)</span> or <span class="math notranslate nohighlight">\(\Gamma_{2}\)</span> (for Robin in 2d) <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="mi">2</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span></code></p></li>
<li><p>A linear form on <span class="math notranslate nohighlight">\(\Gamma\)</span> (for Neumann in 3d) <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="o">-</span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">f</span><span class="o">*</span><span class="n">w</span><span class="p">)</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="o">-</span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)(</span><span class="n">f</span><span class="o">*</span><span class="n">w</span><span class="p">)</span></code></p></li>
<li><p>A bilinear form on <span class="math notranslate nohighlight">\(\Gamma\)</span> or <span class="math notranslate nohighlight">\(\Gamma_{2}\)</span> (for Robin in 3d) <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="mi">2</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span></code></p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>An “on” vectorial form (for Dirichlet): <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">u1</span><span class="o">=</span><span class="n">g1</span><span class="p">,</span><span class="w"> </span><span class="n">u2</span><span class="o">=</span><span class="n">g2</span><span class="p">)</span></code></p></li>
</ul>
<p>If you have vectorial finite element like <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">RT0</span></code>, the 2 components are coupled, and so you have : <span class="math notranslate nohighlight">\(b[i] = &quot;(\Pi_h (g1,g2))[i]&quot; \times tgv\)</span>, where <span class="math notranslate nohighlight">\(\Pi_h\)</span> is the vectorial finite element interpolant.</p>
<ul class="simple">
<li><p>An “on” vectorial form (for Dirichlet):   <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">on</span><span class="p">(</span><span class="n">u</span><span class="o">=</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="kp">tgv</span><span class="o">=</span><span class="w"> </span><span class="n">none</span><span class="w"> </span><span class="n">positive</span><span class="w"> </span><span class="kp">value</span><span class="w">  </span><span class="p">)</span></code> ,</p></li>
</ul>
<blockquote>
<div><p>if the value is equal to -2 (i.e <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">tgv</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-2</span><span class="w"> </span><span class="err">`</span><span class="p">)</span><span class="w"> </span><span class="n">then</span><span class="w">   </span><span class="n">we</span><span class="w"> </span><span class="n">put</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">:</span><span class="n">math</span><span class="o">:</span><span class="err">`</span><span class="mi">0</span></code> all term of the line and colomn  <span class="math notranslate nohighlight">\(i\)</span> in the matrix, except diagonal term <span class="math notranslate nohighlight">\(a_{ii}=1\)</span>, and <span class="math notranslate nohighlight">\(b[i] = &quot;(\Pi_h g)[i]&quot;\)</span>
else if the value is equal to  -20 (i.e <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">tgv</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-20</span><span class="w"> </span><span class="err">`</span><span class="p">)</span><span class="w"> </span><span class="n">then</span><span class="w">   </span><span class="n">we</span><span class="w"> </span><span class="n">put</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">:</span><span class="n">math</span><span class="o">:</span><span class="err">`</span><span class="mi">0</span></code> all term of the line and colomn  <span class="math notranslate nohighlight">\(i\)</span> in the matrix, and <span class="math notranslate nohighlight">\(b[i] = &quot;(\Pi_h g)[i]&quot;\)</span></p>
<p>else if the value is equal to -10 (i.e <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">tgv</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-10</span><span class="w"> </span><span class="err">`</span><span class="p">)</span><span class="w"> </span><span class="n">then</span><span class="w">   </span><span class="n">we</span><span class="w"> </span><span class="n">put</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">:</span><span class="n">math</span><span class="o">:</span><span class="err">`</span><span class="mi">0</span></code> all term of the line the matrix, and <span class="math notranslate nohighlight">\(b[i] = &quot;(\Pi_h g)[i]&quot;\)</span></p>
<p>else  (i.e <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">tgv</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="err">`</span><span class="p">)</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">put</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">:</span><span class="n">math</span><span class="o">:</span><span class="err">`</span><span class="mi">0</span></code> all term of the line <span class="math notranslate nohighlight">\(i\)</span> in the matrix, except diagonal term <span class="math notranslate nohighlight">\(a_{ii}=1\)</span>, and <span class="math notranslate nohighlight">\(b[i] = &quot;(\Pi_h g)[i]&quot;\)</span>.</p>
</div></blockquote>
<ul class="simple">
<li><p>If needed, the different kind of terms in the sum can appear more than once.</p></li>
<li><p>The integral mesh and the mesh associated to test functions or unknown functions can be different in the case of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">varf</span></code> form.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">N</span><span class="p">.</span><span class="kr">y</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">N</span><span class="p">.</span><span class="kr">z</span></code> are the normal’s components.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Ns</span><span class="p">.</span><span class="kr">x</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Ns</span><span class="p">.</span><span class="kr">y</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Ns</span><span class="p">.</span><span class="kr">z</span></code> are the normal’s components of the suface in case of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">meshS</span></code> integral</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Tl</span><span class="p">.</span><span class="kr">x</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Tl</span><span class="p">.</span><span class="kr">y</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Tl</span><span class="p">.</span><span class="kr">z</span></code> are the tangent’s components of the line  in case of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">meshL</span></code> integral</p></li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is not possible to write in the same integral the linear part and the bilinear part such as in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">K</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f</span><span class="o">*</span><span class="n">w</span><span class="p">)</span></code>.</p>
</div>
</section>
<section id="numerical-integration">
<h2>Numerical Integration<a class="headerlink" href="#numerical-integration" title="Link to this heading"></a></h2>
<p>Let <span class="math notranslate nohighlight">\(D\)</span> be a <span class="math notranslate nohighlight">\(N\)</span>-dimensional bounded domain.</p>
<p>For an arbitrary polynomial <span class="math notranslate nohighlight">\(f\)</span> of degree <span class="math notranslate nohighlight">\(r\)</span>, if we can find particular (quadrature) points <span class="math notranslate nohighlight">\(\mathbf{\xi}_j,\, j=1,\cdots,J\)</span> in <span class="math notranslate nohighlight">\(D\)</span> and (quadrature) constants <span class="math notranslate nohighlight">\(\omega_j\)</span> such that</p>
<div class="math notranslate nohighlight">
\[\int_{D}f(\mathbf{x}) = \sum_{\ell =1}^L c_\ell f(\mathbf{\xi}_\ell)\]</div>
<p>then we have an error estimate (see <a class="reference internal" href="../bibliography.html#crouzeix1984" id="id5"><span>[CROUZEIX1984]</span></a>), and then there exists a constant <span class="math notranslate nohighlight">\(C&gt;0\)</span> such that</p>
<div class="math notranslate nohighlight">
\[\left|\int_{D}f(\mathbf{x}) - \sum_{\ell =1}^L \omega_\ell
f(\mathbf{\xi}_\ell )\right|
\le C|D|h^{r+1}\]</div>
<p>for any function <span class="math notranslate nohighlight">\(r + 1\)</span> times continuously differentiable <span class="math notranslate nohighlight">\(f\)</span> in <span class="math notranslate nohighlight">\(D\)</span>, where <span class="math notranslate nohighlight">\(h\)</span> is the diameter of <span class="math notranslate nohighlight">\(D\)</span> and <span class="math notranslate nohighlight">\(|D|\)</span> its measure (a point in the segment <span class="math notranslate nohighlight">\([q^iq^j]\)</span> is given as</p>
<div class="math notranslate nohighlight">
\[\{(x,y)|\; x=(1-t)q^i_x+tq^j_x,\, y=(1-t)q^i_y+tq^j_y,\, 0\le t\le 1\}\]</div>
<p>For a domain <span class="math notranslate nohighlight">\(\Omega_h=\sum_{k=1}^{n_t}T_k,\, \mathcal{T}_h=\{T_k\}\)</span>, we can calculate the integral over <span class="math notranslate nohighlight">\(\Gamma_h=\p\Omega_h\)</span> by:</p>
<p><span class="math notranslate nohighlight">\(\int_{\Gamma_h}f(\mathbf{x})ds\)</span> =<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span></code>
=<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">qfe</span><span class="o">=*</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span></code>
=<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">qforder</span><span class="o">=*</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span></code></p>
<p>where * stands for the name of the quadrature formula or the precision (order) of the Gauss formula.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="6"><p>Quadrature formula on an edge</p></th>
</tr>
<tr class="row-even"><th class="head"><p><span class="math notranslate nohighlight">\(L\)</span></p></th>
<th class="head"><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">qfe</span></code></p></th>
<th class="head"><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">qforder</span></code></p></th>
<th class="head"><p>Point in <span class="math notranslate nohighlight">\([q^i, q^j]\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\omega_\ell\)</span></p></th>
<th class="head"><p>Exact on <span class="math notranslate nohighlight">\(P_k,\ k=\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf1pE</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1/2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(||q^iq^j||\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(2\)</span></p></td>
<td><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf2pE</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((1\pm\sqrt{1/3})/2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(||q^iq^j||/2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(3\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(3\)</span></p></td>
<td><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf3pE</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(6\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((1\pm\sqrt{3/5})/2\)</span></p>
<p><span class="math notranslate nohighlight">\(1/2\)</span></p>
</td>
<td><p><span class="math notranslate nohighlight">\((5/18)||q^iq^j||\)</span></p>
<p><span class="math notranslate nohighlight">\((8/18)||q^iq^j||\)</span></p>
</td>
<td><p><span class="math notranslate nohighlight">\(5\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(4\)</span></p></td>
<td><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf4pE</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(8\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((1\pm\frac{525+70\sqrt{30}}{35})/2\)</span></p>
<p><span class="math notranslate nohighlight">\((1\pm\frac{525-70\sqrt{30}}{35})/2\)</span></p>
</td>
<td><p><span class="math notranslate nohighlight">\(\frac{18-\sqrt{30}}{72}||q^iq^j||\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{18+\sqrt{30}}{72}||q^iq^j||\)</span></p>
</td>
<td><p><span class="math notranslate nohighlight">\(7\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(5\)</span></p></td>
<td><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf5pE</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(10\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((1\pm\frac{245+14\sqrt{70}}{21})/2\)</span></p>
<p><span class="math notranslate nohighlight">\(1/2\)</span></p>
<p><span class="math notranslate nohighlight">\((1\pm\frac{245-14\sqrt{70}}{21})/2\)</span></p>
</td>
<td><p><span class="math notranslate nohighlight">\(\frac{322-13\sqrt{70}}{1800}||q^iq^j||\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{64}{225}||q^iq^j||\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{322+13\sqrt{70}}{1800}||q^iq^j||\)</span></p>
</td>
<td><p><span class="math notranslate nohighlight">\(9\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(2\)</span></p></td>
<td><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf1pElump</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p>
<p><span class="math notranslate nohighlight">\(1\)</span></p>
</td>
<td><p><span class="math notranslate nohighlight">\(||q^iq^j||/2\)</span></p>
<p><span class="math notranslate nohighlight">\(||q^iq^j||/2\)</span></p>
</td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <span class="math notranslate nohighlight">\(|q^iq^j|\)</span> is the length of segment <span class="math notranslate nohighlight">\(\overline{q^iq^j}\)</span>.</p>
<p>For a part <span class="math notranslate nohighlight">\(\Gamma_1\)</span> of <span class="math notranslate nohighlight">\(\Gamma_h\)</span> with the label “1”, we can calculate the integral over <span class="math notranslate nohighlight">\(\Gamma_1\)</span> by:</p>
<p><span class="math notranslate nohighlight">\(\int_{\Gamma_1}f(x,y)ds\)</span> =<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span></code>
=<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">qfe</span><span class="o">=</span><span class="kr">qf2pE</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span></code></p>
<p>The integrals over <span class="math notranslate nohighlight">\(\Gamma_1,\, \Gamma_3\)</span> are given by:</p>
<p><span class="math notranslate nohighlight">\(\int_{\Gamma_1\cup \Gamma_3}f(x,y)ds`=\ :freefem:`int1d(Th, 1, 3)(f)\)</span></p>
<p>For each triangle <span class="math notranslate nohighlight">\(T_k=[q^{k_1}q^{k_2}q^{k_3}]\)</span>, the point <span class="math notranslate nohighlight">\(P(x,y)\)</span> in <span class="math notranslate nohighlight">\(T_k\)</span> is expressed by the <em>area coordinate</em> as <span class="math notranslate nohighlight">\(P(\xi,\eta)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;|T_k|=\frac12 \left|
\begin{array}{ccc}
    1&amp;q^{k_1}_x&amp;q^{k_1}_y\\
    1&amp;q^{k_2}_x&amp;q^{k_2}_y\\
    1&amp;q^{k_3}_x&amp;q^{k_3}_y
\end{array}
\right|\quad
D_1=\left|
\begin{array}{ccc}
    1&amp;x&amp;y\\
    1&amp;q^{k_2}_x&amp;q^{k_2}_y\\
    1&amp;q^{k_3}_x&amp;q^{k_3}_y
\end{array}
\right|
\quad
D_2=\left|
\begin{array}{ccc}
    1&amp;q^{k_1}_x&amp;q^{k_1}_y\\
    1&amp;x&amp;y\\
    1&amp;q^{k_3}_x&amp;q^{k_3}_y
\end{array}
\right|
\quad
D_3=\left|
\begin{array}{ccc}
    1&amp;q^{k_1}_x&amp;q^{k_1}_y\\
    1&amp;q^{k_2}_x&amp;q^{k_2}_y\\
    1&amp;x&amp;y
\end{array}
\right|\\
&amp;\xi=\frac12 D_1/|T_k|\qquad
\eta=\frac12 D_2/|T_k|\qquad \textrm{then }
1-\xi-\eta=\frac12 D_3/|T_k|\end{split}\]</div>
<p>For a two dimensional domain or a border of three dimensional domain <span class="math notranslate nohighlight">\(\Omega_h=\sum_{k=1}^{n_t}T_k,\, \mathcal{T}_h=\{T_k\}\)</span>, we can calculate the integral over <span class="math notranslate nohighlight">\(\Omega_h\)</span> by:</p>
<p><span class="math notranslate nohighlight">\(\int_{\Omega_h}f(x,y)\)</span> =<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span></code>
=<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">qft</span><span class="o">=*</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span></code>
=<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">qforder</span><span class="o">=*</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span></code></p>
<p>where * stands for the name of quadrature formula or the order of the Gauss formula.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="6"><p>Quadrature formula on a triangle</p></th>
</tr>
<tr class="row-even"><th class="head"><p><span class="math notranslate nohighlight">\(L\)</span></p></th>
<th class="head"><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">qft</span></code></p></th>
<th class="head"><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">qforder</span></code></p></th>
<th class="head"><p>Point in <span class="math notranslate nohighlight">\(T_k\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\omega_\ell\)</span></p></th>
<th class="head"><p>Exact on <span class="math notranslate nohighlight">\(P_k,\ k=\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1</p></td>
<td><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf1pT</span></code></p></td>
<td><p>2</p></td>
<td><p><span class="math notranslate nohighlight">\(\left(\frac{1}{3},\frac{1}{3}\right)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(|T_k|\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf2pT</span></code></p></td>
<td><p>3</p></td>
<td><p><span class="math notranslate nohighlight">\(\left(\frac{1}{2},\frac{1}{2}\right)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left(\frac{1}{2},0\right)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left(0,\frac{1}{2}\right)\)</span></p>
</td>
<td><p><span class="math notranslate nohighlight">\(|T_k|/3\)</span></p>
<p><span class="math notranslate nohighlight">\(|T_k|/3\)</span></p>
<p><span class="math notranslate nohighlight">\(|T_k|/3\)</span></p>
</td>
<td><p><span class="math notranslate nohighlight">\(2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf5pT</span></code></p></td>
<td><p>6</p></td>
<td><p><span class="math notranslate nohighlight">\(\left(\frac{1}{3},\frac{1}{3}\right)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left(\frac{6-\sqrt{15}}{21},\frac{6-\sqrt{15}}{21}\right)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left(\frac{6-\sqrt{15}}{21},\frac{9+2\sqrt{15}}{21}\right)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left(\frac{9+2\sqrt{15}}{21},\frac{6-\sqrt{15}}{21}\right)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left(\frac{6+\sqrt{15}}{21},\frac{6+\sqrt{15}}{21}\right)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left(\frac{6+\sqrt{15}}{21},\frac{9-2\sqrt{15}}{21}\right)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left(\frac{9-2\sqrt{15}}{21},\frac{6+\sqrt{15}}{21}\right)\)</span></p>
</td>
<td><p><span class="math notranslate nohighlight">\(0.225|T_k|\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{(155-\sqrt{15})|T_k|}{1200}\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{(155-\sqrt{15})|T_k|}{1200}\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{(155-\sqrt{15})|T_k|}{1200}\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{(155+\sqrt{15})|T_k|}{1200}\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{(155+\sqrt{15})|T_k|}{1200}\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{(155+\sqrt{15})|T_k|}{1200}\)</span></p>
</td>
<td><p><span class="math notranslate nohighlight">\(5\)</span></p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf1pTlump</span></code></p></td>
<td></td>
<td><p><span class="math notranslate nohighlight">\(\left(0,0\right)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left(1,0\right)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left(0,1\right)\)</span></p>
</td>
<td><p><span class="math notranslate nohighlight">\(|T_k|/3\)</span></p>
<p><span class="math notranslate nohighlight">\(|T_k|/3\)</span></p>
<p><span class="math notranslate nohighlight">\(|T_k|/3\)</span></p>
</td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf2pT4P1</span></code></p></td>
<td></td>
<td><p><span class="math notranslate nohighlight">\(\left(\frac{1}{4},\frac{3}{4}\right)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left(\frac{3}{4},\frac{1}{4}\right)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left(0,\frac{1}{4}\right)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left(0,\frac{3}{4}\right)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left(\frac{1}{4},0\right)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left(\frac{3}{4},0\right)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left(\frac{1}{4},\frac{1}{4}\right)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left(\frac{1}{4},\frac{1}{2}\right)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left(\frac{1}{2},\frac{1}{4}\right)\)</span></p>
</td>
<td><p><span class="math notranslate nohighlight">\(|T_k|/12\)</span></p>
<p><span class="math notranslate nohighlight">\(|T_k|/12\)</span></p>
<p><span class="math notranslate nohighlight">\(|T_k|/12\)</span></p>
<p><span class="math notranslate nohighlight">\(|T_k|/12\)</span></p>
<p><span class="math notranslate nohighlight">\(|T_k|/12\)</span></p>
<p><span class="math notranslate nohighlight">\(|T_k|/12\)</span></p>
<p><span class="math notranslate nohighlight">\(|T_k|/6\)</span></p>
<p><span class="math notranslate nohighlight">\(|T_k|/6\)</span></p>
<p><span class="math notranslate nohighlight">\(|T_k|/6\)</span></p>
</td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
</tr>
<tr class="row-even"><td><p>15</p></td>
<td><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf7pT</span></code></p></td>
<td><p>8</p></td>
<td><p>See <a class="reference internal" href="../bibliography.html#taylor2005" id="id6"><span>[TAYLOR2005]</span></a> for detail</p></td>
<td></td>
<td><p>7</p></td>
</tr>
<tr class="row-odd"><td><p>21</p></td>
<td><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qf9pT</span></code></p></td>
<td><p>10</p></td>
<td><p>See <a class="reference internal" href="../bibliography.html#taylor2005" id="id7"><span>[TAYLOR2005]</span></a> for detail</p></td>
<td></td>
<td><p>9</p></td>
</tr>
</tbody>
</table>
<p>For a three dimensional domain <span class="math notranslate nohighlight">\(\Omega_h=\sum_{k=1}^{n_t}T_k,\, \mathcal{T}_h=\{T_k\}\)</span>, we can calculate the integral over <span class="math notranslate nohighlight">\(\Omega_h\)</span> by:</p>
<p><span class="math notranslate nohighlight">\(\int_{\Omega_h}f(x,y)\)</span> =<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span></code>
=<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="kp">qfV</span><span class="o">=*</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span></code>
=<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">int3D</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="kp">qforder</span><span class="o">=*</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span></code></p>
<p>where * stands for the name of quadrature formula or the order of the Gauss formula.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="6"><p>Quadrature formula on a tetrahedron</p></th>
</tr>
<tr class="row-even"><th class="head"><p><span class="math notranslate nohighlight">\(L\)</span></p></th>
<th class="head"><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">qfV</span></code></p></th>
<th class="head"><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">qforder</span></code></p></th>
<th class="head"><p>Point in <span class="math notranslate nohighlight">\(T_k\in\R^3\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\omega_\ell\)</span></p></th>
<th class="head"><p>Exact on <span class="math notranslate nohighlight">\(P_k,\ k=\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1</p></td>
<td><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qfV1</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\left(\frac{1}{4},\frac{1}{4},\frac{1}{4}\right)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(|T_k|\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qfV2</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(G4(0.58\ldots,0.13\ldots,0.13\ldots)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(|T_k|/4\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>14</p></td>
<td><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qfV5</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(6\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(G4(0.72\ldots,0.092\ldots,0.092\ldots)\)</span></p>
<p><span class="math notranslate nohighlight">\(G4(0.067\ldots,0.31\ldots,0.31\ldots)\)</span></p>
<p><span class="math notranslate nohighlight">\(G6(0.45\ldots,0.045\ldots,0.45\ldots)\)</span></p>
</td>
<td><p><span class="math notranslate nohighlight">\(0.073\ldots|T_k|\)</span></p>
<p><span class="math notranslate nohighlight">\(0.11\ldots|T_k|\)</span></p>
<p><span class="math notranslate nohighlight">\(0.042\ldots|T_k|\)</span></p>
</td>
<td><p><span class="math notranslate nohighlight">\(5\)</span></p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">qfV1lump</span></code></p></td>
<td></td>
<td><p><span class="math notranslate nohighlight">\(G4(1,0,0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(|T_k|/4\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
</tr>
</tbody>
</table>
<p>Where <span class="math notranslate nohighlight">\(G4(a,b,b)\)</span> such that <span class="math notranslate nohighlight">\(a+3b=1\)</span> is the set of the four point in barycentric coordinate:</p>
<div class="math notranslate nohighlight">
\[\{(a,b,b,b),(b,a,b,b),(b,b,a,b),(b,b,b,a)\}\]</div>
<p>and where <span class="math notranslate nohighlight">\(G6(a,b,b)\)</span> such that <span class="math notranslate nohighlight">\(2a+2b=1\)</span> is the set of the six points in barycentric coordinate:</p>
<div class="math notranslate nohighlight">
\[\{(a,a,b,b),(a,b,a,b),(a,b,b,a),(b,b,a,a),(b,a,b,a),(b,a,a,b)\}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These tetrahedral quadrature formulae come from <a class="reference external" href="http://nines.cs.kuleuven.be/research/ecf/mtables.html">http://nines.cs.kuleuven.be/research/ecf/mtables.html</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, we use the formula which is exact for polynomials of degree <span class="math notranslate nohighlight">\(5\)</span> on triangles or edges (in bold in three tables).</p>
</div>
<p>It is possible to add an own quadrature formulae with using plugin <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">qf11to25</span></code> on segment, triangle or Tetrahedron.</p>
<p>The quadrature formulae in <span class="math notranslate nohighlight">\(D\)</span> dimension is a bidimentional array of size <span class="math notranslate nohighlight">\(N_q\times (D+1)\)</span> such that the <span class="math notranslate nohighlight">\(D+1\)</span> value of on row <span class="math notranslate nohighlight">\(i=0,...,N_p-1\)</span> are <span class="math notranslate nohighlight">\(w^i,\hat{x}^i_1,...,\hat{x}^i_D\)</span> where <span class="math notranslate nohighlight">\(w^i\)</span> is the weight of the quadrature point, and <span class="math notranslate nohighlight">\(1-\sum_{k=1}^D \hat{x}^i_k ,\hat{x}^i_1,...,\hat{x}^i_D\)</span> is the barycentric coordinate the quadrature point.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">load</span><span class="w"> </span><span class="s">&quot;qf11to25&quot;</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="c1">// Quadrature on segment</span>
<span class="linenos"> 4</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">qq1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="linenos"> 5</span><span class="w">    </span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span>
<span class="linenos"> 7</span><span class="p">];</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="n">QF1</span><span class="w"> </span><span class="nf">qf1</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">qq1</span><span class="p">);</span><span class="w"> </span><span class="c1">//def of quadrature formulae qf1 on segment</span>
<span class="linenos">10</span><span class="c1">//remark:</span>
<span class="linenos">11</span><span class="c1">//1 is the order of the quadrature exact for polynome of degree &lt; 1</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="c1">//Quadrature on triangle</span>
<span class="linenos">14</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">qq2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="linenos">15</span><span class="w">    </span><span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">16</span><span class="w">    </span><span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">17</span><span class="w">    </span><span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">18</span><span class="p">];</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="n">QF2</span><span class="w"> </span><span class="nf">qf2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">qq2</span><span class="p">);</span><span class="w"> </span><span class="c1">//def of quadrature formulae qf2 on triangle</span>
<span class="linenos">21</span><span class="c1">//remark:</span>
<span class="linenos">22</span><span class="c1">//1 is the order of the quadrature exact for polynome of degree &lt; 1</span>
<span class="linenos">23</span><span class="c1">//so must have sum w^i = 1</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="c1">// Quadrature on tetrahedron</span>
<span class="linenos">26</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">qq3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="linenos">27</span><span class="w">    </span><span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">28</span><span class="w">    </span><span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">29</span><span class="w">    </span><span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">30</span><span class="w">    </span><span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">31</span><span class="p">];</span>
<span class="linenos">32</span>
<span class="linenos">33</span><span class="n">QF3</span><span class="w"> </span><span class="nf">qf3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">qq3</span><span class="p">);</span><span class="w"> </span><span class="c1">//def of quadrature formulae qf3 on get</span>
<span class="linenos">34</span><span class="c1">//remark:</span>
<span class="linenos">35</span><span class="c1">//1 is the order of the quadrature exact for polynome of degree &lt; 1)</span>
<span class="linenos">36</span>
<span class="linenos">37</span><span class="c1">// Verification in 1d and 2d</span>
<span class="linenos">38</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="linenos">39</span>
<span class="linenos">40</span><span class="kt">real</span><span class="w"> </span><span class="n">I1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">qfe</span><span class="o">=</span><span class="n">qf1</span><span class="p">)(</span><span class="kr">x</span><span class="o">^</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos">41</span><span class="kt">real</span><span class="w"> </span><span class="n">I1l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">qfe</span><span class="o">=</span><span class="kr">qf1pElump</span><span class="p">)(</span><span class="kr">x</span><span class="o">^</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos">42</span>
<span class="linenos">43</span><span class="kt">real</span><span class="w"> </span><span class="n">I2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">qft</span><span class="o">=</span><span class="n">qf2</span><span class="p">)(</span><span class="kr">x</span><span class="o">^</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos">44</span><span class="kt">real</span><span class="w"> </span><span class="n">I2l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">qft</span><span class="o">=</span><span class="kr">qf1pTlump</span><span class="p">)(</span><span class="kr">x</span><span class="o">^</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos">45</span>
<span class="linenos">46</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">I1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; == &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">I1l</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">47</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">I2</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; == &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">I2l</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">48</span><span class="nf">assert</span><span class="p">(</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">I1</span><span class="o">-</span><span class="n">I1l</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1e-10</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">49</span><span class="nf">assert</span><span class="p">(</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">I2</span><span class="o">-</span><span class="n">I2l</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1e-10</span><span class="w"> </span><span class="p">);</span>
</pre></div>
</div>
<p>The output is</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="m">1</span>.67<span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span>.67
<span class="linenos">2</span><span class="m">0</span>.335<span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span>.335
</pre></div>
</div>
</section>
<section id="variational-form-sparse-matrix-pde-data-vector">
<span id="variationalformsparsematrixpde"></span><h2>Variational Form, Sparse Matrix, PDE Data Vector<a class="headerlink" href="#variational-form-sparse-matrix-pde-data-vector" title="Link to this heading"></a></h2>
<p>In <strong>FreeFEM</strong> it is possible to define variational forms, and use them to build matrices and vectors, and store them to speed-up the script (4 times faster here).</p>
<p>For example let us solve the <a class="reference internal" href="../tutorials/thermalConduction.html#thermalconduction"><span class="std std-ref">Thermal Conduction problem</span></a>.</p>
<p>The variational formulation is in <span class="math notranslate nohighlight">\(L^2(0,T;H^1(\Omega))\)</span>; we shall seek <span class="math notranslate nohighlight">\(u^n\)</span> satisfying:</p>
<div class="math notranslate nohighlight">
\[\forall w \in V_{0}; \qquad \int_\Omega \frac{u^n-u^{n-1}}{\delta t} w + \kappa\n u^n\n w) +\int_\Gamma\alpha(u^n-u_{ue})w=0\]</div>
<p>where <span class="math notranslate nohighlight">\(V_0 = \{w\in H^1(\Omega)/ w_{|\Gamma_{24}}=0\}\)</span>.</p>
<p>So to code the method with the matrices <span class="math notranslate nohighlight">\(A=(A_{ij})\)</span>, <span class="math notranslate nohighlight">\(M=(M_{ij})\)</span>, and the vectors <span class="math notranslate nohighlight">\(u^n, b^n, b',b&quot;, b_{cl}\)</span> (notation if <span class="math notranslate nohighlight">\(w\)</span> is a vector then <span class="math notranslate nohighlight">\(w_i\)</span> is a component of the vector).</p>
<div class="math notranslate nohighlight">
\[\begin{split}u^n = A^{-1} b^n, \quad
\quad b' = b_0 + M u^{n-1},
\quad b&quot;= \frac{1}{\varepsilon} \; b_{cl},
\quad b^n_i = \left\{
\begin{array}{cl} b&quot;_i &amp; \mbox{if }\ i \in \Gamma_{24} \\
b'_i &amp; \mbox{else if } \not\in \Gamma_{24} \end{array}\right.\end{split}\]</div>
<p>Where with <span class="math notranslate nohighlight">\(\frac{1}{\varepsilon} = \mathtt{tgv} = 10^{30}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{rcl}
    A_{ij} &amp;=&amp; \left\{\begin{array}{cl} \frac{1}{\varepsilon} &amp; \mbox{if } i \in \Gamma_{24}, \mbox{and} j=i \\
    \displaystyle
        \int_{\Omega} w_j w_i / dt + k (\nabla w_j. \nabla w_i ) + \int_{\Gamma_{13}} \alpha w_j w_i &amp; \mbox{else if } i \not\in \Gamma_{24}, \mbox{or} j\ne i
        \end{array}\right.\\
        M_{ij} &amp;=&amp; \left\{\begin{array}{cl} \frac{1}{\varepsilon} &amp; \mbox{if } i \in \Gamma_{24}, \mbox{and} j=i\\
    \displaystyle
        \int_{\Omega} w_j w_i / dt
        &amp; \mbox{else if }i \not\in \Gamma_{24}, \mbox{or} j\ne i \end{array}\right. \\
        b_{0,i} &amp;=&amp; \int_{\Gamma_{13}} \alpha u_{ue} w_i \\
        b_{cl} &amp;=&amp; u^{0} \quad \mbox{the initial data}
\end{array}\end{split}\]</div>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Parameters</span>
<span class="linenos"> 2</span><span class="kt">func</span><span class="w"> </span><span class="n">fu0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">90</span><span class="o">*</span><span class="kr">x</span><span class="o">/</span><span class="mi">6</span><span class="p">;</span>
<span class="linenos"> 3</span><span class="kt">func</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.8</span><span class="o">*</span><span class="p">(</span><span class="kr">y</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span>
<span class="linenos"> 4</span><span class="kt">real</span><span class="w"> </span><span class="n">ue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">25.</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="kt">real</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25</span><span class="p">;</span>
<span class="linenos"> 6</span><span class="kt">real</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="linenos"> 7</span><span class="kt">real</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="w"> </span><span class="p">;</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="c1">// Mesh</span>
<span class="linenos">10</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">6</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="p">]);</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="c1">// Fespace</span>
<span class="linenos">13</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos">14</span><span class="n">Vh</span><span class="w"> </span><span class="n">u0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fu0</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u0</span><span class="p">;</span>
</pre></div>
</div>
<p>Create three variational formulation, and build the matrices <span class="math notranslate nohighlight">\(A\)</span>,<span class="math notranslate nohighlight">\(M\)</span>.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Problem</span>
<span class="linenos"> 2</span><span class="kt">varf</span><span class="w"> </span><span class="n">vthermic</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="linenos"> 3</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos"> 4</span><span class="w">        </span><span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="o">/</span><span class="n">dt</span>
<span class="linenos"> 5</span><span class="w">        </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="p">)</span>
<span class="linenos"> 7</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)(</span>
<span class="linenos"> 8</span><span class="w">        </span><span class="n">alpha</span><span class="o">*</span><span class="n">u</span><span class="o">*</span><span class="n">v</span>
<span class="linenos"> 9</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">10</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">11</span><span class="w">    </span><span class="p">;</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="kt">varf</span><span class="w"> </span><span class="nf">vthermic0</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="linenos">14</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)(</span>
<span class="linenos">15</span><span class="w">        </span><span class="n">alpha</span><span class="o">*</span><span class="n">ue</span><span class="o">*</span><span class="n">v</span>
<span class="linenos">16</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">17</span><span class="w">    </span><span class="p">;</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="kt">varf</span><span class="w"> </span><span class="n">vMass</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="linenos">20</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos">21</span><span class="w">        </span><span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="o">/</span><span class="n">dt</span>
<span class="linenos">22</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">23</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">24</span><span class="w">    </span><span class="p">;</span>
<span class="linenos">25</span>
<span class="linenos">26</span><span class="kt">real</span><span class="w"> </span><span class="kp">tgv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e30</span><span class="p">;</span>
<span class="linenos">27</span><span class="kt">matrix</span><span class="w"> </span><span class="kp">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vthermic</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="kp">tgv</span><span class="o">=</span><span class="kp">tgv</span><span class="p">,</span><span class="w"> </span><span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">);</span>
<span class="linenos">28</span><span class="kt">matrix</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vMass</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span>
</pre></div>
</div>
<p>Now, to build the right hand size we need 4 vectors.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">b0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vthermic0</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span><span class="w"> </span><span class="c1">//constant part of the RHS</span>
<span class="linenos">2</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">bcn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vthermic</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span><span class="w"> </span><span class="c1">//tgv on Dirichlet boundary node ( !=0 )</span>
<span class="linenos">3</span><span class="c1">//we have for the node i : i in Gamma_24 -&gt; bcn[i] != 0</span>
<span class="linenos">4</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">bcl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">tgv</span><span class="o">*</span><span class="n">u0</span><span class="p">[];</span><span class="w"> </span><span class="c1">//the Dirichlet boundary condition part</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The boundary condition is implemented by penalization and vector <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">bcn</span></code> contains the contribution of the boundary condition <span class="math notranslate nohighlight">\(u=1\)</span>, so to change the boundary condition, we have just to multiply the vector <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">bcn</span><span class="p">[]</span></code> by the current value <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">f</span></code> of the new boundary condition term by term with the operator <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">.</span><span class="o">*</span></code>.</p>
<p><a class="reference internal" href="../models/navier-stokes-equations.html#navierstokesuzawaconjugategradients"><span class="std std-ref">Uzawa model</span></a> gives a real example of using all this features.</p>
</div>
<p>And the new version of the algorithm is now:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Time loop</span>
<span class="linenos"> 2</span><span class="kt">ofstream</span><span class="w"> </span><span class="n">ff</span><span class="p">(</span><span class="s">&quot;thermic.dat&quot;</span><span class="p">);</span>
<span class="linenos"> 3</span><span class="k">for</span><span class="p">(</span><span class="kt">real</span><span class="w"> </span><span class="kp">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kp">t</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">T</span><span class="p">;</span><span class="w"> </span><span class="kp">t</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">dt</span><span class="p">){</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="c1">// Update</span>
<span class="linenos"> 5</span><span class="w">    </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b0</span><span class="p">;</span><span class="w"> </span><span class="c1">//for the RHS</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">u</span><span class="p">[];</span><span class="w"> </span><span class="c1">//add the the time dependent part</span>
<span class="linenos"> 7</span><span class="w">    </span><span class="c1">//lock boundary part:</span>
<span class="linenos"> 8</span><span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bcn</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">bcl</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="c1">//do forall i: b[i] = bcn[i] ? bcl[i] : b[i]</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="w">    </span><span class="c1">// Solve</span>
<span class="linenos">11</span><span class="w">    </span><span class="n">u</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">A</span><span class="o">^</span><span class="mi">-1</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="w">    </span><span class="c1">// Save</span>
<span class="linenos">14</span><span class="w">    </span><span class="n">ff</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kp">t</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="w">    </span><span class="c1">// Plot</span>
<span class="linenos">17</span><span class="w">    </span><span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
<span class="linenos">18</span><span class="p">}</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="c1">// Display</span>
<span class="linenos">21</span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">22</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)(</span><span class="mf">6.0</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="mf">20.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="c1">// Plot</span>
<span class="linenos">25</span><span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kp">fill</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The functions appearing in the variational form are formal and local to the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">varf</span></code> definition, the only important thing is the order in the parameter list, like in:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">varf</span><span class="w"> </span><span class="nf">vb1</span><span class="p">([</span><span class="n">u1</span><span class="p">,</span><span class="w"> </span><span class="n">u2</span><span class="p">],</span><span class="w"> </span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)((</span><span class="nf">dy</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">u2</span><span class="p">))</span><span class="o">*</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="mi">1</span><span class="o">*</span><span class="n">q</span><span class="p">);</span>
<span class="linenos">2</span><span class="kt">varf</span><span class="w"> </span><span class="nf">vb2</span><span class="p">([</span><span class="n">v1</span><span class="p">,</span><span class="w"> </span><span class="n">v2</span><span class="p">],</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)((</span><span class="nf">dy</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">v2</span><span class="p">))</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="mi">1</span><span class="o">*</span><span class="n">p</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>To build matrix <span class="math notranslate nohighlight">\(A\)</span> from the bilinear part the variational form <span class="math notranslate nohighlight">\(a\)</span> of type <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">varf</span></code> simply write:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kp">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="n">Wh</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">[]...]);</span>
<span class="linenos">2</span><span class="c1">// where</span>
<span class="linenos">3</span><span class="c1">//Vh is &quot;fespace&quot; for the unknown fields with a correct number of component</span>
<span class="linenos">4</span><span class="c1">//Wh is &quot;fespace&quot; for the test fields with a correct number of component</span>
</pre></div>
</div>
<p>Possible named parameters in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">,</span><span class="w"> </span><span class="p">[...]</span></code> are</p>
<ul>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">solver</span><span class="o">=</span></code> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">LU</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">CG</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Crout</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Cholesky</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">GMRES</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">sparsesolver</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code> …</p>
<blockquote>
<div><p>The default solver is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">GMRES</span></code>.</p>
<p>The storage mode of the matrix of the underlying linear system depends on the type of solver chosen; for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">LU</span></code> the matrix is sky-line non symmetric, for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Crout</span></code> the matrix is sky-line symmetric, for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Cholesky</span></code> the matrix is sky-line symmetric positive definite, for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">CG</span></code> the matrix is sparse symmetric positive, and for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">GMRES</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">sparsesolver</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code> the matrix is just sparse.</p>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">factorize</span><span class="w"> </span><span class="o">=</span></code> If true then do the matrix factorization for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">LU</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Cholesky</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Crout</span></code>, the default value is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">false</span></code>.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">eps</span><span class="o">=</span></code> A real expression.</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\varepsilon\)</span> sets the stopping test for the iterative methods like <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">CG</span></code>.</p>
<p>Note that if <span class="math notranslate nohighlight">\(\varepsilon\)</span> is negative then the stopping test is:</p>
<div class="math notranslate nohighlight">
\[|| A x - b || &lt; |\varepsilon|\]</div>
<p>if it is positive then the stopping test is</p>
<div class="math notranslate nohighlight">
\[|| A x - b || &lt; \frac{|\varepsilon|}{|| A x_{0} - b ||}\]</div>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">precon</span><span class="o">=</span></code> Name of a function (for example <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">P</span></code>) to set the preconditioner.</p>
<p>The prototype for the function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">P</span></code> must be:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">func</span><span class="w"> </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="kr">P</span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">xx</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">tgv</span><span class="o">=</span></code> Huge value (<span class="math notranslate nohighlight">\(10^{30}\)</span>) used to implement Dirichlet boundary conditions.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">tolpivot</span><span class="o">=</span></code> Set the tolerance of the pivot in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code> (<span class="math notranslate nohighlight">\(10^-1\)</span>) and, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">LU</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Crout</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Cholesky</span></code> factorization (<span class="math notranslate nohighlight">\(10^{-20}\)</span>).</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">tolpivotsym</span><span class="o">=</span></code> Set the tolerance of the pivot sym in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">strategy</span><span class="o">=</span></code> Set the integer UMFPACK strategy (<span class="math notranslate nohighlight">\(0\)</span> by default).</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The line of the matrix corresponding to the space <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Wh</span></code> and the column of the matrix corresponding to the space <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Vh</span></code>.</p>
</div>
<p>To build the dual vector <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">b</span></code> (of type <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>) from the linear part of the variational form <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">a</span></code> do simply:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">real</span><span class="w"> </span><span class="nf">b</span><span class="p">(</span><span class="n">Vh</span><span class="p">.</span><span class="kr">ndof</span><span class="p">);</span>
<span class="linenos">2</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span>
</pre></div>
</div>
<p>A first example to compute the area of each triangle <span class="math notranslate nohighlight">\(K\)</span> of mesh <span class="math notranslate nohighlight">\(Th\)</span>, just do:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Nh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P0</span><span class="p">);</span><span class="w"> </span><span class="c1">//the space function constant / triangle</span>
<span class="linenos">2</span><span class="n">Nh</span><span class="w"> </span><span class="n">areaK</span><span class="p">;</span>
<span class="linenos">3</span><span class="kt">varf</span><span class="w"> </span><span class="nf">varea</span><span class="w"> </span><span class="p">(</span><span class="kr">unused</span><span class="p">,</span><span class="w"> </span><span class="n">chiK</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">chiK</span><span class="p">);</span>
<span class="linenos">4</span><span class="n">etaK</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">varea</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Ph</span><span class="p">);</span>
</pre></div>
</div>
<p>Effectively, the basic functions of space <span class="math notranslate nohighlight">\(Nh\)</span>, are the characteristic function of the element of Th, and the numbering is the numeration of the element, so by construction:</p>
<div class="math notranslate nohighlight">
\[\mathtt{etaK}[i] = \int {1}_{|K_i} = \int_{K_i} 1;\]</div>
<p>Now, we can use this to compute error indicators like in example <a class="reference internal" href="../models/static-problems.html#modelstaticproblemadaptationusingresidualerrorindicator"><span class="std std-ref">Adaptation using residual error indicator</span></a>.</p>
<p>First to compute a continuous approximation to the function <span class="math notranslate nohighlight">\(h\)</span> “density mesh size” of the mesh <span class="math notranslate nohighlight">\(Th\)</span>.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos"> 2</span><span class="n">Vh</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="p">;</span>
<span class="linenos"> 3</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">count</span><span class="p">(</span><span class="n">Th</span><span class="p">.</span><span class="kr">nv</span><span class="p">);</span>
<span class="linenos"> 4</span><span class="kt">varf</span><span class="w"> </span><span class="nf">vmeshsizen</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">intalledges</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kr">qfnbpE</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">v</span><span class="p">);</span>
<span class="linenos"> 5</span><span class="kt">varf</span><span class="w"> </span><span class="n">vedgecount</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">intalledges</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kr">qfnbpE</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">v</span><span class="o">/</span><span class="kr">lenEdge</span><span class="p">);</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1">// Computation of the mesh size</span>
<span class="linenos"> 8</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vedgecount</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span><span class="w"> </span><span class="c1">//number of edge / vertex</span>
<span class="linenos"> 9</span><span class="n">h</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vmeshsizen</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span><span class="w"> </span><span class="c1">//sum length edge / vertex</span>
<span class="linenos">10</span><span class="n">h</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="p">[].</span><span class="o">/</span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="c1">//mean length edge / vertex</span>
</pre></div>
</div>
<p>To compute error indicator for Poisson equation:</p>
<div class="math notranslate nohighlight">
\[{\eta_K = \int_K h_K^2 |( f + \Delta u_h)|^2 + \int_{\partial K} h_e |[ \frac{\partial u_h}{\partial n} ]|^2 }\]</div>
<p>where <span class="math notranslate nohighlight">\(h_K\)</span> is size of the longest edge (<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">hTriangle</span></code>), <span class="math notranslate nohighlight">\(h_e\)</span> is the size of the current edge (<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">lenEdge</span></code>), <span class="math notranslate nohighlight">\(n\)</span> the normal.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Nh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P0</span><span class="p">);</span><span class="w"> </span><span class="c1">// the space function constant / triangle</span>
<span class="linenos"> 2</span><span class="n">Nh</span><span class="w"> </span><span class="n">etak</span><span class="p">;</span>
<span class="linenos"> 3</span><span class="kt">varf</span><span class="w"> </span><span class="nf">vetaK</span><span class="w"> </span><span class="p">(</span><span class="kr">unused</span><span class="p">,</span><span class="w"> </span><span class="n">chiK</span><span class="p">)</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nf">intalledges</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos"> 5</span><span class="w">        </span><span class="n">chiK</span><span class="o">*</span><span class="kr">lenEdge</span><span class="o">*</span><span class="nf">square</span><span class="p">(</span><span class="nf">jump</span><span class="p">(</span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="kr">N</span><span class="p">.</span><span class="kr">y</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)))</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="p">)</span>
<span class="linenos"> 7</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
<span class="linenos"> 8</span><span class="w">        </span><span class="n">chiK</span><span class="o">*</span><span class="nf">square</span><span class="p">(</span><span class="kr">hTriangle</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">dxx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">dyy</span><span class="p">(</span><span class="n">u</span><span class="p">)))</span>
<span class="linenos"> 9</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">10</span><span class="w">    </span><span class="p">;</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="n">etak</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vetaK</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Ph</span><span class="p">);</span>
</pre></div>
</div>
<p>We add automatic expression optimization by default, if this optimization creates problems, it can be removed with the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">optimize</span></code> as in the following example:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">varf</span><span class="w"> </span><span class="nf">a</span><span class="w"> </span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="w"> </span><span class="n">u2</span><span class="p">)</span>
<span class="linenos">2</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="kp">optimize</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span>
<span class="linenos">3</span><span class="w">        </span><span class="nf">dx</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">u2</span><span class="p">)</span>
<span class="linenos">4</span><span class="w">        </span><span class="o">+</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">u2</span><span class="p">)</span>
<span class="linenos">5</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">6</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">u1</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">7</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">u1</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">8</span><span class="w">    </span><span class="p">;</span>
</pre></div>
</div>
<p>or you can also do optimization and remove the check by setting <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">optimize</span><span class="o">=</span><span class="mi">2</span></code>.</p>
<p>Remark, it is all possible to build interpolation matrix, like in the following example:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">mesh</span><span class="w"> </span><span class="n">TH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="linenos"> 2</span><span class="kt">mesh</span><span class="w"> </span><span class="n">th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="linenos"> 3</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">VH</span><span class="p">(</span><span class="n">TH</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos"> 6</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos"> 7</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Wh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="kt">matrix</span><span class="w"> </span><span class="kp">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span><span class="n">VH</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span><span class="w"> </span><span class="c1">//build interpolation matrix Vh-&gt;VH</span>
<span class="linenos">10</span><span class="kt">matrix</span><span class="w"> </span><span class="n">BB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span><span class="n">Wh</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span><span class="w"> </span><span class="c1">//build interpolation matrix Vh-&gt;Wh</span>
</pre></div>
</div>
<p>and after some operations on sparse matrices are available for example:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">int</span><span class="w"> </span><span class="kr">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="linenos"> 2</span><span class="kt">real</span><span class="w"> </span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="kp">A</span><span class="p">(</span><span class="kr">N</span><span class="p">,</span><span class="w"> </span><span class="kr">N</span><span class="p">);</span><span class="w"> </span><span class="c1">//a full matrix</span>
<span class="linenos"> 3</span><span class="kt">real</span><span class="w"> </span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="kr">N</span><span class="p">),</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="kr">N</span><span class="p">);</span>
<span class="linenos"> 4</span><span class="kp">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="kr">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="kp">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">;</span>
<span class="linenos"> 7</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="kr">N</span><span class="p">)</span><span class="w"> </span><span class="kp">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="w">    </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="linenos"> 9</span><span class="p">}</span>
<span class="linenos">10</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">A</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
<span class="linenos">11</span><span class="kt">matrix</span><span class="w"> </span><span class="n">sparseA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">A</span><span class="p">;</span>
<span class="linenos">12</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">sparseA</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">13</span><span class="n">sparseA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">sparseA</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sparseA</span><span class="o">&#39;</span><span class="p">;</span>
<span class="linenos">14</span><span class="n">sparseA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="n">sparseA</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sparseA</span><span class="o">*</span><span class="mi">5</span><span class="p">;</span>
<span class="linenos">15</span><span class="kt">matrix</span><span class="w"> </span><span class="n">sparseB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sparseA</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sparseA</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sparseA</span><span class="p">;</span><span class="w"> </span><span class="p">;</span>
<span class="linenos">16</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;sparseB = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">sparseB</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="interpolation-matrix">
<h2>Interpolation matrix<a class="headerlink" href="#interpolation-matrix" title="Link to this heading"></a></h2>
<p>It is also possible to store the matrix of a linear interpolation operator from a finite element space <span class="math notranslate nohighlight">\(V_h\)</span> to another <span class="math notranslate nohighlight">\(W_h\)</span> to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">interpolate</span></code>(<span class="math notranslate nohighlight">\(W_h\)</span>,<span class="math notranslate nohighlight">\(V_h\)</span>,…) a function.</p>
<p>Note that the continuous finite functions are extended by continuity outside of the domain.</p>
<p>The named parameters of function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">interpolate</span></code> are:</p>
<ul>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">inside</span><span class="o">=</span></code> set true to create zero-extension.</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">t</span><span class="o">=</span></code> set true to get the transposed matrix</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">op</span><span class="o">=</span></code> set an integer written below</p>
<blockquote>
<div><ul class="simple">
<li><p>0 the default value and interpolate of the function</p></li>
<li><p>1 interpolate the <span class="math notranslate nohighlight">\(\p_x\)</span></p></li>
<li><p>2 interpolate the <span class="math notranslate nohighlight">\(\p_y\)</span></p></li>
<li><p>3 interpolate the <span class="math notranslate nohighlight">\(\p_z\)</span></p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">U2Vc</span><span class="o">=</span></code> set the which is the component of <span class="math notranslate nohighlight">\(W_h\)</span> come in <span class="math notranslate nohighlight">\(V_h\)</span> in interpolate process in a int array so the size of the array is number of component of <span class="math notranslate nohighlight">\(W_h\)</span>, if the put <span class="math notranslate nohighlight">\(-1\)</span> then component is set to <span class="math notranslate nohighlight">\(0\)</span>, like in the following example: (by default the component number is unchanged).</p>
<blockquote>
<div><div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">V4h</span><span class="p">(</span><span class="n">Th4</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nc">P1</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">]);</span>
<span class="linenos">2</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">V3h</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nc">P1</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">]);</span>
<span class="linenos">3</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">u2vc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">];</span><span class="w"> </span><span class="c1">//-1 -&gt; put zero on the component</span>
<span class="linenos">4</span><span class="kt">matrix</span><span class="w"> </span><span class="n">IV34</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span><span class="n">V3h</span><span class="p">,</span><span class="w"> </span><span class="n">V4h</span><span class="p">,</span><span class="w"> </span><span class="kp">inside</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="kp">U2Vc</span><span class="o">=</span><span class="n">u2vc</span><span class="p">);</span><span class="w"> </span><span class="c1">//V3h &lt;- V4h</span>
<span class="linenos">5</span><span class="n">V4h</span><span class="w"> </span><span class="p">[</span><span class="n">a1</span><span class="p">,</span><span class="w"> </span><span class="n">a2</span><span class="p">,</span><span class="w"> </span><span class="n">a3</span><span class="p">,</span><span class="w"> </span><span class="n">a4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">];</span>
<span class="linenos">6</span><span class="n">V3h</span><span class="w"> </span><span class="p">[</span><span class="n">b1</span><span class="p">,</span><span class="w"> </span><span class="n">b2</span><span class="p">,</span><span class="w"> </span><span class="n">b3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">];</span>
<span class="linenos">7</span><span class="n">b1</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IV34</span><span class="o">*</span><span class="n">a1</span><span class="p">[];</span>
</pre></div>
</div>
<p>So here we have: <code class="docutils literal highlight highlight-python"><span></span><span class="n">freefem</span>   <span class="n">b1</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="n">b2</span> <span class="o">==</span> <span class="mi">4</span><span class="p">,</span> <span class="n">b3</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">...</span></code></p>
</div></blockquote>
</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Matrix interpolation</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Mesh</span>
<span class="linenos"> 2</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="linenos"> 3</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kr">x</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="kr">y</span><span class="o">*</span><span class="mf">0.5</span><span class="p">]);</span>
<span class="linenos"> 4</span><span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="n">Th4</span><span class="p">,</span><span class="w"> </span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="c1">// Fespace</span>
<span class="linenos"> 7</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos"> 8</span><span class="n">Vh</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">vv</span><span class="p">;</span>
<span class="linenos"> 9</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh4</span><span class="p">(</span><span class="n">Th4</span><span class="p">,</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos">10</span><span class="n">Vh4</span><span class="w"> </span><span class="n">v4</span><span class="o">=</span><span class="kr">x</span><span class="o">*</span><span class="kr">y</span><span class="p">;</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Wh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P0</span><span class="p">);</span>
<span class="linenos">13</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Wh4</span><span class="p">(</span><span class="n">Th4</span><span class="p">,</span><span class="w"> </span><span class="nc">P0</span><span class="p">);</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="c1">// Interpolation</span>
<span class="linenos">16</span><span class="kt">matrix</span><span class="w"> </span><span class="n">IV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="n">Vh4</span><span class="p">);</span><span class="w"> </span><span class="c1">//here the function is exended by continuity</span>
<span class="linenos">17</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;IV Vh&lt;-Vh4 &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">IV</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="n">v</span><span class="o">=</span><span class="n">v4</span><span class="p">;</span>
<span class="linenos">20</span><span class="n">vv</span><span class="p">[]</span><span class="o">=</span><span class="w"> </span><span class="n">IV</span><span class="o">*</span><span class="n">v4</span><span class="p">[];</span><span class="w"> </span><span class="c1">//here v == vv</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">diff</span><span class="o">=</span><span class="w"> </span><span class="n">vv</span><span class="p">[]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">v</span><span class="p">[];</span>
<span class="linenos">23</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;|| v - vv || = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">diff</span><span class="p">.</span><span class="kr">linfty</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">24</span><span class="nf">assert</span><span class="p">(</span><span class="w"> </span><span class="n">diff</span><span class="p">.</span><span class="kr">linfty</span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">1e-6</span><span class="p">);</span>
<span class="linenos">25</span>
<span class="linenos">26</span><span class="kt">matrix</span><span class="w"> </span><span class="n">IV0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="n">Vh4</span><span class="p">,</span><span class="w"> </span><span class="kp">inside</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">//here the function is exended by zero</span>
<span class="linenos">27</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;IV Vh&lt;-Vh4 (inside=1) &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">IV0</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">28</span>
<span class="linenos">29</span><span class="kt">matrix</span><span class="w"> </span><span class="n">IVt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="n">Vh4</span><span class="p">,</span><span class="w"> </span><span class="kp">inside</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">30</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;IV Vh&lt;-Vh4^t (inside=1) &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">IVt0</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">31</span>
<span class="linenos">32</span><span class="kt">matrix</span><span class="w"> </span><span class="n">IV4t0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span><span class="n">Vh4</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span>
<span class="linenos">33</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;IV Vh4&lt;-Vh^t &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">IV4t0</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">34</span>
<span class="linenos">35</span><span class="kt">matrix</span><span class="w"> </span><span class="n">IW4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span><span class="n">Wh4</span><span class="p">,</span><span class="w"> </span><span class="n">Wh</span><span class="p">);</span>
<span class="linenos">36</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;IV Wh4&lt;-Wh &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">IW4</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">37</span>
<span class="linenos">38</span><span class="kt">matrix</span><span class="w"> </span><span class="n">IW4V</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span><span class="n">Wh4</span><span class="p">,</span><span class="w"> </span><span class="n">Vh</span><span class="p">);</span>
<span class="linenos">39</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;IV Wh4&lt;-Vh &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">IW4</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>Build interpolation matrix <span class="math notranslate nohighlight">\(A\)</span> at a array of points <span class="math notranslate nohighlight">\((xx[j],yy[j]),\ i = 0,\ 2\)</span> here:</p>
<div class="math notranslate nohighlight">
\[a_ij = dop(w^i_c (xx[j],yy[j]))\]</div>
<p>where <span class="math notranslate nohighlight">\(w_i\)</span> is the basic finite element function, <span class="math notranslate nohighlight">\(c\)</span> the component number, <span class="math notranslate nohighlight">\(dop\)</span> the type of diff operator like in op def.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">xx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">.3</span><span class="p">,</span><span class="w"> </span><span class="mf">.4</span><span class="p">],</span><span class="w"> </span><span class="n">yy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">.1</span><span class="p">,</span><span class="w"> </span><span class="mf">.4</span><span class="p">];</span>
<span class="linenos">2</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">dop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">3</span><span class="kt">matrix</span><span class="w"> </span><span class="n">Ixx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span><span class="w"> </span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">yy</span><span class="p">,</span><span class="w"> </span><span class="kp">op</span><span class="o">=</span><span class="n">dop</span><span class="p">,</span><span class="w"> </span><span class="kp">composante</span><span class="o">=</span><span class="n">c</span><span class="p">);</span>
<span class="linenos">4</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Ixx</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">5</span><span class="n">Vh</span><span class="w"> </span><span class="n">ww</span><span class="p">;</span>
<span class="linenos">6</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="nf">dd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">];</span>
<span class="linenos">7</span><span class="n">ww</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ixx</span><span class="o">*</span><span class="nf">dd</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Schwarz</p>
<p>The following shows how to implement with an interpolation matrix a domain decomposition algorithm based on Schwarz method with Robin conditions.</p>
<p>Given a non-overlapping partition <span class="math notranslate nohighlight">\(\bar\Omega=\bar\Omega_0\cup\bar\Omega_1\)</span> with <span class="math notranslate nohighlight">\(\Omega_0\cap\Omega_1=\emptyset\)</span>, <span class="math notranslate nohighlight">\(\Sigma:=\bar\Omega_0\cap\bar\Omega_1\)</span> the algorithm is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}-\Delta u_i &amp;= f \hbox{ in }\Omega_i,~i=0,1,\\
\frac{\partial(u_1-u_0)}{\partial n} + \alpha (u_1-u_0) &amp;=0\hbox{ on }\Sigma.\end{split}\]</div>
<p>The same in variational form is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{rcl}
    &amp;\int_{\Omega_i}\nabla u_i\cdot\nabla v &amp;+ \int_\Sigma\alpha u_i v = \int_{\Omega_i}f v\\
    - \int_{\Omega_j}(\nabla u_j\cdot\nabla v-f v) + \int_\Sigma\alpha u_j v,~~
    \forall v\in H^1_0(\Omega), i,j=[0,1]\cup[1,0]
\end{array}\end{split}\]</div>
<p>To discretized with the <span class="math notranslate nohighlight">\(P^1\)</span> triangular Lagrangian finite element space <span class="math notranslate nohighlight">\(V_h\)</span> simply replace <span class="math notranslate nohighlight">\(H^1_0(\Omega)\)</span> by <span class="math notranslate nohighlight">\(V_h(\Omega_0)\cup V_h(\Omega_1)\)</span>.</p>
<p>Then difficulty is to compute <span class="math notranslate nohighlight">\(\int_{\Omega_j} \nabla u_j\cdot\nabla v\)</span> when <span class="math notranslate nohighlight">\(v\)</span> is a basis function of <span class="math notranslate nohighlight">\(V_h(\Omega_i)\)</span>, <span class="math notranslate nohighlight">\(i\ne j\)</span>.</p>
<p>It is done as follows (with <span class="math notranslate nohighlight">\(\Gamma=\partial\Omega\)</span>):</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="c1">// Parameters</span>
<span class="linenos">  2</span><span class="kt">int</span><span class="w"> </span><span class="kr">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span>
<span class="linenos">  3</span><span class="kt">int</span><span class="w"> </span><span class="n">Gamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos">  4</span><span class="kt">int</span><span class="w"> </span><span class="n">Sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="linenos">  5</span>
<span class="linenos">  6</span><span class="kt">func</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span>
<span class="linenos">  7</span><span class="kt">real</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span>
<span class="linenos">  8</span>
<span class="linenos">  9</span><span class="kt">int</span><span class="w"> </span><span class="n">Niter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span>
<span class="linenos"> 10</span>
<span class="linenos"> 11</span><span class="c1">// Mesh</span>
<span class="linenos"> 12</span><span class="kt">mesh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">Th</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos"> 13</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">reg</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos"> 14</span>
<span class="linenos"> 15</span><span class="kt">border</span><span class="w"> </span><span class="nf">a0</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">Gamma</span><span class="p">;}</span>
<span class="linenos"> 16</span><span class="kt">border</span><span class="w"> </span><span class="nf">a1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">Gamma</span><span class="p">;}</span>
<span class="linenos"> 17</span><span class="kt">border</span><span class="w"> </span><span class="nf">b1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">Gamma</span><span class="p">;}</span>
<span class="linenos"> 18</span><span class="kt">border</span><span class="w"> </span><span class="nf">c1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">Gamma</span><span class="p">;}</span>
<span class="linenos"> 19</span><span class="kt">border</span><span class="w"> </span><span class="nf">c0</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">Gamma</span><span class="p">;}</span>
<span class="linenos"> 20</span><span class="kt">border</span><span class="w"> </span><span class="nf">b0</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">Gamma</span><span class="p">;}</span>
<span class="linenos"> 21</span><span class="kt">border</span><span class="w"> </span><span class="nf">d</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span><span class="w"> </span><span class="kr">label</span><span class="o">=</span><span class="n">Sigma</span><span class="p">;}</span>
<span class="linenos"> 22</span><span class="nf">plot</span><span class="p">(</span><span class="n">a0</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a1</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b1</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c1</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c0</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b0</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">d</span><span class="p">(</span><span class="kr">n</span><span class="p">));</span>
<span class="linenos"> 23</span><span class="kt">mesh</span><span class="w"> </span><span class="n">TH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">a0</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a1</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b1</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c1</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c0</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b0</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">d</span><span class="p">(</span><span class="kr">n</span><span class="p">));</span>
<span class="linenos"> 24</span>
<span class="linenos"> 25</span><span class="n">reg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TH</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">).</span><span class="kr">region</span><span class="p">;</span>
<span class="linenos"> 26</span><span class="n">reg</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TH</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">).</span><span class="kr">region</span><span class="p">;</span>
<span class="linenos"> 27</span>
<span class="linenos"> 28</span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="n">Th</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">trunc</span><span class="p">(</span><span class="n">TH</span><span class="p">,</span><span class="w"> </span><span class="kr">region</span><span class="o">==</span><span class="n">reg</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
<span class="linenos"> 29</span>
<span class="linenos"> 30</span><span class="c1">// Fespace</span>
<span class="linenos"> 31</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh0</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos"> 32</span><span class="n">Vh0</span><span class="w"> </span><span class="n">u0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 33</span>
<span class="linenos"> 34</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Vh1</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="nc">P1</span><span class="p">);</span>
<span class="linenos"> 35</span><span class="n">Vh1</span><span class="w"> </span><span class="n">u1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 36</span>
<span class="linenos"> 37</span><span class="c1">// Macro</span>
<span class="linenos"> 38</span><span class="kt">macro</span><span class="w"> </span><span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">),</span><span class="w"> </span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span><span class="w"> </span><span class="c1">//</span>
<span class="linenos"> 39</span>
<span class="linenos"> 40</span><span class="c1">// Problem</span>
<span class="linenos"> 41</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="linenos"> 42</span><span class="kt">varf</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="linenos"> 43</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="n">i</span><span class="p">])(</span>
<span class="linenos"> 44</span><span class="w">        </span><span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">&#39;*</span><span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos"> 45</span><span class="w">    </span><span class="p">)</span>
<span class="linenos"> 46</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">Sigma</span><span class="p">)(</span>
<span class="linenos"> 47</span><span class="w">        </span><span class="n">alpha</span><span class="o">*</span><span class="n">u</span><span class="o">*</span><span class="n">v</span>
<span class="linenos"> 48</span><span class="w">    </span><span class="p">)</span>
<span class="linenos"> 49</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="n">Gamma</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos"> 50</span><span class="w">    </span><span class="p">;</span>
<span class="linenos"> 51</span>
<span class="linenos"> 52</span><span class="kt">varf</span><span class="w"> </span><span class="nf">b</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="linenos"> 53</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="n">i</span><span class="p">])(</span>
<span class="linenos"> 54</span><span class="w">        </span><span class="n">f</span><span class="o">*</span><span class="n">v</span>
<span class="linenos"> 55</span><span class="w">    </span><span class="p">)</span>
<span class="linenos"> 56</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">on</span><span class="p">(</span><span class="n">Gamma</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos"> 57</span><span class="w">    </span><span class="p">;</span>
<span class="linenos"> 58</span>
<span class="linenos"> 59</span><span class="kt">varf</span><span class="w"> </span><span class="n">du1dn</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="linenos"> 60</span><span class="w">    </span><span class="o">=-</span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="mi">1</span><span class="p">])(</span>
<span class="linenos"> 61</span><span class="w">        </span><span class="n">grad</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span><span class="o">&#39;*</span><span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos"> 62</span><span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="n">f</span><span class="o">*</span><span class="n">v</span>
<span class="linenos"> 63</span><span class="w">    </span><span class="p">)</span>
<span class="linenos"> 64</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">Sigma</span><span class="p">)(</span>
<span class="linenos"> 65</span><span class="w">        </span><span class="n">alpha</span><span class="o">*</span><span class="n">u1</span><span class="o">*</span><span class="n">v</span>
<span class="linenos"> 66</span><span class="w">    </span><span class="p">)</span>
<span class="linenos"> 67</span><span class="w">    </span><span class="o">+</span><span class="nf">on</span><span class="p">(</span><span class="n">Gamma</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos"> 68</span><span class="w">    </span><span class="p">;</span>
<span class="linenos"> 69</span>
<span class="linenos"> 70</span><span class="kt">varf</span><span class="w"> </span><span class="n">du0dn</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="linenos"> 71</span><span class="w">    </span><span class="o">=-</span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="mi">0</span><span class="p">])(</span>
<span class="linenos"> 72</span><span class="w">        </span><span class="n">grad</span><span class="p">(</span><span class="n">u0</span><span class="p">)</span><span class="o">&#39;*</span><span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="linenos"> 73</span><span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="n">f</span><span class="o">*</span><span class="n">v</span>
<span class="linenos"> 74</span><span class="w">    </span><span class="p">)</span>
<span class="linenos"> 75</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">Sigma</span><span class="p">)(</span>
<span class="linenos"> 76</span><span class="w">        </span><span class="n">alpha</span><span class="o">*</span><span class="n">u0</span><span class="o">*</span><span class="n">v</span>
<span class="linenos"> 77</span><span class="w">    </span><span class="p">)</span>
<span class="linenos"> 78</span><span class="w">    </span><span class="o">+</span><span class="nf">on</span><span class="p">(</span><span class="n">Gamma</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos"> 79</span><span class="w">    </span><span class="p">;</span>
<span class="linenos"> 80</span>
<span class="linenos"> 81</span><span class="kt">matrix</span><span class="w"> </span><span class="n">I01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span><span class="n">Vh1</span><span class="p">,</span><span class="w"> </span><span class="n">Vh0</span><span class="p">);</span>
<span class="linenos"> 82</span><span class="kt">matrix</span><span class="w"> </span><span class="n">I10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span><span class="n">Vh0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh1</span><span class="p">);</span>
<span class="linenos"> 83</span>
<span class="linenos"> 84</span><span class="kt">matrix</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="kp">A</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos"> 85</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="kp">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">Vh0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh0</span><span class="p">);</span>
<span class="linenos"> 86</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="kp">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">Vh1</span><span class="p">,</span><span class="w"> </span><span class="n">Vh1</span><span class="p">);</span>
<span class="linenos"> 87</span>
<span class="linenos"> 88</span><span class="c1">// Solving loop</span>
<span class="linenos"> 89</span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">Niter</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span>
<span class="linenos"> 90</span><span class="w">    </span><span class="c1">// Solve on Th[0]</span>
<span class="linenos"> 91</span><span class="w">    </span><span class="p">{</span>
<span class="linenos"> 92</span><span class="w">        </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 93</span><span class="w">        </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">b0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh0</span><span class="p">);</span>
<span class="linenos"> 94</span><span class="w">        </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">Du1dn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">du1dn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh1</span><span class="p">);</span>
<span class="linenos"> 95</span><span class="w">        </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">Tdu1dn</span><span class="p">(</span><span class="n">Vh0</span><span class="p">.</span><span class="kr">ndof</span><span class="p">);</span><span class="w"> </span><span class="n">Tdu1dn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I01</span><span class="o">&#39;*</span><span class="n">Du1dn</span><span class="p">;</span>
<span class="linenos"> 96</span><span class="w">        </span><span class="n">b0</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">Tdu1dn</span><span class="p">;</span>
<span class="linenos"> 97</span><span class="w">        </span><span class="n">u0</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">^</span><span class="mi">-1</span><span class="o">*</span><span class="n">b0</span><span class="p">;</span>
<span class="linenos"> 98</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 99</span><span class="w">    </span><span class="c1">// Solve on Th[1]</span>
<span class="linenos">100</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">101</span><span class="w">        </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos">102</span><span class="w">        </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh1</span><span class="p">);</span>
<span class="linenos">103</span><span class="w">        </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">Du0dn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">du0dn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Vh0</span><span class="p">);</span>
<span class="linenos">104</span><span class="w">        </span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="w"> </span><span class="n">Tdu0dn</span><span class="p">(</span><span class="n">Vh1</span><span class="p">.</span><span class="kr">ndof</span><span class="p">);</span><span class="w"> </span><span class="n">Tdu0dn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I10</span><span class="o">&#39;*</span><span class="n">Du0dn</span><span class="p">;</span>
<span class="linenos">105</span><span class="w">        </span><span class="n">b1</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">Tdu0dn</span><span class="p">;</span>
<span class="linenos">106</span><span class="w">        </span><span class="n">u1</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">-1</span><span class="o">*</span><span class="n">b1</span><span class="p">;</span>
<span class="linenos">107</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">108</span><span class="w">    </span><span class="nf">plot</span><span class="p">(</span><span class="n">u0</span><span class="p">,</span><span class="w"> </span><span class="n">u1</span><span class="p">,</span><span class="w"> </span><span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;iter=&quot;</span><span class="o">+</span><span class="n">iter</span><span class="p">);</span>
<span class="linenos">109</span><span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="finite-elements-connectivity">
<h2>Finite elements connectivity<a class="headerlink" href="#finite-elements-connectivity" title="Link to this heading"></a></h2>
<p>Here, we show how to get informations on a finite element space <span class="math notranslate nohighlight">\(W_h({\cal T}_n,*)\)</span>, where “*” may be <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1</span><span class="p">,</span><span class="w"> </span><span class="nc">P2</span><span class="p">,</span><span class="w"> </span><span class="nc">P1nc</span></code>, etc.</p>
<ul class="simple">
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Wh</span><span class="p">.</span><span class="kr">nt</span></code> gives the number of element of <span class="math notranslate nohighlight">\(W_h\)</span></p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Wh</span><span class="p">.</span><span class="kr">ndof</span></code> gives the number of degrees of freedom or unknown</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Wh</span><span class="p">.</span><span class="kr">ndofK</span></code> gives the number of degrees of freedom on one element</p></li>
<li><p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Wh</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">i</span><span class="p">)</span></code> gives the number of <span class="math notranslate nohighlight">\(i\)</span>th degrees of freedom of element <span class="math notranslate nohighlight">\(k\)</span>.</p></li>
</ul>
<p>See the following example:</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Finite element connectivity</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// Mesh</span>
<span class="linenos"> 2</span><span class="kt">mesh</span><span class="w"> </span><span class="n">Th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1">// Fespace</span>
<span class="linenos"> 5</span><span class="kt">fespace</span><span class="w"> </span><span class="nf">Wh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="w"> </span><span class="nc">P2</span><span class="p">);</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Number of degree of freedom = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Wh</span><span class="p">.</span><span class="kr">ndof</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Number of degree of freedom / ELEMENT = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Wh</span><span class="p">.</span><span class="kr">ndofK</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">kdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Wh</span><span class="p">.</span><span class="kr">ndofK</span><span class="p">;</span><span class="w"> </span><span class="c1">//element 2</span>
<span class="linenos">11</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Degree of freedom of element &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="o">:</span><span class="s">&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
<span class="linenos">12</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">kdf</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">13</span><span class="w">    </span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Wh</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">;</span>
<span class="linenos">14</span><span class="kr">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="kr">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>The output is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>Number<span class="w"> </span>of<span class="w"> </span>degree<span class="w"> </span>of<span class="w"> </span><span class="nv">freedom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">121</span>
<span class="linenos">2</span>Number<span class="w"> </span>of<span class="w"> </span>degree<span class="w"> </span>of<span class="w"> </span>freedom<span class="w"> </span>/<span class="w"> </span><span class="nv">ELEMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span>
<span class="linenos">3</span>Degree<span class="w"> </span>of<span class="w"> </span>freedom<span class="w"> </span>of<span class="w"> </span>element<span class="w"> </span><span class="m">2</span>:
<span class="linenos">4</span><span class="m">78</span><span class="w"> </span><span class="m">95</span><span class="w"> </span><span class="m">83</span><span class="w"> </span><span class="m">87</span><span class="w"> </span><span class="m">79</span><span class="w"> </span><span class="m">92</span>
</pre></div>
</div>
</div>
</section>
</section>


		<div class="content-nav-buttons" role="navigation">
			<a href="mesh-generation.html" class="btn-neutral" title="previous topic" rel="previous"><span class="fa fa-arrow-circle-left"></span> Previous topic: Mesh Generation</a>
			<a href="visualization.html" class="btn-neutral" title="next topic" rel="next">Next topic: Visualization <span class="fa fa-arrow-circle-right"></span></a>
		</div>
	</div>
	
	<div id="toc">
	<div>
		<b>Table of content</b>
		<ul>
<li><a class="reference internal" href="#">Finite element</a><ul>
<li><a class="reference internal" href="#list-of-the-types-of-finite-elements">List of the types of finite elements</a></li>
<li><a class="reference internal" href="#use-of-fespace-in-2d">Use of fespace in 2D</a></li>
<li><a class="reference internal" href="#use-of-fespace-in-3d">Use of fespace in 3D</a></li>
<li><a class="reference internal" href="#use-of-fespace-in-surface-3d">Use of fespace in surface 3D</a></li>
<li><a class="reference internal" href="#finite-element-functions">Finite Element functions</a></li>
<li><a class="reference internal" href="#lagrangian-finite-elements">Lagrangian Finite Elements</a><ul>
<li><a class="reference internal" href="#p0-element">P0-element</a></li>
<li><a class="reference internal" href="#p1-element">P1-element</a></li>
<li><a class="reference internal" href="#p2-element">P2-element</a></li>
</ul>
</li>
<li><a class="reference internal" href="#surface-lagrangian-finite-elements">Surface Lagrangian Finite Elements</a><ul>
<li><a class="reference internal" href="#definition-of-the-surface-p1-lagragian-element">Definition of the surface P1 Lagragian element</a></li>
</ul>
</li>
<li><a class="reference internal" href="#p1-nonconforming-element">P1 Nonconforming Element</a></li>
<li><a class="reference internal" href="#other-fe-space">Other FE-space</a></li>
<li><a class="reference internal" href="#vector-valued-fe-function">Vector Valued FE-function</a><ul>
<li><a class="reference internal" href="#raviart-thomas-element">Raviart-Thomas Element</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-fast-finite-element-interpolator">A Fast Finite Element Interpolator</a></li>
<li><a class="reference internal" href="#keywords-problem-and-solve">Keywords: Problem and Solve</a><ul>
<li><a class="reference internal" href="#weak-form-and-boundary-condition">Weak Form and Boundary Condition</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parameters-affecting-solve-and-problem">Parameters affecting solve and problem</a></li>
<li><a class="reference internal" href="#problem-definition">Problem definition</a></li>
<li><a class="reference internal" href="#numerical-integration">Numerical Integration</a></li>
<li><a class="reference internal" href="#variational-form-sparse-matrix-pde-data-vector">Variational Form, Sparse Matrix, PDE Data Vector</a></li>
<li><a class="reference internal" href="#interpolation-matrix">Interpolation matrix</a></li>
<li><a class="reference internal" href="#finite-elements-connectivity">Finite elements connectivity</a></li>
</ul>
</li>
</ul>

	</div>
</div>
	<footer>
	<p>
		Coded with <i class="fas fa-heart"></i> since 1987
	</p>
	<a href="https://freefem.org" target="_blank"><img src='../_static/img/Symbole.svg' alt="FreeFEM logo"/></a>
	<div>
		<a id="lgpl" href="https://www.gnu.org/licenses/lgpl-3.0.txt" target="_blank">LGPL 3.0</a>
		<a href="http://doc.freefem.org/introduction/citation.html" target="_blank">BibTeX</a>
	</div>
</footer>
	

	<!-- Common -->
	<script async src="../_static/js/common.js"></script>
	<!-- Nav -->
	<script async src="../_static/js/nav.js"></script>
	<!-- Subnav -->
	<script async src="../_static/js/subnav.js"></script>
	<!-- MathJax -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
	<!-- Search -->
	<script src="../_static/js/mathjax-config.js"></script>
	<script src="../_static/js/lunr.js"></script>
	<script src="../_static/lunr/lunr_index.js"></script>
	<script src="../_static/js/search.js"></script>
	<script>
		initSearch('../')
	</script>
	<!-- Github -->
	<script async src="../_static/js/github.js"></script>
</body>

</html>